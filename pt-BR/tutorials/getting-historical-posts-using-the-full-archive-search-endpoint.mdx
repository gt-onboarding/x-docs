---
title: Obtendo posts históricos com o endpoint de busca em todo o arquivo da API do X v2
mode: wide
---

<div id="introduction">
  ## Introdução
</div>

Os [endpoints de Busca de Posts](/pt-BR/x-api/posts/search/introduction)
na v2 permitem receber Posts relacionados a tópicos de interesse,
com base em uma consulta de busca que você define. Temos dois endpoints diferentes
disponíveis na Busca de Posts v2: busca recente, disponível para todos os
desenvolvedores com uma conta aprovada e que pode buscar Posts de até sete dias,
e busca em todo o arquivo, disponível apenas para
pesquisadores aprovados para o
[trilho de produto Academic Research](https://developer.x.com/en/products/x-api/early-access/guide#na_2),
que permite buscar em todo o arquivo de Posts desde março de 2006.

Você pode ver nossa oferta completa de busca na
[página de visão geral de busca](/pt-BR/x-api/posts/search/introduction).

Esses endpoints de Busca de Posts atendem a um dos casos de uso mais comuns para
pesquisadores acadêmicos, que podem usá-los para estudos longitudinais ou para analisar
um tópico ou evento passado.

Este tutorial fornece um guia passo a passo para pesquisadores que desejam usar o
endpoint de busca em todo o arquivo para pesquisar o histórico completo de dados públicos do X.
Ele também demonstra diferentes maneiras de criar um conjunto de dados, como
recuperar Posts com geotags, e como paginar pelos Posts disponíveis para uma
consulta.

<div id="prerequisites">
  ### Pré-requisitos
</div>

Atualmente, este endpoint está disponível apenas como parte da
[trilha de produto Pesquisa Acadêmica](https://developer.x.com/en/solutions/academic-research/products-for-researchers).
Para usar este endpoint, você deve
[solicitar acesso](https://developer.x.com/en/portal/petition/academic/is-it-right-for-you).
Saiba mais sobre a
[inscrição e os requisitos para esta trilha](https://developer.x.com/en/solutions/academic-research/application-info).

<div id="connect-an-app-to-the-academic-project">
  ### Conectar um app ao projeto acadêmico
</div>

Depois que você for aprovado para usar a trilha de produto Academic Research, você verá
seu [Projeto](/pt-BR/resources/fundamentals/projects) acadêmico no
[portal do desenvolvedor](https://developer.x.com/en/portal/dashboard). Na seção
"Projects and Apps", clique em "Add App" para conectar seu
[App do X](/pt-BR/resources/fundamentals/developer-apps) ao Projeto.

[](https://res.cloudinary.com/practicaldev/image/fetch/s--gHFOyuDc--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/gb7aevhqyfvfjznd0pnd.png)

![Esta imagem exibe um Projeto acadêmico no portal do desenvolvedor que ainda não tem um App adicionado](https://cdn.cms-twdigitalassets.com/content/dam/developer-twitter/docs/tutorials/getting-historical-tweets-using-the-full-archive-search-endpoint/dev-portal-1.png.twimg.1920.png)

Em seguida, você pode escolher um App existente e conectá-lo ao seu projeto (como
mostrado abaixo).

![Esta imagem mostra a página que aparece quando você tenta adicionar um App ao seu Projeto acadêmico](https://cdn.cms-twdigitalassets.com/content/dam/developer-twitter/docs/tutorials/getting-historical-tweets-using-the-full-archive-search-endpoint/dev-portal-2.png.twimg.1920.png)

Ou você pode criar um novo App, atribuir um nome e clicar em "Complete" para conectar um novo
App ao seu Projeto acadêmico.

![Esta imagem mostra a página onde você vai inserir um nome para seu novo App ou permite que você selecione um App existente](https://cdn.cms-twdigitalassets.com/content/dam/developer-twitter/docs/tutorials/getting-historical-tweets-using-the-full-archive-search-endpoint/dev-portal-3.png.twimg.1920.png)

Isso fornecerá suas chaves de API e o
[Bearer Token](/pt-BR/resources/fundamentals/authentication#using-and-generating-an-app-only-bearer-token), que você pode
usar para se conectar ao endpoint de busca em todo o arquivo.

![Esta imagem mostra a página exibida após você criar um novo App, onde são mostradas suas chaves e tokens](https://cdn.cms-twdigitalassets.com/content/dam/developer-twitter/docs/tutorials/getting-historical-tweets-using-the-full-archive-search-endpoint/dev-portal-4.png.twimg.1920.png)

**Atenção**

As chaves na captura de tela acima estão ocultas, mas, no seu próprio portal do desenvolvedor,
você poderá ver os valores reais de API Key, API Secret Key e
Bearer Token. Salve essas chaves e o Bearer Token, pois você vai precisar delas
para chamar o endpoint de busca em todo o arquivo.

<div id="connecting-to-the-full-archive-search-endpoint">
  ### Conectando ao endpoint de busca em todo o arquivo
</div>

O comando cURL abaixo mostra como obter Posts históricos do @XDevelopers.
Substitua $BEARER\_TOKEN pelo seu próprio Bearer Token, cole a solicitação completa
no seu terminal e pressione Enter.

```bash
curl --request GET 'https://api.x.com/2/tweets/search/all?query=from:xdevelopers' --header 'Authorization: Bearer $BEARER_TOKEN'
```

Você verá o JSON de resposta.

Por padrão, apenas os 10 Posts mais recentes serão retornados. Se quiser mais
de 10 Posts por solicitação, você pode usar o parâmetro max\_results e defini-lo para
um máximo de 500 Posts por solicitação, como mostrado abaixo:

```bash
curl --request GET 'https://api.x.com/2/tweets/search/all?query=from:xdevelopers&max_results=500' --header 'Authorization: Bearer $BEARER_TOKEN'
```

###

Criando consultas

Como você pode ver nos exemplos de chamadas acima, usando o parâmetro query, é possível especificar os dados que deseja pesquisar. Por exemplo, se você quiser obter todos os Posts que contenham a palavra _covid_ ou a palavra _coronavirus_, você pode usar o operador OR entre parênteses; sua consulta pode ser `(covid OR coronavirus)` e, assim, sua chamada à API ficará como a seguir:

```bash
curl --request GET 'https://api.x.com/2/tweets/search/all?query=(covid%20OR%20coronavirus)&max_results=500' --header 'Authorization: Bearer $BEARER_TOKEN'
```

Da mesma forma, se você quiser todos os Posts que contenham a palavra _covid19_ que não sejam reposts, você pode usar o operador is:retweet com o lógico NOT (representado por -); nesse caso, sua consulta pode ser covid19 -is:retweet e sua chamada à API será:

```bash
curl --request GET 'https://api.x.com/2/tweets/search/all?query=covid19%20-is:retweet&max_results=500' --header 'Authorization: Bearer $BEARER_TOKEN'
```

Confira
[este guia para a lista completa de operadores](/pt-BR/x-api/posts/search/integrate/build-a-query)
compatíveis no endpoint de busca em todo o arquivo.

### Usando os parâmetros start\_time e end\_time para obter Posts históricos

Ao usar o endpoint de busca em todo o arquivo, por padrão serão retornados Posts dos últimos 30 dias. Se você quiser obter Posts mais antigos que 30 dias, pode usar os parâmetros start\_time e end\_time na sua chamada de API. Esses parâmetros devem estar no formato de data e hora RFC3339 válido, por exemplo 2020-12-21T13:00:00.00Z. Assim, se você quiser obter todos os Posts da conta XDevelopers no mês de dezembro de 2020, sua chamada de API será:

```bash
curl --request GET 'https://api.x.com/2/tweets/search/all?query=from:XDevelopers&start_time=2020-12-01T00:00:00.00Z&end_time=2021-01-01T00:00:00.00Z' --header 'Authorization: Bearer $BEARER_TOKEN'
```

###

Obtendo Posts históricos com geotag

Posts com geotag são Posts que têm informações geográficas associadas,
como cidade, estado, país etc.

<div id="using-hasgeo-operator">
  #### Usando o operador has:geo
</div>

Se você quiser obter posts que tenham dados geográficos, pode usar o operador has:geo.
Por exemplo, a solicitação cURL a seguir retornará apenas os posts do
perfil @XDevelopers que possuem dados geográficos:

```
curl --request GET
'https://api.x.com/2/tweets/search/all?query=from:xdevelopers%20has:geo' --header
'Authorization: Bearer $BEARER_TOKEN'
```

#### Usando o operador place\_country

Da mesma forma, você pode limitar os Posts que têm dados geográficos a um país específico usando
o operador place\_country. O comando cURL abaixo retornará todos os Posts do
@XDevelopers provenientes dos Estados Unidos:

```
curl --request GET
'https://api.x.com/2/tweets/search/all?query=from:xdevelopers%20place_country:US'
--hbasheader 'Authorization: Bearer XXXXX'
```

O país é especificado acima usando o código ISO alfa-2. Códigos ISO válidos podem ser encontrados [aqui](http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2).

### Obtendo mais de 500 Posts históricos usando o next\_token

Como mencionado acima, por padrão você só pode obter até 500 Posts por requisição
para uma consulta ao endpoint de busca em todo o arquivo. Se houver mais de 500 Posts
disponíveis para sua consulta, sua resposta JSON incluirá um next\_token que você
pode anexar à sua chamada de API para obter os próximos Posts disponíveis para essa
consulta. Esse next\_token está disponível no objeto meta da sua resposta JSON,
que se parece com:

```
{ "newest_id": "12345678...", "oldest_id": "12345678...", "result_count": 500,
"nebashxt_token": "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX" }
```

Assim, para obter os próximos Posts disponíveis, use o valor de next\_token desse
objeto meta e use esse valor como o valor de next\_token na sua chamada de API para o
endpoint de busca em todo o arquivo, conforme mostrado abaixo (você usará seu próprio Bearer Token
e o valor que obteve para o Next Token na sua chamada de API anterior).

```
curl --request GET
'https://api.x.com/2/tweets/search/all?max_results=500&query=covid&next_token=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX'
--header 'Authorization: Bearer $BEARER_TOKEN'
```

Dessa forma, você pode continuar verificando se um next\_token está disponível e, se ainda não
atingiu o número desejado de Posts a serem coletados, pode continuar chamando o
endpoint de busca em todo o arquivo com o novo next\_token a cada requisição. Lembre-se
de que o endpoint de busca em todo o arquivo conta para o seu total de
[Limites de posts](/pt-BR/x-api/fundamentals/post-cap), ou seja, o número de
Posts por mês que você pode obter pela API do X por
[Projetos e Apps](/pt-BR/resources/fundamentals/projects), portanto, tenha cuidado com a lógica do seu código ao paginar
pelos resultados para garantir que você não acabe, inadvertidamente,
esgotando seus limites de posts.

Abaixo estão alguns recursos que podem ajudar quando você estiver usando o endpoint de busca em todo o arquivo.
Adoraríamos ouvir seu feedback. Fale conosco em
[@XDevelopers](https://x.com/XDevelopers) ou em nossos
[fóruns da comunidade](https://devcommunity.x.com/) com perguntas sobre esse
endpoint.

<div id="additional-resources">
  ### Recursos adicionais
</div>

- [Referência da API da busca em todo o arquivo](/pt-BR/x-api/posts/full-archive-search)
- [Aprenda o básico de como criar uma consulta de busca](/pt-BR/x-api/posts/search/integrate/build-a-query)