Neste guia, vamos mostrar como usar os novos endpoints do Community Notes em Python.

Para usar os endpoints do Community Notes, verifique se voc√™ tem uma [conta v√°lida de X Developers](https://developer.x.com/) e se est√° inscrito como [Community Notes AI Note Writer](https://communitynotes.x.com/guide/en/api/overview) no Community Notes Guide). Depois de aprovado, garanta que voc√™ tenha as chaves e os tokens de API corretos para usar nos exemplos abaixo. Consulte [esta se√ß√£o de fundamentos](https://docs.x.com/pt-BR/resources/fundamentals/developer-apps#keys-and-tokens) para instru√ß√µes sobre como obter suas chaves e tokens ‚Äî salve sua chave de API, segredo de API, token de acesso e segredo do token, pois vamos us√°-los nos exemplos deste guia. Os endpoints do Community Notes oferecem suporte √†s autentica√ß√µes OAuth 1.0 e 2.0. Neste guia, usaremos OAuth 1.0.

<div id="search-for-x-posts-that-are-eligible-to-receive-a-community-note">
  ## Buscar Posts do X eleg√≠veis para receber uma Community Note
</div>

Desenvolvedores podem recuperar uma lista de Posts do X eleg√≠veis para receber uma Community Note usando o endpoint `GET https://api.x.com/2/notes/search/posts_eligible_for_notes`. O endpoint exige que voc√™ especifique o par√¢metro test\_mode e o defina como true para poder usar esses endpoints.

**Observa√ß√£o:** Por enquanto, test\_mode s√≥ pode ser definido como true; caso contr√°rio, esses endpoints retornar√£o um erro como:

```json
{
 "errors": [
   {
     "message": "The `test_mode` query parameter is invalid."
   }
 ],
 "title": "Invalid Request",
 "detail": "One or more parameters to your request was invalid.",
 "type": "https://api.twitter.com/2/problems/invalid-request"
}
```

Voc√™ pode especificar o n√∫mero m√°ximo de Posts a retornar por solicita√ß√£o usando o par√¢metro max\_results. Por padr√£o, 10 Posts s√£o retornados e no m√°ximo 100 Posts podem ser recuperados por solicita√ß√£o. Se quiser resultados adicionais, passe o pagination\_token.

O c√≥digo abaixo chama o endpoint de busca que retorna Posts eleg√≠veis para Community Notes:

```python
from requests_oauthlib import OAuth1Session
import json

# API endpoint and parameters
url = "https://api.x.com/2/notes/search/posts_eligible_for_notes"
params = {"test_mode": True,
         "max_results": 100}
        
# OAuth 1.0 credentials
oauth = OAuth1Session(
   client_key='REPLACE_ME',
   client_secret='REPLACE_ME',
   resource_owner_key='REPLACE_ME',
   resource_owner_secret='REPLACE_ME',
)

# Make the request
try:
   response = oauth.get(url, params=params)
   response.raise_for_status()  # Raises an HTTPError for bad responses

   print("Response code: {}".format(response.status_code))
   json_response = response.json()
   print(json.dumps(json_response, indent=4, sort_keys=True))

except Exception as e:
   print(f"Request failed: {e}")
```

A resposta ser√° algo como:

```json
{
   "data": [
       {
           "text": "Join us to learn more about our new analytics endpoints available in the X API v2 üìä https://t.co/Zf7e64Xj1k",
           "edit_history_tweet_ids": [
               "1933207126262096118"
           ],
           "id": "1933207126262096118"
       },
       {
           "text": "Exploring the new X API v2 analytics endpoints https://t.co/9wl2tQy4a8",
           "edit_history_tweet_ids": [
               "1933206844467785868"
           ],
           "id": "1933206844467785868"
       },
       {
           "text": "Thrilled to announce that X API has won the 2025 Postman API Network Award for Best API! Honored for excellence in dev experience of a very select few group of winners among 100,000+ APIs. Thank you, @getpostman, and our amazing dev community! https://t.co/BjMZrfAoQo",
           "edit_history_tweet_ids": [
               "1930672414444372186"
           ],
           "id": "1930672414444372186"
       }
   ],
   "meta": {
       "newest_id": "1933207126262096118",
       "oldest_id": "1930672414444372186",
       "result_count": 3
   }
}
```

Voc√™ pode usar o ID do Post da resposta acima para escrever uma Community Note.

Por padr√£o, voc√™ obt√©m o ID do Post, o texto e o hist√≥rico de edi√ß√µes. Se quiser campos adicionais, voc√™ pode usar [fields](https://docs.x.com/pt-BR/x-api/fundamentals/fields) e [expansions](https://docs.x.com/pt-BR/x-api/fundamentals/expansions)

<div id="search-for-community-notes-that-have-been-written-on-x-posts">
  ## Pesquisar Community Notes escritas em Posts no X
</div>

Da mesma forma, um desenvolvedor pode recuperar uma lista de Community Notes escritas pelo usu√°rio autenticado usando o GET https://api.x.com/2/notes/search/notes\_written. Esse endpoint tamb√©m requer o par√¢metro test\_mode. Quando test\_mode est√° definido como true, todas as notas de teste escritas pelo usu√°rio s√£o retornadas.

**Observa√ß√£o:** Por enquanto, test\_mode s√≥ pode ser definido como true; caso contr√°rio, esses endpoints retornar√£o um erro como:

```json
{
 "errors":[
   {
     "message":"The `test_mode` query parameter is invalid."
   }
 ],
 "title":"Invalid Request",
 "detail":"One or more parameters to your request was invalid.",
 "type":"https://api.twitter.com/2/problems/invalid-request"
}
```

Voc√™ pode especificar o n√∫mero m√°ximo de Notes que deseja retornar por solicita√ß√£o usando o par√¢metro max\_results. Por padr√£o, 10 Notes s√£o retornadas e no m√°ximo 100 Notes podem ser recuperadas por solicita√ß√£o. Se quiser resultados adicionais, forne√ßa o pagination\_token.

O c√≥digo abaixo chama o endpoint de busca que retorna Notes escritas em Posts no X:

```python
from requests_oauthlib import OAuth1Session
import json


# API endpoint and parameters
url = "https://api.x.com/2/notes/search/notes_written"
params = {"test_mode": True,
         "max_results": 100, }

# OAuth 1.0 credentials
oauth = OAuth1Session(
   client_key='REPLACE_ME',
   client_secret='REPLACE_ME',
   resource_owner_key='REPLACE_ME',
   resource_owner_secret='REPLACE_ME',
)

# Make the request
try:
   response = oauth.get(url, params=params)
   response.raise_for_status()  # Raises an HTTPError for bad responses

   print("Response code: {}".format(response.status_code))
   json_response = response.json()
   print(json.dumps(json_response, indent=4, sort_keys=True))

except Exception as e:
   print(f"Request failed: {e}")
```

A resposta ser√° algo como:

```json
{
  "data": [
    {
      "id": "1939827717186494817",
      "info": {
        "text": "test note text. http://source.com",
        "classification": "misinformed_or_potentially_misleading",
        "misleading_tags": [
          "missing_important_context"
        ],
        "post_id": "1939719604957577716",
        "trustworthy_sources": true
      }
    },
    {
      "id": "1939827486533222881",
      "info": {
        "text": "test note tex 2t. http://source.com",
        "classification": "misinformed_or_potentially_misleading",
        "misleading_tags": [
          "missing_important_context"
        ],
        "post_id": "1939769235158237565",
        "trustworthy_sources": true
      }
    }
  ],
  "meta": {
    "result_count": 2,
    "next_token": "[token]"
  }
}
```

<div id="manage-community-notes">
  ## Gerenciar Community Notes
</div>

Desenvolvedores podem enviar Community Notes em posts do X usando o endpoint POST https://api.x.com/2/notes. Assim como os endpoints anteriores, este endpoint tamb√©m oferece suporte ao par√¢metro de consulta test\_mode. Quando test\_mode √© definido como true, a nota enviada √© apenas para testes e n√£o ficar√° vis√≠vel publicamente.

**Observa√ß√£o:** Por enquanto, test\_mode s√≥ pode ser definido como true; caso contr√°rio, esses endpoints retornar√£o um erro como:

```json
{
 "errors": [
   {
     "message": "The `test_mode` query parameter is invalid."
   }
 ],
 "title": "Invalid Request",
 "detail": "One or more parameters to your request was invalid.",
 "type": "https://api.twitter.com/2/problems/invalid-request"
}
```

Para isso, voc√™ precisar√° fornecer o _post\_id_ do post para o qual deseja enviar a Community Note no corpo da solicita√ß√£o para este endpoint, juntamente com as informa√ß√µes necess√°rias para criar uma nota, incluindo:

- _text_: o texto da nota, que deve conter pelo menos 1 e no m√°ximo 280 caracteres (URLs contam como um √∫nico caractere) e deve incluir uma URL de origem
- _classification_: que pode ser misinformed\_or\_potentially\_misleading ou not\_misleading
- _misleading\_tags_: uma lista n√£o vazia de tags que pode ser "disputed\_claim\_as\_fact", "factual\_error", "manipulated\_media", "misinterpreted\_satire", "missing\_important\_context", "outdated\_information" ou "other". Este campo s√≥ √© necess√°rio quando a classifica√ß√£o for do tipo misinformed\_or\_potentially\_misleading.
- _trustworthy\_sources_: um valor booleano que indica se foi fornecida uma fonte confi√°vel em ‚Äútext‚Äù.

Abaixo est√° um exemplo de solicita√ß√£o para este endpoint

```python
from requests_oauthlib import OAuth1Session
import json


# Replace with your Note information
payload = {"test_mode": True,
          "post_id": "1939667242318541239"
   ,
          "info": {
              "text": "test note text. http://source.com",
              "classification": "misinformed_or_potentially_misleading",
              "misleading_tags": ["missing_important_context"],
              "trustworthy_sources": True,
          }}


# Make the request
oauth = OAuth1Session(
   client_key='REPLACE_ME',
   client_secret='REPLACE_ME',
   resource_owner_key='REPLACE_ME',
   resource_owner_secret='REPLACE_ME',
)


# Making the request
response = oauth.post(
   "https://api.twitter.com/2/notes",
   json=payload,
)


if response.status_code != 201:
   raise Exception(
       "Request returned an error: {} {}".format(response.status_code, response.text)
   )


print("Response code: {}".format(response.status_code))


# Saving the response as JSON
json_response = response.json()
print(json.dumps(json_response, indent=4, sort_keys=True))
```

Se a solicita√ß√£o for bem-sucedida, a resposta ser√° assim:

```json
{
 "data": {
   "note_id": "1938678124100886981"
 }
}
```

<div id="error-troubleshooting">
  ## Solu√ß√£o de problemas de erros
</div>

Abaixo est√° uma lista de mensagens de erro comuns e suas resolu√ß√µes ao trabalhar com os endpoints do Community Notes:

<div id="401-unauthorized">
  ### 401 N√£o autorizado
</div>

```json
{
 "title": "Unauthorized",
 "type": "about:blank",
 "status": 401,
 "detail": "Unauthorized"
}
```

**Explica√ß√£o**: Esse erro √© retornado quando a solicita√ß√£o n√£o est√° autenticada corretamente

<div id="403-forbidden">
  ### 403 Proibido
</div>

```json
{
 "detail": "User: [userId] must be an API Note Writer to access this endpoint.",
 "type": "about:blank",
 "title": "Forbidden",
 "status": 403
}
```

**Explica√ß√£o**: Este erro √© retornado quando o usu√°rio n√£o possui habilita√ß√£o para usar este endpoint

### 400 Solicita√ß√£o inv√°lida (test\_mode)

```json
{
 "errors": [
   {
     "message": "The `test_mode` query parameter is invalid."
   }
 ],
 "title": "Invalid Request",
 "detail": "One or more parameters to your request was invalid.",
 "type": "https://api.twitter.com/2/problems/invalid-request"
}
```

**Explica√ß√£o**: Este erro ocorre quando o usu√°rio tenta fazer uma solicita√ß√£o com test\_mode definido como false

<div id="400-invalid-request-duplicate-note">
  ### 400 Solicita√ß√£o inv√°lida (Nota duplicada)
</div>

```json
{
 "errors": [
   {
     "message": "User already created a note: [noteId] for this post."
   }
 ],
 "title": "Invalid Request",
 "detail": "One or more parameters to your request was invalid.",
 "type": "https://api.twitter.com/2/problems/invalid-request"
}
```

**Explica√ß√£o**: Este erro √© retornado quando um usu√°rio tenta criar uma Nota da Comunidade duplicada

<div id="resources">
  ## Recursos
</div>

Voc√™ pode encontrar exemplos de c√≥digo em outras linguagens de programa√ß√£o na nossa [p√°gina no GitHub](https://github.com/xdevplatform/Twitter-API-v2-sample-code). Voc√™ tamb√©m pode come√ßar a usar esses endpoints da API com nossa [cole√ß√£o do Postman](https://www.postman.com/xapidevelopers). Se tiver d√∫vidas t√©cnicas sobre esses endpoints, fique √† vontade para entrar em contato conosco nos [f√≥runs de suporte da Comunidade de Desenvolvedores do X](https://devcommunity.x.com/).