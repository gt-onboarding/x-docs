---
title: Guia rápido
sidebarTitle: Guia rápido
---

import { Button } from '/snippets/pt-BR/button.mdx';

<div id="getting-started-with-the-manage-direct-message-endpoints">
  ## Introdução aos endpoints de gerenciamento de Mensagens Diretas
</div>

Este guia de início rápido ajudará você a fazer sua primeira requisição aos endpoints de Mensagens Diretas usando o Postman, uma ferramenta para gerenciar e realizar requisições HTTP. Para saber mais sobre nossas coleções do Postman, visite o guia [Usando o Postman](/pt-BR/tutorials/postman-getting-started).

Visite nosso repositório no GitHub [Código de exemplo da API do X v2](https://github.com/xdevplatform/Twitter-API-v2-sample-code) se quiser consultar exemplos em Python. Além disso, os [kits de desenvolvimento de software (SDKs) da Plataforma de Desenvolvedores do X](/pt-BR/x-api/tools-and-libraries/sdks) oficiais serão atualizados para oferecer suporte a esses endpoints de Mensagens Diretas.

<Note>
  **Pré-requisitos**

  Para concluir este guia, você precisará de um conjunto de [chaves e tokens](/pt-BR/resources/fundamentals/authentication) para autenticar sua requisição. Você pode gerar essas chaves e tokens seguindo estas etapas:

  - [Inscreva-se para uma conta de desenvolvedor](https://developer.x.com/en/apply-for-access) e aguarde a aprovação.
  - Crie um [Projeto](/pt-BR/resources/fundamentals/projects) e um [App de desenvolvedor](/pt-BR/resources/fundamentals/developer-apps) associado no portal do desenvolvedor.
  - Acesse a página “Keys and tokens” do seu App para gerar as credenciais necessárias. Certifique-se de salvar todas as credenciais em um local seguro.
</Note>

<div id="steps-to-building-direct-message-lookup-requests">
  ### Etapas para criar solicitações de consulta de Mensagens Diretas
</div>

Neste exemplo, em uma única solicitação, criaremos uma nova conversa em grupo e adicionaremos a primeira mensagem. Em seguida, adicionaremos uma segunda mensagem à conversa criada.

<div id="step-one-start-with-a-tool-or-library">
  #### Etapa um: comece com uma ferramenta ou biblioteca
</div>

Para começar a trabalhar com os endpoints de gerenciamento de Mensagens Diretas, vamos usar a ferramenta Postman para simplificar o processo. Usaremos uma coleção, criada pela equipe XDevelopers, com exemplos de solicitações da API do X v2 para explorar seis endpoints utilizados para criar novas Mensagens Diretas e listar eventos de conversas de Mensagens Diretas.

Embora a maior parte da coleção já esteja pré-preenchida, há alguns detalhes que você precisará fornecer com base no App do X criado para hospedar essas solicitações de API. Primeiro, vamos carregar/atualizar a coleção.

Para carregar a coleção da API do X v2 no seu ambiente do Postman, clique no botão a seguir:

<Button href="https://app.getpostman.com/run-collection/9956214-784efcda-ed4c-4491-a4c0-a26470a67400">
  Adicionar API do X v2 ao Postman
</Button>

Depois que você carregar a coleção da API do X v2 no Postman, navegue até a pasta “Manage Direct Messages”. A guia Authorization desta pasta foi pré-preenchida onde possível. Você precisará atualizar algumas configurações para inserir os detalhes de autenticação do seu App do X.

Esta pasta também contém três endpoints para criar novas Mensagens Diretas. Observe que há também uma pasta "Direct Message lookup" com três endpoints disponíveis para recuperar eventos de conversas de Mensagens Diretas, incluindo o envio e o recebimento de mensagens e os momentos em que participantes entram e saem da conversa.

Como a criação de conversas em grupo é um novo recurso da API do X v2, este exemplo se concentrará nisso. Trabalharemos com o exemplo "New group DM and conversation". Usaremos essa solicitação para criar uma conversa em grupo de Mensagens Diretas.

A próxima etapa é autenticar no endpoint.

<div id="step-two-authenticate-your-request">
  #### Etapa dois: Autentique sua solicitação
</div>

Para fazer corretamente uma solicitação à API do X, você precisa verificar que tem permissão para isso. Para realizar com sucesso uma solicitação a este endpoint, usaremos o [Fluxo de Código de Autorização OAuth 2.0 com PKCE](pt-BR/resources/fundamentals/authentication#oauth-2-0-authorization-code-flow-with-pkce-2). Você pode gerar um token de acesso no Postman.

Com o Postman, você pode definir o método de autenticação no nível da pasta ou da solicitação. Aqui, configuraremos os detalhes de autenticação no nível da pasta. Navegue até a pasta "Manage Direct Messages", selecione a guia "Authorization" e confirme que o Type está definido como “OAuth 2.0” e que "Add auth data to" está definido como "Request Headers." Na seção "Current Token", certifique-se de que o "Header Prefix" está definido como Bearer.

Para configurar e gerar um novo token:

1. Crie um nome para o token, como "DM lookup".

2. Confirme que o **Grant Type** está definido como Authorization Code (with PKCE).

3. Defina sua **Callback URL**. Ela deve corresponder exatamente à Callback URL associada ao seu aplicativo no [v2 Dev Portal](https://developer.x.com/en/portal/dashboard). No App do X usado neste exemplo, a Callback URL está definida como [https://www.example.com](https://www.example.com/) (observe que, como deve corresponder exatamente, [https://example.com](https://example.com) não funcionaria).

4. Confirme que a **Auth URL** está definida como [https://x.com/i/oauth2/authorize](https://x.com/i/oauth2/authorize)

5. Confirme que a **Access Token URL** está definida como [https://api.x.com/2/oauth2/token](https://api.x.com/2/oauth2/token).\
   **Client ID** - Copie e cole o OAuth 2.0 Client ID do Developer Portal\
   **Client Secret** - Você só precisará disso se estiver usando um App do tipo cliente confidencial. Nesse caso, copie e cole o OAuth 2.0 Client Secret do Developer Portal.

6. Confirme que o **Scope** está definido como dm.read dm.write tweet.read users.read.

7. Confirme que o **State** está definido como “state”.

8. Confirme que a **Client Authentication** está definida como Send as Basic Auth header.

9. Clique em “Get New Access Token” e, como parte do processo "Sign-in with X", clique em "Authorize app".

10. Clique no botão "Proceed" e depois em "Use Token" para gerar um token.

11. Clique no botão "Save" para salvar essas configurações.

Você pode receber uma mensagem informando que não está conectado ao X. Se isso ocorrer, será necessário fazer login, no Postman, na conta do X em nome da qual você está tentando postar.

Agora que esses detalhes do OAuth 2.0 foram definidos no nível da pasta, navegue até cada um dos exemplos, acesse a guia "Authorization" e confirme que o Type está definido como "Inherit auth from parent".

Observe que esse token expirará em breve e você precisará gerá-lo novamente clicando no botão "Get New Access Token". Isso acionará o processo "Sign-in with X" e gerará um token novo para fazer solicitações.

<div id="step-three-retrieve-direct-messages-conversation-events">
  #### Etapa três: recuperar eventos de conversas de Mensagens Diretas
</div>

Ao recuperar eventos de conversas de Mensagens Diretas com este endpoint, você precisa especificar um ID de conversa. O ID de conversa faz parte do caminho do endpoint: https://api.x.com/2/dm\_conversations/:dm\_conversation\_id/dm\_events

No Postman, vá até a aba "Params" e insira o ID da conversa para a qual você deseja recuperar eventos na seção "Path Variables".

A configuração será:

|     |     |
| :--- | :--- |
| **Key** | **Value** |
| `dm_conversation_id` | `1228393702244134912` |

Com essa conversa especificada, o caminho resultante passa a ser https://api.x.com/2/dm\_conversations/1582103724607971328/dm\_events

Ao clicar no botão "Send", você receberá, na resposta, os campos padrão do objeto de Mensagem Direta: id, text e event\_type. Haverá também um objeto "meta" com o número de resultados, juntamente com tokens de paginação usados para recuperar mais eventos, se houver.

```
{
   "data": [
       {
           "event_type": "MessageCreate",
           "id": "1580705921830768647",
           "text": "hello to you two, this is a new group conversation."
       }
   ],
   "meta": {
       "result_count": 1,
       "next_token": "18LAA5FFPEKJA52G0G00ZZZZ",
       "previous_token": "1BLC45FFPEKJA52G0S00ZZZZ"
   }
}
```

Se você quiser receber campos adicionais, será necessário especificá-los na solicitação com os parâmetros [field](/pt-BR/x-api/fundamentals/fields) e/ou [expansion](/pt-BR/x-api/fundamentals/expansions).

Para este exercício, solicitaremos conjuntos adicionais de campos do objeto dm\_event:

1. Os campos padrão do objeto de Mensagem Direta: id, text e event\_type.

2. Campos adicionais do objeto de Mensagem Direta: dm\_conversation\_id, created\_at, sender\_id, attachments, participant\_ids, referenced\_tweets

No Postman, vá até a aba "Params" e adicione o seguinte par chave:valor à tabela "Query Params":

|     |     |
| :--- | :--- |
| Key | Value |
| dm\_event.fields | dm\_conversation\_id,created\_at,sender\_id,attachments,participant\_ids,referenced\_tweets |

Agora você deverá ver a seguinte URL ao lado do botão "Send":

https://api.x.com/2/dm\_conversations/:dm\_conversation\_id/dm\_events?dm\_event.fields=id,text,event\_type,dm\_conversation\_id,created\_at,sender\_id,attachments,participant\_ids,referenced\_tweets

<div id="step-four-make-your-request-and-review-your-response">
  #### Etapa quatro: faça sua solicitação e revise a resposta
</div>

Depois que tudo estiver configurado, clique no botão "Send" novamente e você receberá uma resposta semelhante à abaixo. Observe que essa resposta inclui todos os campos disponíveis de dm\_event.

```
{
   "data": [
       {
           "text": "hello to you two, this is a new group conversation.",
           "id": "1580705921830768647",
           "dm_conversation_id": "1580705921830768643",
           "event_type": "MessageCreate",
           "sender_id": "17200003",
           "created_at": "2022-10-13T23:43:54.000Z"
       }
   ],
   "meta": {
       "result_count": 1,
       "next_token": "18LAA5FFPEKJA52G0G00ZZZZ",
       "previous_token": "1BLC45FFPEKJA52G0S00ZZZZ"
   }
}
```