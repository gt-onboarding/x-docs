<div id="v2-account-activity-api-migration-guide">
  # Guia de migração da Account Activity API v2
</div>

Este guia ajuda você a migrar da antiga Enterprise Account Activity API para a Account Activity API v2. A funcionalidade principal permanece a mesma, mas a estrutura dos endpoints e os métodos de autenticação foram atualizados para manter a consistência com a API do X v2.

<div id="summary-of-changes">
  ### Resumo das alterações
</div>

- **Formato da API**: Os endpoints usam o caminho base /2/account\_activity/ em vez de /1.1/account\_activity/.
- **Gerenciamento de webhooks**: A criação, listagem, validação (CRC) e exclusão de webhooks são feitas pela [V2 Webhooks API](https://github.com/m-rosinsky/XWebhookTest/blob/main/app.py).
- **Autenticação**: Endpoints V2 exigem um dos seguintes:
  - **OAuthUser** (OAuth de 3 etapas) para ações específicas do usuário (por exemplo, inscrever um usuário).
  - **OAuth2 App Only** (Bearer Token) para ações no nível do app (por exemplo, listar/excluir inscrições).
  - A V1.1 usava requisitos variados, frequentemente OAuth 1.0a.
- **Mapeamento de endpoints**:

| Endpoint V1.1 | Equivalente/Ação na V2 | Observações |
| ----- | ----- | ----- |
| POST /1.1/account\_activity/webhooks.json?url=\<URL> | POST /2/webhooks | [Docs](https://docs.x.com/pt-BR/x-api/webhooks/introduction). Requer OAuth2AppOnly. |
| GET /1.1/account\_activity/webhooks.json | GET /2/webhooks | [Docs](https://docs.x.com/pt-BR/x-api/webhooks/introduction). Requer OAuth2AppOnly. |
| PUT /1.1/account\_activity/webhooks/:webhook\_id.json | PUT /2/webhooks/:webhook\_id | Aciona CRC. [Docs](https://docs.x.com/pt-BR/x-api/webhooks/introduction). Requer OAuth2AppOnly. |
| DELETE /1.1/account\_activity/webhooks/:webhook\_id.json | DELETE /2/webhooks/:webhook\_id | [Docs](https://docs.x.com/pt-BR/x-api/webhooks/introduction). Requer OAuth2AppOnly. |
| POST /1.1/account\_activity/webhooks/:webhook\_id/subscriptions/all.json | POST /2/account\_activity/webhooks/:webhook\_id/subscriptions/all | Requer OAuthUser. |
| GET /1.1/account\_activity/subscriptions/count.json | GET /2/account\_activity/subscriptions/count | Requer OAuth2AppOnly. |
| GET /1.1/account\_activity/webhooks/:webhook\_id/subscriptions/all.json | GET /2/account\_activity/webhooks/:webhook\_id/subscriptions/all | Requer OAuthUser. |
| GET /1.1/account\_activity/webhooks/:webhook\_id/subscriptions/all/list.json | GET /2/account\_activity/webhooks/:webhook\_id/subscriptions/all/list | Requer OAuth2AppOnly. |
| DELETE /1.1/account\_activity/webhooks/:webhook\_id/subscriptions/:user\_id/all | DELETE /2/account\_activity/webhooks/:webhook\_id/subscriptions/:user\_id/all | Requer OAuth2AppOnly. |
| DELETE /1.1/account\_activity/webhooks/:webhook\_id/subscriptions/all | Descontinuado / Sem equivalente direto | Use exclusões individuais ou remova o webhook via DELETE /2/webhooks/:webhook\_id. |

- **Formatos de resposta**: Revise as estruturas de respostas de sucesso e erro na documentação da AAAPI.

Ao migrar, atualize seu código para usar os novos caminhos base, ajuste os fluxos de autenticação e gerencie webhooks usando a [V2 Webhooks API](https://docs.x.com/pt-BR/x-api/webhooks/introduction).

<div id="how-to-migrate">
  ### Como migrar
</div>

- **Escolha um pacote**:
  - Selecione o pacote Enterprise ou Pro para acesso à Account Activity API, considerando:
    - Quantidade de webhooks necessária.
    - Assinaturas ou usuários autorizados atuais/projetados.
    - Número de aplicativos cliente do X.
    - Nível de suporte desejado (fórum vs. suporte empresarial gerenciado 1:1).
    - Detalhes de preços (entre em contato com Vendas para Enterprise).
- **Atualize sua autenticação para OAuth 2.0**:
  - Verifique se seu X App tem as permissões “Read, Write, and Access Direct Messages”.
  - Atualize para OAuth 2.0 para endpoints da V2. Reautorize os usuários se os escopos tiverem mudado.
  - Use o Developer Portal para gerenciar:
    - OAuth 2.0 Access Token.
    - Client ID e Client Secret.
- **Verifique ou reconfigure seu webhook**:
  - Use sua URL de webhook existente ou configure uma nova (por exemplo, https://your\_domain.com/webhook/twitter).
  - Siga a [documentação da V2 Webhooks API](https://docs.x.com/pt-BR/x-api/webhooks/introduction) para registrar e gerenciar seu webhook.
- **Apps de exemplo:**
  - [Servidor de webhook simples](https://github.com/m-rosinsky/XWebhookTest/blob/main/app.py)
    - Um script único em Python que mostra como responder à verificação CRC e aceitar eventos POST.
  - [Dashboard de exemplo da Account Activity API](https://github.com/xdevplatform/account-activity-dashboard-enterprise/tree/master)
    - Um aplicativo web escrito com [bun.sh](http://bun.sh) que permite gerenciar webhooks, assinaturas e receber eventos em tempo real diretamente no app.