---
title: Recuperação e redundância
sidebarTitle: Recuperação e redundância
---

<div id="introduction">
  #### Introdução
</div>

Ao consumir dados em streaming, maximizar o tempo de conexão e receber todos os dados correspondentes é um objetivo fundamental. Isso significa aproveitar conexões redundantes, detectar automaticamente desconexões, reconectar rapidamente e ter um plano para recuperar dados perdidos.

Neste guia de integração, discutiremos diferentes recursos de recuperação e redundância: conexões redundantes, backfill e recuperação.
 

**Conexões redundantes**

Uma conexão redundante simplesmente permite que você estabeleça mais de uma conexão simultânea ao fluxo filtrado. Isso oferece redundância ao possibilitar a conexão ao mesmo fluxo com dois consumidores distintos, recebendo os mesmos dados por ambas as conexões. Assim, seu app conta com um failover ativo para diversas situações, como a desconexão de um dos fluxos ou a falha do servidor principal do seu aplicativo.

Atualmente, o Fluxo filtrado permite apenas que Projetos com acesso Enterprise se conectem a até duas conexões redundantes. Para usar um fluxo redundante, basta se conectar ao mesmo URL usado para sua conexão principal. Os dados do seu fluxo serão enviados por ambas as conexões.

<div id="recovering-missed-data-after-a-disconnection-backfill">
  #### Recuperando dados perdidos após uma desconexão: Backfill
</div>

Depois de detectar uma desconexão, seu sistema deve ser capaz de se reconectar ao fluxo. Se possível, ele deve registrar por quanto tempo a desconexão durou, para que você possa usar o recurso adequado de recuperação para fazer o backfill dos dados.

Se você estiver usando um Projeto com acesso Enterprise e identificou que a desconexão durou cinco minutos ou menos, pode usar o parâmetro de backfill, backfill\_minutes. Se você enviar esse parâmetro com sua solicitação [GET /tweets/search/stream](/pt-BR/x-api/posts/filtered-stream#get-2-tweets-search-stream), receberá os Posts que correspondem às suas regras dentro dos últimos um a cinco minutos. Em geral, entregamos primeiro esses Posts mais antigos, antes de quaisquer Posts recém-correspondidos, e também não realizamos deduplicação de Posts. Isso significa que, se você ficou desconectado por 90 segundos, mas solicitar dois minutos de backfill, receberá 30 segundos de Posts duplicados, o que seu sistema deve tolerar. Aqui está um exemplo de como uma solicitação com o parâmetro de backfill pode ser:

`curl 'https://api.x.com/2/tweets/search/stream?backfill_minutes=5' -H "Authorization: Bearer $ACCESS_TOKEN"`

Se você não tiver acesso Enterprise ou identificou que a desconexão durou mais de cinco minutos, pode usar o [endpoint de busca recente](/pt-BR/x-api/posts/search/introduction) ou o recurso de recuperação para solicitar os dados perdidos. No entanto, observe que os endpoints de busca de Posts não incluem os operadores sample:, bio:, bio\_name: ou bio\_location:, e apresentam algumas diferenças no comportamento de correspondência ao usar acentos e diacríticos com os operadores de palavra-chave e #hashtag. Essas diferenças podem fazer com que você não recupere totalmente todos os Posts que poderiam ter sido recebidos pelos endpoints de fluxo filtrado.

**Recuperando dados perdidos após uma desconexão: Recovery**

Se você estiver usando um Projeto com acesso Enterprise, pode usar o recurso Recovery para recuperar dados perdidos nas últimas 24 horas caso não consiga se reconectar dentro da janela de backfill de 5 minutos.

O recurso de recovery para streaming permite uma janela de backfill estendida de 24 horas. O Recovery possibilita “reproduzir” o período de dados perdidos. Um fluxo de recovery é iniciado quando você faz uma solicitação de conexão usando os parâmetros de solicitação 'start\_time' e 'end\_time'. Uma vez conectado, o Recovery fará o re-stream do período indicado e, em seguida, desconectará.

Você poderá fazer 2 solicitações simultâneas ao Recovery ao mesmo tempo, ou seja, “duas tarefas de recovery”. O Recovery funciona tecnicamente da mesma forma que o backfill, exceto por definir um horário de início e término. Um período de recovery abrange um único intervalo de tempo.

|     |     |     |
| :--- | :--- | :--- |
| **Nome** | **Tipo** | **Descrição** |
| start\_time | date (ISO 8601) | YYYY-MM-DDTHH:mm:ssZ (ISO 8601/RFC 3339).<br /><br />Data em UTC indicando o horário de início a ser recuperado. |
| end\_time | date (ISO 8601) | YYYY-MM-DDTHH:mm:ssZ (ISO 8601/RFC 3339).<br /><br />Data em UTC indicando o horário de término a ser recuperado. |

URL de solicitação de exemplo: [https://api.x.com/2/tweets/search/stream?start\_time=2022-07-12T15:10:00Z\&end\_time=2022-07-12T15:20:00Z](https://api.x.com/2/tweets/search/stream?start_time=1985-04-12T23:20:50.52Z\&end_time=1985-04-13T00:20:50.52Z)