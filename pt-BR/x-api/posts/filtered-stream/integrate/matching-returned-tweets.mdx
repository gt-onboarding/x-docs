---
title: Correspondência de posts às regras
sidebarTitle: Correspondência de posts às regras
---

<div id="matching-returned-posts-to-their-associated-rule">
  ### Associando os Posts retornados à regra correspondente
</div>

O endpoint do Fluxo filtrado permite manter várias regras por meio de uma única conexão. Antes de começar a receber Posts no seu fluxo, você precisará criar uma regra que especifique quais tipos de Posts são do seu interesse.

Ao definir regras para corresponder a Posts com base em uma ampla variedade de atributos — incluindo atributos de usuário, geolocalização, idioma e outros — você pode anexar uma tag para distinguir essa regra em um nível mais alto. Tags são uma boa forma de contextualizar sua regra, especialmente se você tiver muitas regras ativas. As regras de filtragem determinam quais atividades de Post serão enviadas pela conexão.

Se você precisar adicionar uma nova regra de filtragem para capturar um tipo diferente de Post, ou remover uma regra existente, seu app pode enviar uma solicitação ao endpoint [POST tweets/search/stream/rules](/pt-BR/x-api/posts/filtered-stream#post-2-tweets-search-stream-rules). Quando essa solicitação é enviada, as regras de filtragem são modificadas automaticamente e as alterações entram em vigor no fluxo de dados sem necessidade de reconectar. A maioria das novas regras passa a valer em cerca de 20 segundos ou menos. É improvável, mas, dependendo de fatores externos (por exemplo, conectividade de rede), pode levar mais tempo até que você comece a receber Posts correspondentes. Se você não encontrar uma regra no endpoint de listagem, verifique se a solicitação de criação da regra foi bem-sucedida; isso pode ser feito consultando seus logs em busca de mensagens de erro.

<div id="matching-rules">
  #### Regras de correspondência
</div>

Quando uma atividade é entregue pela sua conexão do Fluxo filtrado, no array matching\_rules, ela indica qual lista de filtros correspondeu ao Post entregue.

No payload do Post há metadados adicionais em formato de string que incluem o id da regra e a tag que causaram a entrega de um Post específico. Se várias regras corresponderem a um único Post, a atividade é entregue uma única vez, com cada uma das regras correspondentes incluída nesses metadados. As regras de correspondência oferecem uma maneira simples de associar um Post específico a regras específicas, o que é especialmente útil se você tiver muitas regras distintas. Como os dados são entregues por meio de um único fluxo, é essencial garantir que id e tag sejam exclusivos para a correspondência.

**Aqui está um exemplo de como o array "matching\_rules" aparece no payload do Post:**

```"matching_rules": [
    {
      "id": "1166916266197536768",
      "tag": "test-rule-tag-00000"
    },
    {
      "id": "1166916266197536769",
      "tag": "test-rule-tag-12345"
    }
  ]
```

<div id="rule-tags">
  #### Tags de regras
</div>

No momento da criação, cada regra de filtragem pode receber uma tag. As tags de regras não têm significado especial; elas são tratadas como cadeias opacas que acompanham a regra. Elas serão incluídas nos metadados matching\_rules nas atividades retornadas e servem para facilitar a distinção das suas regras em um nível mais alto.

As tags oferecem uma maneira simples de criar agrupamentos lógicos de regras de filtragem. Por exemplo, você pode gerar um ID exclusivo para uma regra específica e usá-lo como a tag, permitindo que seu app faça referência a esse ID nas atividades que processa para associar um resultado a clientes, campanhas, categorias ou outros grupos relacionados.

Observe que as tags não podem ser atualizadas em uma regra existente e só podem ser definidas no momento da criação da regra. Para “atualizar” ou “renomear” uma tag, é necessário primeiro excluir a regra e, em seguida, adicioná-la novamente com a tag desejada. A melhor solução é usar um identificador exclusivo como tag, que seu sistema possa associar a vários outros pontos de dados dentro do próprio app, sem precisar alterar nada no conjunto de regras.

<div id="filtered-stream-recovery-and-redundancy-features">
  ### Fluxo filtrado - Recursos de recuperação e redundância
</div>

<Note>
  Observação: esses recursos de recuperação e redundância estão disponíveis apenas para quem tem acesso Enterprise.
</Note>