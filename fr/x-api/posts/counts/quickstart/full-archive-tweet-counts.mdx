---
title: Rechercher des posts (archive complète)
sidebarTitle: Rechercher des posts (archive complète)
---

import { Button } from '/snippets/fr/button.mdx';

### Premiers pas avec l’endpoint des décomptes de Posts sur l’archive complète    

Ce guide de démarrage rapide vous aidera à effectuer votre première requête vers l’endpoint des décomptes de Posts sur l’archive complète avec Postman, un outil graphique permettant d’exécuter des requêtes HTTP.

Si vous souhaitez consulter des exemples de code dans différents langages de programmation, veuillez visiter notre dépôt GitHub [X API v2 sample code](https://github.com/xdevplatform/Twitter-API-v2-sample-code).

<Note>
  ### Prérequis

  L’endpoint des décomptes de Posts sur l’archive complète est actuellement disponible uniquement pour les utilisateurs disposant d’un accès Pro ou Enterprise. Pour utiliser cet endpoint, vous devez demander un accès Pro ou [Enterprise](https://docs.google.com/forms/d/e/1FAIpQLScO3bczKWO2jFHyVZJUSEGfdyfFaqt2MvmOfl_aJp0KxMqtDA/viewform). 

  En plus de l’approbation d’accès, vous devrez disposer d’un ensemble de [keys and tokens](/fr/resources/fundamentals/authentication) pour authentifier votre requête. Vous pouvez générer ces clés et jetons en suivant ces étapes :

  - Accédez à votre [Project](/fr/resources/fundamentals/projects) avec accès Enterprise dans le portail développeur et assurez-vous d’avoir une [developer App](/fr/resources/fundamentals/developer-apps) associée au sein de ce Project.

  - Accédez à la page “Keys and tokens” de votre App pour générer les identifiants requis. Assurez-vous d’enregistrer tous les identifiants dans un emplacement sécurisé.
</Note>

<div id="steps-to-build-a-full-archive-post-counts-request">
  #### Étapes pour formuler une requête de comptages de posts sur l’archive complète
</div>

**Première étape : commencer avec un outil ou une bibliothèque**

Il existe plusieurs outils, exemples de code et bibliothèques que vous pouvez utiliser pour effectuer une requête vers cet endpoint, mais nous allons utiliser Postman ici pour simplifier le processus.

Pour charger dans votre environnement la collection Postman de l’API X v2, veuillez cliquer sur le bouton suivant :

<Button href="https://app.getpostman.com/run-collection/9956214-784efcda-ed4c-4491-a4c0-a26470a67400">
  Ajouter l’API X v2 à Postman
</Button>

Une fois la collection de l’API X v2 chargée dans Postman, accédez à Post counts > Full-archive Post counts request.

**Deuxième étape : authentifier votre requête**

Pour effectuer correctement une requête vers l’API X, vous devez vérifier que vous disposez des autorisations nécessaires. Pour ce faire avec cet endpoint, vous devez authentifier votre requête à l’aide des méthodes d’authentification [OAuth 2.0 App-Only](/fr/resources/fundamentals/authentication#app-only-authentication-and-oauth-2-0-bearer-token).

Vous devez ajouter vos clés et jetons, en particulier le [App Access Token](/fr/resources/fundamentals/authentication#using-and-generating-an-app-only-bearer-token) (également appelé App-only Bearer Token), dans Postman. Pour cela, sélectionnez l’environnement nommé « X API v2 » dans l’angle supérieur droit de Postman et ajoutez vos clés et jetons dans les champs « initial value » et « current value » (en cliquant sur l’icône en forme d’œil à côté du menu déroulant de l’environnement).

Cette variable sera automatiquement intégrée à l’onglet d’autorisation de la requête si vous avez effectué cette opération correctement.
 

**Troisième étape : créer une requête**

Chaque requête de comptages de posts sur l’archive complète nécessite une seule [requête](/fr/x-api/posts/counts/integrate/build-a-query). Pour cet exemple, nous allons utiliser une requête qui correspond aux posts publiés par le compte @XDevelopers. Pour cette requête, nous utilisons l’opérateur from et le définissons sur XDevelopers (insensible à la casse) :

`from:XDevelopers`

Dans Postman, accédez à l’onglet « Params » et saisissez cet ID, ou une chaîne d’IDs de posts séparés par des virgules, dans la colonne « Value » du paramètre `ids`.
 

| Key | Value | Description |
| :--- | :--- | :--- |
| `query` | `from:XDevelopers` | Requête à soumettre à l’endpoint de comptages de posts sur l’archive complète |

Quatrième étape (optionnelle) : spécifier la granularité et la période

Si vous cliquez sur le bouton « Send » après la troisième étape, vous obtiendrez par défaut les comptages de posts sur l’archive complète : par heure pour les 30 derniers jours. Si vous souhaitez obtenir des comptages de posts sur l’archive complète par jour, vous devrez ajouter le paramètre granularity avec la valeur day. Si vous souhaitez des comptages de posts pour une période antérieure à 30 jours, vous devrez spécifier les paramètres start\_time et end\_time avec les valeurs souhaitées. 

Dans Postman, accédez à l’onglet « Params » et ajoutez la paire clé:valeur suivante au tableau « Query Params » :

|     |     |     |
| :--- | :--- | :--- |
| **Key** | **Value** | **Description** |
| granularity | day | La granularité des résultats des comptages de posts. Valeurs possibles : day, hour ou minute |
| start\_time | 2021-05-01T00:00:00Z | L’horodatage UTC le plus ancien à partir duquel les posts seront fournis |
| end\_time | 2021-06-01T00:00:00Z | L’horodatage UTC le plus ancien à partir duquel les posts seront fournis. |

Vous devriez maintenant voir l’URL suivante à côté du bouton « Send » :

`https://api.x.com/2/tweets/counts/all?query=from%3AXDevelopers&start_time=2021-05-01T00:00:00Z&end_time=2021-06-01T00:00:00Z&granularity=day`

**Cinquième étape : envoyer votre requête et examiner la réponse**

Une fois que tout est en place, cliquez sur le bouton « Send » et vous recevrez une réponse similaire à la suivante :

```
{
   "data": [
       {
           "end": "2021-05-02T00:00:00.000Z",
           "start": "2021-05-01T00:00:00.000Z",
           "tweet_count": 0
       },
       {
           "end": "2021-05-03T00:00:00.000Z",
           "start": "2021-05-02T00:00:00.000Z",
           "tweet_count": 0
       },
       {
           "end": "2021-05-04T00:00:00.000Z",
           "start": "2021-05-03T00:00:00.000Z",
           "tweet_count": 0
       },
       {
           "end": "2021-05-05T00:00:00.000Z",
           "start": "2021-05-04T00:00:00.000Z",
           "tweet_count": 0
       },
       {
           "end": "2021-05-06T00:00:00.000Z",
           "start": "2021-05-05T00:00:00.000Z",
           "tweet_count": 0
       },
       {
           "end": "2021-05-07T00:00:00.000Z",
           "start": "2021-05-06T00:00:00.000Z",
           "tweet_count": 0
       },
       {
           "end": "2021-05-08T00:00:00.000Z",
           "start": "2021-05-07T00:00:00.000Z",
           "tweet_count": 0
       },
       {
           "end": "2021-05-09T00:00:00.000Z",
           "start": "2021-05-08T00:00:00.000Z",
           "tweet_count": 0
       },
       {
           "end": "2021-05-10T00:00:00.000Z",
           "start": "2021-05-09T00:00:00.000Z",
           "tweet_count": 0
       },
       {
           "end": "2021-05-11T00:00:00.000Z",
           "start": "2021-05-10T00:00:00.000Z",
           "tweet_count": 0
       },
       {
           "end": "2021-05-12T00:00:00.000Z",
           "start": "2021-05-11T00:00:00.000Z",
           "tweet_count": 0
       },
       {
           "end": "2021-05-13T00:00:00.000Z",
           "start": "2021-05-12T00:00:00.000Z",
           "tweet_count": 6
       },
       {
           "end": "2021-05-14T00:00:00.000Z",
           "start": "2021-05-13T00:00:00.000Z",
           "tweet_count": 1
       },
       {
           "end": "2021-05-15T00:00:00.000Z",
           "start": "2021-05-14T00:00:00.000Z",
           "tweet_count": 0
       },
       {
           "end": "2021-05-16T00:00:00.000Z",
           "start": "2021-05-15T00:00:00.000Z",
           "tweet_count": 0
       },
       {
           "end": "2021-05-17T00:00:00.000Z",
           "start": "2021-05-16T00:00:00.000Z",
           "tweet_count": 0
       },
       {
           "end": "2021-05-18T00:00:00.000Z",
           "start": "2021-05-17T00:00:00.000Z",
           "tweet_count": 0
       },
       {
           "end": "2021-05-19T00:00:00.000Z",
           "start": "2021-05-18T00:00:00.000Z",
           "tweet_count": 1
       },
       {
           "end": "2021-05-20T00:00:00.000Z",
           "start": "2021-05-19T00:00:00.000Z",
           "tweet_count": 0
       },
       {
           "end": "2021-05-21T00:00:00.000Z",
           "start": "2021-05-20T00:00:00.000Z",
           "tweet_count": 8
       },
       {
           "end": "2021-05-22T00:00:00.000Z",
           "start": "2021-05-21T00:00:00.000Z",
           "tweet_count": 1
       },
       {
           "end": "2021-05-23T00:00:00.000Z",
           "start": "2021-05-22T00:00:00.000Z",
           "tweet_count": 0
       },
       {
           "end": "2021-05-24T00:00:00.000Z",
           "start": "2021-05-23T00:00:00.000Z",
           "tweet_count": 0
       },
       {
           "end": "2021-05-25T00:00:00.000Z",
           "start": "2021-05-24T00:00:00.000Z",
           "tweet_count": 0
       },
       {
           "end": "2021-05-26T00:00:00.000Z",
           "start": "2021-05-25T00:00:00.000Z",
           "tweet_count": 1
       },
       {
           "end": "2021-05-27T00:00:00.000Z",
           "start": "2021-05-26T00:00:00.000Z",
           "tweet_count": 1
       },
       {
           "end": "2021-05-28T00:00:00.000Z",
           "start": "2021-05-27T00:00:00.000Z",
           "tweet_count": 1
       },
       {
           "end": "2021-05-29T00:00:00.000Z",
           "start": "2021-05-28T00:00:00.000Z",
           "tweet_count": 2
       },
       {
           "end": "2021-05-30T00:00:00.000Z",
           "start": "2021-05-29T00:00:00.000Z",
           "tweet_count": 0
       },
       {
           "end": "2021-05-31T00:00:00.000Z",
           "start": "2021-05-30T00:00:00.000Z",
           "tweet_count": 0
       },
       {
           "end": "2021-06-01T00:00:00.000Z",
           "start": "2021-05-31T00:00:00.000Z",
           "tweet_count": 0
       }
   ],
   "meta": {
       "total_tweet_count": 22
   }
}
```

**Étape six : paginer vos résultats**

Si l’objet meta de votre réponse contient également un next\_token, vous pouvez transmettre sa valeur au paramètre de requête next\_token.

| Key | Value | Description |
| :--- | :--- | :--- |
| next\_token | Ajoutez ici le next\_token que vous avez extrait de l’objet meta de votre requête précédente. | Si votre dernière requête ne renvoie pas le reste des résultats, vous recevrez un next\_token dans l’objet meta. Extrayez la valeur de ce champ et utilisez-la comme valeur du paramètre next\_token dans votre prochaine requête, en laissant tous les autres paramètres de requête inchangés. |

Une fois la valeur appropriée de next\_token définie, cliquez sur le bouton « Send » pour recevoir la page suivante de résultats.