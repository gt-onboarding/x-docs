---
title: v1 vers v2
sidebarTitle: v1 vers v2
---

<div id="standard-v11-compared-to-x-api-v2">
  ### Standard v1.1 comparé à l’API X v2
</div>

Si vous avez travaillé avec la [recherche/posts](/fr/x-api/posts/search/introduction) v1.1, l’objectif de ce guide est de vous aider à comprendre les similarités et les différences entre le standard et l’endpoint de recherche de posts de l’API X v2.

- **Similarités**
  - OAuth 1.0a en contexte utilisateur et OAuth 2.0 en mode application seule
  - Prise en charge de l’historique d’édition des posts et des métadonnées
- **Différences**
  - URL des endpoints

  - Exigences pour les applications et les projets

  - Format des données de réponse

  - Paramètres de requête

  - Nouveaux opérateurs de requête

  - Priorité des opérateurs AND / OR 

<div id="similarities">
  #### Similarités
</div>

**Contexte utilisateur OAuth 1.0a et authentification OAuth 2.0 App-Only**

Les endpoints v1.1 search/posts et l’API X v2 recent search prennent en charge à la fois le [contexte utilisateur OAuth 1.0a](/fr/resources/fundamentals/authentication) et [OAuth 2.0 App-Only](/fr/resources/fundamentals/authentication#oauth-2-0).

Ainsi, si vous utilisiez auparavant l’endpoint standard v1.1 search, vous pouvez continuer à utiliser la même méthode d’authentification en migrant vers la version API X v2.

Selon la bibliothèque/le package d’authentification que vous utilisez, l’authentification App-Only est probablement la plus simple pour démarrer et peut être configurée via un simple en-tête de requête. Pour savoir comment générer un jeton d’accès d’application (App Access Token), consultez ce [guide OAuth 2.0 App-Only](/fr/resources/fundamentals/authentication#bearer-token-also-known-as-app-only).

Si vous souhaitez exploiter la possibilité de récupérer des métriques privées ou publicitaires avec l’endpoint de l’API X v2, vous devrez utiliser le contexte utilisateur OAuth 1.0a et transmettre les jetons d’accès de l’utilisateur qui a publié le post pour lequel vous souhaitez récupérer des métriques.

**Prise en charge de l’historique d’édition de post et des métadonnées**

Les deux versions fournissent des métadonnées décrivant tout historique d’édition. Consultez les [références de l’API de recherche](/fr/x-api/posts/recent-search) et la [page « Principes fondamentaux » sur l’édition de posts](/fr/x-api/fundamentals/edit-posts) pour plus de détails. 

<div id="differences">
  #### Différences
</div>

**URLs des endpoints**

- Endpoints standard v1.1 :
  - https://api.x.com/1.1/search/tweets

- Endpoint API X v2 :
  - https://api.x.com/2/tweets/search/recent
     

**Exigences pour l’App et le Projet**

Les endpoints de l’API X v2 exigent que vous utilisiez des identifiants d’une [developer App](/fr/resources/fundamentals/developer-apps) associée à un [Project](/fr/resources/fundamentals/projects) lors de l’authentification de vos requêtes. Tous les endpoints de l’API X v1.1 peuvent utiliser des identifiants provenant d’Apps autonomes ou d’Apps associées à un Project. 

**Format des données de réponse**

L’une des plus grandes différences entre les versions des endpoints standard v1.1 et de l’API X v2 est la manière dont vous sélectionnez les champs renvoyés dans votre charge utile.

Pour les endpoints standard, de nombreux champs de réponse sont inclus par défaut, avec la possibilité d’utiliser des paramètres pour préciser quels champs ou ensembles de champs doivent être renvoyés dans la charge utile.

La version de l’API X v2 ne fournit par défaut que les champs id et text du Post. Pour demander des champs ou objets supplémentaires, vous devrez utiliser les paramètres [fields](/fr/x-api/fundamentals/fields) et [expansions](/fr/x-api/fundamentals/expansions). Les champs de Post que vous demandez à partir de ces endpoints seront renvoyés dans l’objet Post principal. Les objets et champs d’utilisateur, de média, de sondage ou de lieu étendus seront renvoyés dans un objet includes au sein de votre réponse. Vous pouvez ensuite faire correspondre tout objet étendu à l’objet Post en faisant correspondre les ID présents à la fois dans le Post et dans l’objet étendu. 

Nous vous encourageons à en savoir plus sur ces nouveaux paramètres dans leurs guides respectifs, ou en lisant notre guide sur [comment utiliser fields et expansions](/fr/x-api/fundamentals/data-dictionary#how-to-use-fields-and-expansions). 

Nous avons également préparé un [guide de migration du format de données](/fr/x-api/migrate/data-format-migration#migrating-from-standard-v1-1s-data-format-to-v2) qui peut vous aider à faire correspondre les champs standard v1.1 aux nouveaux champs v2. Ce guide vous fournira aussi le paramètre d’expansion et de champ spécifique que vous devrez transmettre avec votre requête v2 pour renvoyer des champs précis. 
 

En plus des changements dans la façon de demander certains champs, l’API X v2 introduit également de nouveaux schémas JSON pour les objets renvoyés par les API, y compris les objets [Post](/fr/x-api/fundamentals/data-dictionary#tweet) et [user](/fr/x-api/fundamentals/data-dictionary#user).

- Au niveau racine du JSON, les endpoints standard renvoient des objets Post dans un tableau statuses, tandis que l’API X v2 renvoie un tableau data. 
- Au lieu de faire référence aux « statuses » Retweeted et Quoted, le JSON de l’API X v2 fait référence aux Tweets Retweeted et Quoted. De nombreux champs hérités et obsolètes, tels que contributors et user.translator\_type, sont supprimés. 
- Au lieu d’utiliser à la fois favorites (dans l’objet Post) et favourites (dans l’objet user), l’API X v2 utilise le terme like. 
- X adopte la convention selon laquelle les valeurs JSON sans valeur (par exemple null) ne sont pas écrites dans la charge utile. Les attributs de Post et user ne sont inclus que s’ils ont des valeurs non nulles. 
   

Nous avons également introduit un nouvel ensemble de champs dans l’[objet Post](/fr/x-api/fundamentals/data-dictionary#tweet), notamment :

- Un champ [conversation\_id](/fr/x-api/fundamentals/conversation-id)
- Deux nouveaux champs [annotations](/fr/x-api/fundamentals/post-annotations), à savoir context et entities
- Plusieurs nouveaux champs [metrics](/fr/x-api/fundamentals/metrics) 
- Un nouveau champ reply\_setting, qui indique qui peut répondre à un Post donné

<div id="request-parameters">
  #### Paramètres de requête
</div>

Les paramètres de requête standard v1.1 suivants ont des équivalents dans l’API X v2 :

| Recherche standard v1.1 | Search Posts v2 |
| :--- | :--- |
| q   | query |
|     | start\_time (YYYY-MM-DDTHH:mm:ssZ) |
| until (YYYY-MM-DD) | end\_time (YYYY-MM-DDTHH:mm:ssZ) |
| since\_id | since\_id |
| max\_id | until\_id |
| count | max\_results |
| La réponse fournit search\_metadata.next\_results | next\_token |

Il existe également un ensemble de paramètres de requête standard de recherche de Posts **non** pris en charge dans l’API X v2 :

| **Paramètre standard v1.1** | **Détails** |
| :--- | :--- |
| geocode | Search Posts, au niveau d’accès Basic, ne prend pas en charge les opérateurs géographiques. |
| locale | Avec la recherche standard, ce paramètre servait à préciser la langue de la requête, mais n’a jamais été pleinement implémenté. |
| lang | Les endpoints Search Posts proposent un opérateur de requête lang pour la correspondance sur les langues d’intérêt. |
| include\_entities | Les entités de Post sont toujours incluses. |
| result\_type | Les endpoints Search Posts renvoient tous les Posts correspondants, quel que soit le niveau d’engagement. |
| extended | L’API X v2 est conçue dès l’origine pour prendre en charge des Posts jusqu’à 280 caractères. Avec v2, il n’existe pas de notion de Post « extended ». |

Voici un exemple de requête illustrant la différence entre une requête Standard et une requête Search Posts :

|     |     |
| :--- | :--- |
| **Standard v1.1** | **API X v2** |
| https://api.x.com/1.1/search/tweets.json?q=snow\&count=50 | https://api.x.com/2/tweets/search/recent?query=snow\&max\_results=50 |

Ces requêtes renverront toutes deux les 50 Posts les plus récents contenant le mot-clé snow. La requête v2 renverra les champs par défaut id et text des Posts correspondants. Voici un exemple spécifiant des champs supplémentaires de Post et d’utilisateur à inclure dans la charge utile JSON :

|     |
| :--- |
| **API X v2** |
| https://api.x.com/2/tweets/search/recent?query=snow\&max\_results=50\&tweet.fields=id,created\_at,author\_id,text,source,entities,attachments\&user.fields=id,name,username,description |

**Nouveaux opérateurs de requête**

Search Posts introduit de nouveaux opérateurs pour deux nouvelles fonctionnalités de l’API X v2 : 

- **[Conversation IDs](/fr/x-api/fundamentals/conversation-id)** - Au fil des conversations sur X, un ID de conversation est disponible pour marquer les Posts faisant partie de la conversation. Tous les Posts de la conversation ont leur conversation\_id défini sur l’ID du Post qui l’a initiée. 
  - `conversation_id:`
- **[Annotations X](/fr/x-api/fundamentals/post-annotations)** fournissent des informations contextuelles sur les Posts, et comprennent des annotations d’entité et de contexte. Les entités regroupent des personnes, des lieux, des produits et des organisations. Les contextes sont des domaines, ou sujets, dont font partie les entités mises en avant. Par exemple, des personnes mentionnées dans un Post peuvent avoir un contexte indiquant si elles sont athlètes, acteurs ou politiciens.  
  - context: correspond aux Posts annotés avec un contexte d’intérêt. 
  - entity: correspond aux Posts annotés avec une entité d’intérêt. 

     

#### Priorité des opérateurs AND / OR 

L’élément de base pour construire des requêtes de recherche est l’utilisation de groupements logiques OR et AND. L’API de recherche standard applique les OR avant les AND, tandis que les endpoints Search Posts (ainsi que les versions premium et enterprise) appliquent les AND avant les OR. Cette différence est cruciale lors de la traduction de requêtes entre les deux. 

Par exemple, avec la recherche standard, si vous souhaitez faire correspondre des posts contenant le mot-clé « storm » qui mentionnent le mot « colorado » ou le hashtag #COwx, vous pouvez le faire avec la requête suivante :

storm #COwx OR colorado

Avec la priorité des opérateurs de Search Posts, les AND sont appliqués avant les OR. Ainsi, la requête ci-dessus équivaut à : 

(storm #COwx) OR colorado

Cependant, la règle ci-dessus ferait correspondre tous les posts qui mentionnent « Colorado », que le post mentionne ou non « storm » ou le hashtag #COwx. En outre, elle ferait également correspondre les posts qui mentionnent à la fois le mot-clé « storm » et le hashtag #COwx. 

Pour que la requête se comporte comme prévu à l’origine, les clauses OR doivent être regroupées. La traduction de la requête standard initiale vers Search Posts serait :

storm (#COwx OR colorado)

Ces deux règles ont des comportements de correspondance très différents. Pour le mois d’octobre 2019, la règle initiale fait correspondre plus de 1 175 000 posts tandis que la règle correctement traduite fait correspondre environ 5 600 posts. Veillez à vos AND et OR, et utilisez des parenthèses lorsque nécessaire. 

<div id="curl-requests">
  #### Requêtes cURL
</div>

**La section suivante présente des requêtes cURL pour le point de terminaison standard v1.1 et son équivalent en v2.**

Les requêtes sont faites en utilisant \[OAuth 2.0 App-Only]\(https://developer.x.com(/resources/fundamentals/authentication#app-only-authentication-and-oauth-2-0-bearer-token). Pour exécuter les requêtes cURL ci-dessous, remplacez ACCESS\_TOKEN dans l’en-tête Authorization par le jeton d’accès de votre application. Pour les points de terminaison v2, ce jeton d’accès d’application doit appartenir à une [developer App](/fr/resources/fundamentals/developer-apps/overview) au sein d’un [Project](/fr/resources/fundamentals/projects/overview).

La charge utile de réponse renvoyée par le point de terminaison v1.1 sera différente de celle renvoyée par le point de terminaison v2. Avec la v2, la réponse inclura les champs par défaut, ainsi que tout autre champ demandé avec les paramètres [fields](/fr/x-api/fundamentals/fields) et [expansions](/fr/x-api/fundamentals/expansions). Vous pouvez utiliser ces paramètres pour demander un autre ensemble de champs à retourner.

**Points de terminaison v1.1 standard [GET search/tweets](https://developer.x.com/en/docs/twitter-api/v1/tweets/search/api-reference/get-search-tweets) et v2 [GET tweets/search/recent](/fr/x-api/posts/recent-search)**

```bash
      curl --request GET \
  --url 'https://api.x.com/1.1/search/tweets.json?q=from%3ATwitterDev%20-is%3Aretweet&count=100' \
  --header 'Authorization: Bearer $ACCESS_TOKEN'
```

```bash
      curl --request GET \
  --url 'https://api.x.com/2/tweets/search/recent?query=from%3ATwitterDev%20-is%3Aretweet&tweet.fields=created_at%2Cconversation_id%2Centities&max_results=100' \
  --header 'Authorization: Bearer $ACCESS_TOKEN'
```

**Prochaines étapes**

[Check out our quick start guide for X API v2 recent search](/fr/x-api/posts/search/quickstart/recent-search)

[Review the API reference for recent search](/fr/x-api/posts/recent-search)

[Check out some sample code for these endpoints](https://github.com/xdevplatform/Twitter-API-v2-sample-code "Check out some sample code for these endpoints")

[Step-by-step guide to making your first request to recent search](/fr/x-api/getting-started/make-your-first-request "Step-by-step guide to making your first request to recent search")