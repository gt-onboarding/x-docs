---
title: Recherche sur l’archive complète
sidebarTitle: Recherche sur l’archive complète
---

import { Button } from '/snippets/fr/button.mdx';

<div id="getting-started-with-the-full-archive-search-endpoint">
  ## Prise en main de l’endpoint de recherche sur l’archive complète
</div>

Ce guide de démarrage rapide vous aidera à effectuer votre première requête vers l’endpoint de recherche sur l’archive complète, avec un ensemble de champs spécifiés, à l’aide de Postman.

Si vous souhaitez consulter des exemples de code dans différents langages, veuillez visiter notre dépôt GitHub [API X v2 sample code](https://github.com/xdevplatform/Twitter-API-v2-sample-code).

<Note>
  ### Prérequis

  L’endpoint de recherche sur l’archive complète est actuellement disponible uniquement avec les niveaux d’accès Pro et Enterprise. Pour utiliser cet endpoint, vous devez passer à l’accès Pro ou [demander un accès Enterprise](https://docs.google.com/forms/d/e/1FAIpQLScO3bczKWO2jFHyVZJUSEGfdyfFaqt2MvmOfl_aJp0KxMqtDA/viewform).

  En plus d’être approuvé pour l’accès, vous devrez disposer d’un ensemble de [clés et jetons](/fr/resources/fundamentals/authentication) pour authentifier votre requête. Vous pouvez générer ces clés et jetons en suivant ces étapes :

  - Accédez à votre [Projet](/fr/resources/fundamentals/projects) avec un accès Enterprise ou Pro dans le portail développeur et assurez-vous d’avoir une [application développeur](/fr/resources/fundamentals/developer-apps) associée au sein de ce Projet.

  - Accédez à la page « Keys and tokens » de votre application pour générer les identifiants requis. Veillez à enregistrer tous les identifiants dans un emplacement sécurisé.
</Note>

<div id="steps-to-build-a-full-archive-search-request">
  ### Étapes pour créer une requête de recherche sur l’archive complète
</div>

**Étape 1 : Commencer avec un outil ou une bibliothèque**

Il existe plusieurs outils, exemples de code et bibliothèques que vous pouvez utiliser pour envoyer une requête à cet endpoint, mais nous allons utiliser l’outil Postman pour simplifier le processus.

Pour charger la collection Postman de l’API X v2 dans votre environnement, veuillez cliquer sur le bouton suivant :

<Button href="https://app.getpostman.com/run-collection/9956214-784efcda-ed4c-4491-a4c0-a26470a67400">
  Ajouter l’API X v2 à Postman
</Button>

Une fois la collection API X v2 chargée dans Postman, accédez à Search Posts > Full-archive search request.

**Étape 2 : Authentifier votre requête**

Pour effectuer correctement une requête à l’API X, vous devez vérifier que vous disposez des autorisations nécessaires. Pour ce faire avec cet endpoint, vous devez authentifier votre requête à l’aide des méthodes [OAuth 2.0 App-Only](/fr/resources/fundamentals/authentication#app-only-authentication-and-oauth-2-0-bearer-token).

Vous devez ajouter vos clés et jetons, en particulier le [App Access Token](/fr/resources/fundamentals/authentication#using-and-generating-an-app-only-bearer-token) (également appelé App-only Bearer Token) dans Postman. Pour cela, sélectionnez l’environnement nommé « X API v2 » dans le coin supérieur droit de Postman, puis ajoutez vos clés et jetons dans les champs « initial value » et « current value » (en cliquant sur l’icône en forme d’œil à côté du menu déroulant de l’environnement).

Cette variable sera automatiquement renseignée dans l’onglet Authorization de la requête si vous avez effectué cette étape correctement.
 

**Étape 3 : Créer une requête de recherche**

Chaque recherche sur l’archive complète nécessite une requête unique. Pour cet exemple, nous allons utiliser une requête qui renvoie les Posts publiés par le compte @XDevelopers. Pour cela, nous utilisons l’opérateur from et le définissons sur XDevelopers (insensible à la casse) :

`from:XDevelopers`

Dans Postman, accédez à l’onglet « Params » et saisissez cet ID, ou une liste d’IDs de Posts séparés par des virgules, dans la colonne « Value » du paramètre `ids`.
 

| Key | Value | Description |
| :--- | :--- | :--- |
| `query` | `from:XDevelopers` | Requête de recherche à soumettre à l’endpoint de recherche sur l’archive complète |

Étape 4 : Identifier et spécifier les champs que vous souhaitez récupérer

Si vous cliquez sur le bouton « Send » après l’étape trois, vous recevrez les champs par défaut du [Post object](/fr/x-api/fundamentals/data-dictionary#tweet) dans la réponse : `id`, `text` et `edit_history_tweet_ids`. Notez que si vous recevez des Posts antérieurs à la prise en charge de l’édition, le champ `edit_history_tweet_ids` ne sera pas fourni. Aucun remplissage historique n’a été effectué pour ce champ. 

Si vous souhaitez recevoir d’autres champs au-delà de ces champs par défaut, vous devez les spécifier dans votre requête à l’aide des paramètres [field](/fr/x-api/fundamentals/fields) et/ou [expansion](/fr/x-api/fundamentals/expansions).

Pour cet exercice, nous allons demander quatre ensembles différents de champs provenant d’objets distincts :

1. Les champs par défaut de l’objet Post
2. Le champ supplémentaire tweet.created\_at dans les objets Post
3. Les champs par défaut de [l’objet user](/fr/x-api/fundamentals/data-dictionary#user) des auteurs associés pour les Posts renvoyés
4. Le champ supplémentaire user.description dans les objets utilisateur associés
    

Dans Postman, accédez à l’onglet « Params » et ajoutez la paire clé:valeur suivante au tableau « Query Params » :

| Key | Value | Returned fields |
| :--- | :--- | :--- |
| `tweet.fields` | `created_at` | `tweets.created_at` |
| `expansions` | `author_id` | includes.users.id, includes.users.name, includes.users.username |
| user.fields | description | includes.users.description |

Vous devriez maintenant voir l’URL suivante à côté du bouton « Send » :

`https://api.x.com/2/tweets/search/all?query=from:XDevelopers&tweet.fields=created_at&expansions=author_id&user.fields=created_at`

<Note>
  **Veuillez noter**

  Par défaut, seuls les 10 Posts les plus récents seront renvoyés. Si vous souhaitez plus de 10 Posts par requête, vous pouvez utiliser le paramètre max\_results et le définir à un maximum de 500 Posts par requête. De même, par défaut, les Posts des 30 derniers jours seront renvoyés. Si vous souhaitez obtenir des Posts plus anciens que 30 jours, vous pouvez utiliser les paramètres start\_time et end\_time dans votre appel API.
</Note>

**Étape cinq : Envoyez votre requête et examinez la réponse**

Une fois que tout est configuré, cliquez sur le bouton « Send » et vous recevrez une réponse semblable à ce qui suit :

```
{
   "data": [
       {
           "author_id": "2244994945",
           "created_at": "2020-06-11T16:05:06.000Z",
           "id": "1271111223220809728",
           "text": "Tune in tonight and watch as @jessicagarson takes us through running your favorite Python package in R. 🍿\n\nLearn how to use two powerful programming languages for data science together, and see a live example that uses the recent search endpoint from Twitter’s Developer Labs. https://t.co/v178oUZNuj"
       },
       {
           "author_id": "2244994945",
           "created_at": "2020-06-10T19:25:24.000Z",
           "id": "1270799243071062016",
           "text": "As we work towards building the new Twitter API, we’ve extended the deprecation timeline for several Labs v1 endpoints. Learn more 📖 https://t.co/rRWaJYJgKk"
       },
       {
           "author_id": "2244994945",
           "created_at": "2020-06-09T18:08:47.000Z",
           "id": "1270417572001976322",
           "text": "Annotations help you learn more about a Tweet — they can even help you find topics of interest. 🔬\n\nIn this tutorial, @suhemparack shows us how find Tweets related to COVID-19 using annotations + the filtered stream endpoint.\n\nLearn how you can, too. ⤵️\nhttps://t.co/qwVOgw0zSV"
       }
   ],
   "includes": {
       "users": [
           {
               "description": "The voice of Twitter's #DevRel team, and your official source for updates, news, & events about Twitter's API. \n\n#BlackLivesMatter",
               "id": "2244994945",
               "name": "Twitter Dev",
               "username": "TwitterDev"
           }
       ]
   },
   "meta": {
       "newest_id": "1271111223220809728",
       "oldest_id": "1270417572001976322",
       "result_count": 3
   }
}
```

Dans cet exemple, nous avons utilisé une requête très simple. Pour des guides plus détaillés, consultez les ressources ci-dessous. 

**Prochaines étapes**

[Personnalisez votre requête à l’aide de la référence de l’API](/fr/x-api/posts/full-archive-search)

[Voir la liste complète des opérateurs de requête](/fr/x-api/posts/search/integrate/build-a-query "Voir la liste complète des opérateurs de requête")

[Utilisez des exemples de code pour ces endpoints](https://github.com/xdevplatform/Twitter-API-v2-sample-code "Utilisez des exemples de code pour ces endpoints")