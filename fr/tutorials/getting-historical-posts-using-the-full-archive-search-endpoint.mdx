---
title: Récupérer des posts historiques avec l’endpoint de Recherche sur l’archive complète de l’API X v2
mode: wide
---

<div id="introduction">
  ## Introduction
</div>

Les [endpoints Search Posts](/fr/x-api/posts/search/introduction)
dans l’univers v2 vous permettent de recevoir des Posts liés à des sujets d’intérêt,
en fonction d’une requête de recherche que vous fournissez. Nous proposons deux endpoints
distincts avec v2 Search Posts : la recherche récente, disponible pour tous les
développeurs disposant d’un compte approuvé et permettant de rechercher des Posts
jusqu’à sept jours en arrière, et la recherche sur l’archive complète, disponible uniquement pour les
chercheurs approuvés pour le
[parcours produit Academic Research](https://developer.x.com/en/products/x-api/early-access/guide#na_2),
et permettant d’interroger l’intégralité de l’archive de Posts depuis mars 2006.

Vous pouvez consulter l’intégralité de notre offre de recherche sur notre
[page de présentation de la recherche](/fr/x-api/posts/search/introduction).

Ces endpoints Search Posts couvrent l’un des cas d’usage les plus courants pour
les chercheurs universitaires, qui peuvent les utiliser pour des études longitudinales ou pour analyser
un sujet ou un événement passé.

Ce tutoriel propose un guide pas à pas à l’intention des chercheurs souhaitant utiliser
l’endpoint de recherche sur l’archive complète afin d’interroger l’historique complet des données publiques de X.
Il présentera également différentes façons de constituer un jeu de données, par exemple en
récupérant des Posts géolocalisés, et expliquera comment paginer les Posts disponibles pour une
requête.

<div id="prerequisites">
  ### Prérequis
</div>

Actuellement, ce point de terminaison n’est disponible que dans le cadre du
[parcours produit Academic Research](https://developer.x.com/en/solutions/academic-research/products-for-researchers).
Pour utiliser ce point de terminaison, vous devez
[demander l’accès](https://developer.x.com/en/portal/petition/academic/is-it-right-for-you).
En savoir plus sur
[la procédure de candidature et les exigences de ce parcours](https://developer.x.com/en/solutions/academic-research/application-info).

<div id="connect-an-app-to-the-academic-project">
  ### Connecter une application au projet académique
</div>

Une fois que vous avez été approuvé pour utiliser la filière Academic Research, vous verrez
votre [projet](/fr/resources/fundamentals/projects) académique dans le
[portail développeur](https://developer.x.com/en/portal/dashboard). Dans la section
« Projects and Apps », cliquez sur « Add App » pour connecter votre
[X App](/fr/resources/fundamentals/developer-apps) au projet.

[](https://res.cloudinary.com/practicaldev/image/fetch/s--gHFOyuDc--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/gb7aevhqyfvfjznd0pnd.png)

![Cette image affiche un projet académique dans le portail développeur auquel aucune application n’a encore été ajoutée](https://cdn.cms-twdigitalassets.com/content/dam/developer-twitter/docs/tutorials/getting-historical-tweets-using-the-full-archive-search-endpoint/dev-portal-1.png.twimg.1920.png)

Ensuite, vous pouvez soit choisir une application existante et la connecter à votre projet (comme
illustré ci-dessous).

![Cette image montre la page qui s’affiche lorsque vous tentez d’ajouter une application à votre projet académique](https://cdn.cms-twdigitalassets.com/content/dam/developer-twitter/docs/tutorials/getting-historical-tweets-using-the-full-archive-search-endpoint/dev-portal-2.png.twimg.1920.png)

Ou vous pouvez créer une nouvelle application, lui donner un nom et cliquer sur « Complete » pour connecter une nouvelle
application à votre projet académique.

![Cette image montre la page où vous saisirez un nom pour votre nouvelle application, ou vous permet de sélectionner une application existante](https://cdn.cms-twdigitalassets.com/content/dam/developer-twitter/docs/tutorials/getting-historical-tweets-using-the-full-archive-search-endpoint/dev-portal-3.png.twimg.1920.png)

Cela vous fournira vos clés d’API et
[votre jeton Bearer](/fr/resources/fundamentals/authentication#using-and-generating-an-app-only-bearer-token), que vous pourrez
ensuite utiliser pour vous connecter à l’endpoint de recherche sur l’archive complète.

![Cette image montre la page affichée après la création d’une nouvelle application, présentant vos clés et jetons](https://cdn.cms-twdigitalassets.com/content/dam/developer-twitter/docs/tutorials/getting-historical-tweets-using-the-full-archive-search-endpoint/dev-portal-4.png.twimg.1920.png)

**Veuillez noter**

Les clés dans la capture d’écran ci-dessus sont masquées, mais dans votre propre portail développeur,
vous pourrez voir les valeurs réelles pour la clé d’API (API Key), la clé secrète d’API (API Secret Key) et le
jeton Bearer. Enregistrez ces clés ainsi que le jeton Bearer, car vous en aurez besoin
pour appeler l’endpoint de recherche sur l’archive complète.

<div id="connecting-to-the-full-archive-search-endpoint">
  ### Connexion au point de terminaison de recherche sur l’archive complète
</div>

La commande cURL ci-dessous montre comment récupérer des Posts historiques depuis le compte @XDevelopers.
Remplacez $BEARER\_TOKEN par votre propre jeton Bearer, collez la requête complète
dans votre terminal et appuyez sur « Entrée ».

```bash
curl --request GET 'https://api.x.com/2/tweets/search/all?query=from:xdevelopers' --header 'Authorization: Bearer $BEARER_TOKEN'
```

Vous verrez la réponse JSON.

Par défaut, seuls les 10 Posts les plus récents sont renvoyés. Si vous souhaitez plus
de 10 Posts par requête, vous pouvez utiliser le paramètre max\_results et le définir sur
un maximum de 500 Posts par requête, comme illustré ci-dessous :

```bash
curl --request GET 'https://api.x.com/2/tweets/search/all?query=from:xdevelopers&max_results=500' --header 'Authorization: Bearer $BEARER_TOKEN'
```

###

Création de requêtes

Comme vous pouvez le voir dans les exemples d’appels ci-dessus, en utilisant le paramètre query, vous pouvez
spécifier les données que vous souhaitez rechercher. Par exemple, si vous voulez
récupérer tous les Posts contenant le mot _covid_ ou le mot _coronavirus_, vous pouvez
utiliser l’opérateur OR entre parenthèses, et votre requête peut être
`(covid OR coronavirus)` ; votre appel d’API ressemblera alors à ceci :

```bash
curl --request GET 'https://api.x.com/2/tweets/search/all?query=(covid%20OR%20coronavirus)&max_results=500' --header 'Authorization: Bearer $BEARER_TOKEN'
```

De même, si vous voulez tous les Posts qui contiennent le mot _covid19_ sans
republication, vous pouvez utiliser l’opérateur is:retweet avec la négation logique (représentée
par -), ainsi votre requête peut être covid19 -is:retweet et votre appel d’API sera :

```bash
curl --request GET 'https://api.x.com/2/tweets/search/all?query=covid19%20-is:retweet&max_results=500' --header 'Authorization: Bearer $BEARER_TOKEN'
```

Consultez
[ce guide pour une liste complète des opérateurs](/fr/x-api/posts/search/integrate/build-a-query)
pris en charge par l’endpoint de recherche sur l’archive complète.

### Utilisation des paramètres start\_time et end\_time pour récupérer des posts historiques

Lors de l’utilisation de l’endpoint de recherche sur l’archive complète, par défaut, les posts des 30
derniers jours sont renvoyés. Si vous souhaitez obtenir des posts datant de plus de 30 jours,
vous pouvez utiliser les paramètres start\_time et end\_time dans votre appel d’API. Ces
paramètres doivent respecter le format date-heure RFC3339 valide, par exemple
2020-12-21T13:00:00.00Z. Ainsi, si vous souhaitez obtenir tous les posts du compte XDevelopers
pour le mois de décembre 2020, votre appel d’API sera :

```bash
curl --request GET 'https://api.x.com/2/tweets/search/all?query=from:XDevelopers&start_time=2020-12-01T00:00:00.00Z&end_time=2021-01-01T00:00:00.00Z' --header 'Authorization: Bearer $BEARER_TOKEN'
```

###

Récupérer des Posts historiques géolocalisés

Les Posts géolocalisés sont des Posts associés à des informations géographiques
telles que la ville, l’État, le pays, etc.

<div id="using-hasgeo-operator">
  #### Utilisation de l’opérateur has:geo
</div>

Si vous souhaitez récupérer des posts qui contiennent des données géographiques, vous pouvez utiliser l’opérateur has:geo.
Par exemple, la requête cURL suivante ne récupérera que les posts du compte
@XDevelopers qui ont des données géographiques :

```
curl --request GET
'https://api.x.com/2/tweets/search/all?query=from:xdevelopers%20has:geo' --header
'Authorization: Bearer $BEARER_TOKEN'
```

#### Utilisation de l’opérateur place\_country

De la même manière, vous pouvez restreindre les Posts disposant de données de géolocalisation à un pays spécifique en utilisant l’opérateur place\_country. La commande cURL ci-dessous récupère tous les Posts du compte @XDevelopers provenant des États-Unis :

```
curl --request GET
'https://api.x.com/2/tweets/search/all?query=from:xdevelopers%20place_country:US'
--hbasheader 'Authorization: Bearer XXXXX'
```

Le pays est indiqué ci-dessus à l’aide du code ISO alpha-2. Les codes ISO valides sont disponibles [ici](http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2).

### Obtenir plus de 500 Posts historiques à l’aide de next\_token

Comme mentionné ci-dessus, par défaut vous ne pouvez obtenir que jusqu’à 500 Posts par requête pour
une recherche via l’endpoint de recherche sur l’archive complète. S’il existe plus de 500 Posts
disponibles pour votre requête, votre réponse JSON inclura un next\_token que vous
pouvez ajouter à votre appel d’API afin d’obtenir les Posts suivants disponibles pour cette
requête. Ce next\_token est fourni dans l’objet meta de votre réponse JSON,
qui ressemble à ceci :

```
{ "newest_id": "12345678...", "oldest_id": "12345678...", "result_count": 500,
"next_token": "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX" }
```

Ainsi, pour obtenir les Posts suivants disponibles, utilisez la valeur next\_token de cet objet meta
et utilisez cette valeur comme valeur de next\_token dans votre appel d’API vers l’endpoint
de recherche sur l’archive complète comme indiqué ci-dessous (vous utiliserez votre propre Bearer Token
et la valeur de Next Token obtenue lors de votre appel d’API précédent).

```
curl --request GET
'https://api.x.com/2/tweets/search/all?max_results=500&query=covid&next_token=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX'
--header 'Authorization: Bearer $BEARER_TOKEN'
```

De cette façon, vous pouvez continuer à vérifier si un next\_token est disponible et, si vous n’avez pas
atteint le nombre de Posts que vous souhaitez collecter, vous pouvez continuer à appeler
l’endpoint d’archive complète avec le nouveau next\_token pour chaque requête. Gardez à l’esprit
que l’endpoint de recherche sur l’archive complète est décompté de votre
[plafond de posts](/fr/x-api/fundamentals/post-cap), c’est-à-dire le nombre de
Posts par mois que vous pouvez obtenir depuis l’API X par
[Projet](/fr/resources/fundamentals/projects). Faites donc attention à la logique de votre pagination
afin de ne pas épuiser involontairement votre plafond de posts.

Vous trouverez ci-dessous quelques ressources pour vous aider lors de l’utilisation de la recherche
sur l’archive complète. Nous serions ravis de recueillir vos retours. Contactez-nous sur
[@XDevelopers](https://x.com/XDevelopers) ou sur nos
[forums de la communauté](https://devcommunity.x.com/) pour toute question concernant cet
endpoint.

<div id="additional-resources">
  ### Ressources supplémentaires
</div>

- [Référence de l’API de recherche sur l’archive complète](/fr/x-api/posts/full-archive-search)
- [Découvrir les bases de la création d’une requête de recherche](/fr/x-api/posts/search/integrate/build-a-query)