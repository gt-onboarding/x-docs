---
title: OAuth 2.0-Autorisierungscode-Flow mit PKCE
sidebarTitle: OAuth 2.0-Autorisierungscode-Flow mit PKCE
---

<div id="oauth-20-authorization-code-flow-with-pkce">
  ### OAuth 2.0 mit PKCE: Authorization Code Flow
</div>

<div id="introduction">
  #### Einführung
</div>

OAuth 2.0 ist ein branchenüblicher Autorisierungsstandard, der eine bessere Kontrolle über den Funktionsumfang einer Anwendung und über Autorisierungsabläufe auf mehreren Geräten ermöglicht. OAuth 2.0 ermöglicht es Ihnen, gezielt fein granulierte Scopes auszuwählen, die Ihnen im Namen eines Nutzers bestimmte Berechtigungen erteilen.

Um OAuth 2.0 in Ihrer App zu aktivieren, müssen Sie es in den Authentifizierungseinstellungen Ihrer App einschalten, die Sie im Abschnitt „App-Einstellungen“ des Developer-Portals finden.

#### Wie lange bleiben meine Anmeldedaten gültig?  

Standardmäßig ist das Zugriffstoken, das Sie über den Authorization Code Flow mit PKCE erstellen, nur zwei Stunden gültig, es sei denn, Sie haben den Scope `offline.access` verwendet.

<div id="refresh-tokens">
  #### Refresh-Token
</div>

Refresh-Token ermöglichen es einer Anwendung, ohne Benutzereingriff über den Refresh-Token-Flow ein neues Zugriffstoken zu erhalten.

Wenn der Scope `offline.access` gesetzt ist, wird ein OAuth-2.0-Refresh-Token ausgestellt. Mit diesem Refresh-Token erhalten Sie ein Zugriffstoken. Ist dieser Scope nicht vorhanden, erzeugen wir kein Refresh-Token.

Ein Beispiel für die Anfrage, mit der Sie einen Refresh-Token verwenden, um ein neues Zugriffstoken zu erhalten, ist folgendes:

```bash
POST 'https://api.x.com/2/oauth2/token' \
--header 'Content-Type: application/x-www-form-urlencoded' \
--data-urlencode 'refresh_token=bWRWa3gzdnk3WHRGU1o0bmRRcTJ5VUxWX1lZTDdJSUtmaWcxbTVxdEFXcW5tOjE2MjIxNDc3NDM5MTQ6MToxOnJ0OjE' \
--data-urlencode 'grant_type=refresh_token' \
--data-urlencode 'client_id=rG9n6402A3dbUJKzXTNX4oWHJ
```

<div id="app-settings">
  #### App-Einstellungen
</div>

Sie können die Authentifizierungseinstellungen Ihrer App auf OAuth 1.0a oder OAuth 2.0 festlegen. Sie können außerdem eine App so konfigurieren, dass sie sowohl OAuth 1.0a als auch OAuth 2.0 verwendet.

OAuth 2.0 kann nur mit der X-API v2 verwendet werden. Wenn Sie OAuth 2.0 ausgewählt haben, sehen Sie im Abschnitt „Keys and Tokens“ Ihrer App eine Client-ID. 

<div id="confidential-clients">
  #### Vertrauliche Clients
</div>

[Vertrauliche Clients](https://datatracker.ietf.org/doc/html/rfc6749#section-2.1) können Anmeldedaten sicher aufbewahren, ohne sie unbefugten Parteien offenzulegen, und sich sicher beim Autorisierungsserver authentifizieren; sie halten Ihr Client-Secret geschützt. Öffentliche Clients laufen in der Regel in einem Browser oder auf einem Mobilgerät und können keine Client-Secrets verwenden. Wenn Sie einen App-Typ auswählen, der ein vertraulicher Client ist, erhalten Sie ein Client-Secret. 

Wenn Sie im Entwicklerportal einen Clienttyp ausgewählt haben, der ein vertraulicher Client ist, können Sie auch ein Client-Secret sehen. Ihre Optionen sind Native App, Single Page App, Web App, Automated App oder Bot. Native App und Single Page Apps sind öffentliche Clients, und Web App sowie Automated App oder Bots sind vertrauliche Clients.

Für vertrauliche Clients mit einem gültigen Authorization-Header benötigen Sie keine Client-ID. Bei Anfragen mit einem öffentlichen Client müssen Sie die Client-ID weiterhin im Body angeben. 

<div id="scopes">
  #### Scopes
</div>

Scopes ermöglichen es Ihnen, den Zugriff für Ihre App fein granular festzulegen, sodass Ihre App nur die Berechtigungen hat, die sie benötigt. Weitere Informationen darüber, welche Scopes welchen Endpunkten zugeordnet sind, finden Sie in unserem [Leitfaden zur Authentifizierungszuordnung](/de/resources/fundamentals/authentication/guides/v2-authentication-mapping).

|     |     |
| :--- | :--- |
| **Scope** | **Beschreibung** |
| tweet.read | Alle Tweets, die Sie sehen können, einschließlich Tweets von geschützten Accounts. |
| tweet.write | Tweets und Retweets in Ihrem Namen verfassen. |
| tweet.moderate.write | Antworten auf Ihre Tweets ausblenden und wieder einblenden. |
| users.email | E-Mail-Adresse eines authentifizierten Nutzers. |
| users.read | Jeder Account, den Sie sehen können, einschließlich geschützter Accounts. |
| follows.read | Personen, die Ihnen folgen, und Personen, denen Sie folgen. |
| follows.write | In Ihrem Namen Personen folgen und entfolgen. |
| offline.access | Mit Ihrem Account verbunden bleiben, bis Sie den Zugriff widerrufen. |
| space.read | Alle Spaces, die Sie sehen können. |
| mute.read | Accounts, die Sie stummgeschaltet haben. |
| mute.write | Accounts in Ihrem Namen stumm- und wieder laut schalten. |
| like.read | Tweets, die Ihnen gefallen haben, und Likes, die Sie sehen können. |
| like.write | Tweets in Ihrem Namen mit „Gefällt mir“ markieren und die Markierung entfernen. |
| list.read | Listen, Listenmitglieder und Follower von Listen, die Sie erstellt haben oder denen Sie angehören, einschließlich privater Listen. |
| list.write | Listen in Ihrem Namen erstellen und verwalten. |
| block.read | Accounts, die Sie blockiert haben. |
| block.write | Accounts in Ihrem Namen blockieren und die Blockierung aufheben. |
| bookmark.read | Gespeicherte Tweets eines authentifizierten Nutzers abrufen. |
| bookmark.write | Lesezeichen zu Tweets hinzufügen und entfernen. |
| media.write | Medien hochladen. |

<div id="rate-limits">
  #### Rate Limits
</div>

Größtenteils entsprechen die Rate Limits denen bei der Authentifizierung mit OAuth 1.0a, mit Ausnahme der Tweet- und Nutzerabfragen. Wir erhöhen das Limit pro App von 300 auf 900 Anfragen pro 15 Minuten bei Verwendung von OAuth 2.0 für die Tweet- und Nutzerabfrage. Weitere Informationen finden Sie in unserer [Dokumentation zu Rate Limits](/de/resources/fundamentals/rate-limits).

<div id="grant-types">
  #### Grant-Typen
</div>

Für diese erste Veröffentlichung unterstützen wir nur den [Authorization Code](https://oauth.net/2/grant-types/authorization-code/) mit [PKCE](https://oauth.net/2/pkce/) sowie den [Refresh Token](https://oauth.net/2/grant-types/refresh-token/) als [Grant-Typen](https://oauth.net/2/grant-types/). In Zukunft werden möglicherweise weitere Grant-Typen hinzukommen.

<div id="oauth-20-flow">
  #### OAuth-2.0-Flow
</div>

OAuth 2.0 verwendet einen ähnlichen Flow wie den, den wir derzeit für OAuth 1.0a nutzen. Ein Diagramm und eine ausführliche Erklärung finden Sie in unserer [Dokumentation zu diesem Thema](/de/resources/fundamentals/authentication/oauth-1-0a/obtaining-user-access-tokens). 

<div id="glossary">
  #### Glossar
</div>

|     |     |
| :--- | :--- |
| **Begriff** | **Beschreibung** |
| Grant-Typen | Das OAuth-Framework definiert mehrere Grant-Typen für unterschiedliche Anwendungsfälle sowie einen Rahmen zur Erstellung neuer Grant-Typen. Beispiele sind Authorization Code, Client Credentials, Device Code und Refresh Token. |
| Vertraulicher Client | Anwendungen, die sich sicher beim Authorization Server authentifizieren können, z. B. indem sie ihr registriertes Client Secret geschützt aufbewahren. |
| Öffentlicher Client | Anwendungen, die keine registrierten Client Secrets verwenden können, etwa solche, die im Browser oder auf einem mobilen Gerät laufen. |
| Authorization Code Flow | Wird von vertraulichen und öffentlichen Clients genutzt, um einen Authorization Code gegen ein Access Token einzutauschen. |
| PKCE | Eine Erweiterung des Authorization Code Flow, die mehrere Angriffe verhindert und den OAuth-Austausch durch öffentliche Clients sicher ermöglicht. |
| Client ID | Zu finden im Bereich Keys and Tokens des Developer-Portals unter der Überschrift „Client ID“. Wenn Sie dies nicht sehen, kontaktieren Sie bitte direkt unser Team. Die Client ID wird benötigt, um die Authorize-URL zu erzeugen. |
| Redirect URI | Ihre Callback-URL. Sie benötigen eine [Exact-Match-Validierung](https://datatracker.ietf.org/doc/html/rfc6749#section-10.6). |
| Authorization Code | Ermöglicht einer Anwendung, APIs im Namen von Nutzenden aufzurufen. Bekannt als auth\_code. Der auth\_code hat ein Zeitlimit von 30 Sekunden, sobald der App-Inhaber einen genehmigten auth\_code von der nutzenden Person erhält. Sie müssen ihn innerhalb von 30 Sekunden gegen ein Access Token eintauschen, sonst läuft der auth\_code ab. |
| Access Token | Tokens, die Anwendungen verwenden, um API-Anfragen im Namen einer nutzenden Person zu stellen. |
| Refresh Token | Ermöglicht einer Anwendung, über den Refresh-Token-Flow ein neues Access Token zu erhalten, ohne die nutzende Person zur Interaktion aufzufordern. |
| Client Secret | Wenn Sie einen App-Typ ausgewählt haben, der ein vertraulicher Client ist, erhalten Sie ein „Client Secret“ unter „Client ID“ im Bereich Keys and Tokens Ihrer App. |

<div id="parameters">
  #### Parameter
</div>

Um eine OAuth-2.0-Autorisierungs-URL zu erstellen, stellen Sie sicher, dass die folgenden Parameter in der Autorisierungs-URL enthalten sind. 

|     |     |
| :--- | :--- |
| **Parameter** | **Beschreibung** |
| response\_type | Geben Sie mit dem Wort „code“ an, dass es sich um einen Code handelt. |
| client\_id | Findet sich im Developer-Portal unter der Überschrift „Client ID“. |
| redirect\_uri | Ihre Callback-URL. Dieser Wert muss einer der in den Einstellungen Ihrer App definierten Callback-URLs entsprechen. Für OAuth 2.0 ist eine [Exact-Match-Validierung](https://datatracker.ietf.org/doc/html/rfc6749#section-10.6) für Ihre Callback-URL erforderlich. |
| state | Eine zufällige Zeichenfolge, die Sie zum Schutz vor [CSRF-Angriffen](https://auth0.com/docs/protocols/state-parameters) übermitteln. Die Länge dieser Zeichenfolge kann bis zu 500 Zeichen betragen. |
| code\_challenge | Ein [PKCE](https://www.oauth.com/oauth2-servers/pkce/authorization-request/)-Parameter, ein zufälliges Geheimnis für jede von Ihnen gesendete Anfrage. |
| code\_challenge\_method | Gibt die Methode an, die Sie für die Anfrage verwenden (S256 oder plain). |

#### Autorisierungs-URL 

Mit OAuth 2.0 erstellen Sie eine Autorisierungs-URL, über die sich ein Nutzer per Authentifizierungs-Flow anmelden kann – ähnlich wie „Bei X anmelden“. 

Ein Beispiel für die zu erstellende URL lautet: 

```
https://x.com/i/oauth2/authorize?response_type=code&client_id=M1M5R3BMVy13QmpScXkzTUt5OE46MTpjaQ&redirect_uri=https://www.example.com&scope=tweet.read%20users.read%20account.follows.read%20account.follows.write&state=state&code_challenge=challenge&code_challenge_method=plain
```

Damit diese URL funktioniert, muss sie korrekt kodiert sein. Lesen Sie dazu unsere Dokumentation zur [Prozentkodierung](/de/resources/fundamentals/authentication/oauth-1-0a/percent-encoding-parameters).