---
title: Flusso del codice di autorizzazione OAuth 2.0 con PKCE
sidebarTitle: Flusso del codice di autorizzazione OAuth 2.0 con PKCE
---

<div id="oauth-20-authorization-code-flow-with-pkce">
  ### Flusso del codice di autorizzazione OAuth 2.0 con PKCE
</div>

<div id="introduction">
  #### Introduzione
</div>

OAuth 2.0 è un protocollo di autorizzazione standard del settore che offre un controllo più preciso sull’ambito di un’applicazione e sui flussi di autorizzazione tra più dispositivi. OAuth 2.0 consente di selezionare ambiti specifici e granulari che ti conferiscono permessi puntuali per conto di un utente.

Per abilitare OAuth 2.0 nella tua App, attivalo nelle impostazioni di autenticazione dell’App, nella sezione Impostazioni dell’App del portale sviluppatori.

#### Per quanto tempo resteranno valide le mie credenziali?  

Per impostazione predefinita, il token di accesso che crei tramite il flusso di autorizzazione con PKCE resterà valido solo per due ore, a meno che tu non abbia utilizzato lo scope `offline.access`.

<div id="refresh-tokens">
  #### Token di refresh
</div>

I token di refresh consentono a un’applicazione di ottenere un nuovo token di accesso senza coinvolgere l’utente, tramite il flusso di refresh token.

Se si applica lo scope `offline.access`, viene emesso un token di refresh OAuth 2.0. Con questo token di refresh si ottiene un token di accesso. Se questo scope non viene fornito, non genereremo alcun token di refresh.

Un esempio della richiesta da effettuare per usare un token di refresh e ottenere un nuovo token di accesso è il seguente:

```bash
POST 'https://api.x.com/2/oauth2/token' \
--header 'Content-Type: application/x-www-form-urlencoded' \
--data-urlencode 'refresh_token=bWRWa3gzdnk3WHRGU1o0bmRRcTJ5VUxWX1lZTDdJSUtmaWcxbTVxdEFXcW5tOjE2MjIxNDc3NDM5MTQ6MToxOnJ0OjE' \
--data-urlencode 'grant_type=refresh_token' \
--data-urlencode 'client_id=rG9n6402A3dbUJKzXTNX4oWHJ
```

<div id="app-settings">
  #### Impostazioni dell’App
</div>

Puoi impostare l’autenticazione della tua App su OAuth 1.0a oppure OAuth 2.0. Puoi anche abilitare l’App ad accedere sia a OAuth 1.0a sia a OAuth 2.0.

OAuth 2.0 può essere utilizzato solo con l’API X v2. Se hai selezionato OAuth 2.0, potrai visualizzare un Client ID nella sezione Keys and Tokens della tua App. 

<div id="confidential-clients">
  #### Client riservati
</div>

I [client riservati](https://datatracker.ietf.org/doc/html/rfc6749#section-2.1) possono conservare le credenziali in modo sicuro senza esporle a soggetti non autorizzati e autenticarsi in modo sicuro con il server di autorizzazione, mantenendo al sicuro il tuo client secret. I client pubblici, poiché di solito vengono eseguiti in un browser o su un dispositivo mobile, non sono in grado di utilizzare i tuoi client secrets. Se selezioni un tipo di App che è un client riservato, ti verrà fornito un client secret. 

Se nel developer portal hai selezionato un tipo di client che è un client riservato, potrai anche visualizzare un Client Secret. Le tue opzioni sono Native App, Single page App, Web App, Automated App o bot. Le Native App e le Single page App sono client pubblici, mentre le Web App e le Automated App o i bot sono client riservati.

Non hai bisogno del Client Id per i client riservati se invii un Authorization Header valido. Devi comunque includere il Client Id nel body per le richieste effettuate con un client pubblico. 

<div id="scopes">
  #### Ambiti
</div>

Gli ambiti consentono di impostare un accesso granulare per la tua App, in modo che disponga solo delle autorizzazioni necessarie. Per sapere quali ambiti corrispondono a quali endpoint, consulta la nostra [guida alla mappatura dell’autenticazione](/it/resources/fundamentals/authentication/guides/v2-authentication-mapping).

|     |     |
| :--- | :--- |
| **Ambito** | **Descrizione** |
| tweet.read | Tutti i Tweet che puoi visualizzare, inclusi quelli degli account protetti. |
| tweet.write | Pubblica Tweet e Retweet per tuo conto. |
| tweet.moderate.write | Nascondi e mostra le risposte ai tuoi Tweet. |
| users.email | Email di un utente autenticato. |
| users.read | Qualsiasi account che puoi visualizzare, inclusi quelli protetti. |
| follows.read | Persone che ti seguono e persone che segui. |
| follows.write | Segui e smetti di seguire persone per tuo conto. |
| offline.access | Resta connesso al tuo account finché non revochi l’accesso. |
| space.read | Tutti gli Space che puoi visualizzare. |
| mute.read | Account che hai silenziato. |
| mute.write | Silenzia e riattiva gli account per tuo conto. |
| like.read | Tweet a cui hai messo Mi piace e Mi piace che puoi visualizzare. |
| like.write | Metti e rimuovi Mi piace ai Tweet per tuo conto. |
| list.read | Liste, membri e follower delle liste che hai creato o di cui fai parte, incluse quelle private. |
| list.write | Crea e gestisci Liste per tuo conto. |
| block.read | Account che hai bloccato. |
| block.write | Blocca e sblocca account per tuo conto. |
| bookmark.read | Ottieni i Tweet aggiunti ai segnalibri da un utente autenticato. |
| bookmark.write | Aggiungi e rimuovi segnalibri dai Tweet. |
| media.write | Carica contenuti multimediali. |

<div id="rate-limits">
  #### Limiti di velocità
</div>

Per lo più, i limiti di velocità sono gli stessi dell'autenticazione con OAuth 1.0a, con l'eccezione delle operazioni di ricerca Tweet e ricerca Utenti. Stiamo aumentando il limite per App da 300 a 900 richieste ogni 15 minuti quando si utilizza OAuth 2.0 per la ricerca di Tweet e di utenti. Per saperne di più, consulta la nostra [documentazione sui limiti di velocità](/it/resources/fundamentals/rate-limits).

<div id="grant-types">
  #### Tipi di grant
</div>

Per questo lancio iniziale supportiamo esclusivamente [authorization code](https://oauth.net/2/grant-types/authorization-code/) con [PKCE](https://oauth.net/2/pkce/) e [refresh token](https://oauth.net/2/grant-types/refresh-token/) come [grant types](https://oauth.net/2/grant-types/). Potremmo aggiungere altri grant types in futuro.

<div id="oauth-20-flow">
  #### Flusso OAuth 2.0
</div>

OAuth 2.0 utilizza un flusso simile a quello attualmente in uso per OAuth 1.0a. È possibile consultare un diagramma e una spiegazione dettagliata nella nostra [documentazione sull’argomento](/it/resources/fundamentals/authentication/oauth-1-0a/obtaining-user-access-tokens). 

<div id="glossary">
  #### Glossario
</div>

|     |     |
| :--- | :--- |
| **Termine** | **Descrizione** |
| Tipi di grant | Il framework OAuth definisce diversi grant per casi d’uso differenti e un meccanismo per crearne di nuovi. Esempi: authorization code, client credentials, device code e refresh token. |
| Client confidenziale | I client sono applicazioni che possono autenticarsi in modo sicuro con il server di autorizzazione, ad esempio mantenendo al sicuro il proprio client secret registrato. |
| Client pubblico | Client che non possono utilizzare client secret registrati, ad esempio applicazioni in esecuzione in un browser o su un dispositivo mobile. |
| Flusso authorization code | Utilizzato sia dai client confidenziali sia da quelli pubblici per scambiare un authorization code con un access token. |
| PKCE | Un’estensione del flusso authorization code per prevenire diversi attacchi e consentire di eseguire in modo sicuro lo scambio OAuth dai client pubblici. |
| Client ID | È disponibile nella sezione keys and tokens del developer portal sotto l’intestazione "Client ID". Se non lo vedi, contatta direttamente il nostro team. Il Client ID è necessario per generare la authorize URL. |
| Redirect URI | Il tuo callback URL. È richiesta la [validazione di corrispondenza esatta](https://datatracker.ietf.org/doc/html/rfc6749#section-10.6). |
| Authorization code | Consente a un’applicazione di chiamare le API per conto degli utenti. Conosciuto come auth\_code. L’autorizzazione ha un limite di 30 secondi dal momento in cui il proprietario dell’App riceve un auth\_code approvato dall’utente. Devi scambiarlo con un access token entro 30 secondi, altrimenti l’auth\_code scadrà. |
| Access token | Gli access token sono i token che le applicazioni utilizzano per effettuare richieste API per conto di un utente. |
| Refresh token | Consente a un’applicazione di ottenere un nuovo access token senza richiedere l’intervento dell’utente tramite il flusso di refresh token. |
| Client Secret | Se hai selezionato un tipo di App che è un client confidenziale, troverai un “Client Secret” sotto “Client ID” nella sezione keys and tokens della tua App. |

<div id="parameters">
  #### Parametri
</div>

Per costruire un URL di autorizzazione OAuth 2.0, assicurati di includere i seguenti parametri nell’URL di autorizzazione.

|     |     |
| :--- | :--- |
| **Parametro** | **Descrizione** |
| response\_type | Devi specificare che si tratta di un code utilizzando la parola “code”. |
| client\_id | È reperibile nel portale sviluppatori sotto l’intestazione “Client ID”. |
| redirect\_uri | Il tuo URL di callback. Questo valore deve corrispondere a uno degli URL di callback definiti nelle impostazioni della tua App. Per OAuth 2.0 è richiesta la [validazione di corrispondenza esatta](https://datatracker.ietf.org/doc/html/rfc6749#section-10.6) del tuo URL di callback. |
| state | Una stringa casuale che fornisci per proteggere da [attacchi CSRF](https://auth0.com/docs/protocols/state-parameters). La lunghezza di questa stringa può arrivare fino a 500 caratteri. |
| code\_challenge | Un parametro [PKCE](https://www.oauth.com/oauth2-servers/pkce/authorization-request/), un segreto casuale per ogni richiesta che effettui. |
| code\_challenge\_method | Specifica il metodo che stai utilizzando per effettuare la richiesta (S256 oppure plain). |

#### URL di autorizzazione 

Con OAuth 2.0 crei un URL di autorizzazione, che puoi usare per consentire a un utente di autenticarsi tramite un flusso, in modo simile a “Accedi con X”. 

Un esempio dell’URL che stai creando è il seguente: 

```
https://x.com/i/oauth2/authorize?response_type=code&client_id=M1M5R3BMVy13QmpScXkzTUt5OE46MTpjaQ&redirect_uri=https://www.example.com&scope=tweet.read%20users.read%20account.follows.read%20account.follows.write&state=state&code_challenge=challenge&code_challenge_method=plain
```

Perché questo URL funzioni è necessaria la corretta codifica; assicurati di consultare la nostra documentazione sulla [percent-encoding](/it/resources/fundamentals/authentication/oauth-1-0a/percent-encoding-parameters).