---
title: Guida rapida
sidebarTitle: Guida rapida
---

import { Button } from '/snippets/it/button.mdx';

<div id="getting-started-with-the-manage-direct-message-endpoints">
  ## Guida introduttiva agli endpoint di gestione dei Messaggi Diretti
</div>

Questa guida rapida ti aiuterà a inviare la tua prima richiesta agli endpoint dei Messaggi Diretti utilizzando Postman, uno strumento per gestire ed effettuare richieste HTTP. Per saperne di più sulle nostre collection Postman, visita la guida [Utilizzo di Postman](/it/tutorials/postman-getting-started).

Visita il nostro repository GitHub [Esempi di codice per API X v2](https://github.com/xdevplatform/Twitter-API-v2-sample-code) se desideri consultare esempi in Python. Inoltre, i [software development kit (SDK) ufficiali della Piattaforma Sviluppatori X](/it/x-api/tools-and-libraries/sdks) verranno aggiornati per supportare questi endpoint dei Messaggi Diretti.  

<Note>
  **Prerequisiti**

  Per completare questa guida, ti servirà un set di [key e token](/it/resources/fundamentals/authentication) per autenticare la richiesta. Puoi generare queste key e questi token seguendo questi passaggi:

  - [Richiedi un account sviluppatore](https://developer.x.com/en/apply-for-access) e attendi l’approvazione.
  - Crea un [Progetto](/it/resources/fundamentals/projects) e un’[App sviluppatore](/it/resources/fundamentals/developer-apps) associata nel portale per sviluppatori.
  - Vai alla pagina “Keys and tokens” della tua App per generare le credenziali necessarie. Assicurati di salvare tutte le credenziali in un luogo sicuro.
</Note>

<div id="steps-to-building-manage-direct-message-requests">
  ### Passaggi per gestire le richieste dei Messaggi Diretti
</div>

In questo esempio, con una sola richiesta creeremo una nuova conversazione di gruppo e vi aggiungeremo il primo messaggio. Poi aggiungeremo un secondo messaggio alla conversazione creata.

<div id="step-one-start-with-a-tool-or-library">
  #### Primo passaggio: inizia con uno strumento o una libreria
</div>

Per iniziare a lavorare con gli endpoint per la gestione dei Messaggi Diretti, utilizzeremo lo strumento Postman per semplificare il processo. Useremo una raccolta, creata dal team XDev, di richieste d’esempio dell’API X v2 per esplorare sei endpoint utilizzati per creare nuovi Messaggi Diretti e per elencare gli eventi delle conversazioni dei Messaggi Diretti.

Sebbene gran parte della raccolta sia precompilata, ci sono alcuni dettagli che dovrai fornire in base all’App X creata per ospitare queste richieste API. Per prima cosa, carichiamo/aggiorniamo la raccolta.

Per caricare la raccolta Postman dell’API X v2 nel tuo ambiente, fai clic sul seguente pulsante:

<Button href="https://app.getpostman.com/run-collection/9956214-784efcda-ed4c-4491-a4c0-a26470a67400">
  Aggiungi API X v2 a Postman
</Button>

Una volta caricata in Postman la raccolta dell’API X v2, vai alla cartella “Manage Direct Messages”. La scheda Authorization di questa cartella è stata precompilata ove possibile e puoi aggiornare alcune impostazioni per condividere i dettagli di autenticazione della tua App X. Questa cartella contiene anche tre endpoint per creare nuovi Messaggi Diretti. Nota che è presente anche una cartella "Direct Message lookup" con tre endpoint per recuperare gli eventi delle conversazioni dei Messaggi Diretti, compresi l’invio e la ricezione dei messaggi, e quando i partecipanti alla conversazione si uniscono o lasciano. 

Poiché la creazione di conversazioni di gruppo è una nuova funzionalità entusiasmante dell’API X v2, questo esempio si concentrerà su quella. Useremo l’esempio "New group DM and conversation". Utilizzeremo questa richiesta per creare una conversazione di gruppo nei Messaggi Diretti.

Il passaggio successivo è autenticarsi con l’endpoint.

**Secondo passaggio: autentica la tua richiesta**

Per effettuare correttamente una richiesta all’API X, è necessario verificare di avere l’autorizzazione a farlo. Per eseguire con successo una richiesta a questo endpoint, utilizzeremo [OAuth 2.0 Authorization Code Flow with PKCE](it/resources/fundamentals/authentication#oauth-2-0-authorization-code-flow-with-pkce-2). Puoi generare un token di accesso direttamente in Postman. 

Con Postman puoi impostare il metodo di autenticazione a livello di cartella o di singola richiesta. Qui configureremo i dettagli di autenticazione a livello di cartella.

Vai alla cartella "Manage Direct Messages", seleziona la scheda "Authorization" e conferma che Type sia impostato su “OAuth 2.0” e che "Add auth data to" sia impostato su "Request Headers." Nella sezione "Current Token", assicurati che "header Prefix" sia impostato su Bearer.  

Per configurare e generare un nuovo token:

1. Crea un nome per il token, ad esempio "Manage DMs".

2. Conferma che **Grant Type** sia impostato su Authorization Code (with PKCE).

3. Imposta la tua **Callback URL**. Aggiorna la tua Callback URL in modo che corrisponda esattamente alla Callback URL associata alla tua applicazione nel [v2 Dev Portal](https://developer.x.com/en/portal/dashboard). Con l’App X utilizzata in questo esempio, la Callback URL è impostata su - [_https://www.example.com_.](https://www.example.com/) (Nota: poiché deve corrispondere esattamente, [_https://example.com_](https://example.com) non funzionerebbe.) 

4. Conferma che **Auth URL** sia impostato su [https://x.com/i/oauth2/authorize](https://x.com/i/oauth2/authorize).

5. Conferma che **Access Token URL** sia impostato su [https://api.x.com/2/oauth2/token.](https://api.x.com/2/oauth2/token)**Client ID** - Copia e incolla l’OAuth 2.0 Client ID dal Developer Portal
   **Client Secret** - Ti servirà solo se stai utilizzando un tipo di App che è un confidential client. In tal caso, copia e incolla l’OAuth 2.0 Client Secret dal Developer Portal. 

6. Conferma che **Scope** sia impostato su dm.read, dm.write, tweet.read e users.read.

7. Conferma che **State** sia impostato su “state”.

8. Conferma che **Client Authentication** sia impostato su Send as Basic Auth header.

9. Fai clic su **Get New Access Token**, quindi fai clic su "Authorize app" come parte del processo "Sign in with X".

10. Fai clic sul pulsante "Proceed" e poi su "Use Token" per generare un token. 

11. Fai clic sul pulsante "Save" per salvare questi dettagli di configurazione.

Potresti ricevere un messaggio che indica che non sei connesso a X. Se ottieni questo errore, dovrai accedere all’account X per conto del quale stai tentando di pubblicare direttamente in Postman.

Ora che questi dettagli di OAuth 2.0 sono stati impostati a livello di cartella, apri ciascuno degli esempi, vai alla scheda "Authorization" e verifica che il campo Type sia impostato su "Inherit auth from parent".

Tieni presente che questo token scadrà a breve e dovrai rigenerarlo facendo clic sul pulsante "Get New Access Token". Facendo clic verrà avviato il flusso "Sign-in with X" e generato un nuovo token da usare per le richieste.

<div id="step-three-specify-the-direct-message-conversation-participants-and-message-contents">
  #### Passaggio tre: specificare i partecipanti alla conversazione di Messaggi Diretti e il contenuto del messaggio
</div>

Vai alla scheda “Body” e modifica l’oggetto JSON di esempio. Imposta l’attributo participant\_ids sugli account a cui vuoi inviare il Messaggio Diretto.

`{
   "message": {"text": "Ciao solo a voi due, questa è una nuova conversazione di gruppo."},
   "participant_ids": ["944480690","906948460078698496"],
   "conversation_type": "Group"
}`

<div id="step-four-make-your-request-and-review-the-response">
  #### Passaggio quattro: invia la richiesta e verifica la risposta
</div>

Una volta configurato tutto, fai clic sul pulsante "Send" e riceverai una risposta simile all'esempio riportato di seguito. Promemoria: se il tuo token è scaduto da quando lo hai creato, puoi tornare alla scheda Authorization della cartella e fare clic su "Get New Access Token" per generarne uno nuovo.

```
{
   "data": {
       "dm_conversation_id": "1582103724607971328",
       "dm_event_id": "1582103724607971332"
   }
}
```

Se l'oggetto "data" della risposta contiene un dm\_conversation\_id e un dm\_event\_id, hai creato correttamente una nuova conversazione di Messaggi diretti. Per iniziare a consultare gli eventi associati a questa conversazione, vai alla guida rapida per la consultazione dei Messaggi diretti.

<div id="step-five-add-another-message-to-that-group-conversation">
  #### Passaggio cinque: aggiungi un altro messaggio a quella conversazione di gruppo
</div>

Ora seleziona l'esempio "Add DM to conversation" e poi la scheda "Params". In "Path Variables", imposta dm\_conversation\_id sull'ID della conversazione che hai creato sopra.

|     |     |
| :--- | :--- |
| **Key** | **Value** |
| dm\_conversation\_id | 1582103724607971328 |

Utilizzando questo ID conversazione, il percorso della richiesta sarà: https://api.x.com/2/dm\_conversations/1582103724607971328/messages

Aggiorna anche la scheda "Body" con il JSON della richiesta contenente il testo del messaggio che desideri inviare:

```
{
   "text": "Adding a new message to our group conversation..."
}
```

Una volta configurato tutto, fai clic sul pulsante "Send" e riceverai una risposta simile al seguente esempio:

```
{
   "data": {
       "dm_conversation_id": "1582103724607971328",
       "dm_event_id": "1582106224379559940"
   }
}
```