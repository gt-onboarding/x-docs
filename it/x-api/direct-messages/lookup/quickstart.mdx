---
title: Guida rapida
sidebarTitle: Guida rapida
---

import { Button } from '/snippets/it/button.mdx';

<div id="getting-started-with-the-manage-direct-message-endpoints">
  ## Guida introduttiva agli endpoint per la gestione dei Messaggi Diretti
</div>

Questa guida rapida ti aiuterà a inviare la tua prima richiesta agli endpoint dei Messaggi Diretti utilizzando Postman, uno strumento per la gestione e l’esecuzione di richieste HTTP. Per ulteriori informazioni sulle nostre raccolte Postman, consulta la guida [Uso di Postman](/it/tutorials/postman-getting-started).

Consulta il nostro repository GitHub [Esempi di codice per API X v2](https://github.com/xdevplatform/Twitter-API-v2-sample-code) se desideri esempi in Python. Inoltre, i [kit di sviluppo software (SDK) della Piattaforma per sviluppatori X](/it/x-api/tools-and-libraries/sdks) ufficiali saranno aggiornati per supportare questi endpoint dei Messaggi Diretti.  

<Note>
  **Prerequisiti**

  Per completare questa guida, avrai bisogno di un set di [chiavi e token](/it/resources/fundamentals/authentication) per autenticare la richiesta. Puoi generare queste chiavi e questi token seguendo questi passaggi:

  - [Registrati per un account sviluppatore](https://developer.x.com/en/apply-for-access) e attendi l’approvazione.
  - Crea un [Progetto](/it/resources/fundamentals/projects) e l’[App sviluppatore](/it/resources/fundamentals/developer-apps) associata nel portale per sviluppatori.
  - Vai alla pagina “Keys and tokens” della tua App per generare le credenziali necessarie. Assicurati di salvare tutte le credenziali in un luogo sicuro.
</Note>

<div id="steps-to-building-direct-message-lookup-requests">
  ### Passaggi per creare richieste di ricerca dei Messaggi Diretti
</div>

In questo esempio, con un'unica richiesta, creeremo una nuova conversazione di gruppo e vi aggiungeremo il primo messaggio. Successivamente, aggiungeremo un secondo messaggio alla conversazione creata.

<div id="step-one-start-with-a-tool-or-library">
  #### Primo passaggio: iniziare con uno strumento o una libreria
</div>

Per iniziare a lavorare con gli endpoint per la gestione dei Messaggi Diretti, utilizzeremo lo strumento Postman per semplificare il processo. Useremo una raccolta, realizzata dal team X Developers, di esempi di richieste all’API X v2 per esplorare sei endpoint utilizzati per creare nuovi Messaggi Diretti e per elencare gli eventi delle conversazioni dei Messaggi Diretti.

Sebbene gran parte della raccolta sia precompilata, ci sono alcuni dettagli che dovrai fornire in base all’App X creata per ospitare queste richieste API. Per prima cosa, carichiamo/aggiorniamo la raccolta.

Per caricare la raccolta Postman dell’API X v2 nel tuo ambiente, fai clic sul seguente pulsante:

<Button href="https://app.getpostman.com/run-collection/9956214-784efcda-ed4c-4491-a4c0-a26470a67400">
  Aggiungi API X v2 a Postman
</Button>

Una volta caricata la raccolta dell’API X v2 in Postman, vai alla cartella “Manage Direct Messages”. La scheda Authorization di questa cartella è stata precompilata ove possibile. Dovrai aggiornare alcune impostazioni per inserire i dettagli di autenticazione della tua App X.

Questa cartella contiene anche tre endpoint per creare nuovi Messaggi Diretti. Nota che è presente anche una cartella “Direct Message lookup” con tre endpoint disponibili per recuperare gli eventi delle conversazioni dei Messaggi Diretti, inclusi l’invio e la ricezione dei messaggi e le azioni di ingresso/uscita dei partecipanti alla conversazione.

Poiché la creazione di conversazioni di gruppo è una nuova funzionalità dell’API X v2, questo esempio si concentrerà su questo aspetto. Lavoreremo con l’esempio “New group DM and conversation”. Useremo questa richiesta per creare una conversazione di gruppo nei Messaggi Diretti.

Il passo successivo è autenticarsi con l’endpoint.

<div id="step-two-authenticate-your-request">
  #### Passaggio due: Autentica la tua richiesta
</div>

Per effettuare correttamente una richiesta all’API X, devi verificare di avere l’autorizzazione per farlo. Per inviare una richiesta riuscita a questo endpoint, utilizzeremo l’[OAuth 2.0 Authorization Code Flow with PKCE](it/resources/fundamentals/authentication#oauth-2-0-authorization-code-flow-with-pkce-2). Puoi generare un token di accesso in Postman. 

Con Postman puoi impostare il metodo di autenticazione a livello di cartella o di singola richiesta. Qui configureremo i dettagli di autenticazione a livello di cartella. Vai alla cartella "Mange Direct Messages", seleziona la scheda "Authorization" e conferma che Type sia impostato su “OAuth 2.0” e che "Add auth data to" sia impostato su "Request Headers." Nella sezione "Current Token", assicurati che "header Prefix" sia impostato su Bearer.  

Per configurare e generare un nuovo token:

1. Crea un Token Name, ad esempio "DM lookup."

2. Conferma che **Grant Type** sia impostato su Authorization Code (with PKCE).

3. Imposta la **Callback URL**. Aggiorna la Callback URL in modo che corrisponda esattamente alla Callback URL associata alla tua applicazione nel [v2 Dev Portal](https://developer.x.com/en/portal/dashboard). Con l’App X usata in questo esempio, la Callback URL è impostata su - [https://www.example.com.](https://www.example.com/) (Nota che, poiché deve corrispondere esattamente, [https://example.com](https://example.com) non funzionerebbe.) 

4. Conferma che **Auth URL** sia impostato su [https://x.com/i/oauth2/authorize](https://x.com/i/oauth2/authorize)

5. Conferma che **Access Token URL** sia impostato su [https://api.x.com/2/oauth2/token.](https://api.x.com/2/oauth2/token)**Client ID** - Copia e incolla l’ID client OAuth 2.0 dal Developer Portal
   **Client Secret** - Ti servirà solo se stai usando un tipo di App che è un confidential client. In tal caso, copia e incolla il Client Secret OAuth 2.0 dal Developer Portal. 

6. Conferma che **Scope** sia impostato su dm.read dm.write tweet.read users.read.

7. Conferma che **State** sia impostato su “state.”

8. Conferma che **Client Authentication** sia impostato su Send as Basic Auth header.

9. Fai clic su “Get New Access Token”, quindi fai clic su "Authorize app" come parte del processo "Sign-in with X".

10. Fai clic sul pulsante "Proceed" e poi su "Use Token" per generare un token. 

11. Fai clic sul pulsante "Save" per salvare questi dettagli di configurazione.

Potresti ricevere un messaggio che indica che non hai effettuato l’accesso a X. In tal caso, accedi in Postman all’account X per conto del quale stai tentando di pubblicare.

Ora che questi dettagli OAuth 2.0 sono stati impostati a livello di cartella, apri ciascuno degli esempi, vai alla loro scheda "Authorization" e conferma che Type sia impostato su "Inherit auth from parent." 

Nota che questo token scadrà presto e dovrai rigenerarlo facendo clic sul pulsante "Get New Access Token". Facendo clic, si avvierà il processo "Sign-in with X" e verrà generato un nuovo token con cui effettuare le richieste.

<div id="step-three-retrieve-direct-messages-conversation-events">
  #### Terzo passaggio: recuperare gli eventi delle conversazioni dei Messaggi Diretti
</div>

Quando recuperi gli eventi delle conversazioni dei Messaggi Diretti con questo endpoint, devi specificare un ID conversazione. L’ID conversazione fa parte del percorso dell’endpoint: https://api.x.com/2/dm\_conversations/:dm\_conversation\_id/dm\_events

In Postman, vai alla scheda “Params” e inserisci l’ID della conversazione di cui vuoi recuperare gli eventi nella sezione “Path Variables”.

L’impostazione sarà:

|     |     |
| :--- | :--- |
| **Key** | **Value** |
| `dm_conversation_id` | `1228393702244134912` |

Con questa conversazione specificata, il percorso risultante diventa https://api.x.com/2/dm\_conversations/1582103724607971328/dm\_events

Se fai clic sul pulsante “Send”, riceverai nella risposta i campi predefiniti dell’oggetto Messaggio Diretto: id, text ed event\_type. Ci sarà anche un oggetto “meta” con il numero di risultati, insieme a token di impaginazione usati per recuperare ulteriori eventi, se disponibili.

```
{
   "data": [
       {
           "event_type": "MessageCreate",
           "id": "1580705921830768647",
           "text": "hello to you two, this is a new group conversation."
       }
   ],
   "meta": {
       "result_count": 1,
       "next_token": "18LAA5FFPEKJA52G0G00ZZZZ",
       "previous_token": "1BLC45FFPEKJA52G0S00ZZZZ"
   }
}
```

Se desideri ricevere campi aggiuntivi, devi specificarli nella richiesta con i parametri [field](/it/x-api/fundamentals/fields) e/o [expansion](/it/x-api/fundamentals/expansions).

Per questo esercizio, richiederemo set aggiuntivi di campi dell’oggetto dm\_event:

1. I campi predefiniti dell’oggetto Messaggio Diretto: id, text ed event\_type.

2. Campi aggiuntivi dell’oggetto Messaggio Diretto: dm\_conversation\_id, created\_at, sender\_id, attachments, participant\_ids, referenced\_tweets

In Postman, vai alla scheda “Params” e aggiungi la seguente coppia chiave:valore alla tabella “Query Params”:

|     |     |
| :--- | :--- |
| Key | Value |
| dm\_event.fields | dm\_conversation\_id,created\_at,sender\_id,attachments,participant\_ids,referenced\_tweets |

Ora dovresti vedere il seguente URL accanto al pulsante “Send”:

https://api.x.com/2/dm\_conversations/:dm\_conversation\_id/dm\_events?dm\_event.fields=id,text,event\_type,dm\_conversation\_id,created\_at,sender\_id,attachments,participant\_ids,referenced\_tweets

<div id="step-four-make-your-request-and-review-your-response">
  #### Passaggio quattro: invia la richiesta e verifica la risposta
</div>

Dopo aver completato la configurazione, fai di nuovo clic sul pulsante "Send" e riceverai una risposta simile alla seguente. Nota che questa risposta include tutti i campi dm\_event disponibili.

```
{
   "data": [
       {
           "text": "hello to you two, this is a new group conversation.",
           "id": "1580705921830768647",
           "dm_conversation_id": "1580705921830768643",
           "event_type": "MessageCreate",
           "sender_id": "17200003",
           "created_at": "2022-10-13T23:43:54.000Z"
       }
   ],
   "meta": {
       "result_count": 1,
       "next_token": "18LAA5FFPEKJA52G0G00ZZZZ",
       "previous_token": "1BLC45FFPEKJA52G0S00ZZZZ"
   }
}
```