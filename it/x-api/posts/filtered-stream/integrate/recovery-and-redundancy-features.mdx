---
title: Recupero e ridondanza
sidebarTitle: Recupero e ridondanza
---

<div id="introduction">
  #### Introduzione
</div>

Quando si consumano dati in streaming, massimizzare il tempo di connessione e ricevere tutti i dati corrispondenti è un obiettivo fondamentale. Ciò significa che è importante sfruttare connessioni ridondanti, rilevare automaticamente le disconnessioni, riconnettersi rapidamente e avere un piano per recuperare i dati persi.

In questa guida all’integrazione esamineremo diverse funzionalità di recupero e ridondanza: connessioni ridondanti, backfill e recovery.
 

**Connessioni ridondanti**

Una connessione ridondante consente semplicemente di stabilire più di una connessione simultanea al flusso filtrato. Questo garantisce ridondanza permettendo di connettersi allo stesso flusso con due consumer distinti, ricevendo gli stessi dati su entrambe le connessioni. In questo modo, la tua app dispone di un hot failover per varie situazioni, ad esempio se un flusso viene disconnesso o se il server principale della tua applicazione si arresta.

Il Flusso filtrato attualmente consente solo ai Progetti con accesso Enterprise di stabilire fino a due connessioni ridondanti. Per utilizzare un flusso ridondante, è sufficiente connettersi allo stesso URL usato per la connessione principale. I dati del tuo flusso verranno inviati su entrambe le connessioni.

<div id="recovering-missed-data-after-a-disconnection-backfill">
  #### Recupero dei dati mancanti dopo una disconnessione: Backfill
</div>

Dopo aver rilevato una disconnessione, il tuo sistema dovrebbe essere in grado di riconnettersi al flusso. Se possibile, dovrebbe annotare la durata della disconnessione in modo da poter usare la funzione di recupero appropriata per eseguire il backfill dei dati.

Se utilizzi un Progetto con accesso Enterprise e hai verificato che la disconnessione è durata cinque minuti o meno, puoi usare il parametro di backfill, backfill\_minutes. Se invii questo parametro con la richiesta [GET /tweets/search/stream](/it/x-api/posts/filtered-stream#get-2-tweets-search-stream), riceverai i post che corrispondono alle tue regole relativi agli ultimi uno-cinque minuti. In genere consegniamo prima questi post meno recenti, prima di quelli appena corrispondenti, e non eseguiamo la deduplicazione. Ciò significa che, se sei stato disconnesso per 90 secondi ma richiedi due minuti di backfill, riceverai 30 secondi di post duplicati, che il tuo sistema dovrebbe tollerare. Ecco un esempio di come potrebbe apparire una richiesta con il parametro di backfill:

`curl 'https://api.x.com/2/tweets/search/stream?backfill_minutes=5' -H "Authorization: Bearer $ACCESS_TOKEN"`

Se non hai accesso Enterprise o hai riscontrato che la disconnessione è durata più di cinque minuti, puoi utilizzare il [recent search endpoint](/it/x-api/posts/search/introduction) o la funzionalità di Recovery per richiedere i dati mancanti. Tieni però presente che gli endpoint di ricerca dei post non includono gli operatori sample:, bio:, bio\_name: o bio\_location: e presentano alcune differenze nel comportamento di corrispondenza quando si usano accenti e diacritici con gli operatori keyword e #hashtag. Queste differenze possono comportare il mancato recupero completo di tutti i post che sarebbero stati ricevuti tramite gli endpoint del flusso filtrato.

**Recupero dei dati mancanti dopo una disconnessione: Recovery**

Se utilizzi un Progetto con accesso Enterprise, puoi usare la funzionalità Recovery per recuperare i dati mancanti nelle ultime 24 ore se non riesci a riconnetterti entro la finestra di backfill di 5 minuti.

La funzionalità di recovery dello streaming consente una finestra di backfill estesa a 24 ore. Recovery ti permette di “riprodurre” il periodo di tempo dei dati mancanti. Un flusso di recovery viene avviato quando invii una richiesta di connessione usando i parametri di richiesta 'start\_time' ed 'end\_time'. Una volta connesso, Recovery ritrasmetterà il periodo indicato, quindi si disconnetterà.

Puoi effettuare 2 richieste concorrenti a Recovery nello stesso momento, ossia “due job di recovery”. Recovery funziona tecnicamente allo stesso modo del backfill, tranne per il fatto che vengono definiti un orario di inizio e uno di fine. Un periodo di recovery riguarda un singolo intervallo temporale.

|     |     |     |
| :--- | :--- | :--- |
| **Nome** | **Tipo** | **Descrizione** |
| start\_time | date (ISO 8601) | YYYY-MM-DDTHH:mm:ssZ (ISO 8601/RFC 3339).<br /><br />Data in UTC che indica l’orario di inizio da cui recuperare. |
| end\_time | date (ISO 8601) | YYYY-MM-DDTHH:mm:ssZ (ISO 8601/RFC 3339).<br /><br />Data in UTC che indica l’orario di fine fino a cui recuperare. |

URL di richiesta di esempio: [https://api.x.com/2/tweets/search/stream?start\_time=2022-07-12T15:10:00Z\&end\_time=2022-07-12T15:20:00Z](https://api.x.com/2/tweets/search/stream?start_time=1985-04-12T23:20:50.52Z\&end_time=1985-04-13T00:20:50.52Z)