---
title: da v1 a v2
sidebarTitle: da v1 a v2
---

<div id="standard-v11-compared-to-x-api-v2">
  ### Standard v1.1 rispetto all’API X v2
</div>

Se hai lavorato con la [search/posts](/it/x-api/posts/search/introduction) v1.1, l’obiettivo di questa guida è aiutarti a comprendere le somiglianze e le differenze tra l’endpoint di ricerca dei post standard e quello dell’API X v2.

- **Somiglianze**
  - OAuth 1.0a in contesto utente e OAuth 2.0 solo app
  - Supporto per la cronologia delle modifiche ai post e i metadati.
- **Differenze**
  - URL degli endpoint

  - Requisiti di App e Progetti

  - Formato dei dati di risposta

  - Parametri della richiesta

  - Nuovi operatori di query

  - Precedenza degli operatori AND/OR 

<div id="similarities">
  #### Somiglianze
</div>

**OAuth 1.0a User Context e autenticazione OAuth 2.0 App-Only**

Gli endpoint v1.1 search/posts e l’endpoint di ricerca recente dell’API X v2 supportano sia [OAuth 1.0a User Context](/it/resources/fundamentals/authentication) sia [OAuth 2.0 App-Only](/it/resources/fundamentals/authentication#oauth-2-0). 

Pertanto, se in precedenza utilizzavi l’endpoint standard v1.1 search, puoi continuare a usare lo stesso metodo di autenticazione se effettui la migrazione alla versione dell’API X v2. 

A seconda della libreria o del pacchetto di autenticazione scelto, l’autenticazione App-Only è probabilmente il modo più semplice per iniziare e può essere configurata con una semplice intestazione della richiesta. Per sapere come generare un App Access Token, consulta questa [guida a OAuth 2.0 App-Only](/it/resources/fundamentals/authentication#bearer-token-also-known-as-app-only). 

Se desideri sfruttare la possibilità di recuperare metriche private o pubblicitarie con l’endpoint dell’API X v2, dovrai utilizzare OAuth 1.0a User Context e passare i token di accesso dell’utente associati all’utente che ha pubblicato il Post per cui desideri recuperare le metriche. 

**Supporto per la cronologia delle modifiche al Post e i metadati**

Entrambe le versioni forniscono metadati che descrivono l’eventuale cronologia delle modifiche. Consulta le [API Reference di search](/it/x-api/posts/recent-search) e la [pagina sui fondamenti delle modifiche ai Post](/it/x-api/fundamentals/edit-posts) per maggiori dettagli. 

<div id="differences">
  #### Differenze
</div>

**URL degli endpoint**

- Endpoint standard v1.1:
  - https://api.x.com/1.1/search/tweets

- Endpoint API X v2:
  - https://api.x.com/2/tweets/search/recent
     

**Requisiti per App e Progetti**

Gli endpoint dell’API X v2 richiedono che tu utilizzi credenziali di una [developer App](/it/resources/fundamentals/developer-apps) associata a un [Project](/it/resources/fundamentals/projects) quando autentichi le richieste. Tutti gli endpoint dell’API X v1.1 possono usare credenziali di App autonome o di App associate a un Project. 

**Formato dei dati di risposta**

Una delle principali differenze tra le versioni degli endpoint standard v1.1 e dell’API X v2 è il modo in cui selezioni quali campi restituire nel payload.

Per gli endpoint standard, molti campi della risposta sono inclusi per impostazione predefinita e hai poi la possibilità di usare parametri per indicare quali campi o insiemi di campi devono essere restituiti nel payload.

La versione dell’API X v2 fornisce per impostazione predefinita solo i campi id e text del Post. Per richiedere campi o oggetti aggiuntivi, è necessario usare i parametri [fields](/it/x-api/fundamentals/fields) e [expansions](/it/x-api/fundamentals/expansions). Qualsiasi campo del Post richiesto da questi endpoint verrà restituito nell’oggetto Post principale. Qualsiasi oggetto e campo espanso di tipo user, media, poll o place verrà restituito in un oggetto includes all’interno della risposta. Puoi quindi ricondurre qualsiasi oggetto espanso all’oggetto Post abbinando gli ID presenti sia nel Post sia nell’oggetto espanso. 

Ti invitiamo ad approfondire questi nuovi parametri nelle rispettive guide o consultando la nostra guida su [come utilizzare fields ed expansions](/it/x-api/fundamentals/data-dictionary#how-to-use-fields-and-expansions). 

Abbiamo anche preparato una [guida alla migrazione del formato dei dati](/it/x-api/migrate/data-format-migration#migrating-from-standard-v1-1s-data-format-to-v2) che può aiutarti a mappare i campi standard v1.1 ai più recenti campi v2. Questa guida ti fornirà anche gli specifici parametri di expansion e di field che dovrai passare con la tua richiesta v2 per ottenere campi specifici. 
 

Oltre ai cambiamenti nel modo in cui richiedi determinati campi, l’API X v2 introduce anche nuovi design JSON per gli oggetti restituiti dalle API, inclusi gli oggetti [Post](/it/x-api/fundamentals/data-dictionary#tweet) e [user](/it/x-api/fundamentals/data-dictionary#user).

- Al livello root del JSON, gli endpoint standard restituiscono oggetti Post in un array statuses, mentre l’API X v2 restituisce un array data. 
- Invece di riferirsi a “statuses” di Retweet e Quote, il JSON dell’API X v2 si riferisce a Retweeted e Quoted Tweets. Molti campi legacy e deprecati, come contributors e user.translator\_type, vengono rimossi. 
- Invece di usare sia favorites (nell’oggetto Post) sia favourites (nell’oggetto user), l’API X v2 usa il termine like. 
- X adotta la convenzione secondo cui i valori JSON privi di valore (ad esempio null) non vengono inclusi nel payload. Gli attributi di Post e user sono inclusi solo se hanno valori non null. 
   

Abbiamo anche introdotto un nuovo set di campi nel [Post object](/it/x-api/fundamentals/data-dictionary#tweet), tra cui:

- Un campo [conversation\_id](/it/x-api/fundamentals/conversation-id)
- Due nuovi campi di [annotations](/it/x-api/fundamentals/post-annotations), inclusi context ed entities
- Diversi nuovi campi di [metrics](/it/x-api/fundamentals/metrics) 
- Un nuovo campo reply\_setting, che indica chi può rispondere a un determinato Post

<div id="request-parameters">
  #### Parametri della richiesta
</div>

I seguenti parametri standard della richiesta v1.1 hanno equivalenti nell’API X v2:

| Ricerca standard v1.1 | Search Posts v2 |
| :--- | :--- |
| q | query |
|  | start\_time (YYYY-MM-DDTHH:mm:ssZ) |
| until (YYYY-MM-DD) | end\_time (YYYY-MM-DDTHH:mm:ssZ) |
| since\_id | since\_id |
| max\_id | until\_id |
| count | max\_results |
| La risposta fornisce search\_metadata.next\_results | next\_token |

Esiste anche un insieme di parametri standard della ricerca Posts **non** supportati nell’API X v2:

| **Parametro standard v1.1** | **Dettagli** |
| :--- | :--- |
| geocode | Search Posts al livello Basic Access non supporta operatori geografici. |
| locale | Con la ricerca standard, veniva usato per specificare la lingua della query, ma non è mai stato pienamente implementato. |
| lang | Gli endpoint Search Posts offrono un operatore di query lang per eseguire il matching sulle lingue di interesse. |
| include\_entities | Le entità dei Post sono sempre incluse. |
| result\_type | Gli endpoint Search Posts restituiscono tutti i Post corrispondenti, indipendentemente dal livello di engagement. |
| extended | L’API X v2 è stata progettata dalle fondamenta per supportare Post fino a 280 caratteri. Con v2, non esiste il concetto di Post “extended”. |

Ecco un esempio di richiesta che mostra la differenza tra una richiesta Standard e una richiesta Search Posts:

|  |  |
| :--- | :--- |
| **Standard v1.1** | **API X v2** |
| https://api.x.com/1.1/search/tweets.json?q=snow\&count=50 | https://api.x.com/2/tweets/search/recent?query=snow\&max\_results=50 |

Entrambe le richieste restituiranno i 50 Post più recenti che contengono la parola chiave snow. La richiesta v2 restituirà i campi predefiniti id e text dei Post corrispondenti. Ecco un esempio in cui si specificano ulteriori campi dei Post e dell’utente da includere nel payload JSON:

|  |
| :--- |
| **API X v2** |
| https://api.x.com/2/tweets/search/recent?query=snow\&max\_results=50\&tweet.fields=id,created\_at,author\_id,text,source,entities,attachments\&user.fields=id,name,username,description |

**Nuovi operatori di query**

Search Posts introduce nuovi operatori a supporto di due nuove funzionalità dell’API X v2:

- **[Conversation IDs](/it/x-api/fundamentals/conversation-id)** - Man mano che le conversazioni si sviluppano su X, sarà disponibile un ID conversazione per contrassegnare i Post che ne fanno parte. Tutti i Post nella conversazione avranno conversation\_id impostato sull’ID del Post che l’ha avviata.
  - `conversation_id:`
- **[X Annotations](/it/x-api/fundamentals/post-annotations)** forniscono informazioni contestuali sui Post e includono annotazioni di entità e di contesto. Le entità comprendono persone, luoghi, prodotti e organizzazioni. I contesti sono domini o argomenti di cui fanno parte le entità emerse. Ad esempio, le persone menzionate in un Post possono avere un contesto che indica se sono atleti, attori o politici.
  - context: corrisponde ai Post annotati con un contesto di interesse.
  - entity: corrisponde ai Post annotati con un’entità di interesse. 

     

<div id="and-or-operator-precedence">
  #### Precedenza degli operatori AND / OR
</div>

Il mattone fondamentale per costruire query di ricerca è l’uso dei raggruppamenti logici OR e AND. La Standard Search API applica gli OR prima degli AND, mentre gli endpoint Search Posts (così come le versioni premium ed enterprise) applicano gli AND prima degli OR. Questa differenza è cruciale quando si traducono le query tra le due.

Ad esempio, con la ricerca standard, se volessi trovare i Post con la parola chiave “storm” che menzionano la parola “colorado” o l’hashtag #COwx, potresti farlo con la seguente query:

storm #COwx OR colorado

Con la precedenza degli operatori di Search Posts, gli AND vengono applicati prima degli OR. Quindi la query sopra è equivalente a:

(storm #COwx) OR colorado

Tuttavia, la regola sopra corrisponderebbe a qualsiasi Post che menzioni “Colorado”, indipendentemente dal fatto che il Post menzioni “storm” o l’hashtag #COwx. Inoltre, corrisponderebbe anche ai Post che menzionano sia la parola chiave “storm” sia l’hashtag #COwx.

Per far sì che la query si comporti come previsto in origine, le clausole OR devono essere raggruppate. La traduzione della query standard originale per Search Posts sarebbe:

storm (#COwx OR colorado)

Queste due regole hanno comportamenti di corrispondenza molto diversi. Per il mese di ottobre 2019, la regola originale corrisponde a oltre 1.175.000 Post, mentre la regola tradotta correttamente corrisponde a circa 5.600 Post. Assicurati di prestare attenzione agli AND e agli OR e usa le parentesi quando necessario. 

<div id="curl-requests">
  #### Richieste cURL
</div>

**La sezione seguente mostra le richieste cURL per l’endpoint standard v1.1 e il relativo endpoint equivalente in v2.**

Le richieste vengono effettuate utilizzando \[OAuth 2.0 App-Only]\(https://developer.x.com(/resources/fundamentals/authentication#app-only-authentication-and-oauth-2-0-bearer-token). In order to run the following cURL requests, you will need to replace ACCESS\_TOKEN in the authorization header with your app access token. Per gli endpoint v2, il token di accesso della tua app deve appartenere a una [developer App](/it/resources/fundamentals/developer-apps/overview) all’interno di un [Project](/it/resources/fundamentals/projects/overview). 

Il payload della risposta restituito dall’endpoint v1.1 sarà diverso da quello restituito dall’endpoint v2. Con v2, la risposta includerà i campi predefiniti, oltre a eventuali altri campi richiesti con i parametri [fields](/it/x-api/fundamentals/fields) e [expansions](/it/x-api/fundamentals/expansions). Puoi utilizzare questi parametri per richiedere un set diverso di campi da restituire.

**Endpoint standard v1.1 [GET search/tweets](https://developer.x.com/en/docs/twitter-api/v1/tweets/search/api-reference/get-search-tweets) e v2 [GET tweets/search/recent](/it/x-api/posts/recent-search)**

```bash
      curl --request GET \
  --url 'https://api.x.com/1.1/search/tweets.json?q=from%3ATwitterDev%20-is%3Aretweet&count=100' \
  --header 'Authorization: Bearer $ACCESS_TOKEN'
```

```bash
      curl --request GET \
  --url 'https://api.x.com/2/tweets/search/recent?query=from%3ATwitterDev%20-is%3Aretweet&tweet.fields=created_at%2Cconversation_id%2Centities&max_results=100' \
  --header 'Authorization: Bearer $ACCESS_TOKEN'
```

**Prossimi passi**

[Check out our quick start guide for X API v2 recent search](/it/x-api/posts/search/quickstart/recent-search)

[Review the API reference for recent search](/it/x-api/posts/recent-search)

[Check out some sample code for these endpoints](https://github.com/xdevplatform/Twitter-API-v2-sample-code "Check out some sample code for these endpoints")

[Step-by-step guide to making your first request to recent search](/it/x-api/getting-started/make-your-first-request "Step-by-step guide to making your first request to recent search")