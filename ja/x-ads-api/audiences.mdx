---
title: オーディエンス
---

import { Button } from '/snippets/ja/button.mdx';

<div id="custom-audiences">
  ## カスタムオーディエンス
</div>

<div id="overview">
  ### 概要
</div>

パートナーが[カスタムオーディエンス](https://business.x.com/en/targeting/tailored-audiences.html)を作成する方法は複数あります。

- [Audience API（CRM）](#crm)
- [Web](#web)
- [Mobile](#mobile)
- [Flexible](#flexible)

ルックアライクのカスタムオーディエンスはターゲティングから除外できません。さらに、同一の広告ラインアイテム（広告グループ）で、カスタムオーディエンスとそのルックアライクを同時にターゲティングすることはできません。

**オーディエンス管理**

オーディエンスは、オーディエンスパートナーおよび Ads API パートナー経由で管理できます。API では、カスタムオーディエンスにアクセス・維持するための一連のエンドポイントを提供しています。

カスタムオーディエンス情報については、次の 2 つのエンドポイントを提供しています:

- [GET accounts/:account\_id/custom\_audiences](/ja/x-ads-api/audiences)
- [GET accounts/:account\_id/custom\_audiences/:custom\_audience\_id](/ja/x-ads-api/audiences)

オーディエンスのアップロードと管理方法の詳細は、[Audience API ガイド](/ja/x-ads-api/audiences)をご覧ください。

**処理時間**

一般的に、オーディエンスの変更は 6〜8 時間ごとに実行されるバッチで処理されます。変更の処理中でも、更新対象の既存オーディエンス自体には影響しません。この期間内に、追加に対する更新と削除に対する更新をそれぞれ 1 回を超えて行うことは推奨しません。

**ターゲティング**

オーディエンスは、過去 90 日以内に X が保有・運営するクライアント上でアクティブなユーザーに少なくとも 100 件一致する場合にのみターゲティング可能です。[GET accounts/:account\_id/custom\_audiences/:custom\_audience\_id](/ja/x-ads-api/audiences) では、一致ユーザーが少なすぎてターゲティングできない可能性があるかどうかを示します。

**Audience API（CRM）**

<Frame>
  <img src="https://cdn.cms-twdigitalassets.com/content/dam/developer-twitter/images/crm_0.png" alt="image2" />
</Frame>

オーディエンス／API パートナーがハッシュ化された識別子のリストを提供し、X が照合して、X 上のメディアバイイングで利用可能なセグメントを生成します。パートナーは [Audience API](/ja/x-ads-api/audiences) を使用してこれらのオーディエンスを作成できます。

**仕組み**

<Frame>
  <img src="https://cdn.cms-twdigitalassets.com/content/dam/developer-twitter/images/crm_1.png" alt="image3" />
</Frame>

**Web**

MPP オーディエンスパートナーと連携する際、X 上のメディアバイイング向けにターゲティングするセグメントを特定するための標準的な Cookie マッチングプロセスを提供しています。加えて、広告主は [X Web Event Tag](/ja/x-ads-api/measurement/web-conversions#web-event-tags) を設定してウェブサイトのユーザーデータを収集し、対応するカスタムオーディエンスを作成できます。

**セットアップ手順**

<Frame>
  <img src="https://cdn.cms-twdigitalassets.com/content/dam/developer-twitter/images/screen_shot_2013-11-26-cookie-usage.png" alt="image0" />
</Frame>

![]()

**仕組み**

<Frame>
  <img src="https://cdn.cms-twdigitalassets.com/content/dam/developer-twitter/images/tailored_audience_web.png" alt="image1" />
</Frame>

**Mobile**

詳細は[「Custom Audiences from Mobile Apps」のブログ記事](https://blog.x.com/2014/introducing-tailored-audiences-from-mobile-apps)をご覧ください。

**Flexible**

[フレキシブルオーディエンス](/ja/x-ads-api/audiences)は、広告主が既存のカスタムオーディエンスまたはそのサブセットに基づいて、オーディエンスの組み合わせを構築・保存できる機能を提供します。カスタムオーディエンスのメンバーのサブセットは、インタラクションの新規性（recency）と頻度（frequency）に基づいてターゲティングできます。

**カスタムオーディエンスの制限付きユースケース**

[制限事項の詳細を読む](https://developer.x.com/en/developer-terms/more-on-restricted-use-cases "制限事項の詳細を読む")

<div id="audiences-faq">
  ### オーディエンスに関する FAQ[](#real-time-tailored-audiences "Permalink to this headline")
</div>

**Q: 大量のデータをプッシュしたのに、オーディエンスサイズが TOO\_SMALL と表示されるのはなぜですか？**

A: 現在、データ自体はリアルタイムでオーディエンスに追加されていますが、オーディエンスサイズを算出する処理ジョブは一定時間後にのみ実行されます。数時間後には UI に正しいオーディエンスサイズが表示されるはずです。

**Q: オーディエンスデータの送信を完了し、24時間以上待ちましたが、まだそのオーディエンスをターゲティングできません。次のステップとして何をすべきですか？**

A: 次の点をご確認ください:

- 渡しているユーザー ID が正しく、形式不備がないこと。
- 渡しているオーディエンス名が正しく、過去のメンバーシップ更新と一致していること。
- POST コマンドのレスポンスを確認してください。
- ID Sync ピクセルが正しく実装されていること、また ID Sync の手順どおり、対象サイトに十分なユーザー訪問がありユーザーのマッピングが行われていることを確認してください。メンバーシップ更新に含まれる未マッピングのユーザーは、ターゲティング可能なユーザーに変換されません。

上記すべてが正しく機能している場合は、可能な限り詳細な情報を添えて X のプロダクト担当窓口にご連絡ください（望ましい情報例は [Guide to Partner Inbounds](/ja/x-ads-api/introduction) を参照）。

**Q: エンドポイントは何回呼び出せますか、またどのようなアルゴリズムで呼ぶべきですか？**

A: 増分の差分で呼び出すことを強く推奨し、完全なオーディエンスメンバーシップを再送しないでください。本システムは、世界最大級のウェブサイトの増分データ更新を処理できるスループットで検証されています。初回のオーディエンスアップロードは慎重にスロットリングし、完了まで相応の時間を要する見込みです。

**Q: ターゲティングに使用できるオーディエンスの最小サイズはどのくらいですか？**

- オーディエンスの最小サイズは 100 ユーザー（照合後）です。500 ユーザー未満のオーディエンスが照合された場合、X 広告の UI ではターゲティングに利用できません。

**Q: オーディエンスファイルの処理にはどのくらい時間がかかりますか？また、X のユーザーインターフェースでオーディエンスファイルが利用可能になるまでどのくらいかかりますか？**

- 通常、オーディエンスファイルの処理には 4〜6 時間かかりますが、ファイルサイズに依存します。ファイルの処理が完了すると、X 広告の UI 上でオーディエンスが利用可能になります。

**Q: 照合率はどのように計算されますか？**

- Match Rate = 過去 90 日のアクティブな X ユーザー数 / 提供したユーザー数

**Q: オーディエンスファイルが正しく動作しているかをどのようにテストすればよいですか？**

- テスト用のオーディエンスファイルを提供し、広告主ハンドルとして「keltonlynn」を使用してください。ファイルが適切に取り込まれ、X の UI にロードできることを確認できます。

**Q: パートナーユーザー識別子（`p_user_id`）とは何ですか？**

- 貴社が各顧客を一意に識別するために使用する識別子です。

**Q: 標準 ID とは何ですか？**

- メールアドレス、デバイス ID、X の @handle または ID を指します。

**Q: HMAC キーはどのように入手しますか？**

- 暗号化メールで提供します。公開 PGP キーを [mpp-inquiry%x.com](mailto:mpp-inquiry%x.com) にお送りください。すべてが正常に機能していることを確認するためにテストメールをお送りします。検証後、HMAC キーを送付します。

**Q: 提供された HMAC キーを使ってハッシュ処理が正しく行われたことをどのように検証しますか？**

- X からテストファイル（サンプルのメールアドレス、デバイス ID などを含む）と、照合用のハッシュ結果ファイルを提供します。それを用いて結果を検証できます。

**Q: フルデータマッチファイルにサイズ制限はありますか？**

- いいえ、フルデータマッチファイルにサイズ制限はありません。

**Q: フルデータマッチファイルの処理にはどのくらい時間がかかりますか？**

- X がファイルを受領してから、処理にはおよそ 1 日かかります。

<div id="crm">
  ### CRM
</div>

<Frame>
  <img src="https://cdn.cms-twdigitalassets.com/content/dam/developer-twitter/images/crm_0.png" alt="image0" />
</Frame>

本ドキュメントでは、カスタムオーディエンスのCRMパートナー向けに、ファイル形式やデータ交換プロセスを含む連携の詳細を説明します。

**概要**

Company は、顧客に代わり、ハッシュ化された共通ユーザー識別子（例：メールアドレス）またはパートナーのユーザーIDのリストを X に提供し、ブラインドマッチを実行してターゲティング用の X ユーザーIDのリストを作成します。ターゲティング用セグメントは、ads.x.com のキャンペーン設定でファイル名に指定された広告主の特定の @handle に対して利用可能になります。

Company からのすべてのファイルは、X が Company に付与した専用アカウントを通じて、IronBox（www.golockbox.com）上のセキュアパッケージ経由で X に提供されます。X は IronBox へのアクセスを提供します。IronBox API のドキュメントは [https://secure.goironcloud.com/Docs/Help/](https://secure.goironcloud.com/Docs/Help/) にあります。

<div id="partner-id-matching-requirements">
  #### パートナーID照合の要件
</div>

企業がユーザーを追跡するために独自の標準IDシステム（＝メールアドレス、デバイスID、X ユーザーIDなどの一般的なユーザー識別子ではないもの）を使用している場合、以下のプロセスを推奨します。

**1. フルデータ照合**

まず、Company は、X と共通の一意のユーザー識別子を含む全ユーザーレコードの包括的なリストを単一ファイルで提供し、フルデータ照合を実施して、パートナーID（`p_user_id`）と X ID（`tw_id`）のマッピングを X 側に保存します。これは適切な保守のため、2～3か月ごとに定期的に実施します。照合が完了すると、X はこのファイルに基づくベースラインの照合率を Company にメールで共有します。

このファイルのフォーマットは以下のとおりです：

名称規則: FullDataMatch.\[CompanyName].txt

ハッシュアルゴリズム: HMAC\_SHA-256

フォーマット:

列1: 共通ユーザー識別子の HMAC ハッシュ値

列2: パートナーユーザーID（ユーザーごとに一意、ファイル内では重複あり）

列区切り（CSV）: ハッシュ化された共通ユーザー識別子とパートナーIDの区切りにはカンマを使用

行区切りの値

- 例: ユーザーレコード A にパートナーユーザーID 1 と共通識別子 1、2、3 がある場合:

|     |     |
| :--- | :--- |
| common user identifier 1 | p\_user\_1 |
| common user identifier 2 | p\_user\_1 |
| common user identifier 3 | p\_user\_1 |

\*共通ユーザー識別子については、下記の「ハッシュ手順」セクションを参照してください

**2. カスタムセグメントリスト**

Company は、`p_user_id` の形式でユーザーのリストを提供し、X 上でのターゲティングのために顧客向けのカスタムオーディエンスを作成します。

- 行区切りの値
- `p_user_id`
- _（上記 1. フルデータ照合セクションと同様。フルデータ照合で提供した値がハッシュ化されている場合、Company はオーディエンスファイルでも同じハッシュ値を提供します。ハッシュ化されていない値を提供した場合は、ハッシュ化されていない値を提供します。）_

<div id="standard-matching-requirements">
  #### 標準的なマッチング要件
</div>

企業がすべての顧客ユーザー識別子のマッピングに標準 ID を使用していない場合は、次のプロセスを推奨します。

**カスタムセグメントリスト**

企業は、顧客に代わり、ハッシュ化された一般的なユーザー識別子のリストを X に直接提供して、カスタムオーディエンスを作成します。

ファイルの形式は次のとおりです:

- 行ごとに値を区切る
- ハッシュ化済みの一般的なユーザー識別子（例: email アドレス）
- 以下のファイル命名規則に従う
- 以下の「ハッシュ化手順」に記載の email アドレスのハッシュ化手順に従う

<div id="custom-segment-list-file-naming-operations">
  #### カスタムセグメントリストのファイル命名規則と操作
</div>

ファイルの処理内容はファイル名によって決まり、利用可能な操作と一般的なファイル命名規則は次のとおりです: audiencename\_partnername.handle.operation.filetype

- audiencename: カスタムオーディエンスの名称。広告キャンペーン設定の ads.x.com の UI でオーディエンス選択時に表示される名前（例: brand\_loyalty\_card\_holders）
- partnername: 広告主に代わってデータを提供する企業名（例: company\_name）
- handle: カスタムオーディエンスへのアクセス権を持つ X アカウント（@handle）（例: @pepsi、@dietpepsi）
- operation: new、add、remove、removeall、replace（詳細は下記）
- timestamp: 各オーディエンスファイルの一意性を担保するために使用する、標準的な Unix エポック時間（秒）
- filetype: ファイルは \*.txt 形式である必要があります

<div id="creating-and-updating-audiences">
  #### オーディエンスの作成と更新
</div>

1つのファイルで新しいオーディエンスを作成します（例: loyalty\_card\_holders\_partnername.pepsi.new.txt）

追加 - リストでマッチしたユーザーを既存のオーディエンスに追加します（例: loyalty\_card\_holders\_partnername.pepsi.add..txt）

削除 - リストでマッチしたユーザーを既存のオーディエンスから削除します（例: loyalty\_card\_holders\_partnername.pepsi.remove..txt）

すべて削除 - 定期的に更新される累積リストにより特定されたマッチを、そのクライアントのすべてのオーディエンスから削除します（例: partnername.pepsi.removeall.txt）

- これは、広告主からオプトアウトしたユーザーの包括的なリストとして使用できます。
- X は、このファイルで提供された最新のリストのみを有効とし、既存および将来のすべてのオーディエンスに対して、マッチしたユーザーへ適用します。

このファイルが提供・処理された時点の X ユーザーが対象です。

置換 - 既存のオーディエンスを削除し、新しいオーディエンスリストに置き換えます（例: loyalty\_card\_holders\_partnername.pepsi.replace..txt）

全社オプトアウト - 企業は、自社のオプトアウトポリシーに基づき、オプトアウトしたユーザーを削除するための累積オプトアウトファイルを提供します。

X は、この全社オプトアウトファイルで提供された最新のリストのみを有効とし、このファイルが提供・処理された時点でマッチした X ユーザーに対して、既存および将来のすべてのオーディエンスに適用します。全社オプトアウトファイルの形式は次のとおりです（例: partnername.removeall.txt）

削除 - 現在のオーディエンス一覧から既存のオーディエンスを削除します（例: loyalty\_card\_holders\_partnername.pepsi.delete.txt）

<div id="hashing-directions">
  #### ハッシュ化手順
</div>

X は、一般的なユーザー識別子（例：メールアドレス）をハッシュ化するために、PGP を用いて Base64 エンコード済みの本番鍵を安全に共有します。Company は、その鍵を Base64 デコードして、ハッシュ化に使用する 32 バイトの鍵を生成します。

Base64 エンコード鍵の例:

BrQvOg+dACBUmKjRiNxZgJLh6zydjS0ZOv80FelTNzM=

Base64 デコード鍵の例:

/:� TшY

正規化：Company は、ハッシュ化の前に一般的なユーザー識別子に対して基本的な正規化を実施します（ただし Device ID は除く。Device ID の正規化セクションを参照）。

<div id="e-mail-normalization">
  #### Eメールの正規化
</div>

先頭と末尾の空白を取り除き、メールアドレスを小文字に変換します。

例: 元のメールアドレス: testemail\_Organisational\_baseball+884`@`It92I6Ev2B`.`Com

正規化後: testemail\_organisational\_baseball+884`@`it92i6ev2b`.`com

ハッシュ値: 74d9584eded0ad1e5572a1c1849f3716751d371d6117a6155dad5363f4b4fbec

注: エンコードされた HMAC とキーの文字数は、入力内容やエンコーディングによって変わります。

<div id="device-id-normalization">
  #### デバイス ID の正規化
</div>

デバイス ID のハッシュ化については、SHA-256 ハッシュアルゴリズムと、当社がデータパートナーに提供する共通ソルトを使用するという同一の要件があります。メールアドレスの場合と同様にスペースは除去しますが、IDFA／Android ID については小文字化による正規化は行わず、IDFA／Android ID の正確な形式を使用してください。

以下は、ハッシュ化前の iOS および Android におけるデバイス ID の生データ形式の例です。

iOS IDFA: DD99CFF7-6186-4602-9DF2-ED3FD0B2D431

Android ID: b5bf2122961b3595

ハッシュ化後の iOS IDFA: 134fb8cd95c7fd42e2793f469a447198ca5f990968db2dbadad70e723ed9750b

ハッシュ化後の Android ID: 130dddff1939f229476f50bc8adab8fcb7e3525b0e9604fe8effc15e68cee4a4

<div id="x-user-id-normalization">
  #### X ユーザー ID の正規化
</div>

X ID は、データのグルーピング（例：@handle の Customer List）が PII ではないとしても広告主にとって非公開であるため、引き続きハッシュ化されます。データパートナーに提供する共通ソルトと SHA-256 ハッシュアルゴリズムを用いた X ID のハッシュ化に関する要件は同じです。X ID と「@」username の両方からはスペースを削除してください。ただし、User ID の正規化は不要です。@username は正規化のため小文字にしてください。また、@ 記号は username の一部に含めないでください。

生の ID 形式は次のとおりです:

- User ID: 27674040
- @username: testusername

ハッシュ化された User ID: bf6b57d4e861e83bea8bbed2b800b251a64c95468ee6e8cb07c3368c9ed45e85

ハッシュ化された @username: 12201ae78ad1afa907c7112d17f498154ffb0bf9ea523f5390e072a06d7d9812

<div id="id-sync-integration">
  ### ID 同期の統合
</div>

`p_id` を用いてデータを送信するパートナーは、広告主またはパートナーのユーザー ID と X のユーザー ID のマッピングを生成するために、ID 同期プロセスを実施する必要があります。これにより、広告主は自社のユーザーセグメントを X 上で直接ターゲティングできます。パートナーはメンバーシップ更新を送信する際、パラメータ `user_identifier_type` の値を `TALIST_PARTNER_USER_ID` または `TAWEB_PARTNER_USER_ID` に設定する必要があります。

- **Web のみ**: 以下の手順に従い、広告主のサイトにピクセルを設置して実行できます。
- **リスト**: [CRM](/ja/x-ads-api/audiences#crm) ページで説明されているいずれかの方法で実行できます。

<div id="pixel-url">
  #### ピクセル URL
</div>

|     |
| :--- |
| **ベース URL** |
| [https://analytics.x.com/i/adsct](https://analytics.x.com/i/adsct) |

<div id="pixel-parameters">
  #### ピクセルパラメータ
</div>

|     |     |
| :--- | :--- |
| **パラメータ** | **説明** |
| `p_id` | X によって割り当てられたパートナー ID |
| `p_user_id` | パートナーシステムでのユーザー ID |

<div id="id-sync-pixel">
  #### ID 同期ピクセル:
</div>

パートナー ID の例を 111、`p_user_id` の例を abc とすると、生成されるピクセルは次のとおりです:

```json
    <pre class="brush: xml">
    <img height="1" width="1" src="https://analytics.x.com/i/adsct?p_id=111&p_user_id=abc" style="display:none" />
    </pre>
```

**オプトアウトファイルの構成と送信**

パートナーは、ターゲティング広告配信のオプトアウトを選択したとパートナーの最善の知見に基づき把握しているユーザーのリストを X に提供する必要があります。ファイルの形式は次のとおりです:

|     |     |     |     |
| :--- | :--- | :--- | :--- |
| **列番号** | **列名** | **列の型** | **説明** |
| 1   | Partner ID | string | 「partner id」は、各パートナーを一意に識別するために X がパートナーに付与する ID です。 |
| 2   | パートナーシステムにおけるユーザーの ID | string | `p_user_id` は、パートナーがユーザーを識別するために使用する一意の ID です。これらのオプトアウトユーザーを含むファイルは、[TON upload](/ja/x-ads-api/audiences) エンドポイントを使用してアップロードし、アップロードしたデータのパスを次の Global Opt Out エンドポイントに送信する必要があります: [PUT accounts/:account\_id/custom\_audiences/global\_opt\_out](/ja/x-ads-api/audiences)。 |

**メンバーシップ更新の送信**

エンドポイントのドキュメントに記載のとおり、[POST custom\_audience\_memberships](/ja/x-ads-api/audiences) エンドポイントでユーザーを送信する際は、Cookie ベースのマッチングを有効にするために customer ID を渡す必要があります。`p_id` を含むデータを送信するパートナーは、`user_identifier_type` を `TALIST_PARTNER_USER_ID` または `TAWEB_PARTNER_USER_ID` に設定することが必須です。

その他の手順は、[Real-Time Audience API Integration Guide](/ja/x-ads-api/audiences) に記載されているとおりです。

<div id="custom-audiences-user-data">
  ### カスタムオーディエンスのユーザーデータ
</div>

本ドキュメントでは、\[カスタムオーディエンス]/x-ads-api/audiences のユーザーデータ形式を説明します。

**データ正規化**

**デバイス ID**:

- IDFA - 小文字かつダッシュ区切り。例: `4b61639e-47cc-4056-a16a-c8217e029462`
- AdID - 端末上の元の形式が必須。大文字化せず、ダッシュを含む。例: `2f5f5391-3e45-4d02-b645-4575a08f86e`
- Android ID - 端末上の元の形式が必須。大文字化せず、ダッシュやスペースは含めない。例: `af3802a465767e36`

**メールアドレス**:

- 小文字にし、前後の空白を削除。例: `support@x.com`

**X ユーザー名**:

- @ は不要。小文字にし、前後の空白を削除。例: `jack`

**X ユーザー ID**:

- 標準的な整数。例: `143567`

**データのハッシュ化**

各行のデータはソルトなしで `SHA256` を用いてハッシュ化する必要があります。さらに、最終的な出力ハッシュは小文字にしてください。例: 49e0be2aeccfb51a8dee4c945c8a70a9ac500cf6f5cb08112575f74db9b1470d であり、**49E0BE2AECCFB51A8DEE4C945C8A70A9AC500CF6F5CB08112575F74DB9B1470D ではありません**

```
# Python を使って @AdsAPI ユーザーをハッシュ化
import hashlib
hashlib.sha256("adsapi".encode()).hexdigest()

# 出力
49e0be2aeccfb51a8dee4c945c8a70a9ac500cf6f5cb08112575f74db9b1470d
```

ハッシュ化の追加コードサンプルは [github.com/xdevplatform/ads-platform-tools](https://github.com/xdevplatform/ads-platform-tools) にあります。

<div id="custom-audiences-web">
  ### カスタムオーディエンス: Web
</div>

<Frame>
  <img src="https://cdn.cms-twdigitalassets.com/content/dam/developer-twitter/images/info.png" alt="info.png" />
</Frame>

**情報**

パートナーは広告主に代わってターゲティングするための ID（`p_user_ids`）のリストを送信します。これは、`p_user_ids` と X ユーザー ID の間にマッピングを構築する ID 同期プロセスによって行われます。このマッピングを用いて、ターゲティングに使用できる X ユーザー ID のリストを生成します。これらのカスタムオーディエンスは、ads.x.com の Custom Audiences Web キャンペーン設定でラベルにより指定された、広告主の特定の @handle で利用可能になります。

X は、パートナーのタグやサイトに設置できるセキュアピクセルを提供し、ID（`p_user_ids`）を X ユーザー ID と照合できるようにします。ID 同期プロセスが完了すると、ターゲティングファイルはパートナーによって作成され、HTTPS エンドポイントを通じて X が取得できるよう提供されます。これらのターゲティングファイルは X により定期的に取り込まれ、その後 X の UI で利用可能になります。

**X セキュアピクセル**

X セキュアピクセルは次のとおりです:

https://analytics.x.com/i/adsct?p\_user\_id=xyz\&p\_id=123

**`p_user_id`** - xyz はパートナーが提供するパートナーユーザー ID を示します

**`p_id`** - 123 はパートナー固有の ID（X により付与）を示します

**パートナー HTTPS エンドポイントとターゲティングユーザーファイル**

パートナーは、ターゲティングファイルを定期的に取り込むために使用できる HTTPS エンドポイントと認証情報（ユーザー名／パスワード）を X に提供する必要があります。サンプルの HTTPS エンドポイントは次のとおりです:

```
https://<partnerdomain>/twitter/partner_targeting_%Y-%M-%D.tsv.gz
```

%Y - 年のフォーマットコード（YYYY）

%M - 月のフォーマットコード（MM）

%D - 日のフォーマットコード（DD）

送信されるデータは次のファイルで構成されます:

1. パートナーターゲティングユーザーファイル
2. ターゲティングコンバージョンファイル

すべてのファイルは TSV 形式で、各行の各フィールドはタブ文字で区切られます。フィールド値自体にタブ文字が含まれることはありません。

**許可対象の X IP レンジ:**

パートナーエンドポイントへのアクセスを許可できる IP の範囲は次のとおりです。

- 199.16.156.0/22
- 199.59.148.0/22

**パートナーターゲティングユーザーファイル:**

| **列番号** | **列名** | **列タイプ** | **説明** |
| :--- | :--- | :--- | :--- |
| 1   | partner id | string | 「partner id」は、各パートナーを一意に識別するために X がパートナーに付与する ID です。 |
| 2   | advertiser id | string | 「advertiser id」は広告主の @handle です。 |
| 3   | p\_user\_id | string | 「p\_user\_id」は、パートナーがユーザーを識別するために使用する一意の ID です。 |
| 3   | confidence score | integer | 「confidence score」は任意項目です。推奨するスコア範囲は 0〜100 です。リターゲティングがユースケースの場合、スコア「100」は直接リターゲティングされたユーザーを意味します。0〜99 のスコアは、類似オーディエンスに対する信頼度を表します。 |
| 4   | segment label | string | 「segment label」は任意項目です。パートナーは、たとえば製品カテゴリを指定するために「segment label」を使用できます。ads.x.com の UI における Custom Audiences の人間が読める名称となるため、この「segment label」の利用を推奨します。 |

**注記:**

新しいパートナーターゲティングファイルを受け取るたびに、特段の合意がない限り、増分ではなく、パートナーが推奨するターゲティング対象ユーザーの完全なリストであることを想定します。パートナーごとに、このパートナーターゲティングファイルの配信頻度について合意します。想定どおりにパートナーターゲティングファイルを受領できない場合は、あらかじめ定めた有効期限内で前回のバージョンを使用します。

<div id="audience-api-integration">
  ## オーディエンス API の統合
</div>

<div id="overview">
  ### 概要
</div>

Audience API は Ads API の[v4](/ja/x-ads-api/introduction)の一部としてリリースされ、従来の Audiences エンドポイントに対して複数の改善をもたらしました。この新しいエンドポイントは新たな Audience 処理バックエンドに基づいており、安定性・堅牢性・信頼性の面で大きく向上しています。本ガイドの目的は、Audience API と従来の Audience のアップロード／管理プロセスとの相違点を明確にすることです。 

参照ドキュメントは [Audience API](/ja/x-ads-api/audiences) のリファレンスページにあります。 

**注**: すべての Audience のユーザーデータはアップロード前に SHA-256 でハッシュ化する必要があります。受け入れ可能なユーザー識別子の種類やデータ正規化の詳細は、[user data](/ja/x-ads-api/audiences) ページを参照してください。

**Audience 機能の変更点**

v4 以降、カスタムオーディエンスには以下の変更が導入されており、Ads API v3 のサンセット後は非推奨エンドポイントは利用できなくなります。

- **非推奨** TON アップロード:
  - GET accounts/:account\_id/custom\_audience\_changes
  - GET accounts/:account\_id/custom\_audience\_changes/:custom\_audience\_change\_id
  - POST accounts/:account\_id/custom\_audience\_changes
  - PUT accounts/:account\_id/custom\_audiences/global\_opt\_out
- **非推奨** Real Time Audiences:
  - POST custom\_audience\_memberships
- カスタムオーディエンス:
  - すべての [Custom Audience](/ja/x-ads-api/audiences) エンドポイントのリクエストおよびレスポンスから `list_type` パラメータが削除されます。このパラメータは以前、Audience のユーザー識別子の種類（例: email、X User ID など）を識別するために使用されていましたが、現在の Audiences は同一の Audience に対して複数のユーザー識別子を受け付けられるため、この値は不要になりました。
- 一般:
  - Audience のルックバックウィンドウは、過去30日間から過去90日間にアクティブなユーザーを対象にするよう更新されました
  - ターゲティング可能とみなされるために必要な一致ユーザー数の最小値は、500 から 100 に引き下げられました

<Note>
  **前提条件**

  - Ads API へのアクセス
  - Audience エンドポイントへのアクセスには、許可リストへの追加が必要です。次のフォームに記入し、2018-08-01 より前に初回承認されている場合は新しい [X Ads Products and Services Agreement](/ja/x-ads-api/introduction) に同意してください
</Note>

**Audience のアップロードプロセス**

以下の表は、従来と新しい Audience 作成フローの主な違いを示します。詳細はこの後に記載しています。

| Step in Process | Audience API | (Deprecated) TON Upload |
| :--- | :--- | :--- |
| Create a shell Audience | Can be created via the \[POST custom\_audience endpoint]/x-ads-api/audiences | Can be created via the \[POST custom\_audience endpoint]/x-ads-api/audiences |
| Add a new user | Use the `operation_type` `Update` with the [Audience endpoint](/ja/x-ads-api/audiences) | Use the `operation` `ADD` with the [POST custom\_audience\_changes](/ja/x-ads-api/audiences) endpoint |
| Remove a user | Use the `operation_type` `Delete` with the [Audience endpoint](/ja/x-ads-api/audiences) | Use the `operation` `REMOVE` with the [POST custom\_audience\_changes](/ja/x-ads-api/audiences) endpoint |
| Opting-Out Users | Use the `operation_type` `Delete` with the [Audience endpoint](/ja/x-ads-api/audiences) and the corresponding `custom_audience_id`s that the user is a part of | Use the [Global opt-out endpoint](/ja/x-ads-api/audiences) |

**注** TON アップロード経路で更新またはオプトアウトを行う Audience は、[TON Upload](/ja/x-ads-api/audiences) エンドポイント経由で対応するリストをアップロードし、[custom\_audience\_changes](/ja/x-ads-api/audiences) エンドポイントを使用して Audience に関連付けておく必要があります。

**レート制限**

Audience API エンドポイントのレート制限はアカウントあたり 1500/1min です。単一ペイロードで送信可能なユーザー数に制限はありません。ペイロードの制約は以下のとおりです。

1\. 操作の合計数: 2500 operations

2\. 最大ペイロードサイズ: 5,000,000 bytes

**Audience のユーザー管理**

新しい Audience を作成するには、以下の手順が必要です

<div id="create-a-new-custom-audience">
  ### 新しいカスタムオーディエンスを作成する
</div>

\[POST custom\_audience]/x-ads-api/audiences エンドポイントを使用して、新しいカスタムオーディエンスの「シェル」を作成し、対応するカスタムオーディエンスの `id` を取得します。これはオーディエンスを一から作成する場合に必要な手順です。既存のオーディエンスを更新する場合は、次のセクションに進んでください。

<div id="add-users-to-an-audience">
  ### オーディエンスにユーザーを追加する
</div>

[POST accounts/:account\_id/custom\_audiences/:custom\_audience\_id/users](/ja/x-ads-api/audiences) エンドポイントに、カスタムオーディエンスの `id` と、以下のようなサンプルのペイロードを渡します:

POST https://ads-api.x.com/11/accounts/18ce54d4x5t/custom\_audiences/1nmth/users

```
    # すべての値はハッシュ化する必要があります。この例では説明のために平文の値を使用しています
    [
      {
        "operation_type": "Update",
        "params": {
          "effective_at": "2018-05-15T00:00:00Z",
          "expires_at": "2019-01-01T07:00:00Z",
          "users": [
            {
              "email": [
                "abc@x.com"
              ],
              "handle": [
                "x",
                "adsapi"
              ]
            },
            {
              "email": [
                "edf@x.com"
              ],
              "twitter_id": [
                "121291606",
                "17874544"
              ]
            }
          ]
        }
      }
    ]
```

ユーザーをオーディエンスに追加するには、`operation_type` に `Update` を指定します。新しいオーディエンスインターフェースでは、1人のユーザーに対して複数のユーザーキーを渡せます。JSON オブジェクト配列内の各オブジェクトは1人のユーザーに対応します。上記のサンプルペイロードでは、`email` と `handle` を持つユーザーと、`email` と `twitter_id` を持つユーザーの計2名がオーディエンスに追加されます。 

<div id="remove-users-from-an-audience">
  #### オーディエンスからユーザーを削除する
</div>

ユーザーの追加手順と同様に、ユーザーは次のようにしてオーディエンスから削除できます。

POST https://ads-api.x.com/11/accounts/18ce54d4x5t/custom\_audiences/1nmth/users

```
    # すべての値はハッシュ化する必要があります。以下は説明目的の非ハッシュ化例です
    [
      {
        "operation_type": "Delete",
        "params": {
          "effective_at": "2018-05-15T00:00:00Z",
          "expires_at": "2019-01-01T07:00:00Z",
          "users": [
            {
              "email": [
                "abc@x.com"
              ],
              "twitter_id": [
                "783214",
                "1225933934"
              ]
            },
            {
              "email": [
                "edf@x.com"
              ],
              "twitter_id": [
                "121291606",
                "17874544"
              ]
            }
          ]
        }
      }
    ]
```

`operation_type` は `Delete` に設定する必要があり、ユーザーはオーディエンスに追加した際に使用したいずれかのキーで照合されます。たとえば、あるユーザーを `email` と `twitter_id` を用いてオーディエンスに追加した場合、その同じユーザーはこれらのキーのいずれか一方、すなわち `email` または `twitter_id`、あるいは両方を用いて削除できます。

さらに、同一リクエスト内でオーディエンスへのユーザーの追加と削除を行うことも可能です。このエンドポイントは、1 つのリクエストで複数の `operation_type` をサポートします。

<div id="opt-out-users">
  #### オプトアウトしたユーザー
</div>

グローバルオプトアウトエンドポイントの廃止に伴い、パートナーは、いずれかのオーディエンスからオプトアウトしたユーザーを `Delete` する必要があります。これを実現する方法はいくつかあります:

1. どのユーザーがどのオーディエンスに属しているかを管理し、各オーディエンスから該当ユーザーを個別に削除する。
2. 広告アカウントに関連付けられているオーディエンスから、そのユーザーを**すべて**削除する。

**一般的なベストプラクティス**

- キューの急増による処理遅延やシステムへの不要な負荷を避けるため、このエンドポイントはほぼリアルタイムのバッチで呼び出すことを強く推奨します。これにより、ユーザーをキャンペーンのターゲティングに早期に利用できるようにもなります。
- 成功した API 呼び出しは、リクエストで受領した `user` オブジェクト数に対応する `success_count` と `total_count` を返します。
- このエンドポイントは本質的にアトミックであり、リクエスト全体が成功するか、いずれかでエラーが発生した場合はリクエスト全体が失敗します。エラー応答が返された場合は、API 利用者はエラーを修正し、ペイロード全体を含めてリクエストを再試行することを推奨します。
- 失敗時には、再試行に[指数バックオフ](https://en.wikipedia.org/wiki/Exponential_backoff)手法を用いることを推奨します。例えば、最初の失敗時は即時に再試行し、2 回目の失敗後は 1 分後、3 回連続で失敗した後は 5 分後に再試行する、といった具合です。

<div id="api-reference">
  ## API リファレンス
</div>

<div id="keyword-insights">
  ### キーワードインサイト
</div>

<Button href="https://app.getpostman.com/run-collection/1d12b9fc623b8e149f87">
  Postman で実行
</Button>

<div id="get-insightskeywordssearch">
  #### GET insights/keywords/search[](#get-insights-keywords-search "この見出しへのパーマリンク")
</div>

キーワードのグループを指定すると、関連するツイート数と、関連キーワード30件のセットを取得します。ツイート数は入力したキーワードのみに対応し、関連キーワードは含みません。

許可される時間範囲（`end_time` - `start_time`）の最大値は7日です。

結果は単一の地域（国）でスコープされる点にご留意ください。

**Resource URL[](#resource-url "この見出しへのパーマリンク")**

`https://ads-api.x.com/12/insights/keywords/search`

**Parameters[](#parameters "この見出しへのパーマリンク")**

| Name | Description |
| :--- | :--- |
| granularity  <br />_required_ | `start_time` と `end_time` で示される時間範囲に対して返されるデータの粒度を指定します。たとえば、`HOUR` に設定すると、`start_time` と `end_time` の間の各時刻についてデータポイントが返されます。<br /><br />Type: enum<br /><br />Possible values: `DAY`, `HOUR` |
| keywords  <br />_required_ | 絞り込みに使用するカンマ区切りのキーワード文字列。すべてのキーワードは相互に OR 条件で評価されます。<br /><br />**Note**: 最大10個のキーワード（`keywords` と `negative_keywords` の合計）を使用できます。<br /><br />Type: string<br /><br />Example: `developers` |
| start\_time  <br />_required_ | 取得データを、`start_time` と `end_time` の間の時間窓で収集されたデータにスコープします。[ISO 8601](https://en.wikipedia.org/wiki/ISO_8601) 形式で指定します。<br /><br />Type: string<br /><br />Example: `2017-07-10T00:00:00Z` |
| end\_time  <br />_optional_ | 取得データを、`start_time` と `end_time` の間の時間窓で収集されたデータにスコープします。[ISO 8601](https://en.wikipedia.org/wiki/ISO_8601) 形式で指定します。<br /><br />**Note**: 省略時は現在時刻が既定値です。<br /><br />Type: string<br /><br />Example: `2017-07-11T00:00:00Z` |
| location  <br />_optional_ | アカウントのユーザーの所在国で結果を絞り込むための、[GET targeting\_criteria/locations](/ja/x-ads-api/campaign-management#get-targeting-criteria-locations) エンドポイントから取得できるターゲティング値。現時点では国レベルのロケーションのみがサポートされています。<br /><br />Type: string<br /><br />Example: `0ce8b9a7b2742f7e` |
| negative\_keywords  <br />_optional_ | 除外に使用するカンマ区切りのキーワード文字列。すべての除外キーワードは相互に OR 条件で評価されます。<br /><br />**Note**: 最大10個のキーワード（`keywords` と `negative_keywords` の合計）を使用できます。<br /><br />Type: string<br /><br />Example: `rain` |

**Example Request[](#example-request "この見出しへのパーマリンク")**

```json
GET https://ads-api.x.com/12/insights/keywords/search?end_time=2018-02-02&granularity=DAY&keywords=developers&start_time=2018-02-01
```

**Example Response[](#example-response "この見出しへのパーマリンク")**\*

```
    {
      "request": {
        "params": {
          "start_time": "2018-02-01T00:00:00Z",
          "end_time": "2018-02-02T00:00:00Z",
          "granularity": "DAY",
          "keywords": [
            "developers"
          ]
        }
      },
      "data": {
        "related_keywords": [
          "dev",
          "developer",
          "coders",
          "mysql",
          "devs",
          "#technology",
          "#developers",
          "security",
          "programmers",
          "#tech",
          "javascript",
          "#iot",
          "#bigdata",
          "cloud",
          "devops",
          "php",
          "developer",
          "programmer",
          "engineer",
          "big data",
          "agile",
          "app",
          "programming",
          "ios",
          "maker",
          "startups",
          "developer's",
          "java",
          "#devops",
          "startup"
        ],
        "tweet_volume": [
          15707
        ]
      }
    }
```

<div id="tailored-audience-permissions">
  ### テーラードオーディエンスの権限
</div>

<Button href="https://app.getpostman.com/run-collection/369a02c0adc626ff6a06#?env%5BTwitter%20Ads%20API%5D=W3sia2V5IjoiYWNjb3VudF9pZCIsInZhbHVlIjoieW91cl9hZHNfYWNjb3VudF9pZCIsImVuYWJsZWQiOnRydWV9LHsia2V5IjoidmVyc2lvbiIsInZhbHVlIjoiNSIsImVuYWJsZWQiOnRydWV9LHsia2V5IjoiY29uc3VtZXJfa2V5IiwidmFsdWUiOiJ5b3VyX2NvbnN1bWVyX2tleSIsImVuYWJsZWQiOnRydWV9LHsia2V5IjoiY29uc3VtZXJfc2VjcmV0IiwidmFsdWUiOiJ5b3VyX2NvbnN1bWVyX3NlY3JldCIsImVuYWJsZWQiOnRydWV9LHsia2V5IjoiYWNjZXNzX3Rva2VuIiwidmFsdWUiOiJ5b3VyX2FjY2Vzc190b2tlbiIsImVuYWJsZWQiOnRydWV9LHsia2V5IjoidG9rZW5fc2VjcmV0IiwidmFsdWUiOiJ5b3VyX3Rva2VuX3NlY3JldCIsImVuYWJsZWQiOnRydWV9XQ==">
  Postman で実行
</Button>

#### GET accounts/:account\_id/tailored\_audiences/:tailored\_audience\_id/permissions[](#get-accounts-account-id-tailored-audiences-tailored-audience-id-permissions "Permalink to this headline")

指定したカスタムオーディエンスに関連付けられた権限の一部または全部の詳細を取得します。

**Resource URL[](#resource-url "Permalink to this headline")**

`https://ads-api.x.com/5/accounts/:account_id/tailored_audiences/:tailored_audience_id/permissions`

**Parameters[](#parameters "Permalink to this headline")**

| Name | Description |
| :--- | :--- |
| account\_id  <br />_required_ | 対象アカウントを識別する ID。リソースのパス内に含まれ、[GET accounts](/ja/x-ads-api/campaign-management#accounts) を除くすべての Advertiser API リクエストで一般的に必須です。指定したアカウントは認証済みユーザーに関連付けられている必要があります。<br /><br />Type: string<br /><br />Example: `18ce54d4x5t` |
| tailored\_audience\_id  <br />_required_ | リクエストで操作対象のカスタムオーディエンスを参照します。<br /><br />Type: string<br /><br />Example: `1nmth` |
| count  <br />_optional_ | 個々のリクエストで取得を試みるレコード数を指定します。<br /><br />Type: int<br /><br />Default: `200`  <br />Min, Max: `1`, `1000` |
| cursor  <br />_optional_ | 結果の次ページを取得するためのカーソルを指定します。詳細は [Pagination](/ja/x-ads-api/introduction) を参照してください。<br /><br />Type: string<br /><br />Example: `8x7v00oow` |
| granted\_account\_ids  <br />_optional_ | 識別子のカンマ区切りリストを指定して、レスポンスを該当アカウントのみに絞り込みます。最大 200 個の ID を指定できます。<br /><br />Type: string<br /><br />Example: `18ce54aymz3` |
| sort\_by  <br />_optional_ | サポートされる属性で昇順または降順にソートします。詳細は [Sorting](/ja/x-ads-api/introduction) を参照してください。<br /><br />Type: string<br /><br />Example: `created_at-asc` |
| tailored\_audience\_permission\_ids  <br />_optional_ | 識別子のカンマ区切りリストを指定して、レスポンスを該当のカスタムオーディエンス権限のみに絞り込みます。最大 200 個の ID を指定できます。<br /><br />Type: string<br /><br />Example: `ri` |
| with\_total\_count  <br />_optional_ | レスポンスに `total_count` 属性を含めます。<br /><br />**Note**: このパラメータと `cursor` は排他です。<br /><br />**Note**: `total_count` を含むリクエストはレート制限が低く、現在は 15 分あたり 200 に設定されています。<br /><br />Type: boolean<br /><br />Default: `false`  <br />Possible values: `true`, `false` |

**Example Request[](#example-request "Permalink to this headline")**

`GET https://ads-api.x.com/5/accounts/18ce54d4x5t/tailored_audiences/1nmth/permissions`

**Example Response[](#example-response "Permalink to this headline")**

```
    {
      "request": {
        "params": {
          "account_id": "18ce54d4x5t",
          "tailored_audience_id": "1nmth"
        }
      },
      "next_cursor": null,
      "data": [
        {
          "tailored_audience_id": "1nmth",
          "permission_level": "READ_ONLY",
          "id": "ri",
          "created_at": "2017-06-08T23:17:59Z",
          "granted_account_id": "18ce54aymz3",
          "updated_at": "2017-06-08T23:17:59Z",
          "deleted": false
        }
      ]
    }

```

#### POST accounts/:account\_id/tailored\_audiences/:tailored\_audience\_id/permissions[](#post-accounts-account-id-tailored-audiences-tailored-audience-id-permissions "Permalink to this headline")

指定したオーディエンスを特定のアカウントと共有できるようにする新規の権限オブジェクトを作成します。

**Note**: テーラードオーディエンスの権限を作成または変更するには、そのオーディエンスが権限を変更しようとしているアカウントの所有である必要があります。特定のオーディエンスに対するレスポンスの `is_owner` 属性を確認することで、テーラードオーディエンスの所有者かどうかを確認できます。

**Note**: オーディエンスは、同一ビジネス配下の広告アカウント間でのみ共有できます。もしくは、そのオーディエンスを所有する広告アカウントに `SHARE_AUDIENCE_OUTSIDE_BUSINESS` アカウント機能が付与されている場合に限り、ビジネス外のアカウントとも共有できます。

**Resource URL[](#resource-url "Permalink to this headline")**

`https://ads-api.x.com/5/accounts/:account_id/tailored_audiences/:tailored_audience_id/permissions`

**Parameters[](#parameters "Permalink to this headline")**

| Name | Description |
| :--- | :--- |
| account\_id  <br />_required_ | 対象アカウントの識別子。リソースのパス内に含まれ、[GET accounts](/ja/x-ads-api/campaign-management#accounts) を除くすべての Advertiser API リクエストで原則必須のパラメータです。指定したアカウントは認証済みユーザーに関連付けられている必要があります。<br /><br />Type: string<br /><br />Example: `18ce54d4x5t` |
| granted\_account\_id  <br />_required_ | テーラードオーディエンスに対する権限を付与する相手のアカウント。<br /><br />Type: string<br /><br />Example: `18ce54aymz3` |
| permission\_level  <br />_required_ | `granted_account_id` に付与するテーラードオーディエンスへのアクセス種別。<br /><br />Type: enum<br /><br />Possible values: `READ_ONLY`, `READ_WRITE` |
| tailored\_audience\_id  <br />_required_ | 本リクエストで操作対象となるテーラードオーディエンスの参照。<br /><br />Type: string<br /><br />Example: `2906h` |

**Example Request[](#example-request "Permalink to this headline")**

`POST https://ads-api.x.com/5/accounts/18ce54d4x5t/tailored_audiences/2906h/permissions?granted_account_id=18ce54aymz3&permission_level=READ_ONLY`

**Example Response[](#example-response "Permalink to this headline")**

```
    {
      "request": {
        "params": {
          "account_id": "18ce54d4x5t",
          "granted_account_id": "18ce54aymz3",
          "permission_level": "READ_ONLY",
          "tailored_audience_id": "2906h"
        }
      },
      "data": {
        "tailored_audience_id": "2906h",
        "permission_level": "READ_ONLY",
        "id": "14m",
        "created_at": "2017-09-12T23:49:34Z",
        "granted_account_id": "18ce54aymz3",
        "updated_at": "2017-09-12T23:49:34Z",
        "deleted": false
      }
    }
```

#### DELETE accounts/:account\_id/tailored\_audiences/:tailored\_audience\_id/permissions/:tailored\_audience\_permission\_id[](#delete-accounts-account-id-tailored-audiences-tailored-audience-id-permissions-tailored-audience-permission-id "Permalink to this headline")

指定した Tailored Audience の共有権限を取り消します。

**注**: Tailored Audience の権限を作成または変更するには、そのオーディエンスが権限を変更しようとしているアカウントの所有物である必要があります。特定のオーディエンスのレスポンスに含まれる `is_owner` 属性を確認することで、Tailored Audience の所有者を確認できます。

権限が取り消されると、付与先アカウント（`granted_account_id`）が今後のキャンペーンでそのオーディエンスをターゲティングできないことを保証します。既存のキャンペーンは共有オーディエンスのまま継続して配信されます。キャンペーンは停止されず、オーディエンスもキャンペーンから削除されません。オーディエンス共有権限の取り消し後は、そのキャンペーンをコピーすることはできません。

**Resource URL[](#resource-url "Permalink to this headline")**

`https://ads-api.x.com/5/accounts/:account_id/tailored_audiences/:tailored_audience_id/permissions/:tailored_audience_permission_id`

**Parameters[](#parameters "Permalink to this headline")**

| Name | Description |
| :--- | :--- |
| account\_id  <br />_required_ | 利用するアカウントの識別子。リソースのパス内に現れ、[GET accounts](/ja/x-ads-api/campaign-management#accounts) を除くすべての Advertiser API リクエストで一般的に必須のパラメータです。指定されたアカウントは認証済みユーザーに関連付けられている必要があります。<br /><br />Type: string<br /><br />Example: `18ce54d4x5t` |
| tailored\_audience\_id  <br />_required_ | リクエストで操作対象となる Tailored Audience への参照。<br /><br />Type: string<br /><br />Example: `1nmth` |
| tailored\_audience\_permission\_id  <br />_required_ | リクエストで操作対象となる Tailored Audience の権限への参照。<br /><br />Type: string<br /><br />Example: `ri` |

**Example Request[](#example-request "Permalink to this headline")**

`DELETE https://ads-api.x.com/5/accounts/18ce54d4x5t/tailored_audiences/1nmth/permissions/ri`

**Example Response[](#example-response "Permalink to this headline")**

```
    {
      "request": {
        "params": {
          "account_id": "18ce54d4x5t",
          "tailored_audience_permission_id": "ri",
          "tailored_audience_id": "1nmth"
        }
      },
      "data": {
        "tailored_audience_id": "1nmth",
        "permission_level": "READ_ONLY",
        "id": "ri",
        "created_at": "2017-06-08T23:17:59Z",
        "granted_account_id": "18ce54aymz3",
        "updated_at": "2017-08-30T18:29:35Z",
        "deleted": true
      }
    }
```

<div id="targeted-audiences">
  ### ターゲットオーディエンス
</div>

<Button href="https://app.getpostman.com/run-collection/1d12b9fc623b8e149f87">
  Postman で実行
</Button>

#### GET accounts/:account\_id/custom\_audiences/:custom\_audience\_id/targeted[](#get-accounts-account-id-custom-audiences-custom-audience-id-targeted "この見出しへのパーマリンク")

指定した `custom_audience_id` をターゲットにしている、アクティブまたはすべてのラインアイテムおよびキャンペーンの一覧を取得します

| Name | Description |
| :--- | :--- |
| account\_id  <br />_required_ | 利用するアカウントの識別子。リソースのパス内に含まれ、[GET accounts](/ja/x-ads-api/campaign-management#accounts) を除くすべての Advertiser API リクエストで一般的に必須のパラメータです。指定したアカウントは認証済みユーザーに関連付けられている必要があります。<br /><br />Type: string<br /><br />Example: `18ce54d4x5t` |
| custom\_audience\_id  <br />_required_ | リクエストで操作対象となるカスタムオーディエンスの参照。<br /><br />Type: string<br /><br />Example: `2906h` |
| with\_active  <br />_optional_ | `false` の場合、`servable=false` のラインアイテムも含めます<br /><br />Type: boolean<br /><br />Default: `true`  <br />Possible values: `true`, `false` |
| cursor  <br />_optional_ | 次の結果ページを取得するためのカーソルを指定します。詳細は [Pagination](/ja/x-ads-api/introduction) を参照してください。  <br />  <br />Type: string  <br />  <br />Example: `8x7v00oow` |

**Example Request[](#example-request "この見出しへのパーマリンク")**

`GET https://ads-api.x.com/12/accounts/18ce54d4x5t/custom_audiences/2906h/targeted`

**Example Response[](#example-response "この見出しへのパーマリンク")**

```
    {
      "request": {
        "params": {
          "account_id": "18ce54d4x5t",
          "custom_audience_id": "2906h",
        }
      },
      "next_cursor": null,
      "data": [
        {
          "campaign_id": "59hod",
          "campaign_name": "test-campaign",
          "line_items": [
            {
              "id": "5gzog",
              "name": "test-line-item",
              "servable": true
            }
          ]
        },
        {
          "campaign_id": "arja7",
          "campaign_name": "Untitled campaign",
          "line_items": [
            {
              "id": "bjw1q",
              "name": null,
              "servable": true
            }
          ]
        }
      ]
    }
```

<div id="custom-audiences-users">
  ### カスタムオーディエンスのユーザー
</div>

<Button href="https://app.getpostman.com/run-collection/1d12b9fc623b8e149f87">
  Postman で実行
</Button>

#### POST accounts/:account\_id/custom\_audiences/:custom\_audience\_id/users[](#post-accounts-account-id-custom-audiences-custom-audience-id-users "Permalink to this headline")

このエンドポイントにより、パートナーは指定の `custom_audience_id` に属するユーザーの追加、更新、削除を行えます。ユーザーごとに複数種類のユーザー識別子も受け付けます。

リクエストの `users` フィールドで提供されるデータは、`partner_user_id` を**除き**、`SHA256` でハッシュ化し、[正規化](/ja/x-ads-api/audiences#twitter-user-id-normalization)する必要があります。

**バッチリクエスト**

- 現在の最大バッチサイズは**このエンドポイントに限り** `2500` です。バッチサイズは、リクエストあたりの操作数（`Update`/`Delete`）で決まります。たとえば、1 つの配列に 2500 を超える操作オブジェクト（`{"operation_type": "Update/Delete", [..] }`）が含まれているとエラーになります。
- このエンドポイントが受け付ける POST リクエストボディの最大サイズは `5,000,000` バイトです。
- このエンドポイントのレート制限は、1 分あたり 1500 回です。
- すべてのパラメータはリクエストボディで送信し、`Content-Type` は `application/json` が必須です。
- バッチリクエストはグループとして一括で成功または失敗し、エラー時・成功時いずれの場合も API レスポンスは初期リクエストのアイテム順を保持します。

**バッチレスポンス**

Ads API が返すレスポンスには、`success_count` と `total_count` の 2 つのフィールドが含まれます。これらの値は常に等しくなければならず、バックエンドで処理されたリクエスト内のレコード数を表します。リクエストボディで送信したレコード数が `success_count` および `total_count` と等しく**ない**場合はエラーとして扱い、再試行が必要です。

**バッチエラー**

- リクエストレベルのエラー（例: 最大バッチサイズ超過）は、レスポンスの `errors` オブジェクトに表示されます。
- アイテムレベルのエラー（例: 必須パラメータの欠落）は、レスポンスの `operation_errors` オブジェクトに表示されます。
- `operation_errors` 内のエラーのインデックスは入力アイテム内のインデックスを指し、対応するエラーメッセージが示されます。

<div id="resource-url">
  #### リソース URL[](#resource-url "Permalink to this headline")
</div>

`https://ads-api.x.com/12/accounts/:account_id/custom_audiences/:custom_audience_id/users`

<div id="parameters">
  #### パラメータ[](#parameters "Permalink to this headline")
</div>

| Name | Description |
| :--- | :--- |
| operation\_type  <br />_required_ | `users` グループごとに実行される操作タイプ。<br /><br />Type: enum<br /><br />Possible values: `Update`, `Delete` |
| params  <br />_required_ | `users` 配列、`effective_at`、`expires_at` の各タイムスタンプを含む JSON オブジェクト。<br /><br />Type: JSON |
| users  <br />_required_ | 個々のユーザーのすべてのパラメータを含む JSON オブジェクトの配列。<br /><br />Type: JSON |
| effective\_at  <br />_optional_ | カスタムオーディエンスの関連付けが有効になる UTC 時刻。[ISO 8601](https://en.wikipedia.org/wiki/ISO_8601) で表現。デフォルトは現在日時。<br /><br />Type: string<br /><br />Example: `2017-07-05T07:00:00Z` |
| expires\_at  <br />_optional_ | カスタムオーディエンスの関連付けが失効する UTC 時刻。指定時刻は `effective_at` の値より後である必要があります。[ISO 8601](https://en.wikipedia.org/wiki/ISO_8601) で表現。デフォルトはリクエストのタイムスタンプから 13 か月後。<br /><br />Type: string<br /><br />Example: `2017-07-05T07:00:00Z` |

`users` オブジェクトのマルチキー方式に基づき、このオブジェクトの各要素は以下のとおりです:

| Name | Description |
| :--- | :--- |
| email  <br />_optional_ | ユーザーのメールアドレス。<br /><br />Type: Array\[String] |
| device\_id  <br />_optional_ | IDFA／AdID／Android ID。<br /><br />Type: Array\[String] |
| handle  <br />_optional_ | ユーザーの @handle。<br /><br />Type: Array\[String] |
| twitter\_id  <br />_optional_ | ユーザーの X ID。<br /><br />Type: Array\[String] |
| phone\_number  <br />_optional_ | ユーザーの電話番号。<br /><br />Type: Array\[String] |
| partner\_user\_id  <br />_optional_ | パートナーのシステムにおけるユーザーの ID。<br /><br />Type: Array\[String] |

<div id="example-request">
  #### リクエスト例[](#example-request "Permalink to this headline")
</div>

`POST https://ads-api.x.com/12/accounts/18ce54d4x5t/custom_audiences/1nmth/users`

```
    [
      {
        "operation_type": "Update",
        "params": {
          "effective_at": "2018-05-15T00:00:00Z",
          "expires_at": "2019-01-01T07:00:00Z",
          "users": [
            {
              "email": [
                "4798b8bbdcf6f2a52e527f46a3d7a7c9aefb541afda03af79c74809ecc6376f3"
              ],
              "handle": [
                "7352f353c460e74c7ae226952d04f8aa307b12329c5512ec8cb6f1a0f8f9b2cb",
                "49e0be2aeccfb51a8dee4c945c8a70a9ac500cf6f5cb08112575f74db9b1470d"
              ]
            },
            {
              "email": [
                "5bf13d5ad4200407c5bc8b9bb578e425d05ef936fd488e3799a9d0806669223c"
              ],
              "twitter_id": [
                "34d56c7159a7eea941f359653029410f813f65a1d2d13ecc5ccbdd5a8cb755cf",
                "00e7b76c9739dec57f4c4a20ec021a20ffcf26bd00f519b17ea00f0ed6048f85"
              ]
            }
          ]
        }
      },
      {
        "operation_type": "Delete",
        "params": {
          "effective_at": "2018-05-15T00:00:00Z",
          "expires_at": "2019-01-01T07:00:00Z",
          "users": [
            {
              "device_id": [
                "8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92"
              ],
              "email": [
                "4798b8bbdcf6f2a52e527f46a3d7a7c9aefb541afda03af79c74809ecc6376f3"
              ],
              "handle": [
                "461222f5dd690a20651c3d19848015cb0369db3f8e937571ffb775de70750847"
              ],
              "twitter_id": [
                "c623c7e163984493b46c547088542e95d0aaa529bc52bbecce3ff91eb6b7843b"
              ]
            },
            {
              "email": [
                "5bf13d5ad4200407c5bc8b9bb578e425d05ef936fd488e3799a9d0806669223c"
              ],
              "twitter_id": [
                "858cdc7f313f84a3f3c48e9a6323307c1ef1bb7439b8e3623e140454b0fd8fa5",
                "bb074e154657b91d99bd1bb3757409149670e8ae7a0fe9136fae29a26a7881c8"
              ]
            }
          ]
        }
      }
    ]
```

<div id="example-response">
  #### レスポンス例[](#example-response "Permalink to this headline")
</div>

```
    {
      "request": {
        "params": {
          "account_id": "18ce54d4x5t",
          "custom_audience_id": "1nmth"
        }
      },
      "data": {
        "success_count": 4,
        "total_count": 4
      }
    }
```

<div id="custom-audience-permissions">
  ### カスタムオーディエンスの権限
</div>

<Button href="https://app.getpostman.com/run-collection/369a02c0adc626ff6a06#?env%5BTwitter%20Ads%20API%5D=W3sia2V5IjoiYWNjb3VudF9pZCIsInZhbHVlIjoieW91cl9hZHNfYWNjb3VudF9pZCIsImVuYWJsZWQiOnRydWV9LHsia2V5IjoidmVyc2lvbiIsInZhbHVlIjoiNSIsImVuYWJsZWQiOnRydWV9LHsia2V5IjoiY29uc3VtZXJfa2V5IiwidmFsdWUiOiJ5b3VyX2NvbnN1bWVyX2tleSIsImVuYWJsZWQiOnRydWV9LHsia2V5IjoiY29uc3VtZXJfc2VjcmV0IiwidmFsdWUiOiJ5b3VyX2NvbnN1bWVyX3NlY3JldCIsImVuYWJsZWQiOnRydWV9LHsia2V5IjoiYWNjZXNzX3Rva2VuIiwidmFsdWUiOiJ5b3VyX2FjY2Vzc190b2tlbiIsImVuYWJsZWQiOnRydWV9LHsia2V5IjoidG9rZW5fc2VjcmV0IiwidmFsdWUiOiJ5b3VyX3Rva2VuX3NlY3JldCIsImVuYWJsZWQiOnRydWV9XQ==">
  Postman で実行
</Button>

#### GET accounts/:account\_id/custom\_audiences/:custom\_audience\_id/permissions[](#get-accounts-account-id-custom-audiences-custom-audience-id-permissions "Permalink to this headline")

指定したカスタムオーディエンスに関連付けられた権限の一部またはすべての詳細を取得します。

**Resource URL[](#resource-url "Permalink to this headline")**

`https://ads-api.x.com/12/accounts/:account_id/custom_audiences/:custom_audience_id/permissions`

**Parameters[](#parameters "Permalink to this headline")**

| Name | Description |
| :--- | :--- |
| account\_id  <br />_required_ | 対象アカウントの識別子。リソースのパス内に含まれ、[GET accounts](/ja/x-ads-api/campaign-management#accounts) を除くすべての Advertiser API リクエストで一般的に必須のパラメータです。指定したアカウントは認証済みユーザーに関連付けられている必要があります。<br /><br />Type: string<br /><br />Example: `18ce54d4x5t` |
| custom\_audience\_id  <br />_required_ | リクエストで操作対象のカスタムオーディエンスを参照します。<br /><br />Type: string<br /><br />Example: `1nmth` |
| count  <br />_optional_ | リクエストごとに取得を試みるレコード数を指定します。<br /><br />Type: int<br /><br />Default: `200`  <br />Min, Max: `1`, `1000` |
| cursor  <br />_optional_ | 次ページの結果を取得するためのカーソルを指定します。詳細は [Pagination](/ja/x-ads-api/introduction) を参照してください。<br /><br />Type: string<br /><br />Example: `8x7v00oow` |
| granted\_account\_ids  <br />_optional_ | 対象のアカウントのみにレスポンスを絞り込むため、カンマ区切りの識別子リストを指定します。最大 200 個の ID を指定できます。<br /><br />Type: string<br /><br />Example: `18ce54aymz3` |
| sort\_by  <br />_optional_ | サポートされる属性で昇順または降順にソートします。詳細は [Sorting](/ja/x-ads-api/fundamentals/sorting) を参照してください。<br /><br />Type: string<br /><br />Example: `created_at-asc` |
| custom\_audience\_permission\_ids  <br />_optional_ | 対象のカスタムオーディエンス権限のみにレスポンスを絞り込むため、カンマ区切りの識別子リストを指定します。最大 200 個の ID を指定できます。<br /><br />Type: string<br /><br />Example: `ri` |
| with\_total\_count  <br />_optional_ | レスポンスに `total_count` 属性を含めます。<br /><br />**Note**: このパラメータと `cursor` は同時指定できません。<br /><br />**Note**: `total_count` を含むリクエストにはより低いレート制限が適用され、現在は 15 分あたり 200 回に設定されています。<br /><br />Type: boolean<br /><br />Default: `false`  <br />Possible values: `true`, `false` |

**Example Request[](#example-request "Permalink to this headline")**

`GET https://ads-api.x.com/12/accounts/18ce54d4x5t/custom_audiences/1nmth/permissions`

**Example Response[](#example-response "Permalink to this headline")**

```
    {
      "request": {
        "params": {
          "account_id": "18ce54d4x5t",
          "custom_audience_id": "1nmth"
        }
      },
      "next_cursor": null,
      "data": [
        {
          "custom_audience_id": "1nmth",
          "permission_level": "READ_ONLY",
          "id": "ri",
          "created_at": "2017-06-08T23:17:59Z",
          "granted_account_id": "18ce54aymz3",
          "updated_at": "2017-06-08T23:17:59Z",
          "deleted": false
        }
      ]
    }
```

#### POST accounts/:account\_id/custom\_audiences/:custom\_audience\_id/permissions[](#post-accounts-account-id-custom-audiences-custom-audience-id-permissions "この見出しへのパーマリンク")

指定したオーディエンスを特定のアカウントと共有できるようにする新しい権限オブジェクトを作成します。

**Note**: カスタムオーディエンスの権限を作成または変更するには、そのオーディエンスが、権限を変更しようとしているアカウントに所有されている必要があります。特定のオーディエンスのレスポンスに含まれる `is_owner` 属性を確認することで、カスタムオーディエンスの所有者かどうかをチェックできます。

**Note**: オーディエンスは、同一ビジネス配下の広告アカウント間でのみ共有できます。あるいは、オーディエンスを所有する広告アカウントに `SHARE_AUDIENCE_OUTSIDE_BUSINESS` アカウント機能が付与されている場合は、ビジネス外のアカウントとも共有できます。

**Resource URL[](#resource-url "この見出しへのパーマリンク")**

`https://ads-api.x.com/12/accounts/:account_id/custom_audiences/:custom_audience_id/permissions`

**Parameters[](#parameters "この見出しへのパーマリンク")**

| Name | Description |
| :--- | :--- |
| account\_id  <br />_required_ | 利用するアカウントの識別子。リソースのパス内に現れ、[GET accounts](/ja/x-ads-api/campaign-management#accounts) を除くすべての Advertiser API リクエストで一般に必須のパラメータです。指定したアカウントは認証済みユーザーに関連付けられている必要があります。<br /><br />Type: string<br /><br />Example: `18ce54d4x5t` |
| granted\_account\_id  <br />_required_ | カスタムオーディエンスの権限を付与する相手のアカウント。<br /><br />Type: string<br /><br />Example: `18ce54aymz3` |
| permission\_level  <br />_required_ | `granted_account_id` がカスタムオーディエンスに対して持つアクセスの種類。<br /><br />Type: enum<br /><br />Possible values: `READ_ONLY`, `READ_WRITE` |
| custom\_audience\_id  <br />_required_ | リクエストで操作対象としているカスタムオーディエンスの参照。<br /><br />Type: string<br /><br />Example: `2906h` |

**Example Request[](#example-request "この見出しへのパーマリンク")**

```
POST https://ads-api.x.com/12/accounts/18ce54d4x5t/custom_audiences/2906h/permissions?granted_account_id=18ce54aymz3&permission_level=READ_ONLY
```

**Example Response[](#example-response "この見出しへのパーマリンク")**

```
    {
      "request": {
        "params": {
          "account_id": "18ce54d4x5t",
          "granted_account_id": "18ce54aymz3",
          "permission_level": "READ_ONLY",
          "custom_audience_id": "2906h"
        }
      },
      "data": {
        "custom_audience_id": "2906h",
        "permission_level": "READ_ONLY",
        "id": "14m",
        "created_at": "2017-09-12T23:49:34Z",
        "granted_account_id": "18ce54aymz3",
        "updated_at": "2017-09-12T23:49:34Z",
        "deleted": false
      }
    }
```

#### DELETE accounts/:account\_id/custom\_audiences/:custom\_audience\_id/permissions/:custom\_audience\_permission\_id[](#delete-accounts-account-id-custom-audiences-custom-audience-id-permissions-custom-audience-permission-id "Permalink to this headline")

指定したカスタムオーディエンスの共有権限を取り消します。

**注記**: カスタムオーディエンスの権限を作成または変更するには、対象のオーディエンスが、その権限を変更しようとしているアカウントの所有である必要があります。特定のオーディエンスのレスポンスに含まれる `is_owner` 属性を確認することで、カスタムオーディエンスの所有者を判別できます。

取り消し後は、付与先アカウント（`granted_account_id`）が今後のキャンペーンで当該オーディエンスをターゲティングできないことを保証します。既存のキャンペーンは共有オーディエンスを保持したまま継続実行されます。キャンペーンは停止せず、オーディエンスもキャンペーンから削除されません。オーディエンスの共有権限が取り消された後は、そのキャンペーンをコピーできません。

**Resource URL[](#resource-url "Permalink to this headline")**

`https://ads-api.x.com/12/accounts/:account_id/custom_audiences/:custom_audience_id/permissions/:custom_audience_permission_id`

**Parameters[](#parameters "Permalink to this headline")**

| Name | Description |
| :--- | :--- |
| account\_id  <br />_required_ | 対象アカウントの識別子。リソースパス内に含まれ、[GET accounts](/ja/x-ads-api/campaign-management#accounts) を除くすべての Advertiser API リクエストで一般的に必須のパラメータです。指定したアカウントは認証済みユーザーに関連付けられている必要があります。<br /><br />Type: string<br /><br />Example: `18ce54d4x5t` |
| custom\_audience\_id  <br />_required_ | リクエストで操作対象のカスタムオーディエンスを指す参照。<br /><br />Type: string<br /><br />Example: `1nmth` |
| custom\_audience\_permission\_id  <br />_required_ | リクエストで操作対象のカスタムオーディエンス権限を指す参照。<br /><br />Type: string<br /><br />Example: `ri` |

**Example Request[](#example-request "Permalink to this headline")**

`DELETE https://ads-api.x.com/12/accounts/18ce54d4x5t/custom_audiences/1nmth/permissions/ri`

**Example Response[](#example-response "Permalink to this headline")**

```
    {
      "request": {
        "params": {
          "account_id": "18ce54d4x5t",
          "custom_audience_permission_id": "ri",
          "custom_audience_id": "1nmth"
        }
      },
      "data": {
        "custom_audience_id": "1nmth",
        "permission_level": "READ_ONLY",
        "id": "ri",
        "created_at": "2017-06-08T23:17:59Z",
        "granted_account_id": "18ce54aymz3",
        "updated_at": "2017-08-30T18:29:35Z",
        "deleted": true
      }
    }
```

<div id="custom-audiences">
  ### カスタムオーディエンス
</div>

<Button href="https://app.getpostman.com/run-collection/1d12b9fc623b8e149f87">
  Postman で実行する
</Button>

#### GET accounts/:account\_id/custom\_audiences[](#get-accounts-account-id-custom-audiences "Permalink to this headline")

現在のアカウントに関連付けられたカスタムオーディエンスの一部またはすべての詳細を取得します。

**Resource URL[](#resource-url "Permalink to this headline")**

`https://ads-api.x.com/12/accounts/:account_id/custom_audiences`

**Parameters[](#parameters "Permalink to this headline")**

| Name | Description |
| :--- | :--- |
| account\_id  <br />_required_ | 利用するアカウントの識別子。リソースのパスに含まれ、[GET accounts](/ja/x-ads-api/campaign-management#accounts) を除くすべての Advertiser API リクエストで一般的に必須のパラメータです。指定したアカウントは認証済みユーザーに関連付けられている必要があります。<br /><br />Type: string<br /><br />Example: `18ce54d4x5t` |
| count  <br />_optional_ | リクエストごとに取得を試みるレコード数を指定します。<br /><br />Type: int<br /><br />Default: `200`  <br />Min, Max: `1`, `1000` |
| cursor  <br />_optional_ | 次ページの結果を取得するためのカーソルを指定します。詳細は [Pagination](/ja/x-ads-api/introduction) を参照してください。<br /><br />Type: string<br /><br />Example: `8x7v00oow` |
| permission\_scope  <br />_optional_ | 自分が所有するリスト、または自分と共有されているリストのいずれかにレスポンスを絞り込みます。既定では、このパラメータを指定しない場合は自身が所有するオーディエンスのみが表示されます。<br /><br />Type: enum<br /><br />Default: `OWNER`  <br />Possible values: `OWNER`, `SHARED` |
| q  <br />_optional_ | `name` によるリソースの絞り込みに使用する任意のクエリ。<br /><br />**Note**: 大文字小文字を区別しない前方一致でマッチします。<br /><br />Type: string<br /><br />Min, Max length: `1`, `255` |
| sort\_by  <br />_optional_ | サポートされる属性で昇順または降順に並べ替えます。詳細は [Sorting](/ja/x-ads-api/fundamentals/sorting) を参照してください。<br /><br />Type: string<br /><br />Example: `created_at-asc` |
| custom\_audience\_ids  <br />_optional_ | 識別子のカンマ区切りリストを指定して、レスポンスを目的のカスタムオーディエンスのみに絞り込みます。最大 200 個の ID を指定できます。<br /><br />Type: string<br /><br />Example: `1nmth` |
| with\_deleted  <br />_optional_ | 削除済みの結果を含めます。<br /><br />Type: boolean<br /><br />Default: `false`  <br />Possible values: `true`, `false` |
| with\_total\_count  <br />_optional_ | レスポンスに `total_count` 属性を含めます。<br /><br />**Note**: このパラメータと `cursor` は同時指定できません。<br /><br />**Note**: `total_count` を含むリクエストはレート制限が低く、現在は 15 分あたり 200 に設定されています。<br /><br />Type: boolean<br /><br />Default: `false`  <br />Possible values: `true`, `false` |

**Example Request[](#example-request "Permalink to this headline")**

`GET https://ads-api.x.com/12/accounts/18ce54d4x5t/custom_audiences?custom_audience_ids=1nmth`

**Example Response[](#example-response "Permalink to this headline")**

```
    {
      "request": {
        "params": {
          "custom_audience_ids": [
            "1nmth"
          ],
          "account_id": "18ce54d4x5t"
        }
      },
      "next_cursor": null,
      "data": [
        {
          "targetable": true,
          "name": "twurl-using-subshell-for-file",
          "targetable_types": [
            "CRM",
            "EXCLUDED_CRM"
          ],
          "audience_type": "CRM",
          "description": null,
          "permission_level": "READ_WRITE",
          "owner_account_id": "18ce54d4x5t",
          "id": "1nmth",
          "reasons_not_targetable": [],
          "created_at": "2017-01-08T08:19:58Z",
          "updated_at": "2017-01-08T16:21:13Z",
          "partner_source": "OTHER",
          "deleted": false,
          "audience_size": 1470
        }
      ]
    }
```

#### GET accounts/:account\_id/custom\_audiences/:custom\_audience\_id[](#get-accounts-account-id-custom-audiences-custom-audience-id "この見出しへのパーマリンク")

現在のアカウントに関連付けられた特定のカスタムオーディエンスを取得します。

**Resource URL[](#resource-url "この見出しへのパーマリンク")**

`https://ads-api.x.com/12/accounts/:account_id/custom_audiences/:custom_audience_id`

**Parameters[](#parameters "この見出しへのパーマリンク")**

| Name | Description |
| :--- | :--- |
| account\_id  <br />_required_ | 対象アカウントの識別子。リソースのパスに含まれ、[GET accounts](/ja/x-ads-api/campaign-management#accounts) を除くすべての Advertiser API リクエストで一般的に必須です。指定したアカウントは認証済みユーザーに関連付けられている必要があります。<br /><br />Type: string<br /><br />Example: `18ce54d4x5t` |
| custom\_audience\_id  <br />_required_ | リクエストで操作するカスタムオーディエンスの参照。<br /><br />Type: string<br /><br />Example: `2906h` |
| with\_deleted  <br />_optional_ | 削除済みの結果を含めます。<br /><br />Type: boolean<br /><br />Default: `false`  <br />Possible values: `true`, `false` |

**Example Request[](#example-request "この見出しへのパーマリンク")**

`GET https://ads-api.x.com/12/accounts/18ce54d4x5t/custom_audiences/2906h`

**Example Response[](#example-response "この見出しへのパーマリンク")**

```
    {
      "request": {
        "params": {
          "custom_audience_id": "2906h",
          "account_id": "18ce54d4x5t"
        }
      },
      "data": {
        "targetable": false,
        "name": "developers",
        "targetable_types": [
          "CRM",
          "EXCLUDED_CRM"
        ],
        "audience_type": "CRM",
        "description": null,
        "permission_level": "READ_WRITE",
        "owner_account_id": "18ce54d4x5t",
        "id": "2906h",
        "reasons_not_targetable": [],
        "created_at": "2017-08-22T23:34:26Z",
        "updated_at": "2017-08-22T23:34:26Z",
        "partner_source": "OTHER",
        "deleted": false,
        "audience_size": 140321
      }
    }
```

#### POST accounts/:account\_id/custom\_audiences[](#post-accounts-account-id-custom-audiences "Permalink to this headline")

現在のアカウントに関連付けられた新しいプレースホルダーのカスタムオーディエンスを作成します。

**Resource URL[](#resource-url "Permalink to this headline")**

`https://ads-api.x.com/12/accounts/:account_id/custom_audiences`

**Parameters[](#parameters "Permalink to this headline")**

| Name | Description |
| :--- | :--- |
| account\_id  <br />_required_ | 利用するアカウントの識別子。リソースのパスに含まれ、[GET accounts](/ja/x-ads-api/campaign-management#accounts) を除くすべての Advertiser API リクエストで一般的に必須のパラメータです。指定したアカウントは認証済みユーザーに関連付けられている必要があります。<br /><br />Type: string<br /><br />Example: `18ce54d4x5t` |
| name  <br />_required_ | このオーディエンスの表示名。一意の名前を使用する必要があります。満たさない場合はエラーになります。<br /><br />Type: string<br /><br />Example: `ads api users` |
| description  <br />_optional_ | このオーディエンスの説明。<br /><br />Type: string<br /><br />Example: `Collection of all users of the Ads API` |

**Example Request[](#example-request "Permalink to this headline")**

`POST https://ads-api.x.com/12/accounts/18ce54d4x5t/custom_audiences?name=developers`

**Example Response[](#example-response "Permalink to this headline")**

```
    {
      "data": {
        "targetable": false,
        "name": "developers",
        "targetable_types": [
          "CRM",
          "EXCLUDED_CRM"
        ],
        "audience_type": "CRM",
        "description": null,
        "permission_level": "READ_WRITE",
        "owner_account_id": "18ce54d4x5t",
        "id": "2906h",
        "reasons_not_targetable": [
          "PROCESSING",
          "TOO_SMALL"
        ],
        "created_at": "2017-08-22T23:34:26Z",
        "updated_at": "2017-08-22T23:34:26Z",
        "partner_source": "OTHER",
        "deleted": false,
        "audience_size": null
      },
      "request": {
        "params": {
          "account_id": "18ce54d4x5t",
          "name": "developers"
        }
      }
    }
```

#### PUT accounts/:account\_id/custom\_audiences/:custom\_audience\_id[](#put-accounts-account-id-custom-audiences-custom-audience-id "Permalink to this headline")

現在のアカウントに関連付けられた特定のカスタムオーディエンスを更新します。

**Resource URL[](#resource-url "Permalink to this headline")**

`https://ads-api.x.com/12/accounts/:account_id/custom_audiences/:custom_audience_id`

**Parameters[](#parameters "Permalink to this headline")**

| Name | Description |
| :--- | :--- |
| account\_id  <br />_required_ | 対象アカウントの識別子。リソースのパスに含まれ、[GET accounts](/ja/x-ads-api/campaign-management#accounts) を除くすべての Advertiser API リクエストで一般的に必須です。指定したアカウントは認証済みユーザーに関連付けられている必要があります。<br /><br />Type: string<br /><br />Example: `18ce54d4x5t` |
| custom\_audience\_id  <br />_required_ | リクエストで操作対象となるカスタムオーディエンスの参照。<br /><br />Type: string<br /><br />Example: `2906h` |
| name  <br />_optional_ | このオーディエンスの表示名。一意の名前を使用する必要があります。満たさない場合はエラーとなります。<br /><br />Type: string<br /><br />Example: `ads api users` |
| description  <br />_optional_ | このオーディエンスの説明。<br /><br />Type: string<br /><br />Example: `Collection of all users of the Ads API` |

**Example Request[](#example-request "Permalink to this headline")**

`PUT https://ads-api.x.com/12/accounts/18ce54d4x5t/custom_audiences/2906h?name=developers_changed`

**Example Response[](#example-response "Permalink to this headline")**

```
    {
      "data": {
        "targetable": false,
        "name": "developers_changed",
        "targetable_types": [
          "CRM",
          "EXCLUDED_CRM"
        ],
        "audience_type": "CRM",
        "description": null,
        "permission_level": "READ_WRITE",
        "is_owner": true,
        "id": "2906h",
        "reasons_not_targetable": [
          "PROCESSING",
          "TOO_SMALL"
        ],
        "created_at": "2017-08-22T23:34:26Z",
        "updated_at": "2017-08-22T23:34:26Z",
        "partner_source": "OTHER",
        "deleted": false,
        "audience_size": null
      },
      "request": {
        "params": {
          "account_id": "18ce54d4x5t",
          "name": "developers_changed"
        }
      }
    }
```

#### POST batch/accounts/:account\_id/custom\_audiences[](#post-batch-accounts-account-id-custom-audiences "この見出しへのパーマリンク")

カスタムオーディエンスを一括作成できます。オーディエンスの概要は [Custom Audiences Overview](/ja/x-ads-api/audiences) ページを参照してください。

**注:** このバッチエンドポイントは現在**クローズドベータ**で、一部の広告主のみが利用可能です。ベータ期間中は、モバイルのカスタムオーディエンスに基づくフレキシブルオーディエンスのみ作成できます。

**バッチリクエスト**

- 現在の最大バッチサイズは 10 です。
- すべてのパラメータはリクエストボディで送信し、`Content-Type` は `application/json` が必須です。
- バッチリクエストはグループとしてまとめて成功または失敗し、エラー・成功いずれの場合も、API レスポンスは初回リクエストの項目順を保持します。

**バッチレスポンス**

バッチ API のレスポンスは、順序付きのアイテム集合を返します。それ以外の点は、対応する単一アイテムエンドポイントと同一の構造です。

**バッチエラー**

- リクエストレベルのエラー（例: 最大バッチサイズ超過）は、レスポンス内の `errors` オブジェクトに表示されます。
- アイテムレベルのエラー（例: 必須パラメータの欠落）は、レスポンス内の `operation_errors` オブジェクトに表示されます。

**フレキシブルオーディエンス**

<Button href="https://app.getpostman.com/run-collection/1d12b9fc623b8e149f87">
  Postman で実行
</Button>

- フレキシブルオーディエンスは一度作成すると変更できません。
- カスタムオーディエンスは、ブールロジックの組み合わせによる木構造で渡され、フレキシブルオーディエンスを作成します。
- フレキシブルオーディエンスの作成に使用できるカスタムオーディエンスのリーフノードは最大 10 個です。

**リソース URL[](#resource-url "この見出しへのパーマリンク")**

`https://ads-api.x.com/12/batch/accounts/:account_id/custom_audiences`

**パラメータ[](#parameters "この見出しへのパーマリンク")**

| Name | Description |
| :--- | :--- |
| account\_id  <br />_required_ | 利用するアカウントの識別子。リソースのパス内に含まれ、[GET accounts](/ja/x-ads-api/campaign-management#accounts) を除くすべての Advertiser API リクエストで一般的に必須パラメータです。指定したアカウントは認証済みユーザーに関連付けられている必要があります。<br /><br />Type: string<br /><br />Example: `18ce54d4x5t` |
| audience\_type  <br />_required_ | 作成するオーディエンスの種類。<br /><br />Type: enum<br /><br />Possible values: `FLEXIBLE`, `MOBILE_AUDIENCE` |
| child\_segments  <br />_required_ | ターゲットとするカスタムオーディエンスのメンバーの部分集合を定義するオブジェクトを含む配列。各オブジェクトには `custom_audience_id`、`frequency`、`frequency_comparator`、`lookback_window`、`negate`、および場合によっては追加の `child_segments` を含める必要があります。<br /><br />Type: array |
| name  <br />_required_ | オーディエンスの表示名。一意の名前を使用する必要があります。従わない場合はエラーになります。<br /><br />Type: string<br /><br />Example: `my_flexible_audience_name` |
| operation\_type  <br />_required_ | 各アイテムに対して実行される操作の種類。<br /><br />Type: enum<br /><br />Possible values: `Create`, `Update`, `Delete` |
| boolean\_operator  <br />_sometimes required_ | 親（包含する）オブジェクト内の子セグメント間の論理関係。親オブジェクトで child\_segments が空でない場合に必須。<br /><br />Type: enum<br /><br />Possible values: `AND`, `OR` |
| lookback\_window  <br />_sometimes required_ | 指定のアクションが行われ、該当するカスタムオーディエンスの条件を満たした期間（日数）を指定する整数値。<br /><br />Type: int<br /><br />Possible values: `1`, `7`, `14`, `30` |
| segments  <br />_sometimes required_ | ターゲットとするカスタムオーディエンスのメンバーの部分集合を定義する、`boolean_operator` と `child_segments` を含むオブジェクト。<br /><br />Type: object |
| custom\_audience\_id  <br />_sometimes required_ | 子セグメントとして使用するカスタムオーディエンスの ID。<br /><br />Type: string<br /><br />Example: `tyfo` |
| frequency  <br />_optional_ | 指定のアクションが行われ、該当するカスタムオーディエンスの条件を満たした回数（lookback window 内）を指定する整数値。<br /><br />Type: int<br /><br />Default value: `1` |
| frequency\_comparator  <br />_optional_ | リクエストで指定された `frequency` に対する比較演算子。<br /><br />**Note**: 以下の値において、`GTE` は以上、`LT` は未満などを意味します。<br /><br />Type: string<br /><br />Possible values: `NUM_GTE`, `NUM_GT`, `NUM_EQ`, `NUM_LTE`, `NUM_LT` Default value: `NUM_GTE` |
| negate  <br />_optional_ | セグメントを否定し、組み合わせから除外します。<br /><br />Type: boolean<br /><br />Default value: `true`  <br />Possible values: `true`, `false` |

**Example Request[](#example-request "Permalink to this headline")**

`POST https://ads-api.x.com/12/batch/accounts/18ce54d4x5t/custom_audiences`

```
    [
      {
        "operation_type":"Create",
        "params":{
          "name":"my_flexible_audience_name",
          "audience_type":"FLEXIBLE",
          "segments":{
            "boolean_operator":"AND",
            "child_segments":[
              {
                "custom_audience_id":"TYIF",
                "frequency":1,
                "frequency_comparator":"NUM_GT",
                "lookback_window":30,
                "negate":true,
                "child_segments":[

                ]
              },
              {
                "boolean_operator":"OR",
                "child_segments":[
                  {
                    "custom_audience_id":"TXR1",
                    "lookback_window":30,
                    "child_segments":[

                    ]
                  },
                  {
                    "custom_audience_id":"TYFO",
                    "frequency":1,
                    "frequency_comparator":"NUM_GT",
                    "lookback_window":30,
                    "negate":true,
                    "child_segments":[

                    ]
                  }
                ]
              }
            ]
          }
        }
      }
    ]
```

**レスポンス例[](#example-response "Permalink to this headline")**

```
    {
      "data": {
        "targetable": false,
        "name": "my_flexible_audience_name",
        "targetable_types": [
          "FLEXIBLE",
          "EXCLUDED_FLEXIBLE"
        ],
        "audience_type": "FLEXIBLE",
        "id": "13ld7",
        "reasons_not_targetable": [
          "PROCESSING",
          "TOO_SMALL"
        ],
        "metadata": [
          {
            "custom_audience_id": "13ld7",
            "account_id": "qsx3w2",
            "name": "my_flexible_audience_name",
            "audience_source": "FLEXIBLE_AUDIENCE",
            "upload_status": "UPLOADED",
            "segments": {
              "boolean_operator": "AND",
              "frequency": 1,
              "frequency_comparator": "NUM_GTE",
              "negate": false,
              "child_segments": [
                {
                  "custom_audience_id": "tyif",
                  "lookback_window": 30,
                  "frequency": 1,
                  "frequency_comparator": "NUM_GT",
                  "negate": true,
                  "child_segments": [

                  ]
                },
                {
                  "boolean_operator": "OR",
                  "frequency": 1,
                  "frequency_comparator": "NUM_GTE",
                  "negate": false,
                  "child_segments": [
                    {
                      "custom_audience_id": "txr1",
                      "lookback_window": 30,
                      "frequency": 1,
                      "frequency_comparator": "NUM_GTE",
                      "negate": false,
                      "child_segments": [

                      ]
                    },
                    {
                      "custom_audience_id": "tyfo",
                      "lookback_window": 30,
                      "frequency": 1,
                      "frequency_comparator": "NUM_GT",
                      "negate": true,
                      "child_segments": [

                      ]
                    }
                  ]
                }
              ]
            }
          }
        ],
        "created_at": "2015-11-10T21:26:43Z",
        "updated_at": "2015-11-11T01:11:47Z",
        "partner_source": "OTHER",
        "deleted": false,
        "audience_size": null
      },
      "request": [
        {
          "params": {
            "name": "my_flexible_audience_name",
            "audience_type": "FLEXIBLE",
            "segments": {
              "boolean_operator": "AND",
              "child_segments": [
                {
                  "custom_audience_id": "TYIF",
                  "lookback_window": 30,
                  "frequency": 1,
                  "frequency_comparator": "NUM_GT",
                  "negate": true,
                  "child_segments": [

                  ]
                },
                {
                  "boolean_operator": "OR",
                  "child_segments": [
                    {
                      "custom_audience_id": "TXR1",
                      "lookback_window": 30,
                      "child_segments": [

                      ]
                    },
                    {
                      "custom_audience_id": "TYFO",
                      "lookback_window": 30,
                      "frequency": 1,
                      "frequency_comparator": "NUM_GT",
                      "negate": true,
                      "child_segments": [

                      ]
                    }
                  ]
                }
              ]
            },
            "account_id": "qsx3w2"
          },
          "operation_type": "Create"
        }
      ]
    }
```

#### DELETE accounts/:account\_id/custom\_audiences/:custom\_audience\_id[](#delete-accounts-account-id-custom-audiences-custom-audience-id "Permalink to this headline")

現在のアカウントに属する指定のカスタムオーディエンスを削除します。

**Resource URL[](#resource-url "Permalink to this headline")**

`https://ads-api.x.com/12/accounts/:account_id/custom_audiences/:custom_audience_id`

**Parameters[](#parameters "Permalink to this headline")**

| Name | Description |
| :--- | :--- |
| account\_id  <br />_required_ | 利用対象アカウントの識別子。リソースのパス内に含まれ、[GET accounts](/ja/x-ads-api/campaign-management#accounts) を除くすべての Advertiser API リクエストで一般的に必須のパラメータです。指定したアカウントは認証済みユーザーに関連付けられている必要があります。<br /><br />Type: string<br /><br />Example: `18ce54d4x5t` |
| custom\_audience\_id  <br />_required_ | リクエストで操作対象のカスタムオーディエンスを参照する ID。<br /><br />Type: string<br /><br />Example: `2906h` |

**Example Request[](#example-request "Permalink to this headline")**

`DELETE https://ads-api.x.com/12/accounts/18ce54d4x5t/custom_audiences/2906h`

**Example Response[](#example-response "Permalink to this headline")**

```
    {
      "data": {
        "targetable": false,
        "name": "developers",
        "targetable_types": [
          "CRM",
          "EXCLUDED_CRM"
        ],
        "audience_type": "CRM",
        "description": null,
        "permission_level": "READ_WRITE",
        "owner_account_id": "18ce54d4x5t",
        "id": "2906h",
        "reasons_not_targetable": [
          "TOO_SMALL"
        ],
        "created_at": "2017-08-22T23:34:26Z",
        "updated_at": "2017-08-30T18:09:00Z",
        "partner_source": "OTHER",
        "deleted": true,
        "audience_size": null
      },
      "request": {
        "params": {
          "custom_audience_id": "2906h",
          "account_id": "18ce54d4x5t"
        }
      }
    }
```

<div id="do-not-reach-lists">
  ### 到達不可リスト（DNRL）
</div>

<Button href="https://app.getpostman.com/run-collection/1d12b9fc623b8e149f87">
  Postmanで実行
</Button>

#### GET accounts/:account\_id/do\_not\_reach\_lists[](#get-accounts-account-id-do-not-reach-lists "Permalink to this headline")

現在のアカウントに関連付けられている到達不可リスト（Do Not Reach List）の一部またはすべての詳細を取得します。

**注**: `account_id` ごとに保持できる到達不可リストは最大1つです

**Resource URL[](#resource-url "Permalink to this headline")**

`https://ads-api.x.com/12/accounts/:account_id/do_not_reach_lists`

**Parameters[](#parameters "Permalink to this headline")**

| Name | Description |
| :--- | :--- |
| account\_id  <br />_required_ | 対象アカウントの識別子。リソースのパス内に含まれ、[GET accounts](/ja/x-ads-api/campaign-management#accounts) を除くすべての Advertiser API リクエストで一般的に必須のパラメータです。指定したアカウントは認証済みユーザーに関連付けられている必要があります。<br /><br />Type: string<br /><br />Example: `18ce54d4x5t` |
| with\_deleted  <br />_optional_ | 削除済みの結果をレスポンスに含めます。<br /><br />Type: boolean<br /><br />Default: `false`  <br />Possible values: `true`, `false` |

**Example Request[](#example-request "Permalink to this headline")**

`GET https://ads-api.x.com/12/accounts/18ce54bgxky/do_not_reach_lists`

**Example Response[](#example-response "Permalink to this headline")**

```
    {
      "request": {
        "params": {
          "account_id": "18ce54bgxky"
        }
      },
      "next_cursor": null,
      "data": [
        {
          "targetable": false,
          "name": "Do Not Reach List",
          "description": "test DNRL",
          "id": "4kzrq",
          "reasons_not_targetable": [
            "TOO_SMALL"
          ],
          "created_at": "2021-10-28T22:09:29Z",
          "list_size": null,
          "updated_at": "2021-11-04T03:33:06Z",
          "deleted": false
        }
      ]
    }
```

#### POST accounts/:account\_id/do\_not\_reach\_lists[](#post-accounts-account-id-do-not-reach-lists "Permalink to this headline")

現在のアカウントに関連付けられた新しい到達不可リスト（DNRL）を作成します。

**Note**: `account_id` につき到達不可リストは最大1つまでです

**Resource URL[](#resource-url "Permalink to this headline")**

`https://ads-api.x.com/12/accounts/:account_id/do_not_reach_lists`

**Parameters[](#parameters "Permalink to this headline")**

| Name | Description |
| :--- | :--- |
| account\_id  <br />_required_ | 利用するアカウントの識別子。リソースのパス内に現れ、[GET accounts](/ja/x-ads-api/campaign-management#accounts) を除くすべての Advertiser API リクエストで一般的に必須のパラメータです。指定されたアカウントは認証済みユーザーに関連付けられている必要があります。<br /><br />Type: string<br /><br />Example: `18ce54d4x5t` |
| description  <br />_optional_ | このオーディエンスの説明。<br /><br />Type: string<br /><br />Example: `A list of users to exclude` |

**Example Request[](#example-request "Permalink to this headline")**

`POST https://ads-api.x.com/12/accounts/18ce54bgxky/do_not_reach_lists?description=A list of users to exclude`

**Example Response[](#example-response "Permalink to this headline")**

```
    {
      "request": {
        "params": {
          "description": "A list of users to exclude",
          "account_id": "18ce54bgxky"
        }
      },
      "data": {
        "targetable": false,
        "name": "Do Not Reach List",
        "description": "A list of users to exclude",
        "id": "4ofrq",
        "reasons_not_targetable": [
          "PROCESSING",
          "TOO_SMALL"
        ],
        "created_at": "2022-02-08T23:02:48Z",
        "list_size": null,
        "updated_at": "2022-02-08T23:02:48Z",
        "deleted": false
      }
    }
```

#### POST batch/accounts/:account\_id/do\_not\_reach\_lists/:do\_not\_reach\_list\_id/users[](#post-batch-accounts-account-id-do-not-reach-lists-do-not-reach-list-id-users "Permalink to this headline")

このエンドポイントでは、指定された `do_not_reach_list_id` に対してユーザーの追加、更新、削除を行えます。このエンドポイントで有効なユーザー識別子はメールアドレスのみです。

リクエストの `emails` フィールドで提供するすべてのデータは、`SHA256` でハッシュ化し、[正規化](/ja/x-ads-api/audiences#e-mail-normalization)する必要があります。

**注意事項**

- `account_id` ごとに到達不可リスト（DNRL）は最大1つまでです
- このリストに追加されるユーザーには、現在のタイムスタンプから13か月未満となる `expires_at` タイムスタンプの設定が必須です
- 到達不可リスト API は `effective_at` タイムスタンプを受け付けず、デフォルトで現在のタイムスタンプが使用されます
- 到達不可リストは、アカウント内の任意またはすべてのカスタムオーディエンスからユーザーを削除するものではなく、アカウントで配信されるすべてのキャンペーンに対する除外ターゲティングとして機能します

**バッチリクエスト**

- 現在の最大バッチサイズは（このエンドポイントに限り）`2500` です。バッチサイズはリクエストあたりの操作数（`Update`/`Delete`）によって決まります。たとえば、1つの配列に 2500 を超える操作オブジェクト（`{"operation_type": "Update/Delete", [..] }`）がある場合はエラーになります。
- このエンドポイントが受け付ける最大リクエスト POST ボディサイズは `5,000,000` バイトです。
- このエンドポイントのレート制限は、1分あたり 1500 回です
- すべてのパラメータはリクエストボディで送信し、`Content-Type` は `application/json` が必要です。
- バッチリクエストはグループとして一括で失敗または成功し、エラー／成功いずれの API レスポンスでも、初期リクエストのアイテム順序が保持されます。

**バッチレスポンス**

Ads API が返すレスポンスには、`success_count` と `total_count` の 2 つのフィールドが含まれます。これらの値は常に等しくなければならず、バックエンドで処理されたリクエスト内のレコード数を表します。リクエストボディで送信されたレコード数が `success_count` および `total_count` と等しくない場合はエラーとして扱い、再試行が必要です。

**バッチエラー**

- リクエストレベルのエラー（例：最大バッチサイズ超過）は、レスポンスの `errors` オブジェクトに表示されます。
- アイテムレベルのエラー（例：必須パラメータの欠落）は、レスポンスの `operation_errors` オブジェクトに表示されます。
- `operation_errors` 内のエラーのインデックスは、入力アイテム内のインデックスを指し、対応するエラーメッセージが付与されます

**Resource URL[](#resource-url "Permalink to this headline")**

`https://ads-api.x.com/12/batch/accounts/:account_id/do_not_reach_lists/:do_not_reach_list_id/users`

**Parameters[](#parameters "Permalink to this headline")**

| Name | Description |
| :--- | :--- |
| account\_id  <br />_required_ | 対象アカウントの識別子。リソースのパス内に現れ、[GET accounts](/ja/x-ads-api/campaign-management#accounts) を除くすべての Advertiser API リクエストで一般的に必須のパラメータです。指定されたアカウントは認証済みユーザーに関連付けられている必要があります。<br /><br />Type: string<br /><br />Example: `18ce54d4x5t` |
| do\_not\_reach\_list\_id  <br />_required_ | リクエストで操作対象となる到達不可リストの参照<br /><br />Type: string<br /><br />Example: `2906h` |
| operation\_type  <br />_required_ | 各 `users` グループに対して実行する操作タイプ。<br /><br />Type: enum<br /><br />Possible values: `Update`, `Delete` |
| params  <br />_required_ | `emails` 配列と `expires_at` タイムスタンプを含む JSON オブジェクト。<br /><br />Type: JSON |
| users  <br />_required_ | 個々のユーザーに関するすべてのパラメータを含む JSON オブジェクトの配列。<br /><br />Type: JSON |
| expires\_at  <br />_optional_ | ユーザーの関連付けが失効する UTC 時刻。指定時刻は現在のタイムスタンプより後である必要があります。[ISO 8601](https://en.wikipedia.org/wiki/ISO_8601) で表現します。デフォルトは現在のタイムスタンプから 13 か月後。<br /><br />Type: string<br /><br />Example: `2017-07-05T07:00:00Z` |

`users` オブジェクトのマルチキー方式に基づき、このオブジェクトの各要素は以下に記載します:

| Name | Description |
| :--- | :--- |
| email  <br />_optional_ | ユーザーのメールアドレス（複数可）。<br /><br />Type: Array\[String] |
| phone\_number  <br />_optional_ | ユーザーの電話番号（複数可）。<br /><br />Type: Array\[String] |

**Example Request[](#example-request "Permalink to this headline")**

```
`POST https://ads-api.x.com/12/batch/accounts/18ce54bgxky/do_not_reach_lists/4kzro/users`

    [
      {
        "operation_type": "Update",
        "params": {
          "expires_at": "2023-01-22T00:00:00Z",
          "users": [
            {
              "email": [
                "FEAD76F6ADF99FFFB997AA4E3C8AD38FF531BC4C956DBD03CD0163F744D8AABC"
              ],
              "phone_number": [
                "CCABF1B62A202E0FE28BC6C014983C89A65451DD4482BD66A0ADB65366F38A9A"
              ]
            },
            {
              "email": [
                "FEAD76F6ADF99FFFB997AA4E3C8AD38FF531BC4C956DBD03CD0163F744D8AABA"
              ],
              "phone_number": [
                "CCABF1B62A202E0FE28BC6C014983C89A65451DD4482BD66A0ADB65366F38A9E"
              ]
            }
          ]
        }
      }
    ]
```

**Example Response[](#example-response "Permalink to this headline")**

```
    {
      "data": [
        {
          "success_count": 2,
          "total_count": 2
        }
      ],
      "request": [
        {
          "params": {
            "do_not_reach_list_id": "4ofrq",
            "expires_at": "2023-01-22T00:00:00Z",
            "account_id": "18ce54bgxky"
          },
          "operation_type": "Update"
        }
      ]
    }
```

#### DELETE accounts/:account\_id/do\_not\_reach\_lists/:do\_not\_reach\_list\_id[](#delete-accounts-account-id-do-not-reach-lists-do-not-reach-list-id "この見出しへのパーマリンク")

現在のアカウントに属する指定の到達不可リスト（DNRL）を削除します。

**Resource URL[](#resource-url "この見出しへのパーマリンク")**

`https://ads-api.x.com/12/accounts/:account_id/do_not_reach_lists/:do_not_reach_list_id`

**Parameters[](#parameters "この見出しへのパーマリンク")**

なし

**Example Request[](#example-request "この見出しへのパーマリンク")**

`DELETE https://ads-api.x.com/12/accounts/18ce54bgxky/do_not_reach_lists/4ofrp`

**Example Response[](#example-response "この見出しへのパーマリンク")**

```
    {
      "request": {
        "params": {
          "do_not_reach_list_id": "4ofrp",
          "account_id": "18ce54bgxky"
        }
      },
      "data": {
        "targetable": false,
        "name": "Do Not Reach List",
        "description": null,
        "id": "4ofrp",
        "reasons_not_targetable": [
          "PROCESSING",
          "TOO_SMALL"
        ],
        "created_at": "2022-02-08T23:02:07Z",
        "list_size": null,
        "updated_at": "2022-02-08T23:02:21Z",
        "deleted": true
      }
    }
```