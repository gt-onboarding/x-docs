---
title: 連携ガイド
sidebarTitle: 連携ガイド
---

import { Button } from '/snippets/ja/button.mdx';

このページでは、users lookup エンドポイントをシステムに統合する際に把握しておくべき、いくつかのツールと重要な概念について説明します。ページは次のセクションに分かれています。

- [役立つツール](#helpful)
- 重要な概念
- [認証](#authentication)
- [Developer Portal、プロジェクトとアプリ](#portal)
- [レート制限](#limits)
- [フィールドと拡張](#fields)
- [エッジケース](#edge)

<div id="helpful-tools">
  ### 役立つツール
</div>

このエンドポイントを統合するうえで重要な概念に入る前に、次の内容に慣れておくことをおすすめします。

<div id="postman">
  #### Postman
</div>

Postman は、エンドポイントのテストに使える優れたツールです。各 Postman リクエストには、利用可能な項目をすばやく把握できるよう、すべてのパスおよびボディのパラメータが含まれています。Postman コレクションの詳細は、["Using Postman"](/ja/tutorials/postman-getting-started) のページをご覧ください。 

<div id="code-samples">
  #### コードサンプル
</div>

お好みのプログラミング言語でこのエンドポイントをセットアップしたい方へ。出発点として利用できる複数のコードサンプルを、[GitHub のページ](https://github.com/xdevplatform/Twitter-API-v2-sample-code)で提供しています。

<div id="third-party-libraries">
  #### サードパーティライブラリ
</div>

コミュニティ提供の[サードパーティライブラリ](/ja/x-api/tools-and-libraries/overview)を活用して、スムーズに始めましょう。適切なバージョンタグを確認すれば、v2 エンドポイントに対応するライブラリを見つけられます。

<div id="key-concepts">
  ### 重要な概念
</div>

<div id="authentication">
  #### 認証
</div>

すべての X API v2 エンドポイントでは、キーやトークンとしても知られる認証情報セットによる[認証](/ja/resources/fundamentals/authentication)が必要です。これらのエンドポイントへのリクエスト認証には、OAuth 1.0a User Context、App only、または OAuth 2.0 Authorization Code（PKCE）を使用できます。 

[OAuth 1.0a User Context](/ja/resources/fundamentals/authentication#oauth-1-0a-2)では、API Keys、ユーザーの Access Tokens、その他のパラメータを用いて[認可ヘッダーを作成](/ja/resources/fundamentals/authentication#authorizing-a-request)し、それをリクエストに付与する必要があります。Access Tokens は、あなたが代理でリクエストを行うユーザーに紐づいている必要があります。別のユーザーの Access Tokens を生成したい場合は、そのユーザーが[3-legged OAuth フロー](https://developer-staging.x.com/resources/fundamentals/authentication/obtaining-user-access-tokens)を使用してあなたの App を承認する必要があります。 

OAuth 1.0a の利用は難しい場合がある点にご留意ください。この認証方式に不慣れな場合は、[ライブラリ](/ja/x-api/tools-and-libraries/overview)の利用、Postman のようなツールの利用、または OAuth 2.0 による認証を推奨します。これらのエンドポイントから投稿や非公開メトリクスを取得する場合は、OAuth 1.0a User Context か OAuth 2.0 Authorization Code（PKCE）のいずれかを使用する必要があります。これにより、そのコンテンツの所有ユーザーから適切な権限が付与されていることが保証されます。
 

[App only](/ja/resources/fundamentals/authentication#bearer-token-also-known-as-app-only)では、リクエストに[App only Access Token](/ja/resources/fundamentals/authentication#bearer-token-also-known-as-app-only)を付与するだけで構いません。App only Access Token は、開発者用 App 内で直接生成するか、[POST oauth2/token](/ja/resources/fundamentals/authentication#post-oauth2-token) エンドポイントで生成できます。

[OAuth 2.0 Authorization Code（PKCE）](/ja/resources/fundamentals/authentication#oauth-2-0-authorization-code-flow-with-pkce-2)は、アプリケーションのスコープをより細かく制御でき、複数デバイスにまたがる認可フローにも対応します。OAuth 2.0 では、ユーザーに代わって特定の権限を付与するための粒度の細かいスコープを選択できます。 

App で OAuth 2.0 を有効化するには、開発者ポータルの App 設定セクションにある認証設定で有効にしてください。

**注意事項**

以下のフィールドをリクエストする場合は、OAuth 1.0a User Context または OAuth 2.0 Authorization Code が必要です。 

- tweet.fields.non\_public\_metrics
- tweet.fields.promoted\_metrics
- tweet.fields.organic\_metrics

<div id="developer-portal-projects-and-developer-apps">
  #### 開発者ポータル、プロジェクト、開発者アプリ
</div>

X API v2 のエンドポイントで利用できる認証情報一式を取得するには、[開発者アカウントに登録](https://developer.x.com/en/portal/petition/essential/basic-info)し、そのアカウント内に[プロジェクト](/ja/resources/fundamentals/projects)を作成し、さらにそのプロジェクト内に[開発者アプリ](/ja/resources/fundamentals/developer-apps)を作成する必要があります。キーとトークンは開発者アプリで確認できます。 
 

<div id="rate-limits">
  #### レート制限
</div>

毎日、何千人もの開発者が X API にリクエストを送信しています。これらの大量のリクエストを適切に管理するため、各エンドポイントには[レート制限](/ja/x-api/fundamentals/rate-limits)が設定されており、アプリまたは認証済みユーザーを代理して実行できるリクエスト数が制限されています。 

ユーザー参照系のエンドポイントには、アプリレベルとユーザーレベルの両方のレート制限が適用されます。一方、認証済みユーザー参照エンドポイントはユーザーレベルでのみレート制限されます。

アプリレベルのレート制限は、使用しているキーとトークンで識別される任意のアプリから、一定期間内に当該エンドポイントへ送信できるリクエスト数が制限されることを意味します。ユーザーレベルのレート制限は、あなたが代理する認証済みユーザーが、どの開発者アプリからであっても一定回数までしか実行できないことを意味します。

以下の表は、各エンドポイントのレート制限を示しています。

|     |     |     |
| :--- | :--- | :--- |
| **エンドポイント** | **HTTP メソッド** | **レート制限 / レベル** |
| /2/users | GET | 15分あたり900リクエスト / App および User |
| /2/users/:id | GET | 15分あたり900リクエスト / App および User |
| /2/users/by | GET | 15分あたり900リクエスト / App および User |
| /2/users/by/username/:username | GET | 15分あたり900リクエスト / App および User |
| /2/users/me | GET | 15分あたり75リクエスト / User |

<div id="fields-and-expansions">
  #### フィールドとエキスパンション
</div>

X API v2 では、「フィールド」と「エキスパンション」と呼ばれる一連の手段を使って、API から返すデータを正確に指定できます。expansion パラメータを使うと、ペイロード内で参照されているオブジェクトを展開できます。たとえば、このエンドポイントでは pinned\_tweet\_id エキスパンションを利用できます。

fields パラメータを使うと、受け取りたい各種データオブジェクト内の[フィールド](/ja/x-api/fundamentals/fields)を正確に選択できます。これらのエンドポイントは主にユーザーオブジェクトを返します。既定では、user オブジェクトは id、name、username の各フィールドを返します。user.created\_at や user.location などの追加フィールドを受け取るには、fields パラメータで明示的に指定する必要があります。統合時に検討すべき重要なフィールドとしては、投稿の投票データ、メトリクス、アノテーション、会話 ID などがあります。

[X API v2 データディクショナリ](/ja/x-api/fundamentals/data-dictionary)に、[フィールドとエキスパンションの使用方法](/ja/x-api/fundamentals/data-dictionary#how-to-use-fields-and-expansions)に関するガイドを追加しました。

<div id="edge-cases">
  #### 例外ケース
</div>

- リポストでは投稿テキストが途中で切り捨てられます。短期的な回避策として、参照先の投稿を展開し、その展開から全文を取得してください。これは不具合であり、今後修正予定です。