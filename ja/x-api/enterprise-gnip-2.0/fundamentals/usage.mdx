---
title: Usage API
description: "Usage API は、エンタープライズアカウントにおける製品横断の利用状況に対して、プログラムによるアクセスと可視化を提供する無料の REST API です。"
sidebarTitle: Usage API
---

<div id="usage-api-twitter-api">
  ## Usage API | X API
</div>

<div id="overview">
  ### 概要
</div>

`Enterprise`

これは、アカウント配下の各種 API における利用状況を横断的に監視・管理するための、最も重要かつ「最適な」ツールです。

**重要な免責事項:**

Usage API が返す利用回数は、トライアルやその他の課金調整により、請求書の明細と一致しない場合があります。すべての数値は、その日（UTC）内に消費されたアクティビティを重複排除したうえで算出されています。

<div id="features">
  #### 機能
</div>

- console.gnip.com の UI で確認できる使用状況データをプログラムで取得
- ストリームレベルの使用状況データ - プロダクトレベルに加えて、ストリーム（例：dev、prod）ごとの使用状況データを提供
- きめ細かく説明的なデータ - 検索の「リクエスト」は、全アーカイブ検索と 30 日検索の各プロダクトで内訳表示
- Historical PowerTrack の「days」と「jobs」 

<div id="supported-apis">
  ### サポート対象の API
</div>

以下は、Usage API が現在サポートしている API の一覧です。

- PowerTrack API `enterprise`
- 30-Day Search API `enterprise`
- Full-Archive Search API `enterprise`
- Historical PowerTrack `enterprise`

<div id="limitations">
  ### 制限事項
</div>

- Usage API では、2018年5月1日以降の利用状況データにアクセスできます。2019年7月1日以降は、**直近13か月の暦月**の利用状況データにアクセス可能です。

- `fromDate` と `toDate` で定義された**3か月単位**で利用状況データにアクセスできます。

以下にリクエストとレスポンスの例を示します:

```bash
curl -u<username>:<password> \
"https://gnip-api.x.com/metrics/usage/accounts/<account-name>.json?bucket=month"
```

```json
{
  "account": {
    "name": "accountnamehere"
  },
  "publishers": [
    {
      "type": "twitter",
      "used": [
        {
          "timePeriod": "201805010000",
          "activities": 1235,
          "searchRequests30Day": 3,
          "searchRequestsFullArchive": 19,
          "historicalPowertrackDays": 0,
          "historicalPowertrackJobs": 0
        },
        {
          "timePeriod": "201806010000",
          "activities": 23467,
          "searchRequests30Day": 0,
          "searchRequestsFullArchive": 66,
          "historicalPowertrackDays": 0,
          "historicalPowertrackJobs": 0
        },
        {
          "timePeriod": "201807010000",
          "activities": 431,
          "searchRequests30Day": 11,
          "searchRequestsFullArchive": 4,
          "historicalPowertrackDays": 0,
          "historicalPowertrackJobs": 0
        }
      ],
      "projected": {
        "timePeriod": "201807010000",
        "activities": 803,
        "searchRequests30Day": 20,
        "searchRequestsFullArchive": 7,
        "historicalPowertrackDays": 0,
        "historicalPowertrackJobs": 0
      },
      "products": [
        {
          "type": "Historical PowerTrack サブスクリプション",
          "used": [
            {
              "timePeriod": "201805010000",
              "activities": 0,
              "days": 0,
              "jobs": 0
            },
            {
              "timePeriod": "201806010000",
              "activities": 0,
              "days": 0,
              "jobs": 0
            },
            {
              "timePeriod": "201807010000",
              "activities": 0,
              "days": 0,
              "jobs": 0
            }
          ],
          "projected": {
            "timePeriod": "201807010000",
            "activities": 0,
            "days": 0,
            "jobs": 0
          }
        },
        {
          "type": "PowerTrack",
          "used": [
            {
              "timePeriod": "201805010000",
              "activities": 267
            },
            {
              "timePeriod": "201806010000",
              "activities": 3
            },
            {
              "timePeriod": "201807010000",
              "activities": 32
            }
          ],
          "projected": {
            "timePeriod": "201807010000",
            "activities": 59
          },
          "endpoints": [
            {
              "type": "PowerTrack 2.0",
              "label": "actformat",
              "used": [
                {
                  "timePeriod": "201805010000",
                  "activities": 0
                },
                {
                  "timePeriod": "201806010000",
                  "activities": 0
                },
                {
                  "timePeriod": "201807010000",
                  "activities": 0
                }
              ],
              "projected": {
                "timePeriod": "201807010000",
                "activities": 0
              }
            },
              {
              "type": "PowerTrack Replay 2.0",
              "label": "ogformat",
              "used": [
                {
                  "timePeriod": "201805010000",
                  "activities": 0
                },
                {
                  "timePeriod": "201806010000",
                  "activities": 0
                },
                {
                  "timePeriod": "201807010000",
                  "activities": 0
                }
              ],
              "projected": {
                "timePeriod": "201807010000",
                "activities": 0
              }
            }
          ]
        },
        {
          "type": "Search API（30日）2.0",
          "used": [
            {
              "timePeriod": "201805010000",
              "activities": 10,
              "searchRequests30Day": 3
            },
            {
              "timePeriod": "201806010000",
              "activities": 0,
              "searchRequests30Day": 0
            },
            {
              "timePeriod": "201807010000",
              "activities": 23,
              "searchRequests30Day": 11
            }
          ],
          "projected": {
            "timePeriod": "201807010000",
            "activities": 42,
            "searchRequests30Day": 20
          },
          "endpoints": [
            {
              "type": "Search API（30日）2.0",
              "label": "ogformat",
              "used": [
                {
                  "timePeriod": "201805010000",
                  "activities": 10,
                  "searchRequests30Day": 3
                },
                {
                  "timePeriod": "201806010000",
                  "activities": 0,
                  "searchRequests30Day": 0
                },
                {
                  "timePeriod": "201807010000",
                  "activities": 21,
                  "searchRequests30Day": 10
                }
              ],
              "projected": {
                "timePeriod": "201807010000",
                "activities": 39,
                "searchRequests30Day": 18
              }
            }
          ]
        },
        {
          "type": "Search API（全アーカイブ検索）",
          "used": [
            {
              "timePeriod": "201805010000",
              "activities": 961,
              "searchRequestsFullArchive": 19
            },
            {
              "timePeriod": "201806010000",
              "activities": 23466,
              "searchRequestsFullArchive": 66
            },
            {
              "timePeriod": "201807010000",
              "activities": 379,
              "searchRequestsFullArchive": 4
            }
          ],
          "projected": {
            "timePeriod": "201807010000",
            "activities": 706,
            "searchRequestsFullArchive": 7
          },
          "endpoints": [
            {
              "type": "Search API（全アーカイブ検索）",
              "label": "actformat",
              "used": [
                {
                  "timePeriod": "201805010000",
                  "activities": 1,
                  "searchRequestsFullArchive": 3
                },
                {
                  "timePeriod": "201806010000",
                  "activities": 0,
                  "searchRequestsFullArchive": 0
                },
                {
                  "timePeriod": "201807010000",
                  "activities": 2,
                  "searchRequestsFullArchive": 1
                }
              ],
              "projected": {
                "timePeriod": "201807010000",
                "activities": 3,
                "searchRequestsFullArchive": 1
              }
            },
            {
              "type": "Search API（全アーカイブ検索）",
              "label": "ogformat",
              "used": [
                {
                  "timePeriod": "201805010000",
                  "activities": 961,
                  "searchRequestsFullArchive": 16
                },
                {
                  "timePeriod": "201806010000",
                  "activities": 23466,
                  "searchRequestsFullArchive": 66
                },
                {
                  "timePeriod": "201807010000",
                  "activities": 379,
                  "searchRequestsFullArchive": 3
                }
              ],
              "projected": {
                "timePeriod": "201807010000",
                "activities": 706,
                "searchRequestsFullArchive": 5
              }
            }
          ]
        }
      ]
    }
  ],
  "bucket": "month",
  "fromDate": "201805010000",
  "toDate": "201808010000"
}
```

<div id="sample-payload">
  ### サンプルペイロード
</div>

以下はペイロードの例です：

```bash
{
  "account": {
    "name": "gnip-username"
  },
  "bucket": "month",
  "publishers": [
    {
      "type": "automattic",
      "used": [
        {
          "activities": 0,
          "timePeriod": "201603010000"
        }
      ],
      "projected": {
        "activities": 0,
        "timePeriod": "201603010000"
      },
      "products": [
        {
          "type": "PowerTrack",
          "used": [
            {
              "timePeriod": "201603010000",
              "activities": 0
            }
          ],
          "projected": {
            "timePeriod": "201603010000",
            "activities": 0
          },
          "endpoints": [
            {
              "type": "PowerTrack",
              "label": "dev",
              "used": [
                {
                  "timePeriod": "201603010000",
                  "activities": 0
                }
              ],
              "projected": {
                "timePeriod": "201603010000",
                "activities": 0
              }
            }
          ]
        }
      ]
    },
    {
      "type": "twitter",
      "used": [
        {
          "activities": 84,
          "searchRequests30Day": 4,
          "searchRequestsFullArchive": 0,
          "historicalPowertrackDays": 0,
          "historicalPowertrackJobs": 0,
          "timePeriod": "201603010000"
        }
      ],
      "projected": {
        "activities": 0,
        "searchRequests30Day": 0,
        "searchRequestsFullArchive": 0,
        "historicalPowertrackDays": 0,
        "historicalPowertrackJobs": 0,
        "timePeriod": "201601010000"
      },
      "products": [
        {
          "type": "Historical PowerTrack 2.0",
          "used": [
            {
              "timePeriod": "201511010000",
              "activities": 11884,
              "days": 5,
              "jobs": 5
            },
            {
              "timePeriod": "201512010000",
              "activities": 0,
              "days": 0,
              "jobs": 0
            },
            {
              "timePeriod": "201601010000",
              "activities": 0,
              "days": 0,
              "jobs": 0
            }
          ]
        },
        {
          "type": "PowerTrack",
          "used": [
            {
              "timePeriod": "201511010000",
              "activities": 0
            },
            {
              "timePeriod": "201512010000",
              "activities": 27456
            },
            {
              "timePeriod": "201601010000",
              "activities": 0
            }
          ],
          "projected": {
            "timePeriod": "201601010000",
            "activities": 0
          },
          "endpoints": [
            {
              "type": "PowerTrack",
              "label": "devel",
              "used": [
                {
                  "timePeriod": "201511010000",
                  "activities": 0
                },
                {
                  "timePeriod": "201512010000",
                  "activities": 2930
                },
                {
                  "timePeriod": "201601010000",
                  "activities": 0
                }
              ],
              "projected": {
                "timePeriod": "201601010000",
                "activities": 0
              }
            },
            {
              "type": "PowerTrack 2.0",
              "label": "devel-v2",
              "used": [
                {
                  "timePeriod": "201511010000",
                  "activities": 0
                },
                {
                  "timePeriod": "201512010000",
                  "activities": 24542
                },
                {
                  "timePeriod": "201601010000",
                  "activities": 0
                }
              ],
              "projected": {
                "timePeriod": "201601010000",
                "activities": 0
              }
            },
            {
              "type": "PowerTrack 2.0",
              "label": "devel-v2-1",
              "used": [
                {
                  "timePeriod": "201511010000",
                  "activities": 0
                },
                {
                  "timePeriod": "201512010000",
                  "activities": 0
                },
                {
                  "timePeriod": "201601010000",
                  "activities": 0
                }
              ],
              "projected": {
                "timePeriod": "201601010000",
                "activities": 0
              }
            }
          ]
        },
        {
          "type": "検索 API",
          "used": [
            {
              "timePeriod": "201511010000",
              "activities": 0,
              "searchRequests30Day": 0
            },
            {
              "timePeriod": "201512010000",
              "activities": 0,
              "searchRequests30Day": 0
            },
            {
              "timePeriod": "201601010000",
              "activities": 0,
              "searchRequests30Day": 0
            }
          ],
          "projected": {
            "timePeriod": "201601010000",
            "activities": 0,
            "searchRequests30Day": 0
          },
          "endpoints": [
            {
              "type": "検索 API",
              "label": "devel",
              "used": [
                {
                  "timePeriod": "201511010000",
                  "activities": 0,
                  "searchRequests30Day": 0
                },
                {
                  "timePeriod": "201512010000",
                  "activities": 0,
                  "searchRequests30Day": 0
                },
                {
                  "timePeriod": "201601010000",
                  "activities": 0,
                  "searchRequests30Day": 0
                }
              ],
              "projected": {
                "timePeriod": "201601010000",
                "activities": 0,
                "searchRequests30Day": 0
              }
            }
          ]
        },
        {
          "type": "検索 API（30日）",
          "used": [
            {
              "timePeriod": "201511010000",
              "activities": 0,
              "searchRequests30Day": 0
            },
            {
              "timePeriod": "201512010000",
              "activities": 0,
              "searchRequests30Day": 0
            },
            {
              "timePeriod": "201601010000",
              "activities": 0,
              "searchRequests30Day": 0
            }
          ],
          "projected": {
            "timePeriod": "201601010000",
            "activities": 0,
            "searchRequests30Day": 0
          },
          "endpoints": [
            {
              "type": "検索 API（30日）",
              "label": "devel",
              "used": [
                {
                  "timePeriod": "201511010000",
                  "activities": 0,
                  "searchRequests30Day": 0
                },
                {
                  "timePeriod": "201512010000",
                  "activities": 0,
                  "searchRequests30Day": 0
                },
                {
                  "timePeriod": "201601010000",
                  "activities": 0,
                  "searchRequests30Day": 0
                }
              ],
              "projected": {
                "timePeriod": "201601010000",
                "activities": 0,
                "searchRequests30Day": 0
              }
            }
          ]
        },
        {
          "type": "検索 API（全アーカイブ）",
          "used": [
            {
              "timePeriod": "201511010000",
              "activities": 0,
              "searchRequestsFullArchive": 0
            },
            {
              "timePeriod": "201512010000",
              "activities": 0,
              "searchRequestsFullArchive": 0
            },
            {
              "timePeriod": "201601010000",
              "activities": 0,
              "searchRequestsFullArchive": 0
            }
          ],
          "projected": {
            "timePeriod": "201601010000",
            "activities": 0,
            "searchRequestsFullArchive": 0
          },
          "endpoints": [
            {
              "type": "検索 API（全アーカイブ）",
              "label": "devel",
              "used": [
                {
                  "timePeriod": "201511010000",
                  "activities": 0,
                  "searchRequestsFullArchive": 0
                },
                {
                  "timePeriod": "201512010000",
                  "activities": 0,
                  "searchRequestsFullArchive": 0
                },
                {
                  "timePeriod": "201601010000",
                  "activities": 0,
                  "searchRequestsFullArchive": 0
                }
              ],
              "projected": {
                "timePeriod": "201601010000",
                "activities": 0,
                "searchRequestsFullArchive": 0
              }
            }
          ]
        }
      ]
    }
  ]
}
```

<div id="api-reference">
  ## API リファレンス
</div>

<div id="get-usage">
  ### 使用状況を取得
</div>

<div id="methods">
  #### **メソッド**
</div>

| メソッド | 説明 |
| :--- | :--- |
| [GET /metrics/usage/accounts/{ACCOUNT_NAME}.json](#GETData) | 使用状況データを取得 |

次のとおりです：

- :account\_name は、console.gnip.com に表示されるアカウントに関連付けられた名前（大文字と小文字を区別）です

<div id="authentication-and-rate-limit">
  #### **認証とレートリミット**
</div>

<div id="authentication">
  ##### **認証**
</div>

Usage API へのすべてのリクエストには HTTP Basic 認証が必要です。console.gnip.com へのログインや任意の Gnip ストリームへの接続に使用している、アカウントで有効化されたメールアドレスとパスワードの資格情報のいずれかを使用してください。

<div id="rate-limit">
  ##### **レート制限**
</div>

Usage API では、1 分あたり 2 件のリクエストというレート制限が適用されます。

<div id="best-practices-limitations">
  #### **ベストプラクティスと制約**
</div>

<div id="data-availability">
  ##### **データの可用性**
</div>

利用状況データは、データが処理された最後の完全な期間（UTC）までに取り込まれた重複排除済みアクティビティに基づきます。Gnip がシステムをデプロイしている場合を除き、データは通常、分単位で処理・更新されます。

- Usage API を使用すると、2018 年 5 月 1 日以降の利用状況データにアクセスできます。2019 年 7 月 1 日以降は、Usage API により**直近 13 か月間**の利用状況データにアクセスできます。 

- fromDate と toDate で定義された**3 か月間**の区切りで利用状況データにアクセスできます

<div id="requesting-and-receiving-data">
  #### **データのリクエストと受信**
</div>

Usage API は、アカウントの API エンドポイントに対して、HTTP BASIC 認証の資格情報を用いた HTTP GET リクエストを送信することで動作します。

<div id="get-request">
  ##### GET リクエスト:
</div>

ユーザーの認証情報とアカウント名を使用して、次のエンドポイントに GET リクエストを送信します:

https://gnip-api.x.com/metrics/usage/accounts/:account\_name.json

**追加パラメータ**

|     |     |
| :--- | :--- |
| bucket | 任意。使用状況データが提供される時間の単位。使用状況データは日別または月別の粒度で返されます。  <br />  <br />bucket を指定しないリクエストは、月別の粒度で返されます。  <br />  <br />オプション: 'month' または 'day' |
| fromDate (YYYYMMDDHHMM) | 任意。使用状況データは 2018 年 5 月 1 日以降のみ利用可能です。使用状況データが提供される最も古い UTC タイムスタンプ。タイムスタンプは日単位の粒度で、包含的です（例: 201805010000 は 0501 日を含みます）。時および分に '0000' 以外の値が含まれるリクエストは、デフォルトで '0000' に置き換えられます。  <br />  <br />fromDate または toDate を指定しないリクエストは、当月分の月別使用状況データを返し、過去 2 か月分の履歴も含みます。  <br />  <br />**注意:** 2019 年 6 月 1 日以降、過去 13 か月分の使用状況データにアクセスできます。たとえば 10 月 10 日であれば、前年の 9 月 1 日まで遡ってアクセスできます。  <br />**例:** 201810010000 は 2018 年 10 月 1 日（当日を含む）以降のデータを返します。 |
| toDate (YYYYMMDDHHMM) | 任意。使用状況データが提供される最新の UTC タイムスタンプ。タイムスタンプは日単位の粒度で、非包含的です（例: 201703020000 は 0302 日のデータを含みません）。toDate が当日または将来日を指す場合、使用状況データは直近の完全な日（UTC）まで返されます。時および分に '0000' 以外の値が含まれるリクエストは、デフォルトで '0000' に置き換えられます。  <br />  <br />toDate を指定しないリクエストは、次のバケット（bucket=day の場合は翌日、bucket=month の場合は翌月）をデフォルトとします。fromDate と toDate を指定しないリクエストは bucket=month がデフォルトとなり、当月分と直近 2 か月分のデータを表示します。  <br />  <br />**例:** 201703050000 は 2017 年 3 月 5 日までのデータを返し、3 月 5 日分は含みません。 |

**GET リクエスト例**

このリクエストは、2017 年 3 月 1 日から 2017 年 3 月 5 日までの月別粒度のデータを返し、2017 年 3 月 5 日分は含みません。

curl -u "https://gnip-api.x.com/metrics/usage/accounts/:account\_name.json?bucket=month\&fromdate=201403010000\&toDate=201403150000"

<div id="data-format">
  #### **データ形式**
</div>

以下の表では、Usage API が返す使用状況データのルートレベルのデータ構造を説明します。サブフィールドに複数階層があるフィールドは、リンクをクリックして詳細を展開してください。

Usage API の完全なペイロードのサンプルは、[このページ](/ja/x-api/usage/introduction)をご覧ください。

|     |     |
| :--- | :--- |
| **account** | 使用状況データの取得対象となるアカウントを表すオブジェクト。 |
| **bucket** | 使用状況データが提供される時間単位。'day' または 'month'。 |
| **fromDate** | 取得対象の最も早い UTC タイムスタンプ（境界を含む）。 |
| **toDate** | 取得対象の最も遅い UTC タイムスタンプ（境界を含まない）。 |
| **publishers** | Used、projected、products の3つの主要オブジェクトを含む。 |