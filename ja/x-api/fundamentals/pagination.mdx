---
title: ページ分割
---

<div id="introduction">
  ## はじめに
</div>

ページネーションは、1 回のレスポンスで返せる件数を超える結果を返す X API v2 のエンドポイントに備わっている機能です。その場合、データは連続した「ページ」として返されます。ページネーションとは、結果データセット全体を取得するために、すべてのページをプログラムで順次リクエストする方法を指します。すべての API エンドポイントがページネーションをサポートまたは必要とするわけではありませんが、結果セットが大きい場合によく利用されます。

<div id="use-cases-for-pagination">
  ### ページネーションのユースケース
</div>

**リクエストの全結果を取得する場合:** ページネーションは、特定のリクエストとパラメータに関連するすべてのデータを取得するために使用します。リクエストで一致する結果が `max_results` を超える場合、ページネーションが必要です。ページネーショントークンを使ってリクエストをループさせることで、すべての結果を取得できます。レスポンスに `next_token` が含まれなくなったら、すべての結果を取得し終えたと見なせます。ページネーションはポーリング目的で使用しないでください。前回のリクエスト以降の最新の結果を取得するには、`since_id` を用いたポーリングを確認してください。

**リクエストの結果を順にたどる場合:** ページネーションは、レスポンス内の `next_token` と `previous_token` を使って、リクエストの結果を前後に移動するための手段を提供します。これらのトークンは、次または前のページに移動するために、次回のリクエストで `pagination_token` に設定できます。

<div id="pagination-token-definitions">
  ### ページネーショントークンの定義
</div>

- `next_token` - ページネーションをサポートするエンドポイントの meta オブジェクト内のレスポンスで返される不透明な文字列。さらに結果があることを示し、次のリクエストで `pagination_token` パラメータとして指定すると次ページの結果を取得できる。最終ページの結果には `next_token` は含まれない。
  - `previous_token` - ページネーションをサポートするエンドポイントの meta オブジェクト内のレスポンスで返される不透明な文字列。前のページの結果があることを示し、次のリクエストで `pagination_token` パラメータとして指定すると前ページの結果を取得できる。
  - `pagination_token` - ページネーションリクエストで使用するパラメータ。次ページの結果を取得するには `next_token` の値を指定する。前ページの結果を取得するには `previous_token` の値を指定する。

<div id="fundamentals-of-pagination">
  ### ページネーションの基本
</div>

- ページネーションを使用するエンドポイントは、最初のリクエストに対して最初のページの結果を返し、追加のページがある場合は JSON レスポンスの meta オブジェクト内に `next_token` を含めます。すべての結果を取得するには、レスポンスに `next_token` が含まれなくなるまでこの処理を繰り返してください。
  - 結果は新しい順（逆時系列）で返されます。これは各ページ内でも、複数ページにまたがっても同様です:
    - 最初のレスポンスの先頭のPostが最新です。
    - 最後のレスポンスの末尾のPostが最も古いものです。
  - `max_results` リクエストパラメータで、ページごとに返される Post の数を設定できます。`max_results` には既定値と上限があります。
  - すべてのページネーション実装では、レスポンスペイロードからトークンを取り出し、次以降のリクエストで使用します。
  - 状況によっては、1 ページあたりの結果が `max_results` を下回ることがあります。1 ページあたりの結果数が常に `max_results` の値と等しいことを前提にしないでください。
  - すべての結果を取得するための最良の方法は、統合作業のコード内でループ処理を行うか、X API v2 をサポートする[ライブラリ](/ja/x-api/tools-and-libraries/overview)を使用することです。

<div id="pagination-example">
  ### ページネーションの例
</div>

ここでは、`max_results` が `100` に設定されているため結果は3ページあり、2019年1月1日 17:00:00 UTC から12月12日 00:00:00 UTC までの間にユーザー ID `2244994945`（@XDevelopers）によって作成された投稿が約295件あります。1ページ目の最初の投稿（`1337498609819021312`）が最新で、結果の3ページ目の最後の投稿（`1082718487011885056`）が最も古い投稿です。

<div id="initial-request">
  #### 初回リクエスト
</div>

```bash
      https://api.x.com/2/users/2244994945/tweets?tweet.fields=created_at&max_results=100&start_time=2019-01-01T17:00:00Z&end_time=2020-12-12T01:00:00Z
```

<div id="sequence-table">
  ### シーケンス表
</div>

|             | **最初のリクエスト**                                                                                                                                                                                                                                                                                                                                                          | **2ページ目**                                                                                                                                                                                                                                                                                                                                                                            | **3ページ目**                                                                                                                                                                                                                                                                                                                                                                             | **4ページ目**                                                                                   |
|:-------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------|
| **リクエストパラメータ** | - `max_results` = `100`  - `tweet.fields` = `created_at`  - `start_time` = `2019-01-01T17:00:00Z`  - `end_time` = `2020-12-12T01:00:00Z`                                                                                                                                                                                                               | - `max_results` = `100`  - `tweet.fields` = `created_at`  - `start_time` = `2019-01-01T17:00:00Z`  - `end_time` = `2020-12-12T01:00:00Z`  - `pagination_token` = `7140w`                                                                                                                                                             | - `max_results` = `100`  - `tweet.fields` = `created_at`  - `start_time` = `2019-01-01T17:00:00Z`  - `end_time` = `2020-12-12T01:00:00Z`  - `pagination_token` = `7140k9`                                                                                                                                                             | - `max_results` = `100`  - `tweet.fields` = `created_at`  - `start_time` = `2019-01-01T17:00:00Z`  - `end_time` = `2020-12-12T01:00:00Z`  - `pagination_token` = `71408hi`                                   |
| **レスポンス**          | `json { "data": [ { "created_at": "2020-12-11T20:44:52.000Z", "id": "1337498609819021312", "text": "本日ご視聴いただいた皆さま、ありがとうございました..." }, ... , { "created_at": "2020-05-06T17:24:31.000Z", "id": "1258085245091368960", "text": "ツイートの影響が、これまで以上に把握しやすくなりました..." } ], "meta": { "oldest_id": "1258085245091368960", "newest_id": "1337498609819021312", "result_count": 100, "next_token": "7140w" } } ` | `json { "data": [ { "created_at": "2020-04-29T17:01:44.000Z", "id": "1255542797765013504", "text": "私たちの開発者コミュニティは、刺激的なアイデアであふれています..." }, ... , { "created_at": "2019-11-21T16:17:23.000Z", "id": "1197549579035496449", "text": "まもなく、ツールを公開します..." } ], "meta": { "oldest_id": "1197549579035496449", "newest_id": "1255542797765013504", "result_count": 100, "next_token": "7140k9", "previous_token": "77qp8" } } ` | `json { "data": [ { "created_at": "2019-11-21T16:17:23.000Z", "id": "1197549578418941952", "text": "大量の返信を受け取る一部の方が直面する状況を把握しています..." }, ... , { "created_at": "2019-01-08T19:19:37.000Z", "id": "1082718487011885056", "text": "Grid 埋め込みの更新..." } ], "meta": { "oldest_id": "1082718487011885056", "newest_id": "1197549578418941952", "result_count": 95, "next_token": "71408hi", "previous_token": "77qplte" } } ` | `json { "meta": { "result_count": 0, "previous_token": "77qpw8l" } } ` || **次のリクエストで行う操作** | 次のページを取得するには、レスポンス（`7140w`）の `next_token` をそのまま取り出し、次回のリクエストで `pagination_token` に設定します。                                                                                                                                                          | すべての結果を取得し続けるには、レスポンス（`7140k9`）の `next_token` をそのまま取り出し、次回のリクエストで `pagination_token` に設定します。 前のページに移動するには、レスポンス（`77qp8`）の `previous_token` をそのまま取り出し、次回のリクエストで `pagination_token` に設定します。             | すべての結果を取得し続けるには、レスポンス（`71408hi`）の `next_token` をそのまま取り出し、次回のリクエストで `pagination_token` に設定します。 前のページに移動するには、レスポンス（`77qplte`）の `previous_token` をそのまま取り出し、次回のリクエストで `pagination_token` に設定します。             | `next_token` が存在しないことに注意してください。これは、すべての結果を受信済みであることを示します。 前のページに移動するには、レスポンス（`77qpw8l`）の `previous_token` をそのまま取り出し、次回のリクエストで `pagination_token` に設定します。 |