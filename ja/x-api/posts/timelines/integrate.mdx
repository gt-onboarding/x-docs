---
title: インテグレーションガイド
sidebarTitle: インテグレーションガイド
---

<div id="how-to-integrate-with-the-timelines-endpoints">
  ## Timelines エンドポイントを統合する方法
</div>

このページでは、Timelines エンドポイントをシステムに統合する際に把握しておくべき複数のツールと重要な概念について説明します。ページは次のセクションに分割されています。

- [役立つツール](#helpful-tools)
- 重要な概念
  - [認証](#authentication)
  - [Developer portal、プロジェクトとアプリ](#portal)
  - [レート制限](#rate-limits)
  - [フィールドと拡張](#fields)
  - [投稿メトリクス](/ja/x-api/posts/timelines#timelines-integration-guide)
  - [ページネーション](#pagination)
  - [結果のフィルタリング](#filtering)
  - [投稿上限と返される投稿量](#caps)
  - [投稿の編集](#edits)
  - [エッジケース](#edge)[](#edge)

<div id="helpful-tools">
  ### 便利なツール
</div>

いくつかの主要な概念を見ていく前に、これらのエンドポイントの機能をテストし始めるにあたって、次のツールまたはコードサンプルのいずれかをご利用いただくことをおすすめします。

**コードサンプル**

お好みのプログラミング言語でこれらのエンドポイントのセットアップを始めたい方のために、出発点として使えるコードサンプルを[GitHub ページ](https://github.com/xdevplatform/Twitter-API-v2-sample-code)で多数提供しています。

**ライブラリ**

[コミュニティ製のサードパーティライブラリ](/ja/x-api/tools-and-libraries/overview)を活用して、すばやく導入を始めましょう。適切なバージョンタグを確認することで、v2 エンドポイントに対応したライブラリが見つかります。

**Postman**

Postman は、これらのエンドポイントを試すのに適したツールです。各 Postman リクエストには、利用可能な内容をすばやく把握できるよう、すべてのパスおよびボディパラメータが含まれています。Postman コレクションの詳細は、[Using Postman](/ja/tutorials/postman-getting-started) ページをご覧ください。

<div id="key-concepts">
  ### 重要な概念
</div>

**認証**

すべての X API v2 エンドポイントは、キーやトークンとしても知られる一連の認証情報で[認証](/ja/resources/fundamentals/authentication)されたリクエストを必要とします。これらのエンドポイントへのリクエスト認証には、OAuth 1.0a User Context か OAuth 2.0 Authorization Code（PKCE）を使用できます。ユーザーの投稿タイムラインおよびユーザーのメンションタイムラインには OAuth 2.0 App-Only を使用できます。

[OAuth 1.0a User Context](/ja/resources/fundamentals/authentication#oauth-1-0a-2) では、API Key、ユーザーの Access Token、その他いくつかのパラメータを用いて[認可ヘッダーを作成](https://developer-staging.x.com/resources/fundamentals/authentication/authorizing-a-request)し、それをリクエストに付与する必要があります。Access Token は、あなたが代理でリクエストを行うユーザーに関連付けられている必要があります。別のユーザーのために Access Token のセットを生成したい場合、そのユーザーは [3-legged OAuth フロー](https://developer-staging.x.com/resources/fundamentals/authentication/obtaining-user-access-tokens)を使用してあなたの App を承認する必要があります。

OAuth 1.0a は扱いが難しい場合があります。この認証方式に不慣れな場合は、[ライブラリ](/ja/x-api/tools-and-libraries/overview)を利用する、Postman のようなツールを使う、もしくは OAuth 2.0 を利用してリクエストを認証することを推奨します。これらのエンドポイントから投稿や非公開メトリクスを取得したい場合は、OAuth 1.0a User Context または OAuth 2.0 Authorization Code（PKCE）のいずれかを使用する必要があります。これにより、そのコンテンツの所有者であるユーザーから適切な権限が付与されていることが担保されます。

[OAuth 2.0 App-Only](/ja/resources/fundamentals/authentication#bearer-token-also-known-as-app-only)は、リクエストに[OAuth 2.0 App Access Token](/ja/resources/fundamentals/authentication#bearer-token-also-known-as-app-only)を付与するだけで済みます。App Access Token は、開発者 App 内から直接生成するか、[POST oauth2/token](/ja/resources/fundamentals/authentication#post-oauth2-token) エンドポイントを使用して生成できます。これはユーザーの投稿タイムラインやユーザーのメンションタイムラインに使用できます。

[OAuth 2.0 Authorization Code（PKCE）](/ja/resources/fundamentals/authentication#oauth-2-0-authorization-code-flow-with-pkce-3)は、アプリケーションのスコープに対するより細かな制御や、複数デバイスにまたがる認可フローを可能にします。OAuth 2.0 では、ユーザーに代わって特定の権限を与えるための、きめ細かなスコープを選択できます。

App で OAuth 2.0 を有効化するには、開発者ポータルの App 設定セクションにある App の認証設定で有効化する必要があります。

<Info>
  **ご注意ください**

  以下の[フィールド](/ja/x-api/fundamentals/fields)をリクエストする場合は、OAuth 1.0a User Context または OAuth 2.0 Authorization Code が必要です。

  - `tweet.fields.non_public_metrics`
  - `tweet.fields.promoted_metrics`
  - `tweet.fields.organic_metrics`
  - `media.fields.non_public_metrics`
  - `media.fields.promoted_metrics`
  - `media.fields.organic_metrics`
</Info>

**[](/ja/x-api/fundamentals/pagination)Developer portal、Projects、および developer Apps**

任意の X API v2 エンドポイントを利用するには、[開発者アカウントに登録](https://developer.x.com/en/portal/petition/essential/basic-info)し、そのアカウント内に[プロジェクト](/ja/resources/fundamentals/projects)を設定し、そのプロジェクト内に[developer App](/ja/resources/fundamentals/developer-apps)を作成する必要があります。その developer App 内のキーとトークンは、これらのタイムラインエンドポイントで使用できます。

**レート制限**

毎日、数千人の開発者が X API にリクエストを送信しています。ボリュームを管理するために、各エンドポイントには[レート制限](/ja/x-api/fundamentals/rate-limits)が設けられており、各開発者がアプリや認証済みユーザーに代わって行えるリクエスト数が制限されています。

使用する認証方式によって、これらのエンドポイントには異なるレート制限が適用されます。アプリレベルのレート制限は OAuth 2.0 App-Only を使用する App に適用され、ユーザーレベルのレート制限は OAuth 1.0a User Context を使用して特定の承認ユーザーに代わって行われるリクエストに適用されます。これら 2 つのレート制限は、15 分間のウィンドウ内でのリクエスト頻度に基づきます。

たとえば、これら両方のタイムラインエンドポイントに対して OAuth 2.0 App-Only 認証を使用するアプリは、15 分間にユーザーの投稿タイムラインへ 1,500 件（ページネーションを含む）、ユーザーのメンションタイムラインへ 450 件（ページネーションを含む）のリクエストを行えます。同じアプリが、同じ 15 分間に、2 人の別々の認可済みユーザー（OAuth 1.0a User Context を使用）であれば、各認証ユーザーにつきユーザーの投稿タイムラインへ 900 件（ページネーションを含む）、ユーザーのメンションタイムラインへ 180 件（ページネーションを含む）のリクエストを行えます。

逆時系列のホームタイムラインには、ユーザーごとに 15 分あたり 180 件のレート制限があります。このエンドポイントでは、直近 7 日間にタイムライン上で作成されたすべての投稿に加えて、作成日時に関係なく直近の 800 件を返すことができます。

**Fields と expansions**

X API v2 では、[fields](/ja/x-api/fundamentals/fields) と [expansions](/ja/x-api/fundamentals/expansions) を使用して、API から返すデータを正確に選択できます。expansions パラメータにより、ペイロード内で参照されるオブジェクトを展開できます。たとえば、このエンドポイントでは、expansions パラメータを使用して poll、place、media などのオブジェクトをリクエストできます。

fields パラメータでは、受け取りたい各データオブジェクト内のフィールドを正確に選択できます。デフォルトでは、これらのエンドポイントが返す主要な投稿オブジェクトには id と text フィールドが含まれます。author\_id や public\_metrics などの追加フィールドを受け取るには、fields パラメータを使用して明示的にそれらをリクエストする必要があります。統合での利用を検討すべき重要なフィールドとして、poll データ、[metrics](/ja/x-api/fundamentals/metrics)、[Post annotations](/ja/x-api/fundamentals/post-annotations)、[conversation ID](/ja/x-api/fundamentals/conversation-id) があります。

[fields と expansions の使い方](/ja/x-api/fundamentals/data-dictionary#how-to-use-fields-and-expansions)をまとめたガイドを [X API v2 データ辞書](/ja/x-api/fundamentals/data-dictionary) に追加しました。

**Post metrics**

X API v2 の各エンドポイントでは、適切な fields をリクエストに含めることで、返される投稿オブジェクトから直接 Post metrics を取得できます。

Post metrics には、ユーザープライバシーに関連する制限があり、特に次のレスポンスフィールドに関係します。

- `tweet.fields.non_public_metrics`
- `tweet.fields.promoted_metrics`
- `tweet.fields.organic_metrics`
- `media.fields.non_public_metrics`
- `media.fields.promoted_metrics`
- `media.fields.organic_metrics`

上記のフィールドには非公開メトリクスデータが含まれます。つまり、ユーザー投稿タイムラインエンドポイントを使用してそのデータを代理取得するには、投稿の発行者からの認可が必要であり、[OAuth 1.0a User Context](/ja/resources/fundamentals/authentication) または [OAuth 2.0 Authorization Code Flow with PKCE](/ja/resources/fundamentals/authentication#oauth-2-0-authorization-code-flow-with-pkce-3) を使用する必要があります。

たとえば、ユーザー ID 1234 のユーザー投稿タイムラインで `non_public_metrics` を受け取るには、そのユーザーに関連付けられたアクセストークンをリクエストに含める必要があります。[3-legged OAuth flow](/ja/resources/fundamentals/authentication#obtaining-access-tokens-using-3-legged-oauth-flow) を使用してユーザーにアプリを認可してもらい、そのユーザーに関連付けられたアクセストークンのセットを取得できます。

ユーーメンションタイムラインを使用している場合、上記のフィールドは、メンションした投稿者がアプリに自分の非公開メトリクスデータへのアクセスを認可しており、かつ OAuth 1.0a User Context でそのユーザーのアクセストークンを使用してリクエストしている場合を除き、利用できません。

すべての `non_public_metrics`、organic\_metrics、promoted\_metrics は、過去 30 日以内に作成された投稿に対してのみ利用可能です。つまり、上記のフィールドをリクエストすると、結果は自動的に過去 30 日以内の投稿のみに調整されます。

これらのフィールドがリクエストされた場合、認証済みユーザーが作成した投稿のみが返され、それ以外の投稿はエラーになります。

**Pagination**

これらのエンドポイントはページネーションを使用して、レスポンスを迅速に返します。単一のレスポンスで送信できる結果（タイムラインエンドポイントでは最大 100 件の投稿）を超える場合は、ページネーションが必要です。max\_results パラメータで 1 ページあたりの件数を指定し、pagination\_token パラメータで次ページの結果を取得します。詳細は [ページネーションガイド](/ja/x-api/fundamentals/pagination) をご覧ください。

**Filtering results**

これらのエンドポイントには、結果をフィルタリングするために使用できる複数のパラメータが含まれています。start\_date と end\_date を使用すると、結果を特定の期間に絞り込めます。特定の投稿セットを選択するために投稿 ID を使用したい場合は、since\_id と until\_id を使用できます。ユーザー投稿タイムラインには exclude パラメータもあり、結果からリポストと返信を除外できます。 

**投稿上限と返される投稿数**

ユーザー投稿タイムラインおよびユーザーメンションタイムラインの各エンドポイントは、1 か月に返せる投稿数に制限があります。逆時系列のホームタイムラインエンドポイントにはこの制限は適用されません。

どのタイムラインエンドポイントを使用しても、返された投稿はプロジェクトレベルの[投稿上限](/ja/x-api/fundamentals/post-cap)にカウントされます。使用状況はデベロッパーポータルに表示され、「月」は[developer portal dashboard](https://developer.x.com/en/portal/dashboard)に表示されるサブスクリプションの更新日から始まります。 

ユーザー投稿タイムラインエンドポイントは、ユーザーのタイムラインに投稿された直近 3,200 件の投稿のみを返します。start\_time と end\_time を直近 3,200 件を超える期間に設定した場合、レスポンス自体は成功しますが、投稿は返されません。

また、ユーザー投稿タイムラインのリクエストで excludes=replies を指定した場合、直近 800 件の投稿のみが返される点にも注意が必要です。

ユーザーメンションタイムラインエンドポイントは、直近 800 件の投稿メンションのみを返します。

逆時系列のホームタイムラインエンドポイントは、直近 3,200 件の投稿を返します。

**投稿の編集**

編集対象の投稿は、元の投稿が公開されてから 30 分の間に最大 5 回まで編集できます。検索エンドポイントは常に最新バージョンの投稿を返します。公開から 30 分以上経過した投稿のみをリクエストする場合、常に最終版の投稿を受け取ります。ただし、ほぼリアルタイムのユースケースで直近 30 分以内に公開された投稿をクエリしている場合、それらの投稿は受信後に編集されている可能性があります。これらの投稿は検索、または Post Lookup エンドポイントで再取得して最終状態を確認できます。投稿の編集の仕組みについては、[Edit Posts fundamentals](/ja/x-api/fundamentals/edit-posts)ページをご覧ください。  

**エッジケース**

- User Post タイムラインエンドポイントで、30 日より前の投稿に対して非公開メトリクスをリクエストすると、結果数が 0 の next\_token がレスポンスに含まれる場合があります。この問題を避けるには、non\_public\_metrics パラメータで指定する期間を直近 30 日以内に設定してください。加えて、max\_results の最小値は 10 としてください。これらは回避に役立つ可能性がありますが、それでも発生することがあります。

- プロモーションされていない投稿に対してプロモートメトリクスをリクエストすると、投稿データではなく空のレスポンスが返されます。現在、この問題の修正に取り組んでいます。

- 本文が 140 文字を超える投稿を含むリポストでは、全文を返す代わりに text フィールドが切り詰められます。短期的な回避策として、参照元の投稿をエクスパンドして、展開から全文を取得してください。これは不具合であり、将来的に修正します。

**次のステップ**

\[Make your first request to a Timelines endpoint]/x-api/posts/timelines#getting-started-with-reverse-chronological-home-timeline "Make your first request to a Timelines endpoint")

[API リファレンスでパラメータ、フィールドなどの一覧を見る](/ja/x-api/posts/timelines#api-reference-index)

[サポートの取得またはエラーのトラブルシュート](https://developer.x.com/en/support/x-api)