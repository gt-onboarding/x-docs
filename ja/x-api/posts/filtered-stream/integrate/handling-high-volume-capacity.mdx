---
title: 大量トラフィックの処理
sidebarTitle: 大量トラフィックの処理
---

<div id="how-to-plan-for-high-volume-social-data-events">
  ### 大量ソーシャルデータ発生時への備え方
</div>

国内外の主要イベントでは、ソーシャルメディア全体でユーザーの活動量が劇的に急増することがよくあります。Super Bowl、選挙、世界各地の新年の祝賀のように事前に把握できるものもあれば、自然災害、突発的な政治的出来事、ポップカルチャーの話題、COVID-19 のようなパンデミックなど、予期せぬ出来事が発端となることもあります。

こうしたユーザー活動の急増は、数秒単位の短時間で収まる場合もあれば、数分間続く場合もあります。発生要因にかかわらず、X のデータを取得・利用するアプリケーションへの影響を考慮することが重要です。以下は、大量ソーシャルデータ発生時に備えるためにチームで実践すべきベストプラクティスです。

<div id="review-your-current-filtered-stream-rules">
  #### 現在のフィルタードストリームのルールを見直す
</div>

* 主要なスポーツイベントでブランドがスポンサーになる場合など、トラフィックが多いイベント時には、特定のキーワードが急増することがあります。
* 不要なアクティビティを発生させかねない、不要または過度に汎用的なルールは避けるよう注意してください。
* 事前に高ボリュームが予想されるイベントについてクライアントと連絡を取り、適切に計画できるよう支援することを検討してください。
     

<div id="stress-test-your-application">
  #### アプリケーションのストレステストを実施する
</div>

バースト時のトラフィックは、平均的な日次消費量の5〜10倍に達する可能性があります。設定しているルールによっては、さらに大きく増加することがあります。

<div id="understand-delivery-caps-for-connections">
  #### 接続の配信上限を理解する
</div>

フローおよび配信上限はアクセスレベルに基づきます。これにより、ストリームで配信される結果の量は固定されます。

* **Academic**: 1秒あたり250件の投稿
* **Enterprise**: 1秒あたりの投稿数はアクセスレベルで設定されます

<div id="optimize-to-stay-connected">
  #### 常時接続のための最適化
</div>

ストリームでは、データを取りこぼさないために接続を維持することが重要です。クライアントアプリケーションは切断を検知し、再接続に失敗した場合は指数バックオフを用いつつ、直ちに再接続を試みるロジックを備える必要があります。
 

<div id="add-built-in-buffering-on-your-end">
  #### 組み込みのバッファリングを自前で用意する
</div>

マルチスレッドのアプリケーションを構築することは、大量のストリームを扱ううえで重要な戦略です。概念的には、データストリームを管理するベストプラクティスは、ストリーミング接続を確立する専用のスレッド／プロセスを用意し、受信した JSON アクティビティをメモリ上のデータ構造やバッファ付きストリームリーダーに書き込むことです。この「軽量」なストリーム処理スレッドは受信データの取り込みを担い、必要に応じて伸縮するメモリ内バッファで保持します。続いて、別のスレッドがそのバッファを消費し、JSON のパースやデータベース書き込みの準備など、アプリケーションに必要な「重い処理」を実行します。
 

<div id="global-events-global-time-zones">
  #### グローバルイベント = グローバルタイムゾーン
</div>

イベントは営業時間外や週末に発生する可能性があるため、通常の営業時間外のスパイクにも対応できるよう、チームの準備を整えてください。