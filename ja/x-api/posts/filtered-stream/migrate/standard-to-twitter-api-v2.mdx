---
title: v1 から v2
sidebarTitle: v1 から v2
---

<div id="standard-v11-compared-to-x-api-v2">
  ### Standard v1.1 と X API v2 の比較
</div>

v1.1 の [statuses/filter](https://developer.x.com/en/docs/x-api/v1/tweets/filter-realtime/api-reference/post-statuses-filter) エンドポイントを利用している場合、このガイドは Standard と X API v2 のフィルタードストリームエンドポイント間の共通点と相違点の理解に役立ちます。

- **共通点**
  - リクエストパラメータとオペレーター
  - 投稿の編集履歴およびメタデータのサポート
- **相違点**
  - エンドポイントの URL
  - アプリおよびプロジェクトの要件
  - 認証方法
  - ルール数と永続ストリーム
  - レスポンスデータ形式
  - リクエストパラメータ
  - 復旧および冗長化機能の有無
  - クエリオペレーター

<div id="similarities">
  #### 類似点
</div>

**リクエストパラメータとオペレーター**

標準の v1.1 statuses/filter エンドポイントには、ストリームを絞り込むためにリクエストと一緒に渡せるいくつかのパラメータがあります。v2 のフィルタードストリームでは、代わりに、目的の投稿を取得するためにブールロジックで組み合わせられる一連の[オペレーター](/ja/x-api/posts/filtered-stream#building-rules-for-filtered-stream)を使用します。利用可能なオペレーターには、既存の標準 v1.1 パラメータを直接置き換えるものも含まれます。 

以下の標準 v1.1 リクエストパラメータには、X API v2 で同等のオペレーターがあります:
 

| **Standard** | **X API v2** |
| :--- | :--- |
| follow - ユーザー ID のカンマ区切りリスト。ストリームで配信すべきユーザーの投稿を示します。 | 特定のユーザーに関連する投稿を見つけるのに役立つオペレーター:<br /><br />\* @<br />\* from:<br />\* to:<br />\* など |
| track - フレーズのカンマ区切りリスト。ストリームで配信される投稿を決定するために使用されます。 | 特定のキーワードに関連する投稿を見つけるのに役立つオペレーター:<br /><br />\* keyword<br />\* "完全一致のフレーズ"<br />\* #<br />\* など |

**投稿の編集履歴とメタデータのサポート**

どちらのバージョンも、編集履歴を表すメタデータを提供します。詳細は [フィルタードストリーム API リファレンス](/ja/x-api/posts/filtered-stream#api-reference-index) と [投稿の編集の基礎](/ja/x-api/fundamentals/edit-posts) を参照してください。 

<div id="differences">
  #### 相違点
</div>

**エンドポイント URL**

- Standard v1.1 エンドポイント:
  - https://stream.x.com/1.1/statuses/filter.json
- X API v2 エンドポイント:
  - https://api.x.com/2/tweets/search/stream
  - https://api.x.com/2/tweets/search/stream/rule

**アプリおよびプロジェクトの要件**

X API v2 のエンドポイントでは、リクエストの認証時に [developer App](/ja/resources/fundamentals/developer-apps) の認証情報のうち、[Project](/ja/resources/fundamentals/projects) に関連付けられたものを使用する必要があります。X API v1.1 のすべてのエンドポイントでは、単体のアプリ、またはプロジェクトに関連付けられたアプリの認証情報を使用できます。

**認証方法**

Standard エンドポイントは [OAuth 1.0a User Context](/ja/resources/fundamentals/authentication) をサポートしますが、X API v2 のフィルタードストリームのエンドポイントは [OAuth 2.0 App-Only](/ja/resources/fundamentals/authentication#oauth-2-0)（Application-only authentication とも呼ばれます）をサポートします。X API v2 版にリクエストするには、App Access Token を使用してリクエストを認証する必要があります。

開発者ポータルでプロジェクトとアプリを作成した際に提示された App Access Token をすでにお持ちでない場合は、開発者ポータルのアプリの「Keys and tokens」ページから新しいトークンを生成できます。App Access Token をプログラムで生成する場合は、[OAuth 2.0 App-Only guide](/ja/resources/fundamentals/authentication#app-only-authentication-and-oauth-2-0-bearer-token) を参照してください。

**ルール数と永続ストリーム**

Standard v1.1 エンドポイントは、ストリーミング接続をフィルタリングするルールを 1 つだけサポートします。ルールを変更するには、ストリームを切断し、改訂したフィルタリングルールをパラメータとして指定して新しいリクエストを送信する必要があります。

X API v2 のフィルタードストリームのエンドポイントでは、単一のストリームに複数のルールを適用でき、接続を維持したままルールの追加・削除が可能です。

**レスポンスデータ形式**

Standard v1.1 と X API v2 のエンドポイントの最大の違いの 1 つは、ペイロードで返すフィールドの選択方法です。

Standard エンドポイントでは、多くのレスポンスフィールドがデフォルトで返され、さらにパラメータを使用して、どのフィールドまたはフィールドセットをペイロードに含めるかを指定できます。

X API v2 版は、デフォルトでは Post の id と text フィールドのみを返します。追加のフィールドやオブジェクトを要求するには、[fields](/ja/x-api/fundamentals/fields) と [expansions](/ja/x-api/fundamentals/expansions) パラメータを使用する必要があります。これらのエンドポイントから要求した Post フィールドはメインの Post オブジェクトで返されます。展開された user、media、poll、place の各オブジェクトとフィールドは、レスポンス内の includes オブジェクトで返されます。その後、Post と展開オブジェクトの両方にある ID を照合して、展開オブジェクトを Post オブジェクトに紐付けることができます。

これらの新しいパラメータについては、それぞれのガイド、または[fields と expansions の使い方](/ja/x-api/fundamentals/data-dictionary#how-to-use-fields-and-expansions)のガイドをご参照ください。

また、standard v1.1 のフィールドを新しい v2 のフィールドにマッピングするのに役立つ [data format migration guide](/ja/x-api/migrate/data-format-migration#migrating-from-standard-v1-1s-data-format-to-v2) も用意しています。このガイドでは、特定のフィールドを返すために v2 のリクエストで指定すべき具体的な expansion および field パラメータも提示しています。

特定のフィールドの要求方法の変更に加えて、X API v2 では API によって返されるオブジェクト（Post や [user](/ja/x-api/fundamentals/data-dictionary#user) オブジェクトを含む）の新しい JSON 設計も導入しています。

- JSON のルートレベルでは、standard エンドポイントは Post オブジェクトを statuses 配列で返しますが、X API v2 は data 配列で返します。
- Retweeted および Quoted を「statuses」として参照する代わりに、X API v2 の JSON では Retweeted および Quoted Tweets を参照します。contributors や user.translator\_type などの多くのレガシー/非推奨フィールドは削除されつつあります。
- Post オブジェクトの favorites と user オブジェクトの favourites の両方を使用する代わりに、X API v2 では like という用語を使用します。
- 値が存在しない JSON 値（例: null）はペイロードに書き出さないという規約を X は採用しています。Post および user の属性は、非 null の値がある場合のみ含まれます。

さらに、[Post object](/ja/x-api/fundamentals/data-dictionary#tweet) に以下の新しいフィールド群を導入しました:

- [conversation\_id](/ja/x-api/fundamentals/conversation-id) フィールド
- 新たに 2 つの [annotations](/ja/x-api/fundamentals/post-annotations) フィールド（context と entities を含む）
- 複数の新しい [metrics](/ja/x-api/fundamentals/metrics) フィールド
- 新しい reply\_setting フィールド。特定の投稿に返信できるユーザーを示します

**リクエストパラメータ**

X API v2 ではサポートされていない標準のフィルタードストリームのリクエストパラメータも存在します：

| 標準 v1.1 パラメータ | 詳細 |
| :--- | :--- |
| locations - 投稿をフィルタリングするための境界ボックスの集合を指定する、経度・緯度のペアをカンマ区切りで並べたリスト。 | X API v2 では位置情報ベースのオペレーターはまだリリースしていません。 |
| Delimited | v1.1 エンドポイントでは、これを文字列長に設定すると、クライアントがステータスメッセージの終端までに何バイト読み取るべきかを把握できるよう、ストリーム内のステータスを区切ることを示します。<br /><br />この機能は X API v2 では利用できません。 |
| Stall\_warnings | v1.1 エンドポイントでは、このパラメータを true に設定すると、クライアントが切断される危険がある場合に定期的なメッセージが配信されます。<br /><br />X API v2 では、新しい行が一定間隔で送信される既定の動作としてスタール警告が送られます。 |

**リカバリーおよび冗長化機能の可用性**

X API v2 のフィルタードストリームは、ストリーミングの稼働時間を最大化し、5 分以内の切断により取り逃した可能性のある投稿を復旧するのに役立つリカバリーおよび冗長化機能を導入しています。

冗長接続により、特定のストリームに最大 2 つまで同時接続でき、いずれかの接続が失敗しても常にストリームへの接続を維持しやすくなります。

backfill\_minutes パラメータを使用すると、最大 5 分分の取り逃したデータを復旧できます。

これらの機能はいずれも [Academic Research access](/ja/x-api/getting-started/about-x-api) でのみ利用可能です。詳細は、[recovery and redundancy features](/ja/x-api/posts/filtered-stream#filtered-stream-recovery-and-redundancy-features) 統合ガイドをご覧ください。

**新しいクエリオペレーター**

X API v2 は、次の 2 つの新機能をサポートする新しいオペレーターを導入します。

- **[Conversation IDs](/ja/x-api/fundamentals/conversation-id)** - X 上で会話が展開されると、その会話に属する投稿を示すための会話 ID を利用できます。会話内のすべての投稿は、会話を開始した投稿の ID が conversation\_id に設定されます。
  - conversation\_id:
- **[X Annotations](/ja/x-api/fundamentals/post-annotations)** は投稿に関するコンテキスト情報を提供し、entity と context のアノテーションを含みます。Entities は人、場所、製品、組織で構成されます。Contexts は、検出されたエンティティが属するドメインやトピックです。例えば、投稿で言及されている人物には、アスリート、俳優、政治家といった属性を示すコンテキストが付与される場合があります。
  - context: - 関心のあるコンテキストでアノテートされた投稿にマッチします。
  - entity: - 関心のあるエンティティでアノテートされた投稿にマッチします。 