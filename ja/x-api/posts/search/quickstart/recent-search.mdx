---
title: 直近検索
sidebarTitle: 直近検索
---

import { Button } from '/snippets/ja/button.mdx';

<div id="getting-started-with-the-recent-search-endpoint">
  ## recent search エンドポイントの開始方法
</div>

このクイックスタートガイドでは、Postman を使用して、指定したフィールドのセットを含めて recent search エンドポイントへ最初のリクエストを送信する方法を説明します。

さまざまな言語のサンプルコードをご覧になりたい場合は、GitHub の [X API v2 sample code](https://github.com/xdevplatform/Twitter-API-v2-sample-code) リポジトリをご参照ください。

<Note>
  ### **前提条件**

  このガイドを完了するには、リクエストを認証するための [keys and tokens](/ja/resources/fundamentals/authentication) 一式が必要です。以下の手順に従って、これらの keys と tokens を生成できます。

  - [開発者アカウントに登録](https://developer.x.com/en/apply-for-access) し、承認を受けます。
  - 開発者ポータルで [Project](/ja/resources/fundamentals/projects) と関連付けられた [developer App](/ja/resources/fundamentals/developer-apps) を作成します。
  - アプリの “Keys and tokens” ページに移動し、必要な認証情報を生成します。すべての認証情報は安全な場所に保存してください。
</Note>

<div id="steps-to-build-a-recent-search-request">
  ### 最新検索リクエストを構築する手順
</div>

**ステップ1：ツールまたはライブラリから始める**

このエンドポイントにリクエストを送信するために使用できるツール、コード例、ライブラリがいくつかありますが、ここではプロセスを簡素化するためにPostmanツールを使用します。

X API v2 Postmanコレクションをお使いの環境に読み込むには、以下のボタンをクリックしてください：

<Button href="https://app.getpostman.com/run-collection/9956214-784efcda-ed4c-4491-a4c0-a26470a67400">
  X API v2をPostmanに追加
</Button>

PostmanにX API v2コレクションが読み込まれたら、Search Posts > Recent searchリクエストに移動してください。

**ステップ2：リクエストを認証する**

X APIに適切にリクエストを送信するには、権限があることを確認する必要があります。このエンドポイントでこれを行うには、[OAuth 2.0 App-Only](/ja/resources/fundamentals/authentication#app-only-authentication-and-oauth-2-0-bearer-token)、[OAuth 2.0（PKCE）](ja/resources/fundamentals/authentication#oauth-2-0-authorization-code-flow-with-pkce-2)、または[OAuth 1.0a User Context](/ja/resources/fundamentals/authentication)認証方法のいずれかでリクエストを認証する必要があります。

簡単にするため、このリクエストではOAuth 2.0 App-Onlyを使用しますが、プライベートな[メトリクス](/ja/x-api/fundamentals/metrics)や投稿をリクエストしたい場合は、他の認証方法のいずれかを使用する必要があります。

OAuth 2.0 App-Onlyを使用するには、キーとトークン、特に[App Access Token](/ja/resources/fundamentals/authentication#using-and-generating-an-app-only-bearer-token)（App-only Bearer Tokenとも呼ばれる）をPostmanに追加する必要があります。これは、Postmanの右上角にある「X API v2」という名前の環境を選択し、「initial value」と「current value」フィールドにキーとトークンを追加することで行えます（環境ドロップダウンの横にある目のアイコンをクリック）。

これを正しく行った場合、これらの変数は自動的にリクエストの認証タブに取り込まれます。

**ステップ3：検索クエリを作成する**

各最新検索クエリには、単一の[検索クエリ](/ja/x-api/posts/search/integrate/build-a-query)が必要です。この例では、@XDevelopersアカウントによって投稿された投稿にマッチするクエリを使用します。このクエリでは、from演算子を使用してXDevelopersに設定します（大文字小文字を区別しません）：

`from:XDevelopers`

Postmanで「Params」タブに移動し、このクエリを`query`パラメータの「Value」列に入力してください。

|     |     |     |
| :--- | :--- | :--- |
| **Key** | **Value** | **Description** |
| `query` | from:XDevelopers | 最新検索エンドポイントに送信する検索クエリ |

**ステップ4：取得したいフィールドを特定し指定する**

ステップ3の後に「Send」ボタンをクリックすると、レスポンスでデフォルトの[投稿オブジェクト](/ja/x-api/fundamentals/data-dictionary#tweet)フィールドを受け取ります：id、text、および`edit_history_tweet_ids`。id、text、および`edit_history_tweet_ids`以外の追加フィールドを受け取りたい場合は、[field](/ja/x-api/fundamentals/fields)および/または[expansion](/ja/x-api/fundamentals/expansions)パラメータを使用してリクエストでそれらのフィールドを指定する必要があります。

この演習では、異なるオブジェクトから4つの異なるフィールドセットをリクエストします：

1. デフォルトの投稿オブジェクトフィールド。
2. プライマリユーザーオブジェクトの追加のtweet.created\_atフィールド。
3. 返された投稿の関連する作成者のユーザーオブジェクトのデフォルトフィールド。
4. 関連するユーザーオブジェクトの追加のuser.descriptionフィールド。

Postmanで「Params」タブに移動し、「Query Params」テーブルに以下のkey:valueペアを追加してください：

|     |     |     |
| :--- | :--- | :--- |
| **Key** | **Value** | **Returned fields** |
| `tweet.fields` | `created_at` | `tweets.created_at` |
| `expansions` | `author_id` | `includes.users.id`, `includes.users.name`, `includes.users.username` |
| `user.fields` | `description` | `includes.users.description` |

「Send」ボタンの横に以下のURLが表示されるはずです：

`https://api.x.com/2/tweets/search/recent?query=from:XDevelopers&tweet.fields=created_at&expansions=author_id&user.fields=created_at`

**ステップ5：リクエストを送信し、レスポンスを確認する**

設定が完了したら「Send」ボタンをクリックすると、次のようなレスポンスが返ってきます：

```
{
   "data": [
       {
           "author_id": "2244994945",
           "created_at": "2020-06-11T16:05:06.000Z",
           "id": "1271111223220809728",
           "text": "Tune in tonight and watch as @jessicagarson takes us through running your favorite Python package in R. 🍿\n\nLearn how to use two powerful programming languages for data science together, and see a live example that uses the recent search endpoint from Twitter’s Developer Labs. https://t.co/v178oUZNuj"
       },
       {
           "author_id": "2244994945",
           "created_at": "2020-06-10T19:25:24.000Z",
           "id": "1270799243071062016",
           "text": "As we work towards building the new Twitter API, we’ve extended the deprecation timeline for several Labs v1 endpoints. Learn more 📖 https://t.co/rRWaJYJgKk"
       },
       {
           "author_id": "2244994945",
           "created_at": "2020-06-09T18:08:47.000Z",
           "id": "1270417572001976322",
           "text": "Annotations help you learn more about a Tweet — they can even help you find topics of interest. 🔬\n\nIn this tutorial, @suhemparack shows us how find Tweets related to COVID-19 using annotations + the filtered stream endpoint.\n\nLearn how you can, too. ⤵️\nhttps://t.co/qwVOgw0zSV"
       }
   ],
   "includes": {
       "users": [
           {
               "description": "The voice of Twitter's #DevRel team, and your official source for updates, news, & events about Twitter's API. \n\n#BlackLivesMatter",
               "id": "2244994945",
               "name": "X Developers",
               "username": "XDevelopers"
           }
       ]
   },
   "meta": {
       "newest_id": "1271111223220809728",
       "oldest_id": "1270417572001976322",
       "result_count": 3
   }
}
```

**次のステップ**

[API Reference でリクエストをカスタマイズする](/ja/x-api/posts/recent-search)

[クエリ演算子の一覧を見る](/ja/x-api/posts/search/integrate/build-a-query "クエリ演算子の一覧を見る")

[これらのエンドポイントのサンプルコードを利用する](https://github.com/xdevplatform/Twitter-API-v2-sample-code "これらのエンドポイントのサンプルコードを利用する")