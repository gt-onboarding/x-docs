---
title: 将帖子与规则匹配
sidebarTitle: 将帖子与规则匹配
---

<div id="matching-returned-posts-to-their-associated-rule">
  ### 将返回的帖子与其关联规则匹配
</div>

过滤流端点允许你通过单个连接设置多个规则。在开始接收流中的帖子之前，你需要创建一个规则来指定你感兴趣的帖子类型。

当你基于多种属性（包括用户属性、地理位置、语言等）来指定匹配帖子的规则时，你可以附加一个标签，以在更高层级区分该规则。标签是为规则提供上下文的有效方式，尤其是在你设置了许多规则的情况下。过滤规则决定哪些帖子活动会通过该连接发送。

如果你需要添加新的过滤规则以捕获不同类型的帖子，或移除现有规则，你的应用可以向 [POST tweets/search/stream/rules](/zh/x-api/posts/filtered-stream#post-2-tweets-search-stream-rules) 端点发送请求来实现。请求发送后，过滤规则会自动更新，变更会直接在数据流中生效，无需重新连接。大多数规则添加会在约 20 秒或更短时间内生效。虽然不太可能，但受外部因素影响（例如网络连接），你可能需要更长时间才能开始接收到匹配的帖子。如果你在列出规则的端点中找不到某条规则，请先确认规则创建请求已成功；你可以通过检查日志中的错误消息来核实。

<div id="matching-rules">
  #### 匹配规则
</div>

当某项活动通过你的过滤流连接送达时，负载中的 matching\_rules 数组会注明与该帖子匹配的过滤器列表。

帖子负载中还包含额外的字符串元数据，其中包括导致该帖子被送达的规则 id 和标签。如果多条规则匹配同一帖子，该活动只会送达一次，但会在上述元数据中包含所有匹配的规则。匹配规则可便捷地将特定帖子与对应规则关联，这在你拥有大量不同规则时尤为有用。由于数据以这种方式通过单一流送达，确保 id 与标签的唯一性对匹配至关重要。

**以下是帖子负载中 “matching\_rules” 数组的示例：**
 

```"matching_rules": [
    {
      "id": "1166916266197536768",
      "tag": "test-rule-tag-00000"
    },
    {
      "id": "1166916266197536769",
      "tag": "test-rule-tag-12345"
    }
  ]
```

<div id="rule-tags">
  #### 规则标签
</div>

在创建时，每条过滤规则都可以带有一个标签。规则标签不具备特殊含义，只是作为随规则携带的不透明字符串处理。它们会包含在返回的活动中的 matching\_rules 元数据里，旨在帮助你在更高层级上更容易区分规则。 

标签为创建过滤规则的逻辑分组提供了一种便捷方式。比如，你可以为某条特定规则生成一个唯一 ID 作为其标签，并允许你的应用在所处理的活动中引用该 ID，从而将结果与特定客户、广告活动、类别或其他相关分组关联起来。

请注意，现有规则的标签无法更新，标签只能在创建规则时指定。若要“更新”或“重命名”标签，你需要先删除该规则，然后使用所需标签重新添加。最佳做法是直接使用唯一标识符作为标签，你的系统可在自身应用内将其与其他各类数据点关联，而无需更改任何规则集内容。

<div id="filtered-stream-recovery-and-redundancy-features">
  ### 过滤流 - 恢复和冗余功能
</div>

<Note>
  注意：这些恢复和冗余功能仅向具有企业级访问权限的用户提供。
</Note>