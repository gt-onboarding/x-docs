---
title: 创建规则
sidebarTitle: 创建规则
---

<div id="building-rules-for-filtered-stream">
  ## 为过滤流构建规则
</div>

过滤流端点会根据应用于流的一组规则，将匹配的帖子传送给你。规则由用于匹配各种帖子属性的运算符组成。

可以使用 [POST /tweets/search/stream/rules](/zh/x-api/posts/filtered-stream#post-2-tweets-search-stream-rules) 端点将多个规则应用到同一条流上。添加规则后，通过 [GET /tweets/search/stream](/zh/x-api/posts/filtered-stream#get-2-tweets-search-stream) 端点连接到你的流时，只有符合你规则的帖子会通过持久的流式连接传送。你无需断开与流的连接即可添加或移除规则。 

<div id="table-of-contents">
  ### 目录
</div>

- [构建规则](#building-a-rule)
  - [规则限制](#rule-limitations)
  - [运算符可用性](#operator-availability)
  - [运算符类型：独立使用与需连用](#operator-types-standalone-and-conjunction-required)
  - [布尔运算符与分组](#boolean-operators-and-grouping)
  - [运算顺序](#order-of-operations)
  - [标点、变音符号与大小写敏感](#punctuation-diacritics-and-case-sensitivity)
  - [特异性与效率](#specificity-and-efficiency)
  - [迭代式构建规则](#iteratively-building-a-rule)
  - [添加与删除规则](#adding-and-removing-rules)
  - [规则示例](#rule-examples)
- [运算符清单](#operators)

<div id="building-a-rule">
  ### 创建规则
</div>

<div id="rule-limitations">
  #### 规则限制
</div>

允许的规则数量取决于应用于你的[项目](/zh/resources/fundamentals/projects)的[访问级别](/zh/x-api/getting-started/about-x-api)。

你可以在[过滤流简介](/zh/x-api/posts/filtered-stream)页面查看这些限制的适用方式。

<div id="operator-types-standalone-and-conjunction-required">
  #### 操作符类型：可独立使用与需合取
</div>

**可独立使用的操作符** 可以单独使用，或与任何其他操作符（包括那些需要与之合取的操作符）一起使用。

例如，以下规则可行，因为它使用了可独立使用的 `#hashtag` 操作符：

`#xapiv2`

**需合取的操作符** 不能在规则中单独使用；只有当规则中至少包含一个可独立使用的操作符时才能使用。原因是单独使用这些操作符范围过于宽泛，会匹配到极大量的帖子。

例如，以下规则不受支持，因为它们仅包含需合取的操作符：

`has:media`

`has:links OR is:retweet`

如果我们加入一个可独立使用的操作符，例如短语 "X data"，该规则就可以正常工作。

`"X data" has:mentions (has:media OR has:links)`

<div id="boolean-operators-and-grouping">
  #### 布尔运算符与分组
</div>

如果你希望在单条规则中串联多个运算符，可以使用以下方式：

|     |     |
| :--- | :--- |
| **AND 逻辑** | 相邻的运算符之间**以空格分隔**将产生布尔 “AND” 逻辑，即只有同时满足两个条件时才会匹配帖子。例如，`snow day #NoSchool` 将匹配同时包含词语 snow 和 day 以及话题标签 #NoSchool 的帖子。 |
| **OR 逻辑** | 相邻的运算符之间以 OR 相连将产生 OR 逻辑，即只要满足任一条件就会匹配帖子。例如，`grumpy OR cat OR #meme` 将匹配包含词语 grumpy 或 cat，或话题标签 #meme 的任意帖子。 |
| **NOT 逻辑（取反）** | 在关键字（或任何运算符）前加上短横线（-）即可取反（NOT）。例如，`cat #meme -grumpy` 将匹配包含话题标签 #meme 且包含词语 cat 的帖子，但前提是不包含词语 grumpy。一个常见的规则子句是 `-is:retweet`，它不会匹配转推，因此只会匹配原始帖子、引用推文和回复。所有运算符都可取反，但被取反的运算符不能单独使用。 |
| **分组** | 你可以使用括号对运算符进行分组。例如，`(grumpy cat) OR (#meme has:images)` 将返回包含词语 grumpy 和 cat 的帖子，或包含图像且带有话题标签 #meme 的帖子。注意：先应用 AND，再应用 OR。 |

<Note>
  **关于取反的说明**

  除 `sample:` 外，所有运算符都可以取反；且 `-is:nullcast` 必须始终以取反形式使用。被取反的运算符不能单独使用。

  不要对一组括号内分组的运算符整体取反。应分别对每个运算符取反。

  例如，不要使用 `skiing -(snow OR day OR noschool)`，建议使用 `skiing -snow -day -noschool`。
</Note>

<div id="order-of-operations">
  #### 运算顺序
</div>

在组合 AND 和 OR 功能时，以下运算顺序将决定规则的评估方式。

1. 先合并由 AND 逻辑连接的运算符
2. 再应用由 OR 逻辑连接的运算符

例如：

- `apple OR iphone ipad` 将被评估为 `apple OR (iphone ipad)`
- `ipad iphone OR android` 将被评估为 `(iphone ipad) OR android`

为消除歧义并确保规则按预期进行评估，请在适当位置使用括号将术语分组。

例如：

- `(apple OR iphone) ipad`
- `iphone (ipad OR android)`

<div id="punctuation-diacritics-and-case-sensitivity">
  #### 标点、变音符号与大小写敏感性
</div>

如果你为关键词或话题标签指定了包含重音或变音符号的规则，它只会匹配包含该带有正确重音或变音符号的精确单词的帖子，而不会匹配虽然字母相同但缺少这些重音或变音符号的帖子。 

例如，包含关键词 `diacrítica` 或话题标签 `#cumpleaños` 的规则将匹配包含 _diacrítica_ 或 _#cumpleaños_ 的帖子，因为它们包含重音或变音符号。但是，这些规则不会匹配包含 _Diacritica_ 或 _#cumpleanos_（缺少 í 上的重音或字母 ñ）的帖子。

带有重音或变音符号的字符与普通字符同等处理，不被视为词边界。例如，带有关键词 _cumpleaños_ 的规则只会匹配包含单词 _cumpleaños_ 的帖子，而不会匹配包含 _cumplea_、_cumplean_ 或 _os_ 的帖子。

所有运算符均以不区分大小写的方式进行评估。例如，规则 cat 将匹配以下所有内容：_cat_、_CAT_、_Cat_。

<Note>
  [搜索帖子](/zh/x-api/posts/search/introduction) 的匹配行为与过滤流不同。当[构建搜索帖子查询](/zh/x-api/posts/search/integrate/build-a-query)时，请注意，包含重音或变音符号的关键词和话题标签将同时匹配带有重音或变音符号的术语，以及对应的普通字符形式。 

  例如，包含关键词 `Diacrítica` 或话题标签 `#cumpleaños` 的搜索帖子查询将同时匹配 _Diacrítica_ 和 _#cumpleaños_，以及不带 í 重音或字母 ñ 的 _Diacritica_ 或 _#cumpleanos_。
</Note>

<div id="specificity-and-efficiency">
  #### 具体性与效率
</div>

开始构建规则时，请牢记以下要点。

- 通常不建议在规则中使用宽泛的独立运算符（例如单个关键词或 #hashtag），因为这往往会匹配到海量帖子。编写更健壮的规则可得到更精准的匹配结果，并有望减少有效载荷中的噪声，从而降低为获取有价值洞见所需的筛选工作量。
  - 例如，如果你的规则只是关键词 `happy`，每天可能会获得 200,000–300,000 条帖子。
  - 添加更多条件运算符可缩小搜索范围，例如 `(happy OR happiness) place_country:GB -birthday -is:retweet`
- 编写高效的规则还有助于遵守规则字符长度限制。字符计数包含整个规则字符串（包括空格和运算符）。
  - 例如，以下规则长度为 59 个字符：`(happy OR happiness) place_country:GB -birthday -is:retweet`

<div id="quote-tweet-matching-behavior">
  #### 引用推文的匹配行为
</div>

在使用过滤流端点时，运算符既会匹配被引用的原始帖子的内容，也会匹配引用推文本身的内容。

但请注意，[Search Posts](/zh/x-api/posts/search/introduction) 端点不会匹配被引用的原始帖子的内容，但会匹配引用推文的内容。

<div id="iteratively-building-a-rule">
  #### 迭代构建规则
</div>

<div id="test-your-rule-early-and-often">
  ##### 尽早并频繁地测试你的规则
</div>

第一次就让规则返回“正确”的结果并不常见。X 上的内容极为庞杂，许多细节起初可能并不明显，而上文所述的规则语法也可能难以与期望的搜索精确匹配。在构建规则时，定期使用流式端点进行测试以查看其返回的数据至关重要。你也可以使用任一 [Search Post](/zh/x-api/posts/search/introduction) 端点进行测试，前提是你使用的运算符在该端点同样受支持。

在本节中，我们将从以下规则开始，并根据测试过程中得到的结果进行调整：

`happy OR happiness`

<div id="use-results-to-narrow-the-rule">
  ##### 使用结果来收窄规则
</div>

在测试规则时，你应当浏览返回的帖子，确认它们是否包含你期望接收的数据。先从较宽的规则入手，获取更大的匹配集合，便于先审阅结果，再据此收窄规则以过滤掉不需要的内容。  

当我们测试示例规则时，注意到返回了多种语言的帖子。在这种情况下，我们只想接收英文帖子，因此将添加 `lang:` 运算符：

`(happy OR happiness) lang:en`

测试结果里有不少祝别人生日快乐的帖子，因此我们将添加 `-birthday` 作为取反的关键词运算符。我们还只想接收原创帖子，所以会添加取反的 `-is:retweet` 运算符：

`(happy OR happiness) lang:en -birthday -is:retweet`

<div id="adjust-for-inclusion-where-needed">
  ##### 在需要时调整以包含更多结果
</div>

如果你发现未收到预期的数据，并且确定存在应当返回的帖子，可能需要通过移除会过滤掉目标数据的运算符来放宽规则。

在我们的示例中，我们注意到个人时间线上还有其他表达我们所寻找情绪的帖子，但未包含在测试结果中。为确保更高的覆盖范围，我们将添加关键词 `excited` 和 `elated`。

`(happy OR happiness OR excited OR elated) lang:en -birthday -is:retweet`

<div id="adjust-for-popular-trendsbursts-over-the-time-period">
  ##### 在该时间段内针对流行趋势/突发热点进行调整
</div>

趋势在 X 上变化很快。维护规则应是一个持续的过程。如果你打算在一段时间内使用同一条规则，建议定期查看收到的数据，以判断是否需要做出调整。

在我们的示例中，我们注意到开始收到一些祝人们“节日快乐”的帖子。由于我们不希望这些帖子包含在结果中，我们将添加一个取反的 `-holidays` 关键字。

`(happy OR happiness OR excited OR elated) lang:en -birthday -is:retweet -holidays`

<div id="adding-and-removing-rules">
  #### 添加与移除规则
</div>

当你在流中添加或删除规则时，应使用 [POST /2/tweets/search/stream/rules](/zh/x-api/posts/filtered-stream#post-2-tweets-search-stream-rules) 端点。

要向流中添加一个或多个规则，请提交 `add` JSON 正文，其中包含一个数组；数组元素需包含带有规则的 value 参数，以及可选的 `tag` 参数。`tag` 可为任意文本，用于[标识哪些返回的帖子匹配该规则](/zh/x-api/posts/filtered-stream#matching-returned-posts-to-their-associated-rule)。

例如，如果你要向流中添加一组规则，cURL 命令可能如下所示：

```bash
curl -X POST 'https://api.x.com/2/tweets/search/stream/rules' \
-H "Content-type: application/json" \
-H "Authorization: Bearer $ACCESS_TOKEN" -d \
'{
  "add": [
    {"value": "cat has:media", "tag": "cats with media"},
    {"value": "cat has:media -grumpy", "tag": "happy cats with media"},
    {"value": "meme", "tag": "funny things"},
    {"value": "meme has:images"}
  ]
}'
```

同样地，要从流中移除一个或多个规则，请提交 `delete` JSON 正文，其中包含一个带有 `ids` 的数组，数组内为你希望删除的规则 ID。

例如，如果你要从流中移除一组规则，cURL 命令可能如下所示：

```bash
curl -X POST 'https://api.x.com/2/tweets/search/stream/rules' \
  -H "Content-type: application/json" \
  -H "Authorization: Bearer $ACCESS_TOKEN" -d \
  '{
    "delete": {
      "ids": [
        "1165037377523306498",
        "1165037377523306499"
      ]
    }
  }'
```

我们提供了多种语言的示例代码，可在我们的 [GitHub](https://github.com/xdevplatform/Twitter-API-v2-sample-code/tree/master/Filtered-Stream) 获取。 

<div id="rule-examples">
  #### 规则示例
</div>

<div id="tracking-a-natural-disaster">
  ##### 追踪自然灾害
</div>

以下规则可匹配来自气象机构和水文测站、讨论 2017 年袭击休斯顿的飓风 Harvey 的帖子。请注意使用了[匹配规则](/zh/x-api/posts/filtered-stream#matching-returned-posts-to-their-associated-rule)标签，以及在向[POST /2/tweets/search/stream/rules 端点](/zh/x-api/posts/filtered-stream#post-2-tweets-search-stream-rules)提交规则时所需的 JSON 格式。

```json
{
    "value": "-is:retweet has:geo (from:NWSNHC OR from:NHC_Atlantic OR from:NWSHouston OR from:NWSSanAntonio OR from:USGS_TexasRain OR from:USGS_TexasFlood OR from:JeffLindner1)",
    "tag": "theme:info has:geo original from weather agencies and gauges"
}
```

<div id="reviewing-the-sentiment-of-a-conversation">
  ##### 审阅对话的情感倾向
</div>

下一个规则可用于更好地理解围绕话题标签 _#nowplaying_ 展开的对话情感，但仅限于在北美发布的帖子。

```json
{
    "value": "#nowplaying (happy OR exciting OR excited OR favorite OR fav OR amazing OR lovely OR incredible) (place_country:US OR place_country:MX OR place_country:CA) -horrible -worst -sucks -bad -disappointing",
    "tag": "#nowplaying positive"
},
{
    "value": "#nowplaying (horrible OR worst OR sucks OR bad OR disappointing) (place_country:US OR place_country:MX OR place_country:CA) -happy -exciting -excited -favorite -fav -amazing -lovely -incredible",
    "tag": "#nowplaying negative"
}
```

<div id="find-posts-that-relate-to-a-specific-post-annotation">
  ##### 查找与特定帖子标注相关的帖子
</div>

此规则用于搜索包含非猫类宠物图片且帖子识别语言为日语的原始帖子。为此，我们使用 `context:` 运算符来利用[帖子标注](/zh/x-api/fundamentals/post-annotations)功能。我们首先调用[帖子查询](/zh/x-api/posts/lookup/introduction)端点，并通过 `tweet.fields=context_annotations` 字段参数来确定在查询中需要使用的 domain.entity ID：

- 与猫相关的帖子返回 `domain` 66（兴趣与爱好类别），对应 `entity` 852262932607926273（猫）。
- 与宠物相关的帖子返回 `domain` 65（兴趣与爱好垂直），对应 `entity` 852262932607926273（宠物）。

以下是该规则的示例：

```json
{
    "value": "context:65.852262932607926273 -context:66.852262932607926273 -is:retweet has:images lang:ja",
    "tag": "Japanese pets with images - no cats"
}
```

<div id="operators">
  ### 运算符
</div>

<Note>**注意：** 某些运算符提供了替代名称（别名）。</Note>

| **运算符**                    | **类型**           | **说明**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|:------------------------------|:-------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `keyword`                     | 独立使用           | 匹配帖子正文中的关键词。此为基于分词的匹配，即你的关键词字符串将与帖子正文的分词文本进行比对。分词会根据标点、符号以及 Unicode 基本平面中的分隔字符来拆分词语。<br />例如，文本为“I like coca-cola”的帖子会被拆分为以下词元：I、like、coca、cola。随后这些词元会与规则中使用的关键词字符串进行比较。若要匹配包含标点（例如 coca-cola）、符号或分隔字符的字符串，必须将关键词用双引号包裹。<br /><br />示例：`pepsi OR cola OR "coca cola"`                                                                                                                                                                                                                                                                        |
| `emoji`                       | 独立使用           | 匹配帖子正文中的表情符号。与关键词类似，表情符号的匹配也是基于分词，即你的表情符号将与帖子正文的分词文本进行比对。<br /><br />请注意，如果某个表情符号存在变体，必须用双引号包裹后再添加到规则中。<br /><br />示例：`(😃 OR 😡) 😬`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| `"exact phrase match"`        | 独立使用           | 匹配帖子正文中的完整短语。<br /><br />示例：`("X API" OR #v2) -"filtered stream"`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| `#`                           | 独立使用           | 匹配包含已识别话题标签的任何帖子（前提是该话题标签在帖子中被识别为实体）。<br /><br />此运算符执行精确匹配（非分词匹配），这意味着规则 `#thanku` 将匹配包含完全相同话题标签 #thanku 的帖子，但不会匹配包含话题标签 #thankunext 的帖子。<br /><br />示例：`#thankunext #fanart OR @arianagrande`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| `@`                           | 独立使用           | 匹配提及指定用户名的任何帖子（包括 @ 字符在内，且该用户名被识别为实体）。<br /><br />示例：`(@XDevelopers OR @api) -@x`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `$`                           | 独立使用           | 匹配包含指定“现金标签（cashtag）”的任何帖子（其词元的首字符为 $）。<br /><br />请注意，现金标签运算符依赖 X 的“symbols”实体抽取来匹配现金标签，而不是尝试直接从正文中抽取。<br /><br />示例：`$twtr OR @XDevelopers -$fb`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| `from:`                       | 独立使用           | 匹配来自特定用户的任何帖子。<br />取值可以是用户名（不含 @ 字符）或该用户的数字用户 ID。<br /><br />每个 `from:` 运算符只能传入一个用户名/ID。<br /><br />示例：`from:XDevelopers OR from:api -from:X`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| `to:`                         | 独立使用           | 匹配回复给特定用户的任何帖子。<br />取值可以是用户名（不含 @ 字符）或该用户的数字用户 ID。<br /><br />每个 `to:` 运算符只能传入一个用户名/ID。<br /><br />示例：`to:XDevelopers OR to:api -to:x`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| `url:`                        | 独立使用         | 对帖子中任何格式合法的 URL 执行分词匹配。<br /><br />此运算符可匹配 `url` 或 `expanded_url` 字段的内容。例如，包含 “You should check out X Developer Labs: https://t.co/c0A36SWil4”（该短链接会重定向到 https://developer.x.com） 的帖子将匹配以下两条规则：<br /><br />`from:XDevelopers url:"https://developer.x.com"`<br />（因为它会匹配 `entities.urls.expanded_url` 的内容）<br /><br />`from:XDevelopers url:"https://t.co"`<br />（因为它会匹配 `entities.urls.url` 的内容）<br /><br />包含标点或特殊字符的词元或短语应使用双引号括起（例如，`url:"/developer"`）。同样地，如需匹配特定协议，也请使用双引号括起（例如，`url:"https://developer.x.com"`）。<br /><br />每个 `url:` 运算符只能传入一个 URL。                                                                                                                                                                                                                                                  |
| `retweets_of:`                | 独立使用         | 可用别名：`retweets_of_user:`<br />匹配为指定用户的转帖。取值可以是用户名（不含 @ 字符）或该用户的数字用户 ID。<br /><br />每个 `retweets_of:` 运算符只能传入一个用户名/ID。<br /><br />示例：`retweets_of:XDevelopers OR retweets_of:twitterapi`<br />参见[此处](/zh/x-api/users/lookup/introduction)了解查询 X 账号数字 ID 的方法。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `context:`                    | 独立使用         | 匹配具有特定域 ID 和/或 域 ID、实体 ID 组合的帖子，其中 \* 表示通配符。要了解此运算符的更多信息，请访问我们的[帖子注释](/zh/x-api/fundamentals/post-annotations)页面。<br /><br />每个 `context:` 运算符只能传入一个域/实体。<br /><br />`context:domain_id.entity_id`<br />`context:domain_id.*`<br />`context:*.entity_id`<br /><br />示例：<br />`context:10.799022225751871488`<br />（`domain_id.entity_id` 返回匹配该特定域-实体对的帖子）<br /><br />`context:47.*`<br />（`domain_id.*` 返回匹配该域 ID 的帖子，域-实体对不限）<br /><br />`context:*.799022225751871488`<br />（`*.entity_id` 返回匹配该实体 ID 的帖子，域-实体对不限）                                                                                                                                                                                                                                                        |
| `entity:`                     | 独立使用         | 匹配具有特定实体字符串值的帖子。要了解此运算符的更多信息，请访问我们的[注释](/zh/x-api/fundamentals/post-annotations)页面。<br /><br />每个 `entity:` 运算符只能传入一个实体。<br /><br />`entity:"string declaration of entity/place"`<br /><br />示例：`entity:"Michael Jordan" OR entity:"Barcelona"`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| `conversation_id:`            | 独立使用         | 匹配共享同一会话 ID 的帖子。会话 ID 被设置为开启该会话的帖子的帖子 ID。随着对某条帖子的回复（包括对回复的回复）发布，`conversation_id` 会被加入其 JSON 载荷中。<br /><br />每个 `conversation_id:` 运算符只能传入一个会话 ID。<br /><br />示例：`conversation_id:1334987486343299072 (from:XDevelopers OR from:api)`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| `bio:`                        | 独立使用         | 可用别名：`user_bio:`<br />匹配帖子发布者个人简介中的关键词或短语。这是在 [User 对象](/zh/x-api/fundamentals/data-dictionary#user) 的 `description` 字段内容中进行的分词匹配。<br /><br />示例：`bio:developer OR bio:"data engineer" OR bio:academic`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| `bio_name:`                   | 独立使用         | 匹配帖子发布者用户简介名称中的关键词。这是在 [User 对象](/zh/x-api/fundamentals/data-dictionary#user) 的 “name” 字段内容中进行的分词匹配。<br /><br />示例：`bio_name:phd OR bio_name:md`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `bio_location:`               | 独立使用         | _可用别名：_ `user_bio_location:`<br />匹配由“所在地”包含指定关键词或短语的用户发布的帖子。该运算符执行分词匹配，类似于对消息正文的常规关键词规则。<br /><br />此“所在地”字段属于[用户对象](/zh/x-api/fundamentals/data-dictionary#user)，匹配的是 location 字段，是非规范化、由用户生成的自由格式字符串。它也不同于帖子的地理位置（参见 `place:`）。<br /><br />示例：`bio_location:"big apple" OR bio_location:nyc OR bio_location:manhattan`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| `place:`                      | 独立使用         | 匹配带有指定地理位置或 X 地点 ID 的帖子。多词地点名称（“New York City”“Palo Alto”）应使用引号括起。<br /><br />每个 `place:` 运算符只能传入一个地点。<br /><br />注意：如何获取 X 地点 ID，参见标准 v1.1 端点 [GET geo/search](https://developer.x.com/content/developer-twitter/en/docs/geo/places-near-location/api-reference/get-geo-search)。<br /><br />注意：此运算符不会匹配转帖（Retweet），因为转帖的地点附加在原始帖子上。它也不会匹配引用帖所引用原帖所附的地点。<br /><br />示例：`place:"new york city" OR place:seattle OR place:fd70c22040963ac7`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| `place_country:`              | 独立使用         | 匹配与标注地点/位置关联的国家/地区代码与给定 ISO alpha-2 字符代码相同的帖子。<br /><br />有效 ISO 代码列表参见 [维基百科](http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2)。<br /><br />每个 `place_country:` 运算符只能传入一个 ISO 代码。<br /><br />注意：此运算符不会匹配转帖（Retweet），因为转帖的地点附加在原始帖子上。它也不会匹配引用帖所引用原帖所附的地点。<br /><br />示例：`place_country:US OR place_country:MX OR place_country:CA`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| `point_radius:`               | 独立使用         | 当存在时，匹配帖子的 `place.geo.coordinates` 对象；在 X 中，还会匹配地点的地理多边形，要求该地点多边形完全包含在定义的区域内。<br /><br />`point_radius:[longitude latitude radius]`<br /><br />- 支持的半径单位为英里（mi）和千米（km）<br />- 半径必须小于 25mi<br />- 经度范围为 ±180<br />- 纬度范围为 ±90<br />- 坐标均为十进制度<br />- 规则参数置于方括号内，以空格分隔<br /><br />每个 `point_radius:` 运算符只能传入一个地理多边形。<br /><br />注意：此运算符不会匹配转帖（Retweet），因为转帖的地点附加在原始帖子上。它也不会匹配引用帖所引用原帖所附的地点。<br /><br />示例：`point_radius:[2.355128 48.861118 16km] OR point_radius:[-41.287336 174.761070 20mi]`                                                                                                                                                                                                                        |
| `bounding_box:`               | 独立使用         | 可用别名：`geo_bounding_box:`<br />在存在时，匹配帖子中的 place.geo.coordinates 对象；在 X 中，匹配地点的地理多边形，要求该地点多边形完全落在所定义的区域内。<br /><br />`bounding_box:[west_long south_lat east_long north_lat]`<br /><br />- `west_long south_lat` 表示边界框的西南角，其中 `west_long` 为该点的经度，`south_lat` 为该点的纬度。<br />- `east_long north_lat` 表示边界框的东北角，其中 `east_long` 为该点的经度，`north_lat` 为该点的纬度。<br />- 边界框的宽和高必须小于 25 英里<br />- 经度范围为 ±180<br />- 纬度范围为 ±90<br />- 所有坐标均为十进制度数。<br />- 规则参数置于方括号内，使用空格分隔。<br /><br />每个 `bounding_box:` 运算符只能传入一个地理多边形。<br /><br />注意：此运算符不会匹配转推，因为转推的地点信息附加在原帖上。它也不会匹配附加在被引用原帖上的地点信息。<br /><br />示例：`bounding_box:[-105.301758 39.964069 -105.178505 40.09455]` |
| `is:retweet`                  | 需与其他条件合用 | 匹配符合所设规则其余部分的转推。此运算符仅查找真正的转推（例如使用“转推”按钮生成的）。引用帖不会被此运算符匹配。<br /><br />示例：`data @XDevelopers -is:retweet` |
| `is:reply`                    | 需与其他条件合用 | 仅投递与规则匹配的显式回复。也可取反以从投递中排除匹配规则的回复。<br /><br />与过滤流一起使用时，此运算符可匹配对原帖的回复、引用帖中的回复以及转推中的回复。<br /><br />示例：`from:XDevelopers is:reply` |
| `is:quote`                    | 需与其他条件合用 | 返回所有引用帖（也称为带评论的帖子）。<br /><br />示例：`"sentiment analysis" is:quote` |
| `is:verified`                 | 需与其他条件合用 | 仅投递作者已通过 X 认证的帖子。<br /><br />示例：`#nowplaying is:verified` |
| `-is:nullcast`                | 需与其他条件合用 | 移除仅为投放推广而在 ads.twitter.com 上创建，且 `source:"Twitter for Advertisers (legacy)"` 或 `source:"Twitter for Advertisers"` 的帖子。<br />此运算符必须使用否定形式。<br /><br />有关 Nullcast 帖子的更多信息，请参阅我们的[帖子可用性](https://developer.x.com/content/developer-twitter/en/docs/twitter-api/v1/tweets/post-and-engage/guides/tweet-availability)页面。<br /><br />示例：`"mobile games" -is:nullcast` |
| `has:hashtags`                | 需与其他条件合用 | 匹配至少包含一个话题标签的帖子。<br /><br />示例：`from:XDevelopers -has:hashtags` |
| `has:cashtags`                | 需与其他条件合用 | 匹配包含股票代码标签（以“$”开头，例如 `$tag`）的帖子。<br /><br />示例：`#stonks has:cashtags` |
| `has:links`                   | 需与其他条件合用 | 匹配正文中包含链接或媒体的帖子。<br /><br />示例：`from:XDevelopers announcement has:links` |
| `has:mentions`                | 需与其他条件合用 | 匹配提及其他 X 用户的帖子。<br /><br />示例：`#nowplaying has:mentions` |
| `has:media`                   | 需要与其他条件合用 | _可用别名：_ `has:media_link`<br />匹配包含媒体对象（由 X 判定，如照片、GIF 或视频）的帖子。不匹配使用 Periscope 创建的媒体，或带有指向其他媒体托管站点链接的帖子。<br /><br />示例：`(kittens OR puppies) has:media`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| `has:images`                  | 需要与其他条件合用 | 匹配包含可识别图像 URL 的帖子。<br /><br />示例：`#meme has:images`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| `has:video_link`              | 需要与其他条件合用 | _可用别名：_ `has:videos`<br />匹配包含原生 X 视频（直接上传到 X）的帖子。不匹配使用 Periscope 创建的视频，或带有指向其他视频托管站点链接的帖子。<br /><br />示例：`#icebucketchallenge has:video_link`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| `has:geo`                     | 需要与其他条件合用 | 匹配包含由 X 用户提供的、特定于帖子的地理位置信息的帖子。可表现为 X 地点（包含相应显示名称、地理多边形及其他字段），或在少数情况下为经纬度坐标。<br /><br />注意：基于地点（帖子地理信息）匹配的运算符仅包含来自原始帖子的匹配结果。转发不包含任何地点数据。<br /><br />示例：`recommend #paris has:geo -bakery`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| `sample:`                     | 需要与其他条件合用 | 返回与规则匹配的帖子中的随机百分比样本，而非全部帖子。百分比值必须为 1 到 100 的整数（例如，`sample:10` 将返回随机 10% 的样本）。<br /><br />该运算符会先将流的范围缩小到你指定的百分比，然后再将规则/过滤器应用于该抽样子集。换句话说，如果你使用 `sample:10`，每条帖子有 10% 的概率被抽样。<br /><br />此运算符作用于整条规则，并要求所有用 OR 连接的项分组。<br /><br />示例：`#nowplaying @spotify sample:15`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| `lang:`                       | 需要与其他条件配合使用 | 匹配被 X 归类为特定语言的帖子（且仅在该帖子已被归类时匹配）。需要注意，目前每条帖子仅会被判定为一种语言，因此将多个语言用 AND 组合查询将不会返回任何结果。<br /><br />每个 `lang:` 运算符只能传入一个 BCP 47 语言标识符。<br /><br />注意：若无法进行语言分类，返回的结果为 “und”（未定义）。<br /><br />示例：`recommend #paris lang:en`<br /><br />下表列出了当前支持的语言及其对应的 BCP 47 语言标识符：<br /><br />| 语言         | BCP 47 |<br />|-|-|<br />| 阿姆哈拉语          | `am`   |<br />| 阿拉伯语           | `ar`   |<br />| 亚美尼亚语         | `hy`   |<br />| 巴斯克语           | `eu`   |<br />| 孟加拉语           | `bn`   |<br />| 波斯尼亚语         | `bs`   |<br />| 保加利亚语        | `bg`   |<br />| 缅甸语          | `my`   |<br />| 克罗地亚语         | `hr`   |<br />| 加泰罗尼亚语          | `ca`   |<br />| 捷克语            | `cs`   |<br />| 丹麦语           | `da`   |<br />| 荷兰语           | `nl`   |<br />| 英语          | `en`   |<br />| 爱沙尼亚语         | `et`   |<br />| 芬兰语          | `fi`   |<br />| 法语           | `fr`   |<br />| 格鲁吉亚语         | `ka`   |<br />| 德语           | `de`   |<br />| 希腊语            | `el`   |<br />| 古吉拉特语         | `gu`   |<br />| 海地克里奥尔语   | `ht`   |<br />| 希伯来语           | `iw`   |<br />| 印地语            | `hi`   |<br />| 拉丁化印地语  | `hi-Latn` |<br />| 匈牙利语        | `hu`   |<br />| 冰岛语        | `is`   |<br />| 印度尼西亚语       | `in`   |<br />| 意大利语          | `it`   |<br />| 日语         | `ja`   |<br />| 卡纳达语          | `kn`   |<br />| 高棉语            | `km`   |<br />| 韩语           | `ko`   |<br />| 老挝语              | `lo`   |<br />| 拉脱维亚语       | `lv`   |<br />| 立陶宛语       | `lt`   |<br />| 马拉雅拉姆语        | `ml`   |<br />| 迪维希语        | `dv`   |<br />| 马拉地语          | `mr`   |<br />| 尼泊尔语           | `ne`   |<br />| 挪威语        | `no`   |<br />| 奥里亚语            | `or`   |<br />| 旁遮普语          | `pa`   |<br />| 普什图语           | `ps`   |<br />| 波斯语          | `fa`   |<br />| 波兰语           | `pl`   |<br />| 葡萄牙语       | `pt`   |<br />| 罗马尼亚语         | `ro`   |<br />| 俄语          | `ru`   |<br />| 塞尔维亚语          | `sr`   |<br />| 简体中文 | `zh-CN` |<br />| 信德语           | `sd`   |<br />| 僧伽罗语          | `si`   |<br />| 斯洛伐克语          | `sk`   |<br />| 斯洛文尼亚语        | `sl`   |<br />| 索拉尼库尔德语   | `ckb`  |<br />| 西班牙语          | `es`   |<br />| 瑞典语          | `sv`   |<br />| 他加禄语          | `tl`   |<br />| 泰米尔语            | `ta`   |<br />| 泰卢固语           | `te`   |<br />| 泰语             | `th`   |<br />| 藏语          | `bo`   |<br />| 繁体中文 | `zh-TW` |<br />| 土耳其语          | `tr`   |<br />| 乌克兰语        | `uk`   |<br />| 乌尔都语             | `ur`   |<br />| 维吾尔语           | `ug`   |<br />| 越南语       | `vi`   |<br />| 威尔士语            | `cy`   | |
| `followers_count:`            |                  | 当作者的关注者数量在给定范围内时匹配帖子。<br />如果只指定一个数字，将匹配任何大于或等于该数字的数量。<br /><br />示例：`followers_count:500`<br /><br />此外，还可以指定一个范围，以匹配该范围内的任何数值。<br /><br />示例：`followers_count:1000..10000`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| `tweets_count:`               |                  | _可用别名：_ `statuses_count:`<br />当作者发布的帖子数量落在给定范围内时匹配帖子。<br />如果只指定一个数字，将匹配任何大于或等于该数字的数量。<br /><br />示例：`tweets_count:1000`<br /><br />此外，还可以指定一个范围，以匹配该范围内的任何数值。<br /><br />示例：`tweets_count:1000..10000`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| `following_count:`            |                  | _可用别名：_ `friends_count:`<br />当作者的关注数（其关注的用户数量）落在给定范围内时匹配帖子。<br />如果只指定一个数字，将匹配任何大于或等于该数字的数量。<br /><br />示例：`following_count:500`<br /><br />此外，还可以指定一个范围，以匹配该范围内的任何数值。<br /><br />示例：`following_count:1000..10000`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `listed_count:`               |                  | _可用别名：_ `user_in_lists_count:`<br />当作者被包含在指定数量的列表中时匹配帖子。<br />如果只指定一个数字，将匹配任何大于或等于该数字的数量。<br /><br />示例：`listed_count:10`<br /><br />此外，还可以指定一个范围，以匹配该范围内的任何数值。<br /><br />示例：`listed_count:10..100`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| `url_title:`                  |                  | _可用别名：_ `within_url_title:`<br />在展开后的 URL 的 HTML 标题元数据上执行关键词/短语匹配。<br /><br />示例：`url_title:snow`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| `url_description:`            |                  | _可用别名：_ `within_url_description:`<br />在展开后的页面描述元数据上执行关键词/短语匹配。<br /><br />示例：`url_description:weather`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `url_contains:`               |                  | 匹配包含给定短语或关键词的 URL 的帖子。要搜索包含标点的模式（例如 google.com），请将搜索词用引号括起来。<br />注意：这也会匹配展开后的 URL。<br /><br />示例：`url_contains:photos`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| `source:`                     |                  | 匹配由指定来源应用生成的任何帖子。取值必须是应用名称或应用的 URL。不可单独使用。<br /><br />示例：`source:"X for iPhone"`<br /><br />注意：作为 X 应用开发者，由你的应用以编程方式创建的帖子，其来源将设置为你的应用名称和网站 URL，可在[应用设置](/zh/resources/fundamentals/developer-apps#app-management)中配置。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| `in_reply_to_tweet_id:`       |                  | _可用别名：_ `in_reply_to_status_id:`<br />仅投放对指定帖子的显式回复。<br /><br />示例：`in_reply_to_tweet_id:1539382664746020864`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| `retweets_of_tweet_id:`       |                  | _可用别名：_ `retweets_of_status_id:`<br />仅投放对指定帖子的显式（原生）转发。请注意，所用状态 ID 应为原始帖子的 ID，而非转发帖。<br /><br />示例：`retweets_of_tweet_id:1539382664746020864`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |