---
title: 从 v1 迁移到 v2
sidebarTitle: 从 v1 迁移到 v2
---

import { Button } from '/snippets/zh/button.mdx';

<div id="standard-v11-timelines-to-x-api-v2-timelines">
  ## 标准版 v1.1 时间线到 X API v2 时间线
</div>

如果你一直在使用 v1.1 时间线端点（statuses/user\_timeline 和 statuses/mentions\_timeline），本指南旨在帮助你了解标准版与 X API v2 时间线端点之间的相同点与差异，从而将你当前的集成迁移到新版本。

- **相同点：**
  - 身份验证：
    - OAuth 1.0a 用户上下文（倒序的主页时间线、用户帖子时间线和用户提及时间线）
    - OAuth 2.0 仅应用（用户帖子时间线）
  - 历史访问限制：用户时间线（用户帖子时间线）可访问最近的 3200 条帖子；提及时间线（用户提及时间线）可访问最近的 800 条提及。
  - 支持帖子编辑历史与元数据
  - 速率限制（用户帖子时间线）
  - 刷新轮询：可基于 since\_id 获取新增结果
  - 通过帖子 ID 遍历时间线
  - 结果规范：
    - 排序：按时间倒序返回
    - 可排除回复（仅限用户帖子时间线）
    - 可排除转帖（Retweet）（仅限用户帖子时间线）
- **差异点**
  - 新增身份验证能力： 
    - OAuth 2.0 仅应用（用户提及时间线）
    - OAuth 2.0 授权码流程（含 PKCE）（倒序的主页时间线、用户帖子时间线和用户提及时间线）
  - 访问要求：X API v2 应用与项目要求
  - 速率限制（用户提及时间线与倒序的主页时间线）
  - 不同的请求上限与数据量上限
  - 额外的分页方式
    - 每个响应的 max\_results（count）不同
  - 响应数据格式
  - 请求参数
    - 基于请求参数的自定义数据格式，包括 v2 字段与扩展
    - 额外可用数据：指标、帖子注释、投票

<div id="similarities">
  ### 相似点
</div>

**身份验证**

v1.1 的 statuses/user\_timeline 和 X API v2 的用户帖子时间线端点均支持 [OAuth 1.0a 用户上下文](/zh/resources/fundamentals/authentication) 和 [OAuth 2.0 仅应用](/zh/resources/fundamentals/authentication#bearer-token-also-known-as-app-only)。因此，如果你迁移到 X API v2，可以继续使用相同的身份验证方式和授权令牌。

**历史访问**

v1.1 的 statuses/user\_timeline 和 X API v2 的用户帖子时间线端点均会返回最近 3200 条帖子（包含转发）。

v1.1 的 statuses/mentions\_timeline 和 X API v2 的用户提及时间线端点可以返回最近 800 条帖子。

**对帖子编辑历史与元数据的支持**

两个版本都提供描述编辑历史的元数据。请参阅 [过滤流 API 参考](/zh/x-api/posts/filtered-stream#api-reference-index) 和 [编辑帖子基础](/zh/x-api/fundamentals/edit-posts) 了解更多详情。 

**速率限制**

|     |     |
| :--- | :--- |
| **Standard v1.1** | **X API v2** |
| user\_timeline：<br /><br />使用 OAuth 1.0a 用户上下文每 15 分钟 900 次请求<br /><br />使用 OAuth 2.0 仅应用每 15 分钟 1500 次请求 | 用户帖子时间线：<br /><br />使用 OAuth 1.0a 用户上下文每 15 分钟窗口 900 次请求<br /><br />使用 OAuth 2.0 仅应用每 15 分钟窗口 1500 次请求 |

**使用 since\_id 的刷新轮询**

两个版本都支持使用 since\_id 轮询获取最新结果。

**按帖子 ID 遍历时间线**

这两个端点都可以基于帖子 ID 的构造方式，利用帖子 ID 的“时间戳”在时间线中遍历。除以下差异外，功能基本相同： 

|     |     |
| :--- | :--- |
| **Standard timelines v1.1** | **timelines v2** |
| since\_id（不包含）<br /><br />max\_id（包含） | since\_id（不包含）<br /><br />until\_id（也不包含；相比之下 max\_id 为包含） |

**响应过滤参数**

|     |     |
| :--- | :--- |
| **Standard timelines v1.1** | **timelines v2** |
| 响应过滤参数：<br /><br />\* include\_rts<br />\* exclude\_replies | 响应过滤参数：<br /><br />\* exclude=retweets,replies |
| 示例：<br /><br />https://api.x.com/1.1/statuses/user\_timeline.json?user\_id=2244994945\&include\_rts=0\&exclude\_replies=1 | 示例：<br /><br />https://api.x.com/2/users/2244994945/tweets?max\_results=100\&exclude=retweets,replies |
| 备注：<br /><br />对于 user\_timeline：<br /><br />\* 使用 include\_rts=0 不会改变可返回的历史上限（最近 3200 条） | 备注：<br /><br />对于用户帖子时间线：<br /><br />\* 使用 exclude=retweets 不会改变可返回的历史上限（最近 3200 条）<br />\* 使用 exclude=replies 会将可返回的历史上限降低为最近 800 条回复 |

<div id="differences">
  ### 差异
</div>

**身份验证**

**v1.1 的 statuses/mentions\_timeline 端点仅支持 [OAuth 1.0a 用户上下文](https://developer-staging.x.com/resources/fundamentals/authentication)。X API v2 的用户提及时间线端点同时支持 [OAuth 1.0a 用户上下文](/zh/resources/fundamentals/authentication)、[OAuth 2.0 仅应用](/zh/resources/fundamentals/authentication#bearer-token-also-known-as-app-only) 以及 [OAuth 2.0 授权码（含 PKCE）](/zh/resources/fundamentals/authenticationoauth-2-0/authorization-code "此方法允许已授权的应用以用户身份代表用户执行操作。通常用于访问或发布特定用户的公开信息；当你的应用需要了解用户与该端点返回结果与用户之间的关系时很有用。点击以了解如何使用 OAuth 2.0 授权码（含 PKCE）) 进行身份验证。")**

如果你希望通过 X API v2 的用户帖子时间线端点访问私有或推广指标，需要使用 OAuth 1.0a 用户上下文或 OAuth 2.0 授权码（含 PKCE），并传递与发布该帖子的用户对应的用户访问令牌，以获取其指标。
 

**端点 URL**

请注意，X API v2 时间线端点需要一个用户 ID 的路径参数 :id。

- 标准 v1.1 端点：
  - https://api.x.com/1.1/statuses/home\_timeline
  - https://api.x.com/1.1/statuses/user\_timeline
  - https://api.x.com/1.1/statuses/mention\_timeline
- X API v2 端点：
  - https://api.x.com/2/users/:id/timelines/reverse\_chronological
  - https://api.x.com/2/users/:id/tweets
  - https://api.x.com/2/users/:id/mentions

**应用与项目要求**

在为请求进行身份验证时，X API v2 端点要求你使用与某个[开发者应用](/zh/resources/fundamentals/developer-apps)关联的[项目](/zh/resources/fundamentals/projects)中的凭据。所有 X API v1.1 端点均可使用独立应用或与项目关联的应用的凭据。 
 

**速率限制**

|     |     |
| :--- | :--- |
| **mentions\_timeline：**<br /><br />使用 OAuth 1.0a 用户上下文每 15 分钟 75 次请求 | **用户提及时间线：**<br /><br />使用 OAuth 1.0a 用户上下文每 15 分钟 180 次请求  <br />使用 OAuth 2.0 Bearer Token 每 15 分钟 450 次请求 |
| **home\_timelime：**<br /><br />每 15 分钟 15 次请求  <br /><br />主页时间线上最多可获取 800 条帖子 | **按时间逆序的主页时间线：**<br /><br />每 15 分钟 180 次请求<br /><br />你可以返回过去 7 天在时间线上创建的所有帖子，以及不论创建日期的最近 800 条。 |

**请求限制**

|     |     |
| :--- | :--- |
| **标准时间线 v1.1** | **时间线 v2** |
| 每日请求限制<br /><br />\* 24 小时内最多 100,000 次请求。 | 无每日请求限制，仅受消费量限制。 |

**消费量限制**

|     |     |
| :--- | :--- |
| **标准时间线 v1.1** | **时间线 v2** |
| 消费量仅受请求限制<br /><br />\* 24 小时内最多 100,000 次请求。 | 消费量仅受基于[访问级别](/zh/x-api/getting-started/about-x-api)的项目级每月[帖子上限](/zh/x-api/fundamentals/post-cap)（覆盖多个 v2 端点）限制。<br /><br />\* Essential 级别每月 500,000 条帖子<br />\* Elevated 级别每月 200 万条帖子<br />\* Academic Research 级别每月 1,000 万条帖子 <br /><br />按时间逆序的主页时间线不受每月帖子上限限制。 |

**请求参数**

|     |     |
| :--- | :--- |
| **Standard timelines v1.1** | **timelines v2** |
| 必填：user\_id 或 screen\_name | 必填：在路径参数中指定具体的用户 ID |
| 可选：<br /><br />count - 设置每次请求返回的最大结果数<br /><br />exclude\_replies - 从结果中移除回复<br /><br />include\_rts - 设为 0 时，从结果中移除转帖<br /><br />trim\_user - 从结果中移除再水化的用户对象<br /><br />tweet\_mode - 设置结果返回的数据格式，对超过 140 的帖子设为 extended<br /><br />since\_id - 设置结果中的最早帖子 ID（不包含）<br /><br />max\_id - 设置结果中的最新帖子 ID（包含） | 可选：<br /><br />max\_results - 设置每次请求返回的最大结果数<br /><br />exclude=retweets,replies - 从结果中移除转帖或回复<br /><br />tweet.fields - 设置要返回的 Post 对象字段<br /><br />user.fields - 设置要返回的 User 对象字段<br /><br />place.fields - 设置要返回的 place 对象字段<br /><br />media.fields - 设置要返回的 media 对象字段<br /><br />poll.fields - 设置要返回的 poll 对象字段<br /><br />expansions - 设置要返回的扩展字段和数据<br /><br />start\_time - 设置结果的最早 created\_at 时间<br /><br />end\_time - 设置结果的最晚 created\_at 时间<br /><br />since\_id - 设置结果的最早帖子 ID（不包含）<br /><br />until\_id - 设置结果中的最新帖子 ID（不包含） |

**响应数据格式**

|     |     |
| :--- | :--- |
| **Standard search v1.1** | **Search Posts v2** |
| \[<br />    tweet object,<br />    tweet object<br />  ] | <br />  "data": \[id,text,id,text],<br />  "meta": <br />    "oldest\_id": "1337085692623646724",<br />    "newest\_id": "1334183616172019713",<br />    "previous\_token": "77qpymm88g5h9vqkluldpw91lr0qzfz1sqydh841iz48k",<br />    "result\_count": 10,<br />    "next\_token": "7140dibdnow9c7btw3w29gqolns6a1ipl3kzeae41vsxk"<br />  <br /> |

**X API v2 JSON 格式**

X API v2 为 API 返回的对象引入了新的 JSON 设计，包括 [Post](/zh/x-api/fundamentals/data-dictionary#tweet) 和 [user](/zh/x-api/fundamentals/data-dictionary#user) 对象。您可以通过访问我们的[指南](/zh/x-api/fundamentals/data-dictionary#how-to-use-fields-and-expansions)了解更多关于 X API v2 的格式、如何使用字段与扩展，并查阅更全面的[数据字典](/zh/x-api/fundamentals/data-dictionary)。

- 在 JSON 根级别，标准端点在 statuses 数组中返回 Post 对象，而 X API v2 在 data 数组中返回。 
- X API v2 JSON 不再引用被转发和被引用的“statuses”，而是称为被转发和被引用的 Tweets。许多遗留和已弃用的字段（如 contributors 和 user.translator\_type）正在被移除。 
- 不再同时在 Post 对象和 user 对象中使用 favorites，X API v2 改用术语 like。 
- X 采用的约定是：没有值的 JSON 字段（例如 null）不会写入负载。仅当 Post 和 user 属性具有非空值时才会包含。 
   

Standard v1.1 与 X API v2 端点版本之间最大的差异之一，是如何选择负载中返回的字段。对于标准端点，您可以使用多个参数来确定负载中会返回哪些字段或字段集，而 X API v2 将这些不同的参数简化为[字段](/zh/x-api/fundamentals/fields)和[扩展](/zh/x-api/fundamentals/expansions)。 

- fields：X API v2 端点允许您选择在负载中返回哪些字段。例如，Post、User、Media、Place 和 Poll 对象都有各自可选择返回（或不返回）的字段列表。 

- expansions：用于展开 Post JSON 负载中被引用的相关对象。例如，所有转发和回复都会引用其他 Post。通过设置 expansions=referenced\_tweets.id，这些被引用的 Post 对象会按照 tweet.fields 的设置展开。其他对象（如 users、polls 和 media）也可以展开。 

- conversation\_id

- 两个新的 [annotations](/zh/x-api/fundamentals/post-annotations) 字段，包括 context 和 entities

- 多个新的 [metrics](/zh/x-api/fundamentals/metrics) 字段 
   

我们提供了[数据格式迁移指南](/zh/x-api/migrate/data-format-migration#migrating-from-standard-v1-1s-data-format-to-v2)，可帮助您将 standard v1.1 的字段映射到较新的 v2 字段。该指南还会提供在 v2 请求中需传递的具体 expansion 和 field 参数，以返回所需字段。 

**后续步骤**

[查看 X API v2 Post 查询的快速入门指南](/zh/x-api/posts/lookup/quickstart "Check out our quick start guide for X API v2 Post lookup")

[查阅 v2 Post 查询的 API 参考](/zh/x-api/posts/lookup/migrate/overview "Review the API references for v2 Post lookup")

[查看时间线端点的示例代码](https://github.com/xdevplatform/Twitter-API-v2-sample-code "Check out our sample code for the timelines endpoints")