---
title: 概述
sidebarTitle: 概述
---

<div id="how-to-integrate-with-the-search-posts-endpoints">
  ## 如何集成 Search Posts 端点
</div>

本页介绍在将“近期搜索”或“全档案搜索”端点集成到你的系统时需要了解的多种工具和关键概念。我们将本页分为以下部分：

- [实用工具](#helpful-tools)
- 关键概念
  - [身份验证](#authentication)

  - [开发者门户、项目与应用](#developer-portal)

  - [速率限制](#rate-limits)

  - [字段与扩展](#fields-expansions)

  - [指标](#metrics)

  - [构建搜索查询](#queries)

  - [分页](#pagination)

  - [帖子上限](#tweet-caps) 

  - [帖子编辑](#tweet-edits) 

<div id="helpful-tools">
  ### 实用工具
</div>

在开始探讨一些关键概念之前，我们建议您使用以下任一工具或代码示例来测试这些端点的功能。

<div id="code-samples">
  #### 代码示例
</div>

想用你常用的编程语言，通过一些代码来对这些端点进行集成吗？我们在 [GitHub 页面](https://github.com/xdevplatform/Twitter-API-v2-sample-code)上提供了多种代码示例，可作为起点，其中包括 [Python 客户端](https://github.com/xdevplatform/search-tweets-python)和 [Ruby 客户端](https://github.com/xdevplatform/search-tweets-ruby)。

<div id="libraries">
  #### 库
</div>

利用我们的[社区第三方库](/zh/x-api/tools-and-libraries/overview)来加速起步。查找相应的版本标签即可找到适配 v2 端点的库。

<div id="postman">
  #### Postman
</div>

Postman 是一款非常适合用于测试这些端点的工具。每个 Postman 请求都包含该端点的所有参数，帮助您快速了解可用项。要进一步了解我们的 Postman 集合，请访问[使用 Postman](/zh/tutorials/postman-getting-started)页面。
 

<div id="key-concepts">
  ### 关键概念
</div>

<div id="authentication">
  #### 身份验证
</div>

所有 X API v2 端点都要求你使用一组凭证（也称为密钥和令牌）对请求进行身份验证。你可以使用 OAuth 1.0a 用户上下文、OAuth 2.0 应用专用，或 OAuth 2.0（含 PKCE）的授权码流程来对“近期搜索”端点的请求进行身份验证。使用“全档案搜索”端点时，必须使用 OAuth 2.0 应用专用。

[OAuth 2.0 应用专用](/zh/resources/fundamentals/authentication#oauth-2-0-authorization-code-flow-with-pkce-3) 只要求你在请求中携带一个 [OAuth 2.0 应用访问令牌](/zh/resources/fundamentals/authentication#bearer-token-also-known-as-app-only)。你可以直接在开发者应用中生成应用访问令牌，或使用 [POST oauth2/token](/zh/resources/fundamentals/authentication#post-oauth2-token) 端点生成。

[OAuth 1.0a 用户上下文](/zh/resources/fundamentals/authentication#obtaining-access-tokens-using-3-legged-oauth-flow) 要求你使用 API 密钥、用户访问令牌以及其他一些参数来[创建授权头](https://developer-staging.x.com/resources/fundamentals/authentication/authorizing-a-request)，然后随请求一起传递。访问令牌必须与代表其发出请求的用户关联。如果你想为另一位用户生成一组访问令牌，对方必须通过[三方 OAuth 流程](https://developer-staging.x.com/resources/fundamentals/authentication/obtaining-user-access-tokens)授权你的应用。

请注意，OAuth 1.0a 的使用门槛较高。如果你不熟悉此身份验证方法，建议使用一个[库](/zh/x-api/tools-and-libraries/overview)、Postman 等工具，或改用 OAuth 2.0 对请求进行身份验证。如果你需要从这些端点请求帖子或私有指标，必须使用 OAuth 1.0a 用户上下文或 OAuth 2.0（含 PKCE）的授权码流程，以确保你获得内容所有者授予的适当权限。

[OAuth 2.0（含 PKCE）的授权码流程](/zh/resources/fundamentals/authentication#oauth-2-0-authorization-code-flow-with-pkce-2) 允许对应用的范围（scope）进行更精细的控制，并支持跨多设备的授权流程。OAuth 2.0 允许你选择细粒度的范围，从而代表用户获取特定权限。

要在你的应用中启用 OAuth 2.0，你必须在开发者门户的“应用设置”中的“身份验证设置”里启用它。

<Note>
  **请注意**

  如果你请求以下[字段](/zh/x-api/fundamentals/fields)，则需要使用 OAuth 1.0a 用户上下文或 OAuth 2.0 授权码流程：

  - tweet.fields.non\_public\_metrics
  - tweet.fields.promoted\_metrics
  - tweet.fields.organic\_metrics
  - media.fields.non\_public\_metrics
  - media.fields.promoted\_metrics
  - media.fields.organic\_metrics
</Note>

####

开发者门户、项目与开发者应用

要使用任何 X API v2 端点，您必须先[注册开发者账户](https://developer.x.com/en/portal/petition/essential/basic-info)、在该账户下设置一个项目，并在该项目中创建一个开发者应用。该开发者应用中的密钥和令牌可用于这些搜索端点。

您可以使用任意[访问级别](/zh/x-api/getting-started/about-x-api)的项目中的密钥和令牌来请求“近期搜索”端点。但若要请求“全档案搜索”端点，您需要使用访问级别为 Pro 或 Enterprise 的项目。如果您拥有[Enterprise 访问](/zh/x-api/getting-started/getting-access)，则可使用更多功能，包括更多可用运算符以及更长的查询长度。
 

<div id="rate-limits">
  #### 速率限制
</div>

每天有成千上万的开发者向 X API 发起请求。为帮助管理请求量，我们在每个端点上设置了[速率限制](/zh/x-api/fundamentals/rate-limits)，以限制每位开发者代表某个应用或某个已认证用户所能发起的请求次数。

根据所使用的身份验证方式不同，这些端点适用不同的速率限制。应用级速率限制适用于使用 OAuth 2.0 App-Only 发起请求的应用；而用户级速率限制适用于代表特定授权用户，使用 OAuth 1.0a User Context 或 OAuth 2.0 Authorization Code with PKCE 发起的请求。这两类速率限制均基于 15 分钟窗口内的请求频率。

例如，一个使用 OAuth 2.0 App-Only 身份验证向“最近搜索”端点发起请求的应用，可在 15 分钟内发起 450 次请求（包括分页请求）。同一应用在相同的 15 分钟窗口内，使用两个不同的已认证用户（通过 OAuth 1.0a User Context 或 OAuth 2.0 Authorization Code with PKCE）时，可对每个已认证用户分别向“最近搜索”端点发起最多 180 次请求（包括分页请求）。
 

<div id="fields-and-expansions">
  #### 字段与扩展
</div>

X API v2 允许你使用[字段](/zh/x-api/fundamentals/fields)和[扩展](/zh/x-api/fundamentals/expansions)精确选择希望从 API 返回的数据。expansions 参数可用于展开有效负载中被引用的对象。例如，此端点允许你通过 expansions 参数请求投票、地点、媒体等对象。

fields 参数用于精确选择各类数据对象中你希望接收的具体字段。默认情况下，这些端点返回的主要帖子对象包含 id 和 text 字段（此外，对于该功能上线后创建的帖子，还包括 edit\_history\_tweet\_ids）。若要接收 author\_id 或 public\_metrics 等其他字段，你需要通过 fields 参数明确请求。在你的集成中，值得考虑的一些重要字段包括投票数据、[指标](/zh/x-api/fundamentals/metrics)、[帖子注释](/zh/x-api/fundamentals/post-annotations)以及[会话 ID](/zh/x-api/fundamentals/conversation-id)。

我们已在[X API v2 数据字典](/zh/x-api/fundamentals/data-dictionary)中新增了关于[如何同时使用字段与扩展](/zh/x-api/fundamentals/data-dictionary#how-to-use-fields-and-expansions)的指南。
 

<div id="metrics">
  #### 指标
</div>

X API v2 的端点允许你直接从返回对象中请求指标，前提是你在请求中传入相应的[字段](/zh/x-api/fundamentals/fields)。

帖子指标存在一些需要注意的限制，尤其与用户隐私以及以下响应字段相关：

- tweet.fields.non\_public\_metrics
- tweet.fields.promoted\_metrics
- tweet.fields.organic\_metrics
- media.fields.non\_public\_metrics
- media.fields.promoted\_metrics
- media.fields.organic\_metrics

上述字段包含私有指标数据，这意味着在使用最近搜索端点时，你必须获得帖子发布者的授权，才能代表其检索这些数据，也即必须使用 [OAuth 1.0a User Context](/zh/resources/fundamentals/authentication)。由于该身份验证方式仅适用于最近搜索，你将无法通过全档案搜索端点检索这些指标。

例如，为获取用户 ID 1234 的帖子之 `non_public_metrics`，你需要在请求中包含与该用户关联的访问令牌。你可以通过使用[三方 OAuth 流程](/zh/resources/fundamentals/authentication#obtaining-access-tokens-using-3-legged-oauth-flow)让用户授权你的应用，并获取与其关联的一组访问令牌。

所有 `non_public_metrics`、`organic_metrics` 和 `promoted_metrics` 仅适用于过去 30 天内创建的帖子。这意味着当你请求上述字段时，结果将自动限定为仅包含过去 30 天的帖子。

如果请求了这些字段，则只会返回由已认证用户创作的帖子，其他所有帖子将返回错误消息。
 

<div id="building-search-queries">
  #### 构建搜索查询
</div>

这些端点的核心特性在于使用单一搜索查询来筛选将要投递给您的帖子。查询由用于匹配帖子和用户属性的运算符组成，例如消息关键词、话题标签和 URL。您可以使用布尔逻辑和括号将运算符组合成查询，以精细化匹配行为。

您可以参考我们的[构建查询指南](/zh/x-api/posts/search/integrate/build-a-query)了解更多。

<div id="pagination">
  #### 分页
</div>

这些端点使用分页以便快速返回响应。若结果多于单次响应可返回的数量（最近搜索最多 100 条帖子，全档案搜索最多 500 条），则需要进行分页。使用 max\_results 参数指定每页返回的结果数量，使用 pagination\_token 参数获取下一页结果。请查看我们的[分页指南](/zh/x-api/fundamentals/pagination)以了解更多信息。

<div id="post-caps">
  #### 帖子上限
</div>

Search Posts 端点在任意给定月份可返回的帖子数量有限制，与分页无关。

无论使用哪个搜索端点，返回的帖子都会计入项目级的[帖子上限](/zh/x-api/fundamentals/post-cap)。用量会显示在开发者门户中，“月份”的起始日为你在[开发者门户仪表板](https://developer.x.com/en/portal/dashboard)上所示的订阅续订日。

**帖子编辑**

符合编辑条件的帖子可在原帖发布后的 30 分钟内最多编辑五次。搜索端点始终提供帖子的最新版本。如果你只请求发布于 30 分钟之前的帖子，你将始终收到该帖子的最终版本。然而，如果你的用例接近实时，且正在查询最近三十分钟内发布的帖子，那么这些帖子在你接收之后可能已被编辑。你可以使用搜索或 Post Lookup 端点对这些帖子进行再水化，以确认其最终状态。要进一步了解帖子编辑的工作方式，请参阅[帖子编辑基础](/zh/x-api/fundamentals/edit-posts)页面。  

**下一步**

[向 Search Posts 端点发出你的第一个请求](/zh/x-api/posts/search/quickstart/recent-search)

[在我们的 API 参考页面查看参数、字段等的完整列表](/zh/x-api/posts/recent-search)

[获取支持或排查错误](https://developer.x.com/en/support/x-api)