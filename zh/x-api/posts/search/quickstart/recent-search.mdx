---
title: 近期搜索
sidebarTitle: 近期搜索
---

import { Button } from '/snippets/zh/button.mdx';

<div id="getting-started-with-the-recent-search-endpoint">
  ## 开始使用“近期搜索”端点
</div>

本快速入门指南将帮助你使用 Postman，向“近期搜索”端点发送首个请求，并指定一组字段。

如果你想查看不同语言的示例代码，请访问我们的 [X API v2 示例代码](https://github.com/xdevplatform/Twitter-API-v2-sample-code) GitHub 仓库。

<Note>
  ### **先决条件**

  要完成本指南，你需要一组用于对请求进行身份验证的 [密钥与令牌](/zh/resources/fundamentals/authentication)。你可以按照以下步骤生成这些密钥与令牌：

  - [注册开发者账号](https://developer.x.com/en/apply-for-access) 并通过审批。
  - 在开发者门户中创建一个 [项目](/zh/resources/fundamentals/projects) 以及关联的 [开发者应用](/zh/resources/fundamentals/developer-apps)。
  - 前往你的应用的“Keys and tokens”页面生成所需的凭证。请确保将所有凭证安全保存。
</Note>

<div id="steps-to-build-a-recent-search-request">
  ### 构建近期搜索请求的步骤
</div>

**步骤一：选择工具或库**

有多种工具、代码示例和库可用于向此端点发起请求，但为简化流程，这里我们使用 Postman。

要将 X API v2 的 Postman 集合加载到你的环境，请点击以下按钮：

<Button href="https://app.getpostman.com/run-collection/9956214-784efcda-ed4c-4491-a4c0-a26470a67400">
  将 X API v2 添加到 Postman
</Button>

将 X API v2 集合加载到 Postman 后，前往 Search Posts > Recent search request。

**步骤二：为请求进行身份验证**

要正确调用 X API，你需要确认自己具备相应权限。对于此端点，你必须使用 [OAuth 2.0 App-Only](/zh/resources/fundamentals/authentication#app-only-authentication-and-oauth-2-0-bearer-token)、[OAuth 2.0 Authorization Code with PKCE](zh/resources/fundamentals/authentication#oauth-2-0-authorization-code-flow-with-pkce-2) 或 [OAuth 1.0a User Context](/zh/resources/fundamentals/authentication) 等方式对请求进行认证。

为便于说明，本示例使用 OAuth 2.0 App-Only。但如果你需要访问私有[指标](/zh/x-api/fundamentals/metrics)或私有帖子，则需改用其他认证方式之一。

使用 OAuth 2.0 App-Only 时，你必须将密钥与令牌（尤其是 [App Access Token](/zh/resources/fundamentals/authentication#using-and-generating-an-app-only-bearer-token)，又称 App-only Bearer Token）添加到 Postman。方法：在 Postman 右上角选择名为“X API v2”的环境，并将你的密钥与令牌填写到“initial value”和“current value”字段（点击环境下拉旁的眼睛图标）。

如果设置正确，这些变量会自动填充到请求的 Authorization 选项卡中。
 

**步骤三：创建搜索查询**

每个近期搜索请求都需要一个[搜索查询](/zh/x-api/posts/search/integrate/build-a-query)。本示例将使用匹配 @XDevelopers 账号发布内容的查询。我们使用 from 运算符并将其设为 XDevelopers（不区分大小写）：

`from:XDevelopers`

在 Postman 中，前往 “Params” 选项卡，将该查询或以逗号分隔的一串帖子 ID 填入 `ids` 参数的 “Value” 列。

|     |     |     |
| :--- | :--- | :--- |
| **Key** | **Value** | **Description** |
| `query` | from:XDevelopers | 提交至近期搜索端点的搜索查询 |

**步骤四：确定并指定需返回的字段**

如果在步骤三之后点击 “Send” 按钮，你会在响应中收到默认的 [Post 对象](/zh/x-api/fundamentals/data-dictionary#tweet)字段：id、text 和 `edit_history_tweet_ids`。如果需要除这些默认字段之外的更多字段，则需在请求中通过 [field](/zh/x-api/fundamentals/fields) 和/或 [expansion](/zh/x-api/fundamentals/expansions) 参数进行指定。

在本练习中，我们将从不同对象请求四组字段：

1. 默认的 Post 对象字段。
2. 主要帖子对象中的附加字段 tweet.created\_at。
3. 返回帖子所关联作者的用户对象的默认字段。
4. 关联用户对象中的附加字段 user.description。

在 Postman 中，前往 “Params” 选项卡，在 “Query Params” 表中添加以下键值对：

|     |     |     |
| :--- | :--- | :--- |
| **Key** | **Value** | **Returned fields** |
| `tweet.fields` | `created_at` | `tweets.created_at` |
| `expansions` | `author_id` | `includes.users.id`, `includes.users.name`, `includes.users.username` |
| `user.fields` | `description` | `includes.users.description` |

你现在应当会在 “Send” 按钮旁看到如下 URL：

`https://api.x.com/2/tweets/search/recent?query=from:XDevelopers&tweet.fields=created_at&expansions=author_id&user.fields=created_at`

**步骤五：发出请求并查看响应**

完成所有配置后，点击“Send”按钮，您将收到如下响应：

```
{
   "data": [
       {
           "author_id": "2244994945",
           "created_at": "2020-06-11T16:05:06.000Z",
           "id": "1271111223220809728",
           "text": "Tune in tonight and watch as @jessicagarson takes us through running your favorite Python package in R. 🍿\n\nLearn how to use two powerful programming languages for data science together, and see a live example that uses the recent search endpoint from Twitter’s Developer Labs. https://t.co/v178oUZNuj"
       },
       {
           "author_id": "2244994945",
           "created_at": "2020-06-10T19:25:24.000Z",
           "id": "1270799243071062016",
           "text": "As we work towards building the new Twitter API, we’ve extended the deprecation timeline for several Labs v1 endpoints. Learn more 📖 https://t.co/rRWaJYJgKk"
       },
       {
           "author_id": "2244994945",
           "created_at": "2020-06-09T18:08:47.000Z",
           "id": "1270417572001976322",
           "text": "Annotations help you learn more about a Tweet — they can even help you find topics of interest. 🔬\n\nIn this tutorial, @suhemparack shows us how find Tweets related to COVID-19 using annotations + the filtered stream endpoint.\n\nLearn how you can, too. ⤵️\nhttps://t.co/qwVOgw0zSV"
       }
   ],
   "includes": {
       "users": [
           {
               "description": "The voice of Twitter's #DevRel team, and your official source for updates, news, & events about Twitter's API. \n\n#BlackLivesMatter",
               "id": "2244994945",
               "name": "X Developers",
               "username": "XDevelopers"
           }
       ]
   },
   "meta": {
       "newest_id": "1271111223220809728",
       "oldest_id": "1270417572001976322",
       "result_count": 3
   }
}
```

**后续步骤**

[使用 API 参考自定义您的请求](/zh/x-api/posts/recent-search)

[查看查询运算符完整列表](/zh/x-api/posts/search/integrate/build-a-query "See a full list of query operators")

[查看这些端点的示例代码](https://github.com/xdevplatform/Twitter-API-v2-sample-code "Use sample code for these endpoints")