---
title: v1 升级到 v2（企业版）
sidebarTitle: v1 升级到 v2（企业版）
---

<div id="enterprise-compared-to-x-api-v2">
  ### Enterprise 与 X API v2 的比较
</div>

**相似点**

- 粒度
- 分页
- 时区

**差异**

- 端点 URL
- 应用与项目要求
- 可用时间区间
- 响应数据格式
- HTTP 方法
- 请求时间格式
- 请求参数
- 过滤运算符

<div id="similarities">
  #### 相似点
</div>

**粒度**

虽然用于选择返回数据粒度的参数不同（企业版为 `bucket`，v2 为 `granularity`），但该参数可传递的取值相同，默认行为也一致：

- `day`
- `hour`（默认）
- `minute`

**分页**

尽管 v2 提供了额外的分页功能（新增分页参数，允许使用帖子 ID 通过 `since_id` 和 `until_id` 导航），但企业版和 v2 都允许按时间分页（企业版使用 `fromDate` 和 `toDate`，v2 使用 `start_time` 和 `end_time`）。

如果您使用企业版，将使用 `next` 参数进行分页，下一页令牌字段名为 `next`，并位于响应的根级。

如果您使用 v2，可以使用 `next_token` 或 `pagination_token` 参数进行分页，且下一页令牌位于响应的 `meta.next_token`。
 

**时区**

如分页部分所述，企业版和 v2 都可以按时间在不同数据页之间导航。在这两种情况下，使用这些参数时均采用 UTC 时区。

<div id="differences">
  #### 差异
</div>

**端点 URL**

- 企业版端点：
  - 30 天 - `http://gnip-api.x.com/search/30day/accounts/:account_name/:label/counts.json`
  - 全档案 - `http://gnip-api.x.com/search/fullarchive/accounts/:account_name/:label/counts.json`
- X API v2 端点
  - 最近（7 天）- `https://api.x.com/2/tweets/counts/recent`
  - 全档案 - `https://api.x.com/2/tweets/counts/all`

**应用与项目要求**

X API v2 端点要求你在对请求进行身份验证时，使用与[开发者 App](/zh/resources/fundamentals/developer-apps)关联并属于某个[项目](/zh/resources/fundamentals/developer-apps)的凭证。所有 X API v1.1 端点既可使用独立 App 的凭证，也可使用与项目关联的 App 的凭证。
 

**可用时间范围**

企业版 API 和 X API v2 都提供可检索全档案帖子量数据的端点。

不过，X API v2 不像企业版 API 那样提供 30 天时间范围的端点。相反，它提供上述全档案端点，或与[v2 搜索帖子端点](/zh/x-api/posts/search/introduction)一致的 7 天时间范围。
 

**响应数据格式**

通过企业版和 X API v2 获取的数据格式存在一些细微差异：

- 企业版的计数数据位于 `results` 对象中，而 v2 的计数数据位于 `data` 对象中。
- 企业版的计数字段为 `timePeriod`（开始时间）和 `count`，而 v2 将时间范围拆分为 `start` 和 `end` 字段（使用与企业版不同的日期/时间格式，详见请求时间格式），并将计数字段重命名为 `tweet_count`。
- 企业版的元数据在根级包含 `totalCount`、`next` 和 `requestParameters` 对象。而 v2 不包含 `requestParameters` 对象，并将以下内容移动/重命名到位于根级的 `meta` 对象中：`total_tweet_count` 和 `next_token`。
   

**HTTP 方法**

该 API 的企业版允许你使用带有 JSON 正文的 POST 方法，或带有查询字符串的 GET 方法来发出请求。

v2 仅允许使用带有查询字符串的 GET 方法。
 

**请求时间格式**

此端点的企业版在分页参数和 `timePeriod` 响应字段中使用以下日期/时间格式：`YYYYMMDDHHmm`

v2 端点在分页参数以及 `start` 和 `end` 响应字段中使用 ISO 8601/RFC 3339 日期/时间格式：`YYYY-MM-DDTHH:mm:ssZ`

**请求参数**

以下是企业版与 X API v2 的请求参数对照表：

| 企业版 | 搜索帖子 v2 |
| :--- | :--- |
| query | query |
| bucket | granularity |
| fromDate (YYMMDDHHmm) | start\_time (YYYY-MM-DDTHH:mm:ssZ) |
| toDate (YYMMDDHHmm) | end\_time (YYYY-MM-DDTHH:mm:ssZ) |
|     | since\_id |
|     | until\_id |
| next | next\_token 和 pagination\_token |

**过滤运算符**

虽然企业版与 X API v2 的运算符大多相同，但在可用性方面存在一些差异，且仅在 X API v2 中引入了一些新运算符。

要查看适用于 X API v2、企业版，甚至 premium 的完整运算符表，请访问[帖子计数迁移概览页](/zh/x-api/posts/counts/migrate/overview)。

<div id="api-reference-index">
  ## API 参考索引
</div>

如需查看完整的 API 参考，请从下方选择一个端点。

<div id="recent-post-counts">
  ### 近期帖子计数
</div>

|     |     |
| :--- | :--- |
| **获取过去 7 天内与查询匹配的帖子数量** | `[GET /2/tweets/counts/recent](/x-api/posts/tweet-counts#api-reference-index/get-tweets-counts-recent)` |

<div id="full-archive-post-counts">
  ### 全档案帖子计数
</div>

仅向拥有[专业版和企业版访问权限](/zh/x-api/getting-started/about-x-api)的用户提供

|     |     |
| :--- | :--- |
| **获取与查询匹配的帖子数量** | `[GET /2/tweets/counts/all](/x-api/posts/tweet-counts#api-reference-index/get-tweets-counts-all)` |