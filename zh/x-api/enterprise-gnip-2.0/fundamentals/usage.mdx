---
title: 使用量 API
description: "Usage API 是一项免费的 REST API，可为您的企业帐户提供跨产品的使用活动的程序化访问与可视化。"
sidebarTitle: 使用量 API
---

<div id="usage-api-twitter-api">
  ## 用量 API | Twitter API
</div>

<div id="overview">
  ### 概述
</div>

`Enterprise`

这是帮助监控和管理你账户下各 API 使用情况的最重要、也是最有效的工具。

**重要免责声明：**

由于试用期以及其他结算调整，Usage API 返回的使用量统计可能与账单发票不完全一致。所有数值均基于特定日期（UTC）内已去重的实际消耗活动。

<div id="features">
  #### 功能
</div>

- 以编程方式检索在 console.gnip.com 界面中可用的使用数据
- 流级使用数据——在产品级之外，还提供流级（例如 dev 和 prod）的使用数据
- 细粒度且具描述性的数据——搜索“请求”按 Full-Archive 和 30-Day Search 产品拆分
- Historical PowerTrack 的 “days” 和 “jobs” 

<div id="supported-apis">
  ### 支持的 API
</div>

以下是 Usage API 目前支持的 API 列表：

- PowerTrack API `enterprise`
- 30-Day Search API `enterprise`
- Full-Archive Search API `enterprise`
- Historical PowerTrack `enterprise`

<div id="limitations">
  ### 限制
</div>

- Usage API 允许访问自 2018 年 5 月 1 日起的使用数据。自 2019 年 7 月 1 日起，Usage API 允许访问**最近 13 个日历月**的使用数据。

- 你可以按由 fromDate 和 toDate 定义的**每三个月区间**获取使用数据。

请参见以下请求与响应示例：

```bash
curl -u<username>:<password> \
"https://gnip-api.x.com/metrics/usage/accounts/<account-name>.json?bucket=month"
```

```json
{
  "account": {
    "name": "accountnamehere"
  },
  "publishers": [
    {
      "type": "twitter",
      "used": [
        {
          "timePeriod": "201805010000",
          "activities": 1235,
          "searchRequests30Day": 3,
          "searchRequestsFullArchive": 19,
          "historicalPowertrackDays": 0,
          "historicalPowertrackJobs": 0
        },
        {
          "timePeriod": "201806010000",
          "activities": 23467,
          "searchRequests30Day": 0,
          "searchRequestsFullArchive": 66,
          "historicalPowertrackDays": 0,
          "historicalPowertrackJobs": 0
        },
        {
          "timePeriod": "201807010000",
          "activities": 431,
          "searchRequests30Day": 11,
          "searchRequestsFullArchive": 4,
          "historicalPowertrackDays": 0,
          "historicalPowertrackJobs": 0
        }
      ],
      "projected": {
        "timePeriod": "201807010000",
        "activities": 803,
        "searchRequests30Day": 20,
        "searchRequestsFullArchive": 7,
        "historicalPowertrackDays": 0,
        "historicalPowertrackJobs": 0
      },
      "products": [
        {
          "type": "历史 PowerTrack 订阅"
          "used": [
            {
              "timePeriod": "201805010000",
              "activities": 0,
              "days": 0,
              "jobs": 0
            },
            {
              "timePeriod": "201806010000",
              "activities": 0,
              "days": 0,
              "jobs": 0
            },
            {
              "timePeriod": "201807010000",
              "activities": 0,
              "days": 0,
              "jobs": 0
            }
          ],
          "projected": {
            "timePeriod": "201807010000",
            "activities": 0,
            "days": 0,
            "jobs": 0
          }
        },
        {
          "type": "PowerTrack"
          "used": [
            {
              "timePeriod": "201805010000",
              "activities": 267
            },
            {
              "timePeriod": "201806010000",
              "activities": 3
            },
            {
              "timePeriod": "201807010000",
              "activities": 32
            }
          ],
          "projected": {
            "timePeriod": "201807010000",
            "activities": 59
          },
          "endpoints": [
            {
              "type": "PowerTrack 2.0"
              "label": "actformat"
              "used": [
                {
                  "timePeriod": "201805010000",
                  "activities": 0
                },
                {
                  "timePeriod": "201806010000",
                  "activities": 0
                },
                {
                  "timePeriod": "201807010000",
                  "activities": 0
                }
              ],
              "projected": {
                "timePeriod": "201807010000",
                "activities": 0
              }
            },
              {
              "type": "PowerTrack Replay 2.0"
              "label": "ogformat"
              "used": [
                {
                  "timePeriod": "201805010000",
                  "activities": 0
                },
                {
                  "timePeriod": "201806010000",
                  "activities": 0
                },
                {
                  "timePeriod": "201807010000",
                  "activities": 0
                }
              ],
              "projected": {
                "timePeriod": "201807010000",
                "activities": 0
              }
            }
          ]
        },
        {
          "type": "搜索 API（30 天）2.0"
          "used": [
            {
              "timePeriod": "201805010000",
              "activities": 10,
              "searchRequests30Day": 3
            },
            {
              "timePeriod": "201806010000",
              "activities": 0,
              "searchRequests30Day": 0
            },
            {
              "timePeriod": "201807010000",
              "activities": 23,
              "searchRequests30Day": 11
            }
          ],
          "projected": {
            "timePeriod": "201807010000",
            "activities": 42,
            "searchRequests30Day": 20
          },
          "endpoints": [
            {
              "type": "搜索 API（30 天）2.0"
              "label": "ogformat",
              "used": [
                {
                  "timePeriod": "201805010000",
                  "activities": 10,
                  "searchRequests30Day": 3
                },
                {
                  "timePeriod": "201806010000",
                  "activities": 0,
                  "searchRequests30Day": 0
                },
                {
                  "timePeriod": "201807010000",
                  "activities": 21,
                  "searchRequests30Day": 10
                }
              ],
              "projected": {
                "timePeriod": "201807010000",
                "activities": 39,
                "searchRequests30Day": 18
              }
            }
          ]
        },
        {
          "type": "搜索 API（全档案）",
          "used": [
            {
              "timePeriod": "201805010000",
              "activities": 961,
              "searchRequestsFullArchive": 19
            },
            {
              "timePeriod": "201806010000",
              "activities": 23466,
              "searchRequestsFullArchive": 66
            },
            {
              "timePeriod": "201807010000",
              "activities": 379,
              "searchRequestsFullArchive": 4
            }
          ],
          "projected": {
            "timePeriod": "201807010000",
            "activities": 706,
            "searchRequestsFullArchive": 7
          },
          "endpoints": [
            {
              "type": "搜索 API（全档案）",
              "label": "actformat",
              "used": [
                {
                  "timePeriod": "201805010000",
                  "activities": 1,
                  "searchRequestsFullArchive": 3
                },
                {
                  "timePeriod": "201806010000",
                  "activities": 0,
                  "searchRequestsFullArchive": 0
                },
                {
                  "timePeriod": "201807010000",
                  "activities": 2,
                  "searchRequestsFullArchive": 1
                }
              ],
              "projected": {
                "timePeriod": "201807010000",
                "activities": 3,
                "searchRequestsFullArchive": 1
              }
            },
            {
              "type": "搜索 API（全档案）",
              "label": "ogformat",
              "used": [
                {
                  "timePeriod": "201805010000",
                  "activities": 961,
                  "searchRequestsFullArchive": 16
                },
                {
                  "timePeriod": "201806010000",
                  "activities": 23466,
                  "searchRequestsFullArchive": 66
                },
                {
                  "timePeriod": "201807010000",
                  "activities": 379,
                  "searchRequestsFullArchive": 3
                }
              ],
              "projected": {
                "timePeriod": "201807010000",
                "activities": 706,
                "searchRequestsFullArchive": 5
              }
            }
          ]
        }
      ]
    }
  ],
  "bucket": "month"
  "fromDate": "201805010000",
  "toDate": "201808010000"
}
```

<div id="sample-payload">
  ### 示例载荷
</div>

以下是一个载荷示例：

```bash
{
  "account": {
    "name": "gnip-username"
  },
  "bucket": "month"
  "publishers": [
    {
      "type": "automattic"
      "used": [
        {
          "activities": 0
          "timePeriod": "201603010000"
        }
      ],
      "projected": {
        "activities": 0
        "timePeriod": "201603010000"
      },
      "products": [
        {
          "type": "PowerTrack"
          "used": [
            {
              "timePeriod": "201603010000"
              "activities": 0
            }
          ],
          "projected": {
            "timePeriod": "201603010000"
            "activities": 0
          },
          "endpoints": [
            {
              "type": "PowerTrack"
              "label": "dev"
              "used": [
                {
                  "timePeriod": "201603010000"
                  "activities": 0
                }
              ],
              "projected": {
                "timePeriod": "201603010000"
                "activities": 0
              }
            }
          ]
        }
      ]
    },
    {
      "type": "twitter"
      "used": [
        {
          "activities": 84
          "searchRequests30Day": 4
          "searchRequestsFullArchive": 0
          "historicalPowertrackDays": 0
          "historicalPowertrackJobs": 0
          "timePeriod": "201603010000"
        }
      ],
      "projected": {
        "activities": 0
        "searchRequests30Day": 0
        "searchRequestsFullArchive": 0
        "historicalPowertrackDays": 0
        "historicalPowertrackJobs": 0
        "timePeriod": "201601010000"
      },
      "products": [
        {
          "type": "Historical PowerTrack 2.0"
          "used": [
            {
              "timePeriod": "201511010000"
              "activities": 11884
              "days": 5
              "jobs": 5
            },
            {
              "timePeriod": "201512010000"
              "activities": 0
              "days": 0
              "jobs": 0
            },
            {
              "timePeriod": "201601010000"
              "activities": 0
              "days": 0
              "jobs": 0
            }
          ]
        },
        {
          "type": "PowerTrack"
          "used": [
            {
              "timePeriod": "201511010000"
              "activities": 0
            },
            {
              "timePeriod": "201512010000"
              "activities": 27456
            },
            {
              "timePeriod": "201601010000"
              "activities": 0
            }
          ],
          "projected": {
            "timePeriod": "201601010000"
            "activities": 0
          },
          "endpoints": [
            {
              "type": "PowerTrack"
              "label": "devel"
              "used": [
                {
                  "timePeriod": "201511010000"
                  "activities": 0
                },
                {
                  "timePeriod": "201512010000"
                  "activities": 2930
                },
                {
                  "timePeriod": "201601010000"
                  "activities": 0
                }
              ],
              "projected": {
                "timePeriod": "201601010000"
                "activities": 0
              }
            },
            {
              "type": "PowerTrack 2.0"
              "label": "devel-v2"
              "used": [
                {
                  "timePeriod": "201511010000"
                  "activities": 0
                },
                {
                  "timePeriod": "201512010000"
                  "activities": 24542
                },
                {
                  "timePeriod": "201601010000"
                  "activities": 0
                }
              ],
              "projected": {
                "timePeriod": "201601010000"
                "activities": 0
              }
            },
            {
              "type": "PowerTrack 2.0"
              "label": "devel-v2-1"
              "used": [
                {
                  "timePeriod": "201511010000"
                  "activities": 0
                },
                {
                  "timePeriod": "201512010000"
                  "activities": 0
                },
                {
                  "timePeriod": "201601010000"
                  "activities": 0
                }
              ],
              "projected": {
                "timePeriod": "201601010000"
                "activities": 0
              }
            }
          ]
        },
        {
          "type": "搜索 API",
          "used": [
            {
              "timePeriod": "201511010000",
              "activities": 0,
              "searchRequests30Day": 0
            },
            {
              "timePeriod": "201512010000",
              "activities": 0,
              "searchRequests30Day": 0
            },
            {
              "timePeriod": "201601010000",
              "activities": 0,
              "searchRequests30Day": 0
            }
          ],
          "projected": {
            "timePeriod": "201601010000",
            "activities": 0,
            "searchRequests30Day": 0
          },
          "endpoints": [
            {
              "type": "搜索 API",
              "label": "devel",
              "used": [
                {
                  "timePeriod": "201511010000",
                  "activities": 0,
                  "searchRequests30Day": 0
                },
                {
                  "timePeriod": "201512010000",
                  "activities": 0,
                  "searchRequests30Day": 0
                },
                {
                  "timePeriod": "201601010000",
                  "activities": 0,
                  "searchRequests30Day": 0
                }
              ],
              "projected": {
                "timePeriod": "201601010000",
                "activities": 0,
                "searchRequests30Day": 0
              }
            }
          ]
        },
        {
          "type": "搜索 API（30 天）",
          "used": [
            {
              "timePeriod": "201511010000",
              "activities": 0,
              "searchRequests30Day": 0
            },
            {
              "timePeriod": "201512010000",
              "activities": 0,
              "searchRequests30Day": 0
            },
            {
              "timePeriod": "201601010000",
              "activities": 0,
              "searchRequests30Day": 0
            }
          ],
          "projected": {
            "timePeriod": "201601010000",
            "activities": 0,
            "searchRequests30Day": 0
          },
          "endpoints": [
            {
              "type": "搜索 API（30 天）",
              "label": "devel",
              "used": [
                {
                  "timePeriod": "201511010000",
                  "activities": 0,
                  "searchRequests30Day": 0
                },
                {
                  "timePeriod": "201512010000",
                  "activities": 0,
                  "searchRequests30Day": 0
                },
                {
                  "timePeriod": "201601010000",
                  "activities": 0,
                  "searchRequests30Day": 0
                }
              ],
              "projected": {
                "timePeriod": "201601010000",
                "activities": 0,
                "searchRequests30Day": 0
              }
            }
          ]
        },
        {
          "type": "搜索 API（全档案）",
          "used": [
            {
              "timePeriod": "201511010000",
              "activities": 0,
              "searchRequestsFullArchive": 0
            },
            {
              "timePeriod": "201512010000",
              "activities": 0,
              "searchRequestsFullArchive": 0
            },
            {
              "timePeriod": "201601010000",
              "activities": 0,
              "searchRequestsFullArchive": 0
            }
          ],
          "projected": {
            "timePeriod": "201601010000",
            "activities": 0,
            "searchRequestsFullArchive": 0
          },
          "endpoints": [
            {
              "type": "搜索 API（全档案）",
              "label": "devel",
              "used": [
                {
                  "timePeriod": "201511010000",
                  "activities": 0,
                  "searchRequestsFullArchive": 0
                },
                {
                  "timePeriod": "201512010000",
                  "activities": 0,
                  "searchRequestsFullArchive": 0
                },
                {
                  "timePeriod": "201601010000",
                  "activities": 0,
                  "searchRequestsFullArchive": 0
                }
              ],
              "projected": {
                "timePeriod": "201601010000",
                "activities": 0,
                "searchRequestsFullArchive": 0
              }
            }
          ]
        }
      ]
    }
  ]
}
```

<div id="api-reference">
  ## API 参考
</div>

<div id="get-usage">
  ### 获取使用情况
</div>

<div id="methods">
  #### **方法**
</div>

| 方法 | 描述 |
| :--- | :--- |
| [GET /metrics/usage/accounts/{ACCOUNT_NAME}.json](#GETData) | 获取使用数据 |

说明：

- :account\_name 是与您的账户关联的名称（区分大小写），如 console.gnip.com 所示

<div id="authentication-and-rate-limit">
  #### **身份验证与频率限制**
</div>

<div id="authentication">
  ##### **身份验证**
</div>

所有对 Usage API 的请求都必须使用 HTTP 基本身份验证。请使用您账户中已启用的任一电子邮件/密码凭据，这些凭据可用于登录 console.gnip.com 或连接到任何 Gnip 流。

<div id="rate-limit">
  ##### **速率限制**
</div>

Usage API 的速率限制为每分钟 2 次请求。

<div id="best-practices-limitations">
  #### **最佳实践与限制**
</div>

<div id="data-availability">
  ##### **数据可用性**
</div>

使用数据基于去重后的活动，覆盖到数据最后一次处理的最近一个完整时间段（UTC）。除非 Gnip 正在进行系统部署，否则数据通常会被处理并更新至分钟级。

- Usage API 允许你访问自 2018 年 5 月 1 日起的使用数据。自 2019 年 7 月 1 日起，Usage API 允许你访问**过去连续 13 个公历月**的使用数据。

- 你可以按由 fromDate 和 toDate 定义的**每三个月区间**访问使用数据

<div id="requesting-and-receiving-data">
  #### **请求与接收数据**
</div>

Usage API 的工作机制是：向与你的账户对应的 API 端点发起携带 HTTP BASIC-AUTH 凭据的 HTTP GET 请求。

<div id="get-request">
  ##### GET 请求：
</div>

使用你的用户凭证和账户名称向以下端点发起 GET 请求：

https://gnip-api.x.com/metrics/usage/accounts/:account\_name.json

**其他参数**

|     |     |
| :--- | :--- |
| bucket | 可选。用于提供用量数据的时间单位。用量数据可按“日”或“月”的粒度返回。  <br />  <br />未指定 bucket 的请求将返回按月粒度的数据。  <br />  <br />可选值：'month' 或 'day' |
| fromDate (YYYYMMDDHHMM) | 可选。用量数据仅自 2018 年 5 月 1 日起可用。用于提供用量数据的最早 UTC 时间戳。时间戳按“天”粒度，且为包含（例如，201805010000 包含 05 月 01 日）。对于小时和分钟，若提供的值不是 '0000'，将默认重置为 '0000'。  <br />  <br />未提供 fromDate 或 toDate 的请求将返回当月的按月用量数据，并包含前两个月的历史参考。  <br />  <br />**请注意：** 自 2019 年 6 月 1 日起，你可以访问过去 13 个日历月的用量数据。例如，如果现在是 10 月 10 日，你可以访问到上一年 9 月 1 日起的用量数据。  <br />**示例：** 201810010000 将返回从 2018 年 10 月 1 日（含）开始的数据。 |
| toDate (YYYYMMDDHHMM) | 可选。用于提供用量数据的最新 UTC 时间戳。时间戳按“天”粒度，且为不包含（例如，201703020000 不包含 03 月 02 日的数据）。当为当天或未来日期指定 toDate 时，将返回截至上一完整日（UTC）的用量数据。对于小时和分钟，若提供的值不是 '0000'，将默认重置为 '0000'。  <br />  <br />未提供 toDate 的请求将默认取到下一个 bucket（当 bucket=day 时为明天，bucket=month 时为下个月）。未提供 fromDate 和 toDate 的请求将默认 bucket=month，并显示当月以及前两个月的数据。  <br />  <br />**示例：** 201703050000 将返回截至 2017 年 3 月 5 日的数据，但不包含 3 月 5 日的任何数据。 |

**GET 请求示例**

此请求将返回从 2017 年 3 月 1 日到 2017 年 3 月 5 日（不包含 2017 年 3 月 5 日任何数据）的按月粒度数据。

curl -u "https://gnip-api.x.com/metrics/usage/accounts/:account\_name.json?bucket=month\&fromdate=201403010000\&toDate=201403150000"

<div id="data-format">
  #### **数据格式**
</div>

下表描述了 Usage API 返回的使用数据中的根级数据结构。对于具有多级子字段的字段，请点击提供的链接以查看子字段的详细信息。

如果您希望查看完整的 Usage API 负载示例，请访问[此页面](/zh/x-api/usage/introduction)。

|     |     |
| :--- | :--- |
| **account** | 表示请求其使用数据的账户的对象。 |
| **bucket** | 提供使用数据的时间单位，可为 “day” 或 “month”。 |
| **fromDate** | 要拉取使用数据的最早 UTC 时间戳（含）。 |
| **toDate** | 要拉取使用数据的最晚 UTC 时间戳（不含）。 |
| **publishers** | 包含三个主要对象：used、projected 和 products。 |