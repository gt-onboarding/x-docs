---
title: 分页
---

<div id="introduction">
  ## 介绍
</div>

当某个 X API v2 端点需要返回的结果超过单个响应所能包含的数量时，会采用分页功能。此时，数据将以一系列“页面”返回。分页指的是通过编程方式请求所有页面以获取完整的结果数据集的方法。并非所有 API 端点都支持或需要分页，但在结果集较大时，分页常被采用。

<div id="use-cases-for-pagination">
  ### 分页的用例
</div>

**检索某个请求的全部结果：** 应使用分页来获取与特定请求及其参数相关的所有数据。当匹配结果数量超过该请求的 `max_results` 时，必须使用分页。通过携带分页令牌循环发起请求，可以检索全部结果。当返回的响应不包含 `next_token` 值时，可以认为所有结果都已分页遍历完毕。分页不应用于轮询。若要获取自上次请求以来的最新结果，请参阅使用 `since_id` 的轮询方式。

**遍历某个请求的结果：** 分页通过使用响应中的 `next_token` 和 `previous_token` 值，提供在请求结果中前后导航的能力。可在后续请求中将这些令牌设置为 `pagination_token`，以前往下一页或上一页的结果。

<div id="pagination-token-definitions">
  ### 分页令牌定义
</div>

- `next_token` - 在支持分页的端点中，作为 meta 对象响应返回的不透明字符串。表示有更多结果可用，可在下一次请求中作为 `pagination_token` 参数使用，以返回下一页结果。最后一页结果不会包含 `next_token`。
  - `previous_token` - 在支持分页的端点中，作为 meta 对象响应返回的不透明字符串。表示存在上一页结果，可在下一次请求中将其设为 `pagination_token` 参数，以返回上一页结果。
  - `pagination_token` - 用于分页请求的参数。将其设为 `next_token` 的值以获取下一页结果；将其设为 `previous_token` 的值以获取上一页结果。

<div id="fundamentals-of-pagination">
  ### 分页基础
</div>

- 使用分页的端点在首次请求时会返回第一页结果；如果还有更多结果可用，会在 JSON 响应的 meta 对象中提供一个 `next_token`。要获取全部结果，请重复该流程，直到响应中不再包含 `next_token`。
  - 结果按时间逆序返回，这在单页和跨页都适用：
    - 第一条响应中的第一条帖子是最新的。
    - 最后一条响应中的最后一条帖子是最早的。
  - `max_results` 请求参数可用于配置每页返回的帖子数量。`max_results` 具有默认值和最大值。
  - 任意分页实现都需要从响应负载中解析令牌，并在后续请求中使用这些令牌。
  - 在某些情况下，每页返回的结果可能少于 `max_results`。不要假设每页结果总是等于 `max_results` 参数值。
  - 获取完整结果的最佳做法是：在集成代码中使用循环逻辑，或使用支持 X API v2 的[库](/zh/x-api/tools-and-libraries/overview)。

<div id="pagination-example">
  ### 分页示例
</div>

这里共有三页结果，因为 `max_results` 设为 `100`，且在 2019 年 1 月 1 日 17:00:00 UTC 至 12 月 12 日 00:00:00 UTC 之间，用户 ID `2244994945`（@XDevelopers）创建了约 295 条帖子。第一页的第一条帖子（`1337498609819021312`）是最新的，第三页结果中的最后一条帖子（`1082718487011885056`）是最早的。

<div id="initial-request">
  #### 初始请求
</div>

```bash
      https://api.x.com/2/users/2244994945/tweets?tweet.fields=created_at&max_results=100&start_time=2019-01-01T17:00:00Z&end_time=2020-12-12T01:00:00Z
```

<div id="sequence-table">
  ### 序列表格
</div>

|             | **首次请求**                                                                                                                                                                                                                                                                                                                                                          | **第二页**                                                                                                                                                                                                                                                                                                                                                                            | **第三页**                                                                                                                                                                                                                                                                                                                                                                             | **第四页**                                                                                   |
|:-------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------|
| **请求参数** | - `max_results` = `100`  - `tweet.fields` = `created_at`  - `start_time` = `2019-01-01T17:00:00Z`  - `end_time` = `2020-12-12T01:00:00Z`                                                                                                                                                                                                               | - `max_results` = `100`  - `tweet.fields` = `created_at`  - `start_time` = `2019-01-01T17:00:00Z`  - `end_time` = `2020-12-12T01:00:00Z`  - `pagination_token` = `7140w`                                                                                                                                                             | - `max_results` = `100`  - `tweet.fields` = `created_at`  - `start_time` = `2019-01-01T17:00:00Z`  - `end_time` = `2020-12-12T01:00:00Z`  - `pagination_token` = `7140k9`                                                                                                                                                             | - `max_results` = `100`  - `tweet.fields` = `created_at`  - `start_time` = `2019-01-01T17:00:00Z`  - `end_time` = `2020-12-12T01:00:00Z`  - `pagination_token` = `71408hi`                                   |
| **响应**          | `json { "data": [ { "created_at": "2020-12-11T20:44:52.000Z", "id": "1337498609819021312", "text": "感谢所有今天参与收看的朋友们……" }, ... , { "created_at": "2020-05-06T17:24:31.000Z", "id": "1258085245091368960", "text": "现在更容易理解推文影响力了……" } ], "meta": { "oldest_id": "1258085245091368960", "newest_id": "1337498609819021312", "result_count": 100, "next_token": "7140w" } } ` | `json { "data": [ { "created_at": "2020-04-29T17:01:44.000Z", "id": "1255542797765013504", "text": "我们的开发者社区充满了鼓舞人心的创意……" }, ... , { "created_at": "2019-11-21T16:17:23.000Z", "id": "1197549579035496449", "text": "我们很快将发布相关工具……" } ], "meta": { "oldest_id": "1197549579035496449", "newest_id": "1255542797765013504", "result_count": 100, "next_token": "7140k9", "previous_token": "77qp8" } } ` | `json { "data": [ { "created_at": "2019-11-21T16:17:23.000Z", "id": "1197549578418941952", "text": "我们知道，收到大量回复的用户可能会……" }, ... , { "created_at": "2019-01-08T19:19:37.000Z", "id": "1082718487011885056", "text": "网格嵌入的更新……" } ], "meta": { "oldest_id": "1082718487011885056", "newest_id": "1197549578418941952", "result_count": 95, "next_token": "71408hi", "previous_token": "77qplte" } } ` | `json { "meta": { "result_count": 0, "previous_token": "77qpw8l" } } ` || **下一次请求的操作** | 若要获取下一页，请直接从响应中取出 `next_token`（`7140w`），并将其设置为下一次请求的 `pagination_token`。                                                                                                                                                          | 若要继续获取全部结果：请直接从响应中取出 `next_token`（`7140k9`），并将其设置为下一次请求的 `pagination_token`。若要返回上一页：请直接从响应中取出 `previous_token`（`77qp8`），并将其设置为下一次请求的 `pagination_token`。             | 若要继续获取全部结果：请直接从响应中取出 `next_token`（`71408hi`），并将其设置为下一次请求的 `pagination_token`。若要返回上一页：请直接从响应中取出 `previous_token`（`77qplte`），并将其设置为下一次请求的 `pagination_token`。             | 请注意，此处没有 `next_token`，表示已获取全部结果。若要返回上一页：请直接从响应中取出 `previous_token`（`77qpw8l`），并将其设置为下一次请求的 `pagination_token`。 |