---
title: 认证用户查询
sidebarTitle: 认证用户查询
---

import { Button } from '/snippets/zh/button.mdx';

<div id="getting-started-with-the-authenticated-user-lookup-endpoint">
  ## 开始使用已验证用户查找端点
</div>

本快速入门指南将帮助你使用 Postman 向已验证用户查找端点发出第一个请求。

如果你想查看不同语言的示例代码，请访问我们的 [X API v2 sample code](https://github.com/xdevplatform/Twitter-API-v2-sample-code) GitHub 代码库。

<Note>
  ### 先决条件

  要完成本指南，你需要一组用于对请求进行身份验证的 [keys and tokens](/zh/resources/fundamentals/authentication)。你可以按照以下步骤生成这些 keys 和 tokens：

  - [注册开发者账号](https://developer.x.com/en/apply-for-access) 并获得审批。
  - 在开发者门户中创建一个 [Project](/zh/resources/fundamentals/projects) 以及关联的 [developer App](/zh/resources/fundamentals/developer-apps)。
  - 前往你的 App 的“Keys and tokens”页面以生成所需的凭据。请确保将所有凭据保存在安全的位置。
</Note>

<div id="steps-to-build-an-authenticated-user-lookup-request">
  ### 构建已授权用户查询请求的步骤
</div>

<div id="step-one-start-with-a-tool-or-library">
  #### 步骤一：从工具或库入手
</div>

有多种工具、代码示例和库可用于向此端点发起请求，但为简化流程，我们将在此使用 Postman。

要将 X API v2 的 Postman 集合导入到您的环境中，请点击以下按钮：

<Button href="https://app.getpostman.com/run-collection/9956214-784efcda-ed4c-4491-a4c0-a26470a67400">
  将 X API v2 添加到 Postman
</Button>

在将 X API v2 集合导入 Postman 后，前往 “Authenticated User Lookup” 文件夹，并选择 “Lookup an Authenticated User”。

<div id="step-two-authenticate-your-request">
  #### 步骤二：为请求进行身份验证
</div>

要正确地向 X API 发起请求，需要先验证访问权限。对于此端点，你必须使用 [OAuth 1.0a User Context](/zh/resources/fundamentals/authentication) 或 [OAuth 2.0 Authorization Code with PKCE](zh/resources/fundamentals/authentication#oauth-2-0-authorization-code-flow-with-pkce-2) 对请求进行身份验证。

在本示例中，我们将使用 OAuth 1.0a User Context。

你需要将密钥和令牌——具体包括 API Key、API Secret Key、OAuth 1.0a 用户 Access Token，以及 OAuth 1.0a 用户 Access Token Secret——添加到 Postman。你可以在 Postman 右上角选择名为“X API v2”的环境，并将这些密钥和令牌添加到“initial value”和“current value”字段（点击环境下拉菜单旁的眼睛图标）。

如果已正确完成上述操作，这些变量会自动填充到请求的“authorization”选项卡中。
 

<div id="step-three-determine-which-user-fields-you-want-to-retrieve">
  ##### 步骤三：确定要检索的用户字段
</div>

如果在完成步骤三后点击“Send”按钮，响应中将返回默认的[user object](/zh/x-api/fundamentals/data-dictionary#user)字段：id、name 和 username。

如果你希望在 id、name 和 username 之外获取更多字段，需要在请求中通过[field](/zh/x-api/fundamentals/fields)和/或[expansion](/zh/x-api/fundamentals/expansions)参数显式指定。

在本练习中，我们将从不同对象请求三组附加字段：

1. 主用户对象中的附加字段 user.created\_at。

2. 与返回用户关联的置顶帖子对象的默认字段：id 和 text。

3. 关联帖子对象中的附加字段 tweet.created\_at。

在 Postman 中，进入“Params”选项卡，在“Query Params”表中添加如下键值对：

|     |     |     |
| :--- | :--- | :--- |
| **Key** | **Value** | **Returned fields** |
| user.fields | created\_at | user.created\_at |
| expansions | pinned\_tweet\_id | includes.tweets.id,  <br />includes.tweets.text |
| tweet.fields | created\_at, author\_id | includes.tweets.created\_at, includes\_tweets.author\_id |

现在你应该会在“Send”按钮旁看到类似的 URL：

```
      https://api.x.com/2/users/me?user.fields=created_at&expansions=pinned_tweet_id&tweet.fields=author_id,created_at
```