---
title: 集成指南
sidebarTitle: 集成指南
---

import { Button } from '/snippets/zh/button.mdx';

本页介绍在将用户查找端点集成到你的系统时需要了解的多种工具与关键概念。我们将内容分为以下几个部分：

- [实用工具](#helpful)
- 关键概念
- [身份验证](#authentication)
- [开发者门户、项目与应用](#portal)
- [速率限制](#limits)
- [字段与扩展](#fields)
- [边界情况](#edge)

<div id="helpful-tools">
  ### 实用工具
</div>

在深入介绍有助于你集成此端点的关键概念之前，建议先熟悉以下内容：

<div id="postman">
  #### Postman
</div>

Postman 是一款非常适合测试端点的工具。每个 Postman 请求都包含所有路径和请求体参数，帮助你快速了解可用内容。要了解更多关于我们 Postman 集合的信息，请访问我们的 [「使用 Postman」](/zh/tutorials/postman-getting-started) 页面。 

<div id="code-samples">
  #### 代码示例
</div>

想使用你偏好的编程语言，通过一些代码来对接此端点吗？我们在 [GitHub 页面](https://github.com/xdevplatform/Twitter-API-v2-sample-code)提供了多种可作为起点的代码示例。

<div id="third-party-libraries">
  #### 第三方库
</div>

利用我们社区的[第三方库](/zh/x-api/tools-and-libraries/overview)加速起步。查找相应的版本标签即可找到兼容 v2 端点的库。

<div id="key-concepts">
  ### 关键概念
</div>

<div id="authentication">
  #### 身份验证
</div>

所有 X API v2 端点都要求使用一组凭据（也称为密钥和令牌）对请求进行[身份验证](/zh/resources/fundamentals/authentication)。你可以使用 OAuth 1.0a 用户上下文、仅应用模式，或 OAuth 2.0 授权码（含 PKCE）来对这些端点的请求进行认证。

[OAuth 1.0a 用户上下文](/zh/resources/fundamentals/authentication#oauth-1-0a-2)要求你使用 API Key、用户 Access Token，以及少量其他参数来[创建授权请求头](/zh/resources/fundamentals/authentication#authorizing-a-request)，然后随请求一并发送。Access Token 必须与代其发起请求的用户相关联。如果你想为其他用户生成一组 Access Token，他们必须使用[三方 OAuth 流程](https://developer-staging.x.com/resources/fundamentals/authentication/obtaining-user-access-tokens)授权你的 App。

请注意，OAuth 1.0a 使用起来可能比较复杂。如果你不熟悉这种身份验证方法，建议使用[库](/zh/x-api/tools-and-libraries/overview)、使用 Postman 等工具，或改用 OAuth 2.0 来为请求进行认证。如果你需要从这些端点请求帖子或私有指标，必须使用 OAuth 1.0a 用户上下文或 OAuth 2.0 授权码（含 PKCE），以确保你拥有内容所属用户授予的适当权限。

[仅应用模式](/zh/resources/fundamentals/authentication#bearer-token-also-known-as-app-only)只要求你在请求中携带一个[仅应用 Access Token](/zh/resources/fundamentals/authentication#bearer-token-also-known-as-app-only)。你可以直接在开发者 App 中生成仅应用 Access Token，或通过[POST oauth2/token](/zh/resources/fundamentals/authentication#post-oauth2-token) 端点生成。

[OAuth 2.0 授权码（含 PKCE）](/zh/resources/fundamentals/authentication#oauth-2-0-authorization-code-flow-with-pkce-2)可对应用的权限范围以及跨多设备的授权流程进行更精细的控制。OAuth 2.0 允许你选择特定的细粒度 scope，从而代表用户获得相应的权限。

要在你的 App 中启用 OAuth 2.0，必须在开发者门户的 App 设置页中的身份验证设置里开启该功能。

**请注意**

如果你请求以下字段，则需要使用 OAuth 1.0a 用户上下文或 OAuth 2.0 授权码：

- tweet.fields.non\_public\_metrics
- tweet.fields.promoted\_metrics
- tweet.fields.organic\_metrics

<div id="developer-portal-projects-and-developer-apps">
  #### 开发者门户、项目与开发者应用
</div>

要获取可用于 X API v2 端点的一组身份验证凭据，您必须先[注册开发者账号](https://developer.x.com/en/portal/petition/essential/basic-info)、在该账号下设置一个[项目](/zh/resources/fundamentals/projects)，并在该项目中创建一个[开发者应用](/zh/resources/fundamentals/developer-apps)。随后，您可以在开发者应用中找到自己的密钥和令牌。 
 

<div id="rate-limits">
  #### 速率限制
</div>

每天都有成千上万的开发者向 X API 发起请求。为帮助管理海量请求，我们在每个端点上设置了[速率限制](/zh/x-api/fundamentals/rate-limits)，以限制你代表应用或代表已验证用户所能发起的请求次数。

用户查找端点在应用级和用户级都会受到速率限制。不过，已验证用户查找端点仅在用户级受到速率限制。

应用级速率限制表示你（开发者）在给定时间段内，使用任意特定的 App（由你使用的密钥和令牌所标识）对该端点只能发起一定数量的请求。用户级速率限制表示你代表其发起请求的已验证用户，在任意开发者 App 中只能执行一定次数的请求。

下表展示了各端点的速率限制。

|     |     |     |
| :--- | :--- | :--- |
| **端点** | **HTTP 方法** | **速率限制 / 级别** |
| /2/users | GET | 每 15 分钟 900 次请求 / App 和 User |
| /2/users/:id | GET | 每 15 分钟 900 次请求 / App 和 User |
| /2/users/by | GET | 每 15 分钟 900 次请求 / App 和 User |
| /2/users/by/username/:username | GET | 每 15 分钟 900 次请求 / App 和 User |
| /2/users/me | GET | 每 15 分钟 75 次请求 / User |

<div id="fields-and-expansions">
  #### 字段与扩展
</div>

X API v2 提供一组称为“字段”和“扩展”的工具，允许你精确选择希望从 API 返回的数据。扩展参数用于展开有效负载中被引用的对象。例如，此端点允许你使用 pinned\_tweet\_id 扩展。

字段参数允许你在不同数据对象中精确指定希望接收的[字段](/zh/x-api/fundamentals/fields)。这些端点主要返回用户对象。默认情况下，用户对象包含 id、name 和 username 字段。若要接收其他字段（如 user.created\_at 或 user.location），必须通过字段参数明确请求。在你的集成中可能值得考虑的一些重要字段包括帖子投票数据、指标、注释以及会话 ID 等字段。

我们已在[X API v2 数据字典](/zh/x-api/fundamentals/data-dictionary)中提供了[如何使用字段与扩展](/zh/x-api/fundamentals/data-dictionary#how-to-use-fields-and-expansions)的指南。

<div id="edge-cases">
  #### 边缘情况
</div>

- 转发的帖子文本会被截断。短期的解决办法是展开被引用的帖子，并从展开结果中获取完整文本。这是一个我们将来会修复的缺陷。