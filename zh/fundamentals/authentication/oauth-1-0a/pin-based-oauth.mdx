---
title: 基于PIN的授权
sidebarTitle: 基于PIN的OAuth
---

import { Button } from "/snippets/zh/button.mdx";

<div id="pin-based-authorization">
  ### 基于 PIN 的授权
</div>

基于 PIN 的 OAuth 流程是[三方（3-legged）OAuth](/zh/resources/fundamentals/authentication/oauth-1-0a/obtaining-user-access-tokens)流程的一种变体，适用于授权后无法访问或嵌入网页浏览器以重定向用户的应用程序。此类应用的示例包括命令行应用、嵌入式系统、游戏主机以及某些类型的移动应用。

基于 PIN 的 OAuth 流程由应用在 `request_token` 阶段发起，并将 `oauth_callback` 设为 `oob`。术语 `oob` 表示带外（out-of-band）OAuth。用户仍需访问 X 登录或授权该应用，但在批准访问后不会自动重定向回应用程序。相反，他们会看到一个数字 PIN 码，并收到返回应用并输入该值的指引。

<Note>
  **注意：** 即使使用基于 PIN 的授权，X 应用设置中的 `callback_url` 仍然是必填项。
</Note>

 

<div id="implementing-the-pin-based-oauth-flow">
  #### 实施基于 PIN 的 OAuth 流程
</div>

基于 PIN 的流程与[三方授权](/zh/resources/fundamentals/authentication/oauth-1-0a/obtaining-user-access-tokens)（以及[使用 X 登录](/zh/resources/fundamentals/authentication#log-in-with-x)）的实现方式相同，但有以下差异：

1. 在调用 [POST oauth/request\_token](/zh/resources/fundamentals/authentication/api-reference#post-oauth-request-token) 时，`oauth_callback` 的值必须设置为 `oob`。

2. 当用户被引导至 X，并通过 [GET oauth/authenticate](/zh/resources/fundamentals/authentication/api-reference#get-oauth-authenticate) 或 [GET oauth/authorize](/zh/resources/fundamentals/authentication/api-reference#get-oauth-authorize) 授权你的应用后，用户不会被重定向到你的 `callback_url`，而是会看到一个页面，上面显示由 X 生成的约 7 位 PIN，并附有指引，要求将该 PIN 输入到你的应用中。

3. 用户在你的应用中输入该 PIN；你的应用在调用 [POST oauth/access\_token](/zh/resources/fundamentals/authentication/api-reference#post-oauth-access-token) 时，将该 PIN 作为 `oauth_verifier` 使用，以获取 `access_token`。

<Note>
  **注意：** PIN 不可重复使用，且获取到的 `access_token` 应用于应用与用户相关的请求。
</Note>