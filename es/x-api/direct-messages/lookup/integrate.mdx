---
title: Guía de integración
sidebarTitle: Guía de integración
---

import { Button } from '/snippets/es/button.mdx';

Los endpoints de Mensajes Directos v2 introducen las conversaciones y los eventos de conversación como objetos fundamentales de la API de X, y distinguen entre conversaciones 1-1 y de grupo. Las conversaciones 1-1 siempre tienen dos, y solo dos, participantes, mientras que las conversaciones de grupo pueden tener dos o más y membresías que pueden cambiar.   

Esta página contiene información sobre varias herramientas y conceptos clave que debe conocer al integrar los endpoints de búsqueda de Mensajes Directos en su sistema. Hemos dividido la página en dos secciones:

- Conceptos clave
  - [Conversaciones de Mensajes Directos](#direct-message-conversations)
  - [ID de conversación y de evento compartidos entre v1.1 y v2](#shared-conversation-and-event-ids)
  - [Campos y expansiones de eventos de Mensajes Directos](#direct-message-event-fields-and-expansions)
  - [Tipos de eventos de conversación](#conversation-event-types)
  - [Autenticación](#authentication)
  - [Portal para desarrolladores, Proyectos y Apps](#developer-portal-projects-and-apps)
  - [Límites de tasa](#rate-limits)
  - [Paginación](#pagination)
- [Herramientas útiles](#helpful-tools)

<div id="key-concepts">
  ### Conceptos clave
</div>

<div id="direct-message-conversations">
  ### Conversaciones de Mensajes Directos
</div>

Todos los Mensajes Directos forman parte de una conversación de Mensajes Directos. Estas conversaciones pueden ser entre dos personas o de grupo. Este lanzamiento proporciona los endpoints fundamentales necesarios para crear Mensajes Directos y recuperar eventos asociados con conversaciones de Mensajes Directos. Todas las conversaciones tienen un dm\_conversation\_id único y los eventos que componen esa conversación tienen cada uno un dm\_event\_id único.  

Los endpoints de consulta de Mensajes Directos proporcionan métodos para recuperar eventos asociados con conversaciones. Estos endpoints GET se utilizan para recuperar los mensajes que componen una conversación y, en el caso de conversaciones de grupo, pueden utilizarse para ver quién se ha unido y quién ha salido de las conversaciones de grupo.

Esta versión inicial de la consulta de Mensajes Directos incluye tres métodos GET:

- **GET /2/dm\_conversations/with/:participant\_id/dm\_events** - Recupera eventos de Mensajes Directos asociados con una conversación entre dos personas. El parámetro de ruta :participant\_id es el ID de usuario numérico de la cuenta que mantiene la conversación con el usuario autenticado que realiza esta solicitud.  

- **GET /2/dm\_conversations/:dm\_conversation\_id/dm\_events** - Recupera eventos de Mensajes Directos asociados con un ID de conversación específico, según lo indicado por el parámetro de ruta :dm\_conversation\_id. Se admiten IDs de conversaciones tanto entre dos personas como de grupo.  

- **GET /2/dm\_events** - Recupera eventos de Mensajes Directos asociados con el usuario autenticado, incluidas conversaciones tanto entre dos personas como de grupo. Hay eventos disponibles de hasta 30 días atrás.  

Todos estos endpoints GET admiten recuperar dm\_events por tipo de evento mediante el parámetro de consulta event\_types. Actualmente, se admiten tres tipos de eventos de conversación:

- **MessageCreate** - Se crea cuando se genera un nuevo Mensaje Directo. Este objeto de evento puede incluir la hora y el texto del mensaje, junto con el ID de la cuenta que envió el mensaje y los IDs de la conversación y del evento. 

- **ParticipantsJoin** - Se crea cuando un nuevo participante se une a una conversación de grupo. Este objeto dm\_event incluye el ID del participante que se une, junto con la marca de tiempo created\_at y el sender\_id del evento “invite”. 

- **ParticipantsLeave** - Se crea cuando un participante abandona una conversación. Este objeto de evento incluye el ID del participante que abandona, junto con la hora del evento. 

Para más información, consulte las [referencias de la API de consulta de Mensajes Directos](/es/x-api/direct-messages/get-dm-events-for-a-dm-conversation).

<div id="shared-conversation-and-event-ids-across-v11-and-v2">
  ### IDs de conversación y de evento compartidos entre v1.1 y v2
</div>

Un concepto importante es que los IDs de conversación y de evento se comparten entre las versiones v1.1 y v2 de la Plataforma de X. Esto significa que ambas versiones pueden usarse conjuntamente. Por ejemplo, los endpoints de Direct Messages v1.1 ofrecen métodos para recuperar un único evento y para eliminar eventos, métodos que aún no están disponibles en v2. Dado que los IDs son comunes entre v1.1 y v2, puede realizar solicitudes a v1.1 basadas en IDs proporcionados por v2, o haciendo referencia a los IDs de conversación que se muestran en las URL de conversación en la aplicación de X.  

<div id="direct-message-event-fields-and-expansions">
  ### Campos y expansiones de eventos de Mensaje Directo
</div>

La API de X v2 permite seleccionar exactamente qué datos devolver desde la API mediante un conjunto de herramientas llamadas campos y expansiones. Por ejemplo, los endpoints de consulta de Mensajes Directos admiten los siguientes campos de dm\_events:

- id, event\_type y text son los valores predeterminados para los eventos MessageCreate.

- id, event\_type y participant\_ids son los valores predeterminados para los eventos ParticipantsJoin y ParticipantsLeave.

- dm\_conversation\_id y created\_at están disponibles para todos los eventos.

- attachments y referenced\_tweets están disponibles para los eventos MessageCreate.

- sender\_id está disponible para los eventos MessageCreate y ParticipantsJoin.

- participant\_ids está disponible para los eventos ParticipantsJoin y ParticipantsLeave.

Además, los endpoints de consulta de Mensajes Directos admiten las siguientes [expansions](/es/x-api/fundamentals/expansions):

- sender\_id: Expande el objeto User asociado con quien envió el mensaje o quien invitó a alguien a la conversación.

- referenced\_tweets.id: Expande el objeto Post si el texto del Mensaje Directo incluye un enlace a una Publicación.

- attachments.media\_keys: Expande el objeto Media si el Mensaje Directo incluye un archivo multimedia adjunto.

- participant\_ids: Expande el objeto User asociado con quien se unió o salió de una conversación grupal.

Dado que las expansiones incluyen objetos Post, User y Media, también puede usar los parámetros de consulta tweet.fields, user.fields y media.fields. Consulte nuestra guía sobre cómo [usar campos y expansiones](/es/x-api/fundamentals/data-dictionary#how-to-use-fields-and-expansions) para obtener más información.

<div id="conversation-event-types">
  ### Tipos de eventos de conversación
</div>

A continuación se muestran objetos JSON de ejemplo para los tipos de evento de Mensaje Directo MessageCreate, ParticipantsJoin y ParticipantsLeave.

Campos disponibles del objeto dm\_event: id, text, event\_type, dm\_conversation\_id, created\_at, sender\_id, attachments, referenced\_tweets, participant\_ids. Consulte la sección Fields and Expansion para obtener más detalles sobre cómo seleccionar estos campos en sus solicitudes.

Ejemplo de evento MessageCreate:

Con todos los campos de dm\_event especificados, esta es la respuesta para un Mensaje Directo de texto simple:

`{
    "text": "Hi everyone.",
    "sender_id": "944480690",
    "dm_conversation_id": "1578398451921985538",
    "id": "1582838499983564806",
    "event_type": "MessageCreate",
    "created_at": "2022-10-19T20:58:00.000Z"
}`

Ejemplo de evento ParticipantsJoin:

Con todos los campos de dm\_event especificados, esta es la respuesta para un participante que se une a una conversación:

`{
    "participant_ids": [
        "944480690"
    ],
    "sender_id": "17200003",
    "dm_conversation_id": "1578398451921985538",
    "id": "1582835469712138240",
    "event_type": "ParticipantsJoin",
    "created_at": "2022-10-19T20:45:58.000Z"
}`

Ejemplo de evento ParticipantsLeave:

Con todos los campos de dm\_event especificados, esta es la respuesta para un participante que abandona una conversación:

`{
    "participant_ids": [
        "944480690"
    ],
    "dm_conversation_id": "1578398451921985538",
    "id": "1582838535115067392",
    "event_type": "ParticipantsLeave",
    "created_at": "2022-10-19T20:58:09.000Z"
    }`

<div id="authentication">
  ### Autenticación
</div>

Todos los endpoints de la API de X v2 requieren que autentiques tus solicitudes con un conjunto de credenciales, también conocidas como claves y tokens. Todos los Mensajes Directos son privados y requieren autorización del usuario para acceder a ellos.

Estos endpoints de Mensajes Directos requieren el uso del [flujo de autorización OAuth 2.0 con PKCE](/es/x-api/posts/manage-tweets) o del [contexto de usuario 1.0a](/es/resources/fundamentals/authentication), lo que significa que debes usar un conjunto de claves de API y tokens de acceso de usuario para realizar una solicitud correcta. Los tokens de acceso deben estar asociados con el usuario en cuyo nombre realizas la solicitud. Si deseas generar un conjunto de tokens de acceso para otro usuario, este debe autorizar o autenticar tu App utilizando el [flujo OAuth de 3 patas](/es/resources/fundamentals/authentication#obtaining-access-tokens-using-3-legged-oauth-flow).

Ten en cuenta que el contexto de usuario de OAuth puede ser complejo de usar. Si no estás familiarizado con este método de autenticación, te recomendamos usar una [biblioteca](/es/x-api/tools-and-libraries/overview) o una herramienta como Postman para autenticar correctamente tus solicitudes.

[OAuth 2.0 Authorization Code with PKCE](es/resources/fundamentals/authentication#oauth-2-0-authorization-code-flow-with-pkce-2) permite un mayor control sobre el alcance de una aplicación y flujos de autorización en múltiples dispositivos. OAuth 2.0 te permite elegir ámbitos específicos y granulares que te otorgan permisos precisos en nombre de un usuario. Los endpoints de consulta de Mensajes Directos requieren estos ámbitos: dm.read, post.read, user.read

Para habilitar OAuth 2.0 en tu App, debes activarlo en la configuración de autenticación de tu App, que se encuentra en la sección de configuración de la App en el portal para desarrolladores.

<div id="developer-portal-projects-and-developer-apps">
  ### Portal para desarrolladores, Proyectos y Apps de desarrollador
</div>

Para obtener un conjunto de credenciales de autenticación que funcione con los endpoints de la API de X v2, debe tener una cuenta de desarrollador aprobada, configurar un Proyecto en esa cuenta y crear una App de desarrollador en ese Proyecto. Luego podrá encontrar sus claves y tokens en su App de desarrollador. 

<div id="rate-limits">
  ### Límites de uso
</div>

Cada día, miles de desarrolladores realizan solicitudes a la API de X. Para gestionar el gran volumen de estas solicitudes, se aplican límites de uso en cada endpoint que restringen la cantidad de solicitudes que puedes realizar en nombre de tu app o de un usuario autenticado.

Los endpoints de consulta de Mensajes Directos tienen límites de uso a nivel de usuario, lo que significa que el usuario autenticado en cuyo nombre realizas la solicitud solo puede efectuar un número determinado de solicitudes con tu app de X. Existe un límite de 300 solicitudes por usuario cada 15 minutos para los métodos GET. Estos límites se comparten entre los endpoints GET. 

<div id="pagination">
  ### Paginación
</div>

Estos endpoints utilizan paginación para que las respuestas se devuelvan rápidamente. En los casos en que haya más resultados de los que se pueden enviar en una sola respuesta (hasta 100 eventos), deberá paginar. Use el parámetro max\_results para definir cuántos resultados se devolverán por página y el parámetro pagination\_token para obtener la siguiente página de resultados. Puede obtener más información en nuestra [guía de paginación](/es/x-api/fundamentals/pagination).

**Herramientas útiles**

A continuación encontrará algunas herramientas útiles que le recomendamos explorar mientras trabaja con los endpoints de consulta de Mensajes Directos: 

****Postman****

Postman es una excelente herramienta que puede usar para probar un endpoint. Cada solicitud de Postman incluye todos los parámetros de ruta y de cuerpo para ayudarle a entender rápidamente qué está disponible. Para obtener más información sobre nuestras colecciones de Postman, visite nuestra página [Uso de Postman](/es/tutorials/postman-getting-started). 

****Ejemplos de código****

El código de ejemplo en Python para los endpoints de Mensajes Directos de v2 está disponible en nuestro repositorio de [código de ejemplo de la API de X v2 en GitHub](https://github.com/xdevplatform/Twitter-API-v2-sample-code). La carpeta "Manage-Direct-Messages" contiene ejemplos para los métodos POST y la carpeta "Direct-Messages-lookup" contiene ejemplos para los métodos GET.

****Kits de desarrollo de software (SDK) de XDev****

Estas [bibliotecas](/es/x-api/tools-and-libraries/overview) se están actualizando para los endpoints de Mensajes Directos de v2 y deberían estar listas pronto:

- [X API Java SDK](https://github.com/xdevplatform/twitter-api-java-sdk) - SDK oficial de Java para la API de X v2
- [X API TypeScript/JavaScript SDK](https://github.com/xdevplatform/twitter-api-typescript-sdk) - SDK oficial de TS/JS para la API de X v2

**Bibliotecas de terceros**

Hay un número creciente de [bibliotecas de terceros](/es/x-api/tools-and-libraries/overview#community-tools-and-libraries-for-v2) desarrolladas por nuestra comunidad. Estas bibliotecas están diseñadas para ayudarle a comenzar, y se espera que varias admitan pronto los endpoints de Mensajes Directos de v2. Puede encontrar una biblioteca que funcione con los endpoints de v2 buscando la etiqueta de versión correspondiente.