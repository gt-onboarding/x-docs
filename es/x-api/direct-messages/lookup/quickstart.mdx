---
title: Guía rápida
sidebarTitle: Guía rápida
---

import { Button } from '/snippets/es/button.mdx';

<div id="getting-started-with-the-manage-direct-message-endpoints">
  ## Introducción a los endpoints para gestionar Mensajes Directos
</div>

Esta guía de inicio rápido le ayudará a realizar su primera solicitud a los endpoints de Mensajes Directos con Postman, una herramienta para gestionar y efectuar solicitudes HTTP. Para obtener más información sobre nuestras colecciones de Postman, visite la guía [Uso de Postman](/es/tutorials/postman-getting-started).

Si desea revisar ejemplos en Python, visite nuestro repositorio de GitHub [Código de ejemplo de la API de X v2](https://github.com/xdevplatform/Twitter-API-v2-sample-code). Además, los [kits de desarrollo de software (SDK) de la Plataforma de Desarrolladores de X](/es/x-api/tools-and-libraries/sdks) oficiales se actualizarán para admitir estos endpoints de Mensajes Directos.  

<Note>
  **Requisitos previos**

  Para completar esta guía, necesitará un conjunto de [claves y tokens](/es/resources/fundamentals/authentication) para autenticar su solicitud. Puede generar estas claves y tokens siguiendo estos pasos:

  - [Solicite una cuenta de desarrollador](https://developer.x.com/en/apply-for-access) y espere la aprobación.
  - Cree un [Proyecto](/es/resources/fundamentals/projects) y una [App de desarrollador](/es/resources/fundamentals/developer-apps) asociada en el portal de desarrolladores.
  - Vaya a la página “Keys and tokens” de su App para generar las credenciales requeridas. Asegúrese de guardar todas las credenciales en una ubicación segura.
</Note>

<div id="steps-to-building-direct-message-lookup-requests">
  ### Pasos para crear solicitudes de consulta de Mensajes Directos
</div>

En este ejemplo, en una sola solicitud crearemos una nueva conversación grupal y añadiremos nuestro primer mensaje. Luego añadiremos un segundo mensaje a la conversación creada.

<div id="step-one-start-with-a-tool-or-library">
  #### Paso uno: Comience con una herramienta o biblioteca
</div>

Para empezar a trabajar con los endpoints de administración de Mensajes Directos, usaremos la herramienta Postman para simplificar el proceso. Se utilizará una colección de solicitudes de ejemplo de la API de X v2, creada por XDevelopers, para explorar seis endpoints usados para crear nuevos Mensajes Directos y para listar eventos de conversaciones de Mensajes Directos.

Aunque gran parte de la colección está preconfigurada, hay algunos detalles que deberá proporcionar en función de la App de X creada para alojar estas solicitudes de API. Primero, carguemos/actualicemos la colección.

Para cargar la colección de Postman de la API de X v2 en su entorno, haga clic en el siguiente botón:

<Button href="https://app.getpostman.com/run-collection/9956214-784efcda-ed4c-4491-a4c0-a26470a67400">
  Agregar API de X v2 a Postman
</Button>

Una vez que tenga la colección de la API de X v2 cargada en Postman, navegue a la carpeta “Manage Direct Messages”. La pestaña Authorization de esta carpeta se ha preconfigurado cuando ha sido posible. Deberá actualizar algunos ajustes para incluir los detalles de autenticación de su App de X.

Esta carpeta también contiene tres endpoints para crear nuevos Mensajes Directos. Tenga en cuenta que también hay una carpeta "Direct Message lookup" con tres endpoints disponibles para recuperar eventos de conversaciones de Mensajes Directos, incluido el envío y la recepción de mensajes, y cuándo los participantes de la conversación se unen y abandonan.

Dado que la creación de conversaciones grupales es una característica nueva de la API de X v2, este ejemplo se centrará en ello. Trabajaremos con el ejemplo "New group DM and conversation". Usaremos esta solicitud para crear una conversación grupal de Mensajes Directos.

El siguiente paso es autenticarse con el endpoint.

<div id="step-two-authenticate-your-request">
  #### Paso dos: autentica tu solicitud
</div>

Para realizar correctamente una solicitud a la API de X, debes verificar que tienes permiso para hacerlo. Para hacer una solicitud exitosa a este endpoint, usaremos [OAuth 2.0 Authorization Code Flow with PKCE](es/resources/fundamentals/authentication#oauth-2-0-authorization-code-flow-with-pkce-2). Puedes generar un token de acceso en Postman. 

Con Postman puedes establecer el método de autenticación a nivel de carpeta o de solicitud. Aquí configuraremos los detalles de autenticación a nivel de carpeta. Navega a la carpeta "Mange Direct Messages", selecciona la pestaña "Authorization" y confirma que Type esté establecido en “OAuth 2.0”, y que "Add auth data to" esté establecido en "Request Headers". En la sección "Current Token", asegúrate de que "Header Prefix" esté establecido en Bearer.  

Para configurar y generar un nuevo token:

1. Crea un Token Name, por ejemplo "DM lookup".

2. Confirma que **Grant Type** esté establecido en Authorization Code (with PKCE).

3. Configura tu **Callback URL**. Debe coincidir exactamente con el Callback URL asociado a tu aplicación en el [v2 Dev Portal](https://developer.x.com/en/portal/dashboard). En la X App usada en este ejemplo, el Callback URL es: [https://www.example.com](https://www.example.com/) (Ten en cuenta que, como debe coincidir exactamente, [https://example.com](https://example.com) no funcionaría). 

4. Confirma que **Auth URL** esté establecido en [https://x.com/i/oauth2/authorize](https://x.com/i/oauth2/authorize)

5. Confirma que **Access Token URL** esté establecido en [https://api.x.com/2/oauth2/token](https://api.x.com/2/oauth2/token) **Client ID** - Copia y pega el OAuth 2.0 Client ID desde el Developer Portal
   **Client Secret** - Solo lo necesitarás si usas un tipo de App que sea cliente confidencial. Si es así, copia y pega el OAuth 2.0 Client Secret desde el Developer Portal. 

6. Confirma que **Scope** esté establecido en dm.read dm.write tweet.read users.read.

7. Confirma que **State** esté establecido en “state”.

8. Confirma que **Client Authentication** esté establecido en Send as Basic Auth header.

9. Haz clic en “Get New Access Token” y luego en "Authorize app" como parte del proceso "Sign-in with X".

10. Haz clic en el botón "Proceed" y luego en "Use Token" para generar un token. 

11. Haz clic en el botón "Save" para guardar estos detalles de configuración.

Es posible que recibas un mensaje indicando que no has iniciado sesión en X. Si ves este error, deberás iniciar sesión en la cuenta de X en cuyo nombre intentas publicar dentro de Postman.

Ahora que estos detalles de OAuth 2.0 se han configurado a nivel de carpeta, navega a cada uno de los ejemplos y a su pestaña "Authorization" y confirma que tengan su Type establecido en "Inherit auth from parent". 

Ten en cuenta que este token expirará pronto y tendrás que regenerarlo haciendo clic en el botón "Get New Access Token". Al hacerlo, se iniciará el proceso "Sign-in with X" y se generará un token nuevo para realizar solicitudes.

<div id="step-three-retrieve-direct-messages-conversation-events">
  #### Paso tres: Recuperar eventos de conversaciones de Mensajes Directos
</div>

Al recuperar eventos de conversaciones de Mensajes Directos con este endpoint, debes especificar un ID de conversación. El ID de conversación forma parte de la ruta del endpoint: https://api.x.com/2/dm\_conversations/:dm\_conversation\_id/dm\_events

En Postman, ve a la pestaña "Params" e ingresa el ID de la conversación para la que deseas recuperar eventos en la sección "Path Variables".

La configuración sería:

|     |     |
| :--- | :--- |
| **Key** | **Value** |
| `dm_conversation_id` | `1228393702244134912` |

Con esta conversación especificada, la ruta resultante pasa a ser https://api.x.com/2/dm\_conversations/1582103724607971328/dm\_events

Si haces clic en el botón "Send", recibirás en la respuesta los campos predeterminados del objeto de Mensaje Directo: id, text y event\_type. También habrá un objeto "meta" con la cantidad de resultados, junto con tokens de paginación usados para recuperar más eventos si están disponibles.

```
{
   "data": [
       {
           "event_type": "MessageCreate",
           "id": "1580705921830768647",
           "text": "hello to you two, this is a new group conversation."
       }
   ],
   "meta": {
       "result_count": 1,
       "next_token": "18LAA5FFPEKJA52G0G00ZZZZ",
       "previous_token": "1BLC45FFPEKJA52G0S00ZZZZ"
   }
}
```

Si deseas recibir campos adicionales, tendrás que especificarlos en tu solicitud con los parámetros [field](/es/x-api/fundamentals/fields) y/o [expansion](/es/x-api/fundamentals/expansions).

Para este ejercicio, solicitaremos conjuntos adicionales de campos del objeto dm\_event:

1. Los campos predeterminados del objeto de Mensaje Directo: id, text y event\_type.

2. Campos adicionales del objeto de Mensaje Directo: dm\_conversation\_id, created\_at, sender\_id, attachments, participant\_ids, referenced\_tweets

En Postman, ve a la pestaña "Params" y agrega el siguiente par key:value a la tabla "Query Params":

|     |     |
| :--- | :--- |
| Key | Value |
| dm\_event.fields | dm\_conversation\_id,created\_at,sender\_id,attachments,participant\_ids,referenced\_tweets |

Ahora deberías ver la siguiente URL junto al botón "Send":

https://api.x.com/2/dm\_conversations/:dm\_conversation\_id/dm\_events?dm\_event.fields=id,text,event\_type,dm\_conversation\_id,created\_at,sender\_id,attachments,participant\_ids,referenced\_tweets

<div id="step-four-make-your-request-and-review-your-response">
  #### Paso cuatro: Realiza tu solicitud y revisa la respuesta
</div>

Una vez que tengas todo configurado, haz clic de nuevo en el botón "Send" y recibirás una respuesta similar a la siguiente. Ten en cuenta que esta respuesta incluye todos los campos disponibles de dm\_event.

```
{
   "data": [
       {
           "text": "hello to you two, this is a new group conversation.",
           "id": "1580705921830768647",
           "dm_conversation_id": "1580705921830768643",
           "event_type": "MessageCreate",
           "sender_id": "17200003",
           "created_at": "2022-10-13T23:43:54.000Z"
       }
   ],
   "meta": {
       "result_count": 1,
       "next_token": "18LAA5FFPEKJA52G0G00ZZZZ",
       "previous_token": "1BLC45FFPEKJA52G0S00ZZZZ"
   }
}
```