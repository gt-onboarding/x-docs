---
title: Introducción a R y a la API de X v2
mode: wide
---

<div id="introduction">
  ## Introducción
</div>

Este tutorial te guiará por lo que necesitas para comenzar con el
lenguaje de programación R y la API de X v2. Usando R para conectarte al endpoint
[user lookup](/es/x-api/users/lookup/introduction), mostraré cómo trabajar
con el JSON que devuelve la API de X. User lookup es un método GET y devuelve
información sobre un usuario o un grupo de usuarios, especificados por un ID de usuario o un
nombre de usuario.

Si no estás familiarizado, R es uno de los lenguajes más populares para tareas comunes de ciencia
de datos como análisis de series temporales, modelado, visualización y otros análisis de
datos, y a menudo se utiliza junto con la API de X. Con el endpoint de user
lookup, puedes usar el
[user object](/es/x-api/fundamentals/data-dictionary#user) para
determinar la correlación entre la cantidad de seguidores que tiene una persona y la
puntuación de sentimiento de su biografía. El user object también puede utilizarse para mapear un grupo de
cuentas según la ubicación que figure públicamente en sus perfiles.

<div id="getting-started-with-the-x-api">
  ### Introducción a la API de X
</div>

Antes de poder usar la API de X v2, deberá
[registrarse](https://developer.x.com/en/portal/petition/essential/basic-info)
para obtener una cuenta de desarrollador.

Una vez que tenga una cuenta de desarrollador aprobada, primero deberá crear un
[Proyecto](/es/resources/fundamentals/projects). Los Proyectos le permiten organizar su trabajo
según cómo planea usar la API de X, para que pueda gestionar eficazmente
su acceso a la API y supervisar su uso.

Cada Proyecto contiene una [App](/es/resources/fundamentals/developer-apps), con la cual podrá
generar las credenciales necesarias para usar la API de X. Puede obtener más información
sobre cómo comenzar con la API de X en la sección de
[introducción](/es/x-api/getting-started/about-x-api) de nuestra
documentación.

<div id="getting-your-r-environment-set-up">
  ### Configurar tu entorno de R
</div>

Primero, debes [descargar R](https://cloud.r-project.org/), lo cual puedes hacer
en el [sitio web de CRAN](https://cran.r-project.org/).

Luego, para configurar un entorno de trabajo con R, puedes usar
[RStudio](https://www.rstudio.com/), el paquete de extensiones de R para
[Visual Studio Code](https://marketplace.visualstudio.com/items?itemName=Ikuyadeu.r-pack),
o un
[notebook de Jupyter](https://docs.anaconda.com/anaconda/navigator/tutorials/r-lang/)
si vienes del mundo de Python.

<div id="setting-up-your-environment-variable">
  ### Configuración de su variable de entorno
</div>

Para los ejemplos de código que voy a mostrar hoy, querrá crear una
variable de entorno para su token Bearer. El Bearer Token es lo que le permite
autenticarse en la API de X y empezar a realizar solicitudes. Primero, reemplace
“your-bearer-token” por su propio token Bearer, que puede obtener en la
sección de claves y tokens de su App en el portal para desarrolladores. Deberá ejecutar
esta línea de código en la consola antes de empezar a escribir un script.

```r
Sys.setenv(BEARER_TOKEN = "your-bearer-token")
```

<div id="making-your-request">
  ### Realizar tu solicitud
</div>

Puedes usar el paquete
[httr](https://cran.r-project.org/web/packages/httr/index.html) para realizar solicitudes HTTP
a la API de X. Si aún no lo has instalado, instala el paquete en tu consola. También necesitarás instalar
[jsonlite](https://cran.r-project.org/web/packages/jsonlite/index.html) para trabajar
con objetos JSON y [dplyr](https://dplyr.tidyverse.org/) para la
manipulación de datos.

```r
install.packages("httr")
install.packages("jsonlite")
install.packages("dplyr")
```

Ahora puedes comenzar a escribir tu script de R para conectarte a la API. En la parte superior del
archivo, carga los paquetes httr, jsonlite y dplyr.

```r
require(httr)
require(jsonlite)
require(dplyr)
```

El primer paso en tu ejemplo de código es prepararte para autenticarte con la
API de X. Obtén el
[Bearer Token](/es/resources/fundamentals/authentication#using-and-generating-an-app-only-bearer-token) que extrajiste de
tu App y pásalo en los encabezados para la autenticación. En el ejemplo de abajo,
reemplaza $BEARER\_TOKEN por tu token.

```r
bearer_token <- Sys.getenv("$BEARER_TOKEN")
headers <- c(`Authorization` = sprintf('Bearer %s', bearer_token))
```

Una vez que tengas configurada la autenticación, define los parámetros de tu solicitud.
De forma predeterminada, recibirás el id, name y username de cada usuario recuperado.
Puedes ajustar este payload agregando
[fields](/es/x-api/fundamentals/fields) y
[expansions](/es/x-api/fundamentals/expansions) adicionales. Para este ejemplo, necesitarás
la biografía del perfil del usuario, que se solicita usando user.fields=description,
y una expansión que contenga el Post fijado del usuario.

```r
params <- list(`user.fields` = 'description', `expansions` = 'pinned_tweet_id')
```

Ahora estás listo para formatear tu URL con el handle de X, también conocido como
cuenta, sobre la cual deseas obtener más información. Usa el método readline
para que este ejemplo sea reutilizable. Después de escribir el handle que quieres consultar,
da formato a tu URL para que contenga el handle que definas reemplazando $USERNAME por
el handle de X deseado.

```r
handle <- readline('$USERNAME')
url_handle <- sprintf('https://api.x.com/2/users/by?usernames=%s', handle)
```

En este punto, usa el paquete httr para hacer una solicitud GET a la URL que acabas de
crear, pasa tu credencial de autenticación en el encabezado y pasa los
parámetros que definiste. Puedes guardar la respuesta como un objeto de texto en la
variable obj e imprimirla para ver el resultado de la solicitud que realizaste.

```r
response <-
  httr::GET(url = url_handle,
    httr::add_headers(.headers = headers),
    query = params)
obj <- httr::content(response, as = "text")
print(obj)
```

<div id="working-with-our-json-payload">
  ### Trabajar con nuestra carga JSON
</div>

Una de mis formas favoritas de trabajar con un JSON es usar un data frame, lo que permite
acceder fácilmente a datos anidados complejos. Para hacerlo, usa el método fromJSON del
paquete jsonlite para aplanar tu archivo y que los campos queden en el mismo
objeto. Luego, pasa ese objeto a un data frame. Ahora estás listo para visualizar este
data frame.

```
json_data <- fromJSON(obj, flatten = TRUE) %>% as.data.frame View(json_data)
```

Puedes acceder a los campos de los datos desde el data frame y pasarlos a una
cadena que incluya el handle, el nombre de usuario y la biografía.

```r
final <-
  sprintf(
    "Handle: %s\nBio: %s\nPublicación fijada: %s",
    json_data$data.username,
    json_data$data.description,
    json_data$includes.tweets.text
  )
```

Usa cat en lugar de print para ver el objeto con saltos de línea entre cada campo que
estás extrayendo.

```r
cat(final)
```

Si tuvieras varios handles para los que hiciste solicitudes, podrías usar fácilmente un bucle
para acceder a cada elemento del data frame.

<div id="conclusion">
  ### Conclusión
</div>

Esperamos que este tutorial sea un punto de partida para trabajar con R y la
API de X. Como siguiente paso, quizá quiera consultar nuestros ejemplos en R para búsqueda reciente,
consulta de publicaciones y consulta de usuarios en nuestro
[v2 sample code](https://github.com/xdevplatform). No dude en hacérnoslo saber en los
[foros](https://devcommunity.x.com/) si encuentra algún problema en el
camino o publíquenos en [@XDevelopers](https://x.com/XDevelopers) si este
tutorial le inspira a crear algo.