---
title: Flujo de código de autorización de OAuth 2.0 con PKCE
sidebarTitle: Flujo de código de autorización de OAuth 2.0 con PKCE
---

<div id="oauth-20-authorization-code-flow-with-pkce">
  ### Flujo de código de autorización de OAuth 2.0 con PKCE
</div>

<div id="introduction">
  #### Introducción
</div>

OAuth 2.0 es un protocolo de autorización estándar del sector que permite un mayor control sobre el alcance de una aplicación y sobre los flujos de autorización en múltiples dispositivos. OAuth 2.0 le permite elegir alcances granulares específicos que le otorgan permisos concretos en nombre de un usuario.

Para habilitar OAuth 2.0 en su App, debe activarlo en la configuración de autenticación de su App, ubicada en la sección de configuración de la App en el portal para desarrolladores.

#### ¿Cuánto tiempo seguirán siendo válidas mis credenciales?  

De forma predeterminada, el token de acceso que generes mediante el flujo de código de autorización con PKCE solo será válido durante dos horas, a menos que hayas usado el alcance `offline.access`.

<div id="refresh-tokens">
  #### Tokens de actualización
</div>

Los tokens de actualización permiten que una aplicación obtenga un nuevo token de acceso sin solicitar la intervención del usuario mediante el flujo de actualización.

Si se aplica el alcance `offline.access`, se emitirá un token de actualización de OAuth 2.0. Con este token de actualización, puede obtener un token de acceso. Si este alcance no se envía, no generaremos un token de actualización.

Un ejemplo de la solicitud que realizaría para usar un token de actualización y obtener un nuevo token de acceso es el siguiente:

```bash
POST 'https://api.x.com/2/oauth2/token' \
--header 'Content-Type: application/x-www-form-urlencoded' \
--data-urlencode 'refresh_token=bWRWa3gzdnk3WHRGU1o0bmRRcTJ5VUxWX1lZTDdJSUtmaWcxbTVxdEFXcW5tOjE2MjIxNDc3NDM5MTQ6MToxOnJ0OjE' \
--data-urlencode 'grant_type=refresh_token' \
--data-urlencode 'client_id=rG9n6402A3dbUJKzXTNX4oWHJ
```

<div id="app-settings">
  #### Configuración de la App
</div>

Puede seleccionar que la configuración de autenticación de su App sea OAuth 1.0a u OAuth 2.0. También puede habilitar que una App use tanto OAuth 1.0a como OAuth 2.0.

OAuth 2.0 solo puede usarse con la API de X v2. Si ha seleccionado OAuth 2.0, podrá ver un Client ID en la sección Keys and Tokens de su App. 

<div id="confidential-clients">
  #### Clientes confidenciales
</div>

Los [clientes confidenciales](https://datatracker.ietf.org/doc/html/rfc6749#section-2.1) pueden mantener las credenciales de forma segura sin exponerlas a terceros no autorizados y autenticarse de manera segura con el servidor de autorización, manteniendo a salvo tu secreto de cliente. Los clientes públicos, al ejecutarse normalmente en un navegador o en un dispositivo móvil, no pueden usar tus secretos de cliente. Si seleccionas un tipo de App que sea un cliente confidencial, se te proporcionará un secreto de cliente.

Si seleccionaste un tipo de cliente confidencial en el portal para desarrolladores, también podrás ver un secreto de cliente. Tus opciones son Native App, Single Page App, Web App, Automated App o bot. Native App y Single Page App son clientes públicos, y Web App y Automated App o los bots son clientes confidenciales.

No necesitas un client\_id para clientes confidenciales cuando utilizas un encabezado Authorization válido. Aun así, debes incluir client\_id en el cuerpo de las solicitudes realizadas con un cliente público. 

<div id="scopes">
  #### Alcances
</div>

Los alcances permiten definir acceso granular para tu App, de modo que solo tenga los permisos necesarios. Para obtener más información sobre qué alcances corresponden a qué endpoints, consulta nuestra [guía de asignación de autenticación](/es/resources/fundamentals/authentication/guides/v2-authentication-mapping).

|     |     |
| :--- | :--- |
| **Alcance** | **Descripción** |
| tweet.read | Todos los Tweets que puedes ver, incluidos los de cuentas protegidas. |
| tweet.write | Publicar Tweets y Retweets por ti. |
| tweet.moderate.write | Ocultar y mostrar respuestas a tus Tweets. |
| users.email | Correo electrónico de un usuario autenticado. |
| users.read | Cualquier cuenta que puedas ver, incluidas las cuentas protegidas. |
| follows.read | Personas que te siguen y a las que sigues. |
| follows.write | Seguir y dejar de seguir personas por ti. |
| offline.access | Mantener la conexión a tu cuenta hasta que revoques el acceso. |
| space.read | Todos los Spaces que puedes ver. |
| mute.read | Cuentas que has silenciado. |
| mute.write | Silenciar y dejar de silenciar cuentas por ti. |
| like.read | Tweets que te han gustado y Me gusta que puedes ver. |
| like.write | Indicar Me gusta y quitar Me gusta a Tweets por ti. |
| list.read | Listas, miembros de listas y seguidores de listas que has creado o de las que eres miembro, incluidas las listas privadas. |
| list.write | Crear y administrar Listas por ti. |
| block.read | Cuentas que has bloqueado. |
| block.write | Bloquear y desbloquear cuentas por ti. |
| bookmark.read | Obtener Tweets guardados en marcadores de un usuario autenticado. |
| bookmark.write | Agregar y eliminar marcadores de Tweets. |
| media.write | Cargar contenido multimedia. |

<div id="rate-limits">
  #### Límites de uso
</div>

En términos generales, los límites de uso son los mismos que al autenticarse con OAuth 1.0a, con la excepción de las consultas de Tweets y de usuarios. Estamos aumentando el límite por App de 300 a 900 solicitudes por cada 15 minutos al usar OAuth 2.0 para las consultas de Tweets y de usuarios. Para obtener más información, consulta nuestra [documentación sobre límites de uso](/es/resources/fundamentals/rate-limits).

<div id="grant-types">
  #### Tipos de concesión
</div>

Para este lanzamiento inicial, solo ofrecemos [authorization code](https://oauth.net/2/grant-types/authorization-code/) con [PKCE](https://oauth.net/2/pkce/) y [refresh token](https://oauth.net/2/grant-types/refresh-token/) como [grant types](https://oauth.net/2/grant-types/) compatibles. Es posible que en el futuro admitamos más tipos de concesión.

<div id="oauth-20-flow">
  #### Flujo de OAuth 2.0
</div>

OAuth 2.0 utiliza un flujo similar al que usamos actualmente para OAuth 1.0a. Puede consultar un diagrama y una explicación detallada en nuestra [documentación sobre este tema](/es/resources/fundamentals/authentication/oauth-1-0a/obtaining-user-access-tokens). 

<div id="glossary">
  #### Glosario
</div>

|     |     |
| :--- | :--- |
| **Término** | **Descripción** |
| Tipos de concesión (grant types) | El marco OAuth especifica varios tipos de concesión para distintos casos de uso y un marco para crear nuevos tipos. Ejemplos: código de autorización, credenciales de cliente, código de dispositivo y token de actualización. |
| Cliente confidencial | Aplicaciones que pueden autenticarse de forma segura con el servidor de autorización, por ejemplo, manteniendo a salvo su secreto de cliente registrado. |
| Cliente público | Aplicaciones que no pueden usar secretos de cliente registrados, como las que se ejecutan en un navegador o en un dispositivo móvil. |
| Flujo de código de autorización | Usado por clientes confidenciales y públicos para intercambiar un código de autorización por un token de acceso. |
| PKCE | Extensión del flujo de código de autorización que previene varios ataques y permite realizar de forma segura el intercambio OAuth desde clientes públicos. |
| Client ID | Se encuentra en la sección de claves y tokens del portal para desarrolladores bajo el encabezado “Client ID”. Si no lo ves, comunícate directamente con nuestro equipo. El Client ID será necesario para generar la URL de autorización. |
| URI de redirección | Tu URL de callback. Necesitarás contar con [validación de coincidencia exacta](https://datatracker.ietf.org/doc/html/rfc6749#section-10.6). |
| Código de autorización | Permite que una aplicación invoque APIs en nombre de los usuarios. También conocido como auth\_code. El auth\_code tiene un límite de 30 segundos desde que el propietario de la App recibe un auth\_code aprobado del usuario. Deberás intercambiarlo por un token de acceso dentro de esos 30 segundos o el auth\_code vencerá. |
| Token de acceso | Token que las aplicaciones usan para hacer solicitudes a la API en nombre de un usuario. |
| Token de actualización | Permite que una aplicación obtenga un nuevo token de acceso sin solicitar la intervención del usuario mediante el flujo de token de actualización. |
| Client Secret | Si seleccionaste un tipo de App que sea un cliente confidencial, se te proporcionará un “Client Secret” debajo de “Client ID” en la sección de claves y tokens de tu App. |

<div id="parameters">
  #### Parámetros
</div>

Para construir una URL de autorización de OAuth 2.0, debe asegurarse de incluir los siguientes parámetros en la URL de autorización.

|     |     |
| :--- | :--- |
| **Parameter** | **Description** |
| response\_type | Debe indicar que se trata de un código con la palabra “code”. |
| client\_id | Se encuentra en el portal para desarrolladores bajo el encabezado «Client ID». |
| redirect\_uri | Su URL de callback. Este valor debe corresponder a una de las Callback URLs definidas en la configuración de su App. Para OAuth 2.0, debe tener [validación de coincidencia exacta](https://datatracker.ietf.org/doc/html/rfc6749#section-10.6) para su URL de callback. |
| state | Una cadena aleatoria que usted proporciona para protegerse contra [ataques CSRF](https://auth0.com/docs/protocols/state-parameters). La longitud de esta cadena puede ser de hasta 500 caracteres. |
| code\_challenge | Un parámetro [PKCE](https://www.oauth.com/oauth2-servers/pkce/authorization-request/), un secreto aleatorio para cada solicitud que realice. |
| code\_challenge\_method | Especifica el método que utiliza para realizar la solicitud (S256 o plain). |

#### URL de autorización 

Con OAuth 2.0, creas una URL de autorización que puedes usar para permitir que un usuario se autentique mediante un flujo de autenticación, similar a “Iniciar sesión con X”. 

Un ejemplo de la URL que estás creando es el siguiente: 

```
https://x.com/i/oauth2/authorize?response_type=code&client_id=M1M5R3BMVy13QmpScXkzTUt5OE46MTpjaQ&redirect_uri=https://www.example.com&scope=tweet.read%20users.read%20account.follows.read%20account.follows.write&state=state&code_challenge=challenge&code_challenge_method=plain
```

Necesitas aplicar la codificación adecuada para que esta URL funcione; asegúrate de consultar nuestra documentación sobre la [codificación por porcentaje](/es/resources/fundamentals/authentication/oauth-1-0a/percent-encoding-parameters).