---
title: R와 X API v2 시작하기
mode: wide
---

<div id="introduction">
  ## 소개
</div>

이 튜토리얼에서는 프로그래밍 언어 R과 X API v2를 시작하는 데 필요한 사항을 안내합니다. R을 사용해 [user lookup](/ko/x-api/users/lookup/introduction) 엔드포인트에 연결하면서 X API가 반환하는 JSON을 다루는 방법을 보여드리겠습니다. user lookup은 GET 메서드이며, 사용자 ID 또는 사용자 이름으로 지정한 단일 사용자 또는 사용자 그룹에 대한 정보를 반환합니다.

만약 익숙하지 않다면, R은 시계열 분석, 모델링, 시각화 및 기타 데이터 분석 등 일반적인 데이터 사이언스 작업에 널리 사용되는 대표적인 언어로, X API와도 자주 함께 사용됩니다. user lookup 엔드포인트를 사용하면 [user object](/ko/x-api/fundamentals/data-dictionary#user)를 통해 특정 사용자의 팔로워 수와 해당 사용자의 바이오 감성 점수 간 상관관계를 파악할 수 있습니다. 또한 user object는 프로필에 공개적으로 표시된 위치 정보를 기반으로 계정 그룹을 매핑하는 데에도 활용할 수 있습니다.

<div id="getting-started-with-the-x-api">
  ### X API 시작하기
</div>

X API v2를 사용하려면 먼저
[가입](https://developer.x.com/en/portal/petition/essential/basic-info)
하여 개발자 계정을 생성해야 합니다.

개발자 계정 승인을 받은 후에는 먼저
[프로젝트](/ko/resources/fundamentals/projects)를 만들어야 합니다. 프로젝트를 사용하면 X API 활용 목적에 따라 작업을 체계적으로 구성하고, API 접근을 효율적으로 관리하며, 사용량을 모니터링할 수 있습니다.

각 프로젝트에는 [앱](/ko/resources/fundamentals/developer-apps)이 포함되어 있으며, 이를 통해 X API 사용에 필요한 자격 증명을 생성할 수 있습니다. X API를 시작하는 방법에 대한 자세한 내용은 문서의
[시작하기](/ko/x-api/getting-started/about-x-api)
섹션에서 확인할 수 있습니다.

<div id="getting-your-r-environment-set-up">
  ### R 환경 설정하기
</div>

먼저 [CRAN 웹사이트](https://cran.r-project.org/)에서 [R을 다운로드](https://cloud.r-project.org/)하세요.

그다음 R로 작업할 환경을 설정하려면
[RStudio](https://www.rstudio.com/), [Visual Studio Code](https://marketplace.visualstudio.com/items?itemName=Ikuyadeu.r-pack)의 R 확장 팩,
또는 파이썬 환경에 익숙하다면
[Jupyter 노트북](https://docs.anaconda.com/anaconda/navigator/tutorials/r-lang/)을 사용할 수 있습니다.

<div id="setting-up-your-environment-variable">
  ### 환경 변수 설정
</div>

오늘 보여드릴 코드 예제를 실행하려면 베어러 토큰용 환경 변수를 만들어야 합니다. 베어러 토큰은 X API에 인증하고 요청을 보낼 수 있도록 해 줍니다. 먼저 개발자 포털의 앱(App)에서 키 및 토큰(keys and tokens) 섹션에서 발급받은 본인의 베어러 토큰으로 “your-bearer-token”을 바꾸세요. 스크립트를 작성하기 전에 콘솔에서 아래 코드 한 줄을 실행해야 합니다.

```r
Sys.setenv(BEARER_TOKEN = "your-bearer-token")
```

<div id="making-your-request">
  ### 요청 만들기
</div>

패키지
[httr](https://cran.r-project.org/web/packages/httr/index.html)를 사용하여 X API에 HTTP
요청을 보낼 수 있습니다. 아직 설치하지 않았다면 콘솔에서
패키지를 설치하세요. 또한 JSON 객체 처리를 위해
[jsonlite](https://cran.r-project.org/web/packages/jsonlite/index.html)와 데이터
조작을 위해 [dplyr](https://dplyr.tidyverse.org/)을 설치해야 합니다.

```r
install.packages("httr")
install.packages("jsonlite")
install.packages("dplyr")
```

이제 API에 연결하는 R 스크립트 작성을 시작할 수 있습니다. 파일 상단에서
httr, jsonlite, dplyr 패키지를 로드하세요.

```r
require(httr)
require(jsonlite)
require(dplyr)
```

코드 예제의 첫 단계는 X API 인증 설정입니다.
앱에서 가져온
[Bearer Token](/ko/resources/fundamentals/authentication#using-and-generating-an-app-only-bearer-token)을
준비하고, 인증을 위해 헤더에 전달하세요. 아래 예제에서 $BEARER\_TOKEN을
본인의 토큰으로 바꾸세요.

```r
bearer_token <- Sys.getenv("$BEARER_TOKEN")
headers <- c(`Authorization` = sprintf('Bearer %s', bearer_token))
```

인증을 설정했으면, 요청 매개변수를 정의하세요.
기본적으로 각 사용자에 대해 id, name, username이
반환됩니다. 추가
[fields](/ko/x-api/fundamentals/fields)와
[expansions](/ko/x-api/fundamentals/expansions)을 추가해 페이로드를 조정할 수 있습니다. 이 예제에서는
user.fields=description으로 사용자의 프로필 소개를 요청하고,
사용자의 고정된 Post를 포함하는 확장을 추가합니다.

```r
params <- list(`user.fields` = 'description', `expansions` = 'pinned_tweet_id')
```

이제 더 많은 정보를 확인하려는 X 핸들(계정)을 포함하도록
URL을 구성할 준비가 되었습니다. 샘플을 재사용 가능하게 하려면
readline 메서드를 사용하세요. 조회하려는 핸들을 입력한 뒤,
원하는 X 핸들로 $USERNAME을 대체해 해당 핸들이 포함되도록 URL을
포맷하세요.

```r
handle <- readline('$USERNAME')
url_handle <- sprintf('https://api.x.com/2/users/by?usernames=%s', handle)
```

이 시점에서 httr 패키지를 사용해 방금 만든 URL로 GET 요청을 보내고,
헤더로 인증 정보를 전달하며, 정의한 매개변수도 함께 전달하세요.
응답을 변수 obj에 텍스트 객체로 저장한 뒤, 요청 결과를 확인하기 위해
출력할 수 있습니다.

```r
response <-
  httr::GET(url = url_handle,
    httr::add_headers(.headers = headers),
    query = params)
obj <- httr::content(response, as = "text")
print(obj)
```

<div id="working-with-our-json-payload">
  ### JSON 페이로드 다루기
</div>

제가 JSON을 다룰 때 가장 선호하는 방법 중 하나는 데이터 프레임을 사용하는 것으로,
복잡하게 중첩된 데이터를 쉽게 접근할 수 있게 해줍니다. 이를 위해 jsonlite
패키지의 fromJSON 메서드를 사용해 파일을 평탄화하여 필드들이 동일한 객체 내에
있도록 합니다. 그런 다음 그 객체를 데이터 프레임으로 변환합니다. 이제 이 데이터 프레임을
볼 준비가 되었습니다.

```
json_data <- fromJSON(obj, flatten = TRUE) %>% as.data.frame View(json_data)
```

데이터 프레임에서 데이터의 필드를 참조한 뒤, 핸들, 사용자 이름, 그리고 소개(Bio)가 포함된
문자열로 넣을 수 있습니다.

```r
final <-
  sprintf(
    "Handle: %s\nBio: %s\nPinned Post: %s",
    json_data$data.username,
    json_data$data.description,
    json_data$includes.tweets.text
  )
```

각 필드 사이에 줄바꿈이 적용된 형태로 객체를 확인하려면 print 대신 cat을 사용하세요.

```r
cat(final)
```

여러 개의 핸들에 대해 요청했다면, 루프를 사용해 각 데이터 프레임 요소에 쉽게
접근할 수 있습니다.

<div id="conclusion">
  ### 결론
</div>

이 튜토리얼이 R과 X
API로 작업을 시작하는 데 도움이 되었기를 바랍니다. 다음 단계로, 최신 검색,
게시물 조회 및 사용자 조회를 위한 R 샘플은
[v2 샘플 코드](https://github.com/xdevplatform)에서 확인해 보세요. 진행 중 문제가 있으면
[포럼](https://devcommunity.x.com/)에 알려주시거나, 이
튜토리얼이 창작에 영감을 주었다면 [@XDevelopers](https://x.com/XDevelopers)로 게시글을 올려주세요.