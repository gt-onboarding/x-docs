---
title: "Account Activity API: Enterprise"
---

<Note>
  이 엔드포인트가 게시물 편집 메타데이터를 포함하도록 업데이트되었습니다. 해당 메타데이터에 대한 자세한 내용은 ["게시물 편집" 기본 사항 페이지](/ko/x-api/enterprise-gnip-2.0/fundamentals/edit-tweets)를 참조하세요. 

  이 엔드포인트는 Direct Messages 엔드포인트와 함께 자주 사용됩니다. 새로운 [v2 Direct Messages 엔드포인트](/ko/x-api/direct-messages/manage/introduction)를 출시했습니다. Enterprise 및 Premium Account Activity API는 v2 1:1 메시지를 지원하지만, 아직 그룹 대화는 지원하지 않습니다.   
</Note>

개요

`Enterprise`

Account Activity API는 웹훅을 통해 사용자 계정과 관련된 실시간 활동을 구독할 수 있게 해줍니다. 이를 통해 보유하거나 구독한 하나 이상의 계정에서 단일 연결로 실시간 게시물, Direct Messages, 기타 계정 이벤트를 수신할 수 있습니다.

웹훅 등록 시 각 사용자 구독에 대해 아래의 모든 관련 활동을 수신합니다:

| 활동 유형 |     |
| :--- | :--- |
| \* 게시물(사용자)  <br />    <br />\* 게시물 삭제(사용자)<br />\* @멘션(해당 사용자)<br />\* 답글(사용자에게 또는 사용자로부터)<br />\* 리포스트(사용자 또는 해당 사용자에 대한)<br />\* 인용 트윗(사용자 또는 해당 사용자에 대한)<br />\* 인용 트윗의 리포스트(사용자 또는 해당 사용자에 대한)<br />\* 좋아요(사용자 또는 해당 사용자에 대한)<br />\* 팔로우(사용자 또는 해당 사용자에 대한)  <br />    <br />\* 언팔로우(사용자) | \* 차단(사용자)<br />\* 차단 해제(사용자)<br />\* 뮤트(사용자)<br />\* 뮤트 해제(사용자)<br />\* Direct Messages 발신(사용자)<br />\* Direct Messages 수신(사용자)<br />\* 입력 중 표시(해당 사용자에게)<br />\* 읽음 확인(해당 사용자에게)<br />\* 구독 해지(사용자) |

**유의 사항** - Account Activity API는 홈 타임라인 데이터를 제공하지 않습니다. 이 데이터를 가져오려면 [GET statuses/home\_timeline](https://developer.x.com/en/docs/x-api/v1/tweets/timelines/overview)을 사용하세요.
 

<div id="video-series">
  #### 동영상 시리즈
</div>

Account Activity API를 빠르게 익히려면 [4부작 동영상 시리즈](https://www.youtube.com/watch?v=otPxejFhyy8\&index=0\&list=PLFKjcMIU2WshGG6Yj940XM7Z6BFs1zfBg)를 확인하세요!

<iframe src="https://platform.x.com/embed/Tweet.html?dnt=false&embedId=twitter-widget-0&features=eyJ0ZndfdGltZWxpbmVfbGlzdCI6eyJidWNrZXQiOltdLCJ2ZXJzaW9uIjpudWxsfSwidGZ3X2ZvbGxvd2VyX2NvdW50X3N1bnNldCI6eyJidWNrZXQiOnRydWUsInZlcnNpb24iOm51bGx9LCJ0ZndfdHdlZXRfZWRpdF9iYWNrZW5kIjp7ImJ1Y2tldCI6Im9uIiwidmVyc2lvbiI6bnVsbH0sInRmd19yZWZzcmNfc2Vzc2lvbiI6eyJidWNrZXQiOiJvbiIsInZlcnNpb24iOm51bGx9LCJ0ZndfZm9zbnJfc29mdF9pbnRlcnZlbnRpb25zX2VuYWJsZWQiOnsiYnVja2V0Ijoib24iLCJ2ZXJzaW9uIjpudWxsfSwidGZ3X21peGVkX21lZGlhXzE1ODk3Ijp7ImJ1Y2tldCI6InRydWF0bWVudCIsInZlcnNpb24iOm51bGx9LCJ0ZndfZXhwZXJpbWVudHNfY29va2llX2V4cGlyYXRpb24iOnsiYnVja2V0IjoxMjA5NjAwLCJ2ZXJzaW9uIjpudWxsfSwidGZ3X3Nob3dfYmlyZHdhdGNoX3Bpdm90c19lbmFibGVkIjp7ImJ1Y2tldCI6Im9uIiwidmVyc2lvbiI6bnVsbH0sInRmd19kdXBsaWNhdGVfc2NyaWJlc190b19zZXR0aW5ncyI6eyJidWNrZXQiOiJvbiIsInZlcnNpb24iOm51bGx9LCJ0ZndfdXNlX3Byb2ZpbGVfaW1hZ2Vfc2hhcGVfZW5hYmxlZCI6eyJidWNrZXQiOiJvbiIsInZlcnNpb24iOm51bGx9LCJ0ZndfdmlkZW9faGxzX2R5bmFtaWNfbWFuaWZlc3RzXzE1MDgyIjp7ImJ1Y2tldCI6InRydWVfYml0cmF0ZSIsInZlcnNpb24iOm51bGx9LCJ0ZndfbGVnYWN5X3RpbWVsaW5lX3N1bnNldCI6eyJidWNrZXQiOnRydWUsInZlcnNpb24iOm51bGx9LCJ0ZndfdHdlZXRfZWRpdF9mcm9udGVuZCI6eyJidWNrZXQiOiJvbiIsInZlcnNpb24iOm51bGx9fQ%3D%3D&frame=false&hideCard=false&hideThread=false&id=996790447048613888&lang=en&origin=https%3A%2F%2Fdeveloper.x.com%2Fen%2Fdocs%2Fx-api%2Fenterprise%2Faccount-activity-api%2Foverview&sessionId=81f4a0339cbd7bd77b669faa00bd3a7224bc4418&theme=light&widgetsVersion=2615f7e52b7e0%3A1702314776716&width=550px" height="400px" />

<div id="feature-summary">
  ### 기능 요약
</div>

| 티어 | 가격 | 고유 구독 수 | 웹훅 수 | 안정성 및 활동 복구 |
| :--- | :--- | :--- | :--- | :--- |
| Enterprise | [영업팀에 문의](/ko/x-api/enterprise-gnip-2.0/enterprise-gnip) | 최대 500개 이상 | 3개 이상 | [재시도](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#retries) 및 [리플레이](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-replay-api) |

- 문의사항이 있으신가요? 오류가 발생하나요?
  - [자주 묻는 질문](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#frequently-asked-questions) 또는 [오류 문제 해결 가이드](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#frequently-asked-questions)를 확인하세요.

- 샘플 코드를 살펴보세요:
  - [Enterprise Account Activity API 대시보드](https://github.com/xdevplatform/account-activity-dashboard-enterprise): Account Activity API의 엔터프라이즈 티어를 사용하여 웹훅 이벤트를 표시하고 [리플레이](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-replay-api) 기능을 포함한 Node 웹앱입니다.
  - [SnowBot 챗봇](https://github.com/xdevplatform/SnowBotDev): 엔터프라이즈 Account Activity 및 Direct Message API를 기반으로 만든 Ruby 웹앱입니다.

#### 웹훅 관리:

웹훅을 사용하면 단일 연결로 사용자 계정과 관련된 실시간 활동을 구독할 수 있습니다. 

<Tabs>
  <Tab title="웹훅 추가">
    지정한 애플리케이션 컨텍스트에 새 웹훅 URL을 등록하는 것부터 시작합니다.

    URL은 저장 전에 CRC 요청으로 유효성이 검사됩니다. 웹훅을 등록한 후에는 나중에 필요하므로 웹훅 ID를 반드시 기록해 두세요.

    아래 cURL 요청을 복사하기 전에 다음 값을 본인 환경에 맞게 바꾼 뒤, 명령줄에서 실행하세요.

    - **URL** `<URL>` 예: `https://yourdomain.com/webhooks/twitter/`

    - **Consumer key** `<CONSUMER_KEY>` 예: `xvz1evFS4wEEPTGEFPHBog`

    - **Access token** `<ACCESS_TOKEN>` 예:  `370773112-GmHxMAgYyLbNEtIKZeRNFsMKPR9EyMZeS9weJAEb`

      ```
      curl --request POST --url 'https://api.x.com/1.1/account_activity/webhooks.json?url=<URL>' --header 'authorization: OAuth oauth_consumer_key="<CONSUMER_KEY>", oauth_nonce="GENERATED", oauth_signature="GENERATED", oauth_signature_method="HMAC-SHA1", oauth_timestamp="GENERATED", oauth_token="<ACCESS_TOKEN>", oauth_version="1.0"'
      ```
  </Tab>

  <Tab title="웹훅 조회">
    다음 명령을 실행하면 지정한 애플리케이션에 등록된 모든 웹훅 URL과 해당 상태가 반환됩니다.

    아래 cURL 요청을 복사하기 전에 다음 값을 본인 환경에 맞게 바꾼 뒤, 명령줄에서 실행하세요.

    - **Bearer token** `<BEARER_TOKEN>` 예: `AAAAAAAAAAAA0%2EUifi76ZC9Ub0wn...`

      ```curl --request GET --url https://api.x.com/1.1/account_activity/webhooks.json --header 'authorization: Bearer <BEARER_TOKEN>'
      ```
  </Tab>

  <Tab title="웹훅 제거">
    해당 애플리케이션 구성에서 웹훅을 제거하려면, 아래 cURL 요청을 복사하기 전에 다음 값을 본인 환경에 맞게 바꾼 뒤, 명령줄에서 실행하세요.

    - **Webhook ID** `<:WEBHOOK_ID>` 예: `1234567890`

    - **Consumer key** `<CONSUMER_KEY>` 예: `xvz1evFS4wEEPTGEFPHBog`

    - **Access token** `<ACCESS_TOKEN>` 예:  `370773112-GmHxMAgYyLbNEtIKZeRNFsMKPR9EyMZeS9weJAEb`

      ```curl --request DELETE --url https://api.x.com/1.1/account_activity/webhooks/<:WEBHOOK_ID>.json --header 'authorization: OAuth oauth_consumer_key="<CONSUMER_KEY>", oauth_nonce="GENERATED", oauth_signature="GENERATED", oauth_signature_method="HMAC-SHA1", oauth_timestamp="GENERATED", oauth_token="<ACCESS_TOKEN>", oauth_version="1.0"'
      ```
  </Tab>
</Tabs>

<div id="managing-a-webhook">
  #### 구독 사용자 관리:
</div>

Webhook을 등록한 뒤 해당 사용자의 계정 활동을 수신하려면 Account Activity API에 구독 사용자를 추가할 수 있습니다.

<Tabs>
  <Tab title="구독 추가">
    모든 이벤트 유형을 수신할 수 있도록 먼저 사용자를 구독시킵니다.

    아래 cURL 요청에서 다음 값을 수정한 후 명령줄에 복사해 실행하세요.

    - **Webhook ID** `<:WEBHOOK_ID>` 예: `1234567890`

    - **Consumer key name** `<CONSUMER_KEY>` 예: `xvz1evFS4wEEPTGEFPHBog`

    - **구독 사용자의 액세스 토큰** `<SUBSCRIBING_USER'S_ACCESS_TOKEN>` 예: `370773112-GmHxMAgYyLbNEtIKZeRNFsMKPR9EyMZeS9weJAEb`

      ```
      curl --request POST --url https://api.x.com/1.1/account_activity/webhooks/<:WEBHOOK_ID>/subscriptions/all.json --header 'authorization: OAuth oauth_consumer_key="<CONSUMER_KEY>", oauth_nonce="GENERATED", oauth_signature="GENERATED", oauth_signature_method="HMAC-SHA1", oauth_timestamp="GENERATED", oauth_token="<SUBSCRIBING_USER'S_ACCESS_TOKEN>", oauth_version="1.0"'
      ```
  </Tab>

  <Tab title="구독 보기">
    지정한 webhook의 모든 활동 유형 구독 목록을 보려면, 아래 cURL 요청에서 다음 값을 수정한 후 명령줄에 복사해 실행하세요.

    - **Webhook ID** `<:WEBHOOK_ID>` 예: `1234567890`

    - **Bearer token** `<BEARER_TOKEN>` 예: `AAAAAAAAAAAA0%2EUifi76ZC9Ub0wn...`

      ```
      curl --request GET --url https://api.x.com/1.1/account_activity/webhooks/<:WEBHOOK_ID>/subscriptions/all/list.json --header 'authorization: Bearer <BEARER_TOKEN>'
      ```
  </Tab>

  <Tab title="구독 제거">
    구독을 비활성화하면 해당 요청 사용자에 대한 모든 이벤트가 더 이상 webhook URL로 전송되지 않습니다.

    제공된 사용자 컨텍스트와 애플리케이션에서 구독을 비활성화하려면, 아래 cURL 요청에서 다음 값을 수정한 후 명령줄에 복사해 실행하세요.

    - **Webhook ID** `<:WEBHOOK_ID>` 예: `1234567890`

    - **Consumer key** `<CONSUMER_KEY>` 예: `xvz1evFS4wEEPTGEFPHBog`

    - **구독 사용자의 액세스 토큰** `<SUBSCRIBING_USER'S_ACCESS_TOKEN>` 예: `370773112-GmHxMAgYyLbNEtIKZeRNFsMKPR9EyMZeS9weJAEb`

      ```
      curl --request DELETE --url https://api.x.com/1.1/account_activity/webhooks/<:WEBHOOK_ID>/subscriptions/all.json --header 'authorization: OAuth oauth_consumer_key="<CONSUMER_KEY>", oauth_nonce="GENERATED", oauth_signature="GENERATED", oauth_signature_method="HMAC-SHA1", oauth_timestamp="GENERATED", oauth_token="<SUBSCRIBING_USER'S_ACCESS_TOKEN>", oauth_version="1.0"'
      ```
  </Tab>
</Tabs>

잘하셨습니다! 이제 webhook과 구독 사용자를 관리할 수 있습니다.

<div id="managing-subscribed-users">
  #### 참고 문서
</div>

- [Overview of Challenge-Response Check (CRC)](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#securing-webhooks)
- \[Account Activity Data Types]\(/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-data-object-structure
- [Managing Webhooks and Subscriptions](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#managing-webhooks-and-subscriptions)

## Account Activity API 동영상 가이드

이 동영상 가이드에서는 Account Activity API의 프리미엄 및 엔터프라이즈 티어 기능을 살펴봅니다.

동영상을 통해 다음 기능을 학습합니다.

- 웹훅 등록
- 사용자 구독 추가
- 사용자 구독 제거
- 계정 활동 수신
- 계정 활동 재생

<iframe src="https://platform.x.com/embed/Tweet.html?dnt=false&embedId=twitter-widget-0&features=eyJ0ZndfdGltZWxpbmVfbGlzdCI6eyJidWNrZXQiOltdLCJ2ZXJzaW9uIjpudWxsfSwidGZ3X2ZvbGxvd2VyX2NvdW50X3N1bnNldCI6eyJidWNrZXQiOnRydWUsInZlcnNpb24iOm51bGx9LCJ0ZndfdHdlZXRfZWRpdF9iYWNrZW5kIjp7ImJ1Y2tldCI6Im9uIiwidmVyc2lvbiI6bnVsbH0sInRmd19yZWZzcmNfc2Vzc2lvbiI6eyJidWNrZXQiOiJvbiIsInZlcnNpb24iOm51bGx9LCJ0ZndfZm9zbnJfc29mdF9pbnRlcnZlbnRpb25zX2VuYWJsZWQiOnsiYnVja2V0Ijoib24iLCJ2ZXJzaW9uIjpudWxsfSwidGZ3X21peGVkX21lZGlhXzE1ODk3Ijp7ImJ1Y2tldCI6InRyZWF0bWVudCIsInZlcnNpb24iOm51bGx9LCJ0ZndfZXhwZXJpbWVudHNfY29va2llX2V4cGlyYXRpb24iOnsiYnVja2V0IjoxMjA5NjAwLCJ2ZXJzaW9uIjpudWxsfSwidGZ3X3Nob3dfYmlyZHdhdGNoX3Bpdm90c19lbmFibGVkIjp7ImJ1Y2tldCI6Im9uIiwidmVyc2lvbiI6bnVsbH0sInRmd19kdXBsaWNhdGVfc2NyaWJlc190b19zZXR0aW5ncyI6eyJidWNrZXQiOiJvbiIsInZlcnNpb24iOm51bGx9LCJ0ZndfdXNlX3Byb2ZpbGVfaW1hZ2Vfc2hhcGVfZW5hYmxlZCI6eyJidWNrZXQiOiJvbiIsInZlcnNpb24iOm51bGx9LCJ0ZndfdmlkZW9faGxzX2R5bmFtaWNfbWFuaWZlc3RzXzE1MDgyIjp7ImJ1Y2tldCI6InRydWVfYml0cmF0ZSIsInZlcnNpb24iOm51bGx9LCJ0ZndfbGVnYWN5X3RpbWVsaW5lX3N1bnNldCI6eyJidWNrZXQiOnRydWUsInZlcnNpb24iOm51bGx9LCJ0ZndfdHdlZXRfZWRpdF9mcm9udGVuZCI6eyJidWNrZXQiOiJvbiIsInZlcnNpb24iOm51bGx9fQ%3D%3D&frame=false&hideCard=false&hideThread=false&id=1204084171334832128&lang=en&origin=https%3A%2F%2Fdeveloper.x.com%2Fen%2Fdocs%2Fx-api%2Fenterprise%2Faccount-activity-api%2Fquick-start%2Fa-visual-walkthrough-of-the-account-activity-api&sessionId=b5b8e259a4c6287be2413de9059093170036fb30&theme=light&widgetsVersion=2615f7e52b7e0%3A1702314776716&width=550px" />

- 질문이 있으신가요? 오류가 발생했나요?
  - [자주 묻는 질문](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#frequently-asked-questions) 또는 [오류 해결 가이드](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#frequently-asked-questions)를 읽어보세요.

- 샘플 코드를 살펴보세요:
  - [Enterprise Account Activity API 대시보드](https://github.com/xdevplatform/account-activity-dashboard-enterprise): Account Activity API의 엔터프라이즈 티어를 사용해 웹후크 이벤트를 표시하고 [Replay](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-replay-api) 기능을 포함한 Node 웹 앱입니다.
  - [SnowBot 챗봇](https://github.com/xdevplatform/SnowBotDev): 엔터프라이즈 Account Activity API와 Direct Message API를 기반으로 구축된 Ruby 웹 앱입니다.

**Enterprise**

<div id="a-video-walkthrough-of-the-account-activity-api">
  ## 웹훅 시작하기
</div>

Account Activity API는 개발자가 직접 개발·배포·호스팅하는 웹 앱으로 계정 이벤트를 전송하는 웹훅 기반 API입니다.

이벤트 소비자 애플리케이션에서 웹훅 이벤트를 수신하기 전에 준비해야 할 몇 가지 ‘기초적인’ 구성 요소가 있습니다. 아래 설명대로 X 앱을 생성하고 Account Activity API 접근 권한을 얻은 뒤, 웹훅 이벤트를 처리하는 웹 앱을 개발해야 합니다. 

### 1. X 앱을 생성합니다.

- [개발자 포털](/ko/resources/fundamentals/developer-portal)에서 승인된 개발자 계정으로 [X 앱](/ko/resources/fundamentals/developer-apps)을 생성하세요. 회사 대표로 앱을 생성하는 경우에는 기업용 X 계정으로 생성할 것을 권장합니다. 개발자 계정을 신청하려면 [여기를 클릭](/ko/resources/fundamentals/developer-apps)하세요.
- 앱 페이지의 [permissions](/ko/resources/fundamentals/developer-apps#oauth-1-0a-app-permissions) 탭에서 "Read, Write and Access direct messages"를 활성화하세요.
- "Keys and Access Tokens" 탭에서 앱의 Consumer Key(API Key)와 Consumer Token(API Secret)을 기록해 두세요.
- 같은 탭에서 앱의 [Access Token and Access Token Secret](/ko/resources/fundamentals/authentication#obtaining-access-tokens-using-3-legged-oauth-flow)을 생성하세요. 이 액세스 토큰은 웹훅 URL을 등록하는 데 필요하며, 해당 URL로 X가 계정 이벤트를 전송합니다.
- [X Sign-in](/ko/resources/fundamentals/authentication#log-in-with-x) 및 X API에서 사용자 컨텍스트가 동작하는 방식에 익숙하지 않다면 [Obtaining Access Tokens](https://dev.x.com/webhooks/access-tokens)를 확인하세요. 이벤트를 수신할 계정을 추가할 때는 해당 계정의 액세스 토큰으로 구독합니다.
- [개발자 포털](/ko/resources/fundamentals/developer-portal)의 ["Apps"](/ko/resources/fundamentals/developer-apps) 페이지에 표시되는 앱의 숫자형 ID를 기록해 두세요. Account Activity API 액세스를 신청할 때 이 앱 ID가 필요합니다.
   

<div id="1-create-a-x-app">
  ### 2. Account Activity API 액세스 신청
</div>

X 앱을 만든 후 다음 단계는 Account Activity API 액세스를 신청하는 것입니다. 

Account Activity API는 Enterprise에서만 제공되므로 아래 링크를 통해 신청서를 제출해야 합니다.

<Button href="https://developer.x.com/en/enterprise-application.html">
  Enterprise 액세스 신청
</Button>

<div id="2-get-account-activity-api-access">
  ### 3. 웹훅 컨슈머 앱 개발
</div>

Account Activity API 액세스를 받으면 X 웹훅 이벤트를 수신할 웹 앱을 개발, 배포, 호스트해야 합니다. 

- 이벤트를 수신할 웹훅으로 사용할 URL이 있는 웹 앱을 만드세요. 이는 들어오는 X 웹훅 이벤트를 수신하기 위해 서버에 배포되는 엔드포인트입니다. 
  - URI 경로는 전적으로 자유롭게 정할 수 있습니다. 예시는 다음과 같습니다: https://mydomain.com\_/service/listen\_

  - 여러 소스의 웹훅을 수신한다면 일반적인 패턴은 다음과 같습니다: https://mydomain.com/webhook/twitter

  - 지정한 URL에는 포트를 명시할 수 없다는 점에 유의하세요(https://mydomain.com:5000/NoWorkie).

- [웹훅 보안](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#securing-webhooks) 가이드에 설명된 대로, 첫 단계는 X Challenge Response Check(CRC) GET 요청을 수신하고 올바르게 형식화된 JSON으로 응답하는 코드를 작성하는 것입니다. 

- 웹훅 URL을 등록하세요. /webhooks.json?url= 엔드포인트로 POST 요청을 보냅니다. 이 요청을 보내면 X가 웹 앱에 CRC 요청을 전송합니다. 웹훅이 성공적으로 등록되면 응답에 웹훅 id가 포함됩니다. 이 웹훅 id는 이후 Account Activity API에 일부 요청을 할 때 필요합니다. 

- X는 계정 웹훅 이벤트를 등록한 URL로 전송합니다. 웹 앱이 들어오는 이벤트에 대한 POST 요청을 처리할 수 있는지 확인하세요. 이러한 이벤트는 JSON으로 인코딩됩니다. 예시 웹훅 JSON 페이로드는 [여기](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-data-object-structure)에서 확인하세요.

- 웹 앱이 준비되면 다음 단계로, 활동을 수신할 계정을 추가합니다. 계정을 추가(또는 삭제)할 때는 account id를 참조하는 POST 요청을 보냅니다. 자세한 내용은 [구독 추가 가이드](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#managing-webhooks-and-subscriptions)를 참조하세요.

<div id="3-develop-webhook-consumer-app">
  ### 4. 설정 검증
</div>

- 앱과 웹훅이 올바르게 구성되었는지 확인하려면, 앱이 구독 중인 X 계정 중 하나가 올린 게시물을 즐겨찾기하세요. 구독자가 받는 각 즐겨찾기마다 웹훅 URL로의 POST 요청을 통해 `favorite_events`를 수신해야 합니다.
- 구독을 추가한 후 이벤트가 전송되기 시작하기까지 최대 10초가 걸릴 수 있습니다.

**중요 참고 사항**

- 웹훅 URL을 등록할 때 웹 앱은 consumer token과 secret, 그리고 앱 소유자의 user access token과 secret으로 인증해야 합니다. 

- 모든 수신 다이렉트 메시지는 웹훅을 통해 전달됩니다. [POST direct\_messages/events/new (message\_create)](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/new-event)로 전송된 모든 다이렉트 메시지도 웹훅으로 전달됩니다. 이는 웹 앱이 다른 클라이언트를 통해 전송된 다이렉트 메시지도 인지할 수 있도록 하기 위함입니다.

- 모든 웹훅 이벤트에는 해당 이벤트가 어떤 구독에 대해 전달되었는지를 나타내는 for\_user\_id 사용자 ID가 포함됩니다.

- 동일한 대화에서 두 사용자가 다이렉트 메시지용으로 웹 앱을 사용 중인 경우, 웹훅은 두 개의 중복 이벤트(각 사용자별 1개)를 수신합니다. 웹 앱은 이를 고려해야 합니다. 

- 동일한 웹훅 URL을 공유하는 둘 이상의 웹 앱이 있고 각 앱에 동일한 사용자가 매핑되어 있는 경우, 동일한 이벤트가 웹훅으로 여러 번 전송됩니다(웹 앱당 한 번).

- 경우에 따라 웹훅이 중복 이벤트를 수신할 수 있습니다. 웹훅 앱은 이를 허용하도록 설계하고 이벤트 ID로 중복 제거를 수행해야 합니다.

- 빠른 답장(Quick Reply) 응답이 요청 직후 바로 이어질 것이라고 기대하지 마세요. 사용자는 빠른 답장 요청을 무시하고 일반 다이렉트 메시지로 응답할 수 있습니다. 또한 사용자는 메시지 스레드에서 이전에 응답하지 않았던 요청에 대해 빠른 답장으로 회신할 수도 있습니다.

- 예제 코드:
  - [Enterprise Account Activity API dashboard](https://github.com/xdevplatform/account-activity-dashboard-enterprise): Account Activity API의 엔터프라이즈 티어를 사용해 웹훅 이벤트를 표시하고 [Replay](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-replay-api) 기능을 포함하는 Node 웹 앱입니다.

  - [SnowBot chatbot](https://github.com/xdevplatform/SnowBotDev): Account Activity 및 다이렉트 메시지 API를 기반으로 구축된 Ruby 웹 앱입니다. 이 코드베이스에는 Account Activity API 웹훅 설정을 돕는 [script](https://github.com/xdevplatform/SnowBotDev/wiki/Account-Activity-API-setup-script)가 포함되어 있습니다.

## 웹훅 보안

X의 웹훅 기반 API는 웹훅 서버의 보안을 확인하기 위한 두 가지 방법을 제공합니다.

1. 챌린지-응답 검사를 통해 웹훅 이벤트를 수신하는 웹 앱의 소유권을 X가 확인할 수 있습니다.
2. 각 POST 요청의 서명 헤더를 통해 들어오는 웹훅이 X에서 전송된 것인지 확인할 수 있습니다.
    

### 챌린지-응답 검사 

앱과 웹훅 URL의 소유자임을 확인하기 위해 X는 Challenge-Response Check(CRC)를 수행합니다. 이는 사이클릭 리던던시 체크(cyclic redundancy check)와 혼동하면 안 됩니다. CRC가 전송되면 X는 `crc_token` 매개변수를 포함해 웹 앱에 GET 요청을 보냅니다. 해당 요청을 수신하면, 웹 앱은 _`crc_token`_ 매개변수와 앱의 Consumer Secret(아래 상세 참조)을 기반으로 암호화된 `response_token`을 생성해야 합니다. `response_token`은 JSON으로 인코딩되어야 하며(아래 예시 참조) 3초 이내에 반환되어야 합니다. 성공하면 웹훅 `id`가 반환됩니다. 

웹훅 URL을 등록할 때 CRC가 전송되므로, CRC 응답 코드를 구현하는 것은 기본적인 첫 단계입니다. 웹훅이 설정된 후에는 마지막으로 성공적인 응답을 수신한 시점으로부터 대략 24시간마다 X가 CRC를 트리거합니다. 또한 필요한 경우 웹훅 `id`로 PUT 요청을 보내 CRC를 트리거할 수 있습니다. 새 코드를 배포하거나 서비스를 재시작하는 등 웹훅 애플리케이션을 개발하는 동안 CRC를 트리거하는 것은 유용합니다. 

\_`crc_token`\_은 수신되는 각 CRC 요청마다 변경되며, 계산 시 메시지로 사용하고 Consumer Secret을 키로 사용해야 합니다.

응답이 3초 이내에 반환되지 않거나 유효하지 않은 경우, 등록된 웹훅으로 이벤트 전송이 중단됩니다.

#### CRC 요청은 다음과 같은 경우에 발생합니다:

- 웹훅 URL이 등록될 때
- 웹훅 URL을 검증하기 위해 대략 _매시간_
- PUT 요청으로 수동으로 CRC를 트리거할 수 있습니다. 웹훅 클라이언트를 개발하면서 CRC 응답을 구현하는 동안 CRC를 수동으로 트리거하는 계획을 세우는 것이 좋습니다. 
   

<div id="the-crc-request-will-occur">
  #### 응답 요건:
</div>

- `crc_token`과 앱 Consumer Secret을 사용해 생성한 base64 인코딩된 HMAC SHA-256 해시
- 유효한 response\_token 및 JSON 형식
- 지연 시간 3초 미만
- HTTP 200 응답 코드
   

<div id="response-requirements">
  #### 언어별 HMAC 라이브러리:
</div>

- [Java/Scala](https://docs.oracle.com/javase/8/docs/api/index.html?javax/crypto/Mac.html)
- [Ruby](http://ruby-doc.org/stdlib-2.1.0/libdoc/openssl/rdoc/OpenSSL/HMAC.html)
- [Node.js](https://nodejs.org/api/crypto.html#crypto_class_hmac)
- [Python](https://docs.python.org/2/library/hmac.html)

<div id="language-specific-hmac-libraries">
  #### Python에서의 응답 토큰 생성 예시:
</div>

다음은 Python 2.7 Flask 웹앱에서 챌린지 응답 확인에 올바르게 응답하는 라우트를 정의합니다.

```
import base64
import hashlib
import hmac
import json


\# Defines a route for the GET request
@app.route('/webhooks/twitter', methods=\['GET'\])
def webhook_challenge():

  # creates HMAC SHA-256 hash from incomming token and your consumer secret
  sha256\_hash\_digest = hmac.new(TWITTER\_CONSUMER\_SECRET, msg=request.args.get('crc_token'), digestmod=hashlib.sha256).digest()

  # construct response data with base64 encoded hash
  response = {
    'response\_token': 'sha256=' + base64.b64encode(sha256\_hash_digest)
  }

  # returns properly formatted json response
  return json.dumps(response)
```

<div id="example-response-token-generation-in-python">
  #### 예시 JSON 응답:
</div>

위와 같이 라우트를 정의했다면 웹 브라우저에서 https://your-app-domain/webhooks/twitter?crc\_token=foo 로 이동할 때 아래와 유사한 응답을 웹앱이 반환해야 합니다.

```
{
  "response_token": "sha256=x0mYd8hz2goCTfcNAaMqENy2BFgJJfJOb4PdvTffpwg="
}
```

<div id="example-json-response">
  #### 기타 예:
</div>

- [여기](https://github.com/xdevplatform/account-activity-dashboard/blob/master/helpers/security.js)는 Node/JS로 작성된 CRC 응답 메서드 예입니다.
- [여기](https://github.com/xdevplatform/SnowBotDev/blob/master/app/controllers/snow_bot_dev_app.rb)는 Ruby로 작성된 CRC 응답 메서드 예입니다(_generate\_crc\_response_ 및 CRC 이벤트를 수신하는 /GET 라우트를 참고).

### 선택적 서명 헤더 검증

X에서 POST 요청을 수신하거나 웹후크를 생성하기 위해 GET 요청을 보내거나 수동 CRC를 수행하기 위해 GET 요청을 보낼 때, 헤더에 x-twitter-webhooks-signature라는 해시 서명이 전달됩니다. 이 서명은 데이터의 출처가 X인지 검증하는 데 사용할 수 있습니다. POST 해시 서명은 sha256=으로 시작하며, 이는 HMAC SHA-256을 사용해 X 앱 Consumer Secret과 페이로드를 암호화했음을 나타냅니다. GET 해시는 쿼리 매개변수 문자열 crc\_token=$token\&nonce=$nonce에서 계산됩니다.

**요청을 검증하는 단계**

1. Consumer Secret과 수신된 페이로드 본문을 사용해 해시를 생성합니다.
2. 생성한 해시를 base64로 인코딩된 x-twitter-webhooks-signature 값과 비교합니다. 타이밍 공격에 대한 취약성을 줄이기 위해 [compare\_digest](https://docs.python.org/2/library/hmac.html) 같은 메서드를 사용하세요.

<div id="optional-signature-header-validation">
  ### 추가 보안 지침
</div>

다음은 웹 애플리케이션에서 고려해야 할 추가 보안 지침입니다. 이러한 지침을 적용하지 않아도 웹후크 기능에는 지장이 없지만, X 정보보안 팀에서 강력히 권장합니다. 아래 권장 사항에 익숙하지 않다면 서버 관리자와 상의하십시오.

#### X 집계 네트워크 블록

추가 보안을 위해 다음 집계 네트워크 블록을 허용 목록에 추가하는 것을 권장합니다:

- 199.59.148.0/22

- 199.16.156.0/22

- 192.133.77.0/26

- 64.63.15.0/24

- 64.63.31.0/24

- 64.63.47.0/24

- 202.160.128.0/24

- 202.160.129.0/24

- 202.160.130.0/24

<div id="x-aggregate-network-blocks">
  #### 권장 서버 구성
</div>

- [ssllabs.com](http://ssllabs.com/) 테스트에서 “A” 등급
- **TLS 1.2 활성화**
- Forward Secrecy 활성화
- SSLv2 비활성화
- SSLv3 비활성화(POODLE로 인해)
- TLS 1.0 비활성화
- TLS 1.1 비활성화
- TLS 압축 비활성화
- 세션 티켓 키를 순환(로테이션)하지 않는다면 세션 티켓 비활성화
- SSL 구성에서 “ssl\_prefer\_server\_ciphers” 또는 “SSLHonorCipherOrder” 옵션을 “on”으로 설정
- 암호 스위트 목록이 다음과 같은 최신 목록인지 확인:
  `ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES128-SHA256:AES128-SHA:AES256-GCM-SHA384:AES256-SHA256:AES256-SHA:ECDHE-RSA-DES-CBC3-SHA:DES-CBC3-SHA`

## 웹훅과 구독 관리

### 웹훅 생성 및 변경

웹훅 URL을 변경하려면 기존 웹훅을 삭제한 다음 새 웹훅을 생성해야 합니다. 이때 새 웹훅에 사용자 구독을 다시 추가해야 한다는 점에 유의하세요.

#### Webhook 구성 관리 엔드포인트:

|     |     |
| :--- | :--- |
| **Method** | 엔터프라이즈 |
| Webhook URL 등록 / webhook\_id 생성 | [POST webhooks](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#enterprise-account-activity-api) |
| 모든 Webhook URL과 상태 반환 | [GET webhooks](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks) |
| 앱의 현재 Webhook 구성 삭제 | [DELETE webhooks/:webhook\_id](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id) |
| CRC 요청 수동 트리거 | [PUT webhooks/:webhook\_id](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#put-account-activity-webhooks-webhook-id) |

<div id="webhook-configuration-management-endpoints">
  #### 왜 웹훅 URL만 업데이트할 수 없나요?
</div>

왜 웹훅 구성은 변경할 수 없게 되어 있나요? X는 보안을 매우 중요하게 여깁니다. 웹훅 URL이 변경됐다면 애플리케이션의 consumer key와 consumer secret이 유출됐을 가능성이 있습니다. 새로운 웹훅 구성을 생성하도록 요구하는 이유는 사용자 이벤트에 다시 구독하도록 하기 위해서입니다. 이 과정에는 악의적인 주체가 보유했을 가능성이 낮은 액세스 토큰이 필요합니다. 결과적으로 다른 사람이 사용자의 비공개 정보를 수신할 가능성이 줄어듭니다.
 

### 사용자 구독 추가 및 제거

수천 건의 구독을 지원하려면 엔터프라이즈 티어가 필요합니다. 이미 담당 어카운트 매니저가 있다면 문의 사항을 그들에게 직접 전달해 주세요. 엔터프라이즈 API 액세스를 신청하려면 [여기를 클릭](https://developer.x.com/en/products/x-api/enterprise)하세요. 

#### 구독 관리 엔드포인트

 

|     |     |
| :--- | :--- |
| 메서드 | 엔터프라이즈 |
| 새 사용자 구독 추가 | [POST webhooks/:webhook\_id/subscriptions/all](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks-webhook-id-subscriptions-all) |
| 사용자 구독 조회 | [GET webhooks/:webhook\_id/subscriptions/all](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks-webhook-id-subscriptions-all) |
| 활성 구독 전체 목록 반환 | [GET webhooks/:webhook\_id/subscriptions/all/list](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-subscriptions-count) |
| 앱 전용 OAuth를 사용해 사용자 구독 비활성화 | [DELETE webhooks/:webhook\_id/subscriptions/:user\_id/all.json](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-user-id-all-json) |

Account Activity API: 엔터프라이즈

<Note>
  **유의사항**: 

  API를 사용하기 전에 X가 귀하의 개발자 앱에 대해 Account Activity API 액세스를 활성화해야 합니다. 이를 위해 인증에 사용할 앱 ID를 계정 관리자 또는 기술 지원 팀과 공유했는지 확인하세요.
</Note>

[Account Activity API](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity)는 단일 연결을 통해 구독한 모든 계정의 실시간 계정 활동을 수신할 수 있도록, 사용자 구독을 생성하고 관리하는 엔드포인트 모음으로 구성됩니다. 

Account Activity API에서는 두 가지 인증 방법([OAuth 1.0a](/ko/resources/fundamentals/authentication#oauth-1-0a-2) 및 [OAuth 2.0 Bearer Token](/ko/resources/fundamentals/authentication#bearer-token-also-known-as-app-only))을 사용할 수 있습니다. 어떤 인증 방법을 사용할지는 이용하는 엔드포인트에 따라 달라집니다.

|     |     |     |     |
| :--- | :--- | :--- | :--- |
| **설명** | **엔드포인트** | OAuth 1.0a  <br />(사용자 컨텍스트) | OAuth 2.0 베어러 토큰(애플리케이션 전용) |
| 지정된 애플리케이션 컨텍스트에 대해 새로운 웹훅 URL 등록 | [POST account\_activity/webhooks](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks) | ✓   |     |
| 지정된 애플리케이션의 모든 URL과 해당 상태 반환 | [GET account\_activity/webhooks](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks) |     | ✓   |
| 지정된 웹훅의 URL에 대해 CRC(챌린지 응답 검사) 트리거 | [PUT account\_activity/webhooks/:webhook\_id](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#put-account-activity-webhooks-webhook-id) | ✓   |     |
| 애플리케이션을 사용자의 계정 이벤트에 구독 | [POST account\_activity/webhooks/:webhook\_id/subscriptions/all](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks-webhook-id-subscriptions-all) | ✓ \* |     |
| 현재 활성 구독 수 반환 | [GET account\_activity/subscriptions/count](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-subscriptions-count) |     | ✓   |
| 웹훅 설정이 사용자의 이벤트를 구독 중인지 확인 | [GET account\_activity/webhooks/:webhook\_id/subscriptions/all](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks-webhook-id-subscriptions-all) | ✓ \* |     |
| 현재 활성 구독 목록 반환 | [GET account\_activity/webhooks/:webhook\_id/subscriptions/all/list](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks-webhook-id-subscriptions-all-list) |     | ✓   |
| 웹훅 삭제 | [DELETE account\_activity/webhooks/:webhook\_id](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id) | ✓   |     |
| \[사용 중단됨] 제공된 사용자 컨텍스트와 애플리케이션에 대한 구독 비활성화 | [DELETE account\_activity/webhooks/:webhook\_id/subscriptions/all](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-all-deprecated) | ✓ \* |     |
| 애플리케이션 전용 OAuth를 사용하여 구독 비활성화 | [DELETE /account\_activity/webhooks/:webhook\_id/subscriptions/:user\_id/all.json](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-user-id-all-json) |     | ✓   |
| 활동을 웹훅으로 재전송 | [POST /1.1/account\_activity/replay/webhooks/:webhook\_id/subscriptions/all.json](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#replay-api) |     | ✓   |

\*\_ 인증에는 구독하는 사용자의 액세스 토큰이 필요합니다. \_

OAuth 1.0a 사용자 컨텍스트 인증이 필요한 엔드포인트의 경우, 요청을 인증하려면 다음 자격 증명이 필요합니다: 

- 컨슈머 키(API 키와 시크릿)
- 액세스 토큰(액세스 토큰과 시크릿)

다음 세 엔드포인트의 경우 애플리케이션 컨텍스트에서 쓰기 작업을 수행합니다(X 사용자는 관여하지 않음). 따라서 제공해야 하는 액세스 토큰은 개발자 앱에 속한 토큰입니다. 이는 앱의 “Keys and tokens” 탭에서 [developer portal](https://developer.x.com/en/portal/projects-and-apps)을 통해 직접 생성할 수 있습니다.  

- [POST account\_activity/webhooks](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks): 지정된 애플리케이션 컨텍스트에 새 웹훅 URL을 등록합니다
- [PUT account\_activity/webhooks/:webhook\_id](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#put-account-activity-webhooks-webhook-id): 지정된 웹훅 URL에 대해 CRC(Challenge Response Check)를 수행합니다
- [DELETE account\_activity/webhooks/:webhook\_id](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id): 웹훅을 삭제합니다

반면, 다음 세 엔드포인트는 애플리케이션이 X 사용자를 대신해 보호된 데이터(예: 다이렉트 메시지)에 접근할 수 있도록 요청합니다. 따라서 해당 구독 사용자에 속한 Access Token을 제공해야 합니다. 필요한 Access Token은 3-legged OAuth 플로우를 사용해 얻을 수 있습니다([OAuth 1.0a: 사용자의 Access Token 얻는 방법](/ko/resources/fundamentals/authentication#obtaining-access-tokens-using-3-legged-oauth-flow) 참조). 이러한 엔드포인트는 위 표에서 별표(\*)로 표시되어 있습니다.

- [POST account\_activity/webhooks/:webhook\_id/subscriptions/all](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks-webhook-id-subscriptions-all): 애플리케이션을 사용자의 계정 이벤트에 구독합니다
- [GET account\_activity/webhooks/:webhook\_id/subscriptions/all](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks-webhook-id-subscriptions-all): 웹훅 구성이 사용자의 이벤트에 구독되어 있는지 확인합니다
- [DELETE account\_activity/webhooks/:webhook\_id/subscriptions/all](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-all-deprecated): 제공된 사용자 컨텍스트와 애플리케이션에 대한 구독을 비활성화합니다 \[사용 중단됨]

<Note>
  **유의하세요**: 

  개발자 App이 "Read, Write, and Direct Messages"로 활성화되어 있는지 확인하세요. 이 설정은 개발자 계정의 [Projects & Apps 섹션](https://developer.x.com/en/portal/projects-and-apps)에서 선택한 개발자 App의 “App permissions”에서 변경할 수 있습니다. 권한 설정을 변경한 후에는 App 자격 증명을 다시 생성해야 합니다.
</Note>

Account Activity API에서 제공되는 모든 엔드포인트 목록과 관련 설명, 인증 구현 예제가 포함된 예시 cURL 요청은 [API 참조 문서](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-api-reference-index)에서 확인할 수 있습니다.

추가 정보는 Enterprise Account Activity API 시작에 도움이 되는 XDev의 [샘플 웹 앱 및 헬퍼 스크립트](https://github.com/xdevplatform/account-activity-dashboard-enterprise)를 확인하세요.

<Note>
  **유의하세요**: 

  API를 사용하기 시작하기 전에 X가 개발자 App에 대해 Account Activity API 접근을 활성화해야 합니다. 이를 위해 인증에 사용할 App ID를 계정 매니저 또는 기술 지원팀과 공유했는지 확인하세요.
</Note>

[Account Activity API](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity)는 단일 연결을 통해 구독된 모든 계정의 실시간 계정 활동을 수신할 수 있도록 사용자 구독을 생성하고 관리할 수 있는 일련의 엔드포인트로 구성됩니다. 

Account Activity API에는 두 가지 인증 방법([OAuth 1.0a](/ko/resources/fundamentals/authentication#oauth-1-0a-2) 및 [OAuth 2.0 Bearer Token](/ko/resources/fundamentals/authentication#oauth-2-0))이 제공됩니다. 사용할 인증 방법은 사용하는 엔드포인트에 따라 달라집니다.

|     |     |     |     |
| :--- | :--- | :--- | :--- |
| **설명** | **엔드포인트** | OAuth 1.0a  <br />(사용자 컨텍스트) | OAuth 2.0 베어러 토큰(애플리케이션 전용) |
| 지정된 애플리케이션 컨텍스트에 대해 새로운 웹훅 URL 등록 | [POST account\_activity/webhooks](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks) | ✓   |     |
| 지정된 애플리케이션의 모든 URL과 해당 상태 반환 | [GET account\_activity/webhooks](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks) |     | ✓   |
| 지정된 웹훅의 URL에 대해 CRC(챌린지 응답 검사) 트리거 | [PUT account\_activity/webhooks/:webhook\_id](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#put-account-activity-webhooks-webhook-id) | ✓   |     |
| 애플리케이션을 사용자의 계정 이벤트에 구독 | [POST account\_activity/webhooks/:webhook\_id/subscriptions/all](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks-webhook-id-subscriptions-all) | ✓ \* |     |
| 현재 활성 구독 수 반환 | [GET account\_activity/subscriptions/count](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-subscriptions-count) |     | ✓   |
| 웹훅 설정이 사용자의 이벤트를 구독 중인지 확인 | [GET account\_activity/webhooks/:webhook\_id/subscriptions/all](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks-webhook-id-subscriptions-all) | ✓ \* |     |
| 현재 활성 구독 목록 반환 | [GET account\_activity/webhooks/:webhook\_id/subscriptions/all/list](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks-webhook-id-subscriptions-all-list) |     | ✓   |
| 웹훅 삭제 | [DELETE account\_activity/webhooks/:webhook\_id](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id) | ✓   |     |
| \[사용 중단됨] 제공된 사용자 컨텍스트와 애플리케이션에 대한 구독 비활성화 | [DELETE account\_activity/webhooks/:webhook\_id/subscriptions/all](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-all-deprecated) | ✓ \* |     |
| 애플리케이션 전용 OAuth를 사용하여 구독 비활성화 | [DELETE /account\_activity/webhooks/:webhook\_id/subscriptions/:user\_id/all.json](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-user-id-all-json) |     | ✓   |
| 활동을 웹훅으로 재전송 | [POST /1.1/account\_activity/replay/webhooks/:webhook\_id/subscriptions/all.json](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#replay-api) |     | ✓   |

\*\_ 인증에는 구독하는 사용자의 액세스 토큰이 필요합니다. \_

OAuth 1.0a 사용자 컨텍스트 인증이 필요한 엔드포인트의 경우, 요청을 인증하려면 다음 자격 증명이 필요합니다: 

- 컨슈머 키(API 키와 시크릿)
- 액세스 토큰(액세스 토큰과 시크릿)

다음 세 엔드포인트의 경우 애플리케이션 컨텍스트에서 쓰기 작업을 수행합니다(X 사용자는 관여하지 않음). 따라서 제공해야 하는 액세스 토큰은 개발자 앱에 속한 토큰입니다. 이는 앱의 “Keys and tokens” 탭에서 [developer portal](https://developer.x.com/en/portal/projects-and-apps)을 통해 직접 생성할 수 있습니다.  

- [POST account\_activity/webhooks](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks): 지정된 애플리케이션 컨텍스트에 대해 새 웹훅 URL을 등록합니다
- [PUT account\_activity/webhooks/:webhook\_id](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#put-account-activity-webhooks-webhook-id): 지정된 웹훅의 URL에 대해 CRC(Challenge Response Check)를 수행합니다
- [DELETE account\_activity/webhooks/:webhook\_id](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id): 웹훅을 삭제합니다

한편, 다음 세 엔드포인트는 X 사용자를 대신하여 보호된 데이터(예: 다이렉트 메시지)에 애플리케이션이 액세스할 수 있도록 요청합니다. 따라서 해당 구독 사용자의 액세스 토큰을 제공해야 합니다. 필요한 액세스 토큰은 3-legged OAuth 플로우를 사용해 획득할 수 있습니다([OAuth 1.0a: 사용자의 액세스 토큰 획득 방법](/ko/resources/fundamentals/authentication#obtaining-access-tokens-using-3-legged-oauth-flow) 참조). 이러한 엔드포인트는 위 표에서 별표(\*)로 표시되어 있습니다.

- [POST account\_activity/webhooks/:webhook\_id/subscriptions/all](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks-webhook-id-subscriptions-all): 애플리케이션을 사용자의 계정 이벤트에 구독합니다
- [GET account\_activity/webhooks/:webhook\_id/subscriptions/all](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks-webhook-id-subscriptions-all): 웹훅 구성이 사용자의 이벤트에 구독되어 있는지 확인합니다
- [DELETE account\_activity/webhooks/:webhook\_id/subscriptions/all](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-all-deprecated): 제공된 사용자 컨텍스트와 애플리케이션의 구독을 비활성화합니다 \[사용 중단됨]

<Note>
  **유의하세요**: 

  개발자 App이 "Read, Write, and Direct Messages"에 대해 활성화되어 있는지 확인하세요. 개발자 계정의 [Projects & Apps 섹션](https://developer.x.com/en/portal/projects-and-apps)에서 선택한 개발자 App의 “App permissions”에서 이 설정을 변경할 수 있습니다. 권한 설정을 변경한 후에는 App 자격 증명을 다시 생성해야 합니다.
</Note>

Account Activity API로 사용 가능한 모든 엔드포인트 목록(관련 설명과 인증 구현 예제를 포함한 예시 cURL 요청 포함)은 [API 레퍼런스 문서](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-api-reference-index)에서 확인할 수 있습니다.

추가 정보는 Enterprise Account Activity API 시작에 도움이 되는 XDev의 [샘플 웹 앱 및 헬퍼 스크립트](https://github.com/xdevplatform/account-activity-dashboard-enterprise)를 참고하세요.

## 재시도

`Enterprise`

Account Activity API의 엔터프라이즈 티어 혜택 중 하나는 웹후크 이벤트에 대한 재시도 메커니즘입니다. 200 ‘성공’ HTTP 응답 코드를 받지 못하면 X 서버는 재시도를 시작하여 5분 동안 최대 세 번까지 웹후크 이벤트를 다시 전송합니다. 이 웹후크 이벤트 재시도 서비스는 네트워크 문제 발생 시 및 클라이언트 측 서비스 중단이나 배포 과정에서 신뢰성을 높이고 이벤트 복구를 지원합니다.
 

### 재시도란 무엇인가요?

Account Activity API는 클라이언트의 웹 앱이 계정 활동 웹훅 이벤트에 대해 '성공' 200 응답을 반환하지 않을 때 재시도 기능을 제공합니다. 클라이언트 측에서 이벤트의 성공적인 수신을 확인하지 않으면 X는 해당 이벤트가 수신되지 않은 것으로 간주합니다. 200이 아닌 응답을 받았거나, 3초 이내에 응답이 없었거나, 아예 응답이 없는 경우 요청을 재시도하고 그 요청을 3초 동안 대기 상태로 둡니다. 이는 웹훅 URL로 보내는 활동에 대해 응답할 수 있는 시간이 두 번의 시도에 걸쳐 대략 총 5초라는 의미입니다. 서버가 응답하지 않거나 일시적인 오류를 반환하는 경우, 5분 동안 재시도를 이어갑니다. 검증 확인을 위한 재시도는 총 세 번 수행됩니다. 이는 중복성과 안전장치를 제공하여 모든 웹훅 이벤트를 수신할 수 있도록 합니다. 재시도를 사용하는 구독은 해당 웹훅에 구독된 모든 사용자에 대한 모든 활동에 대해 재전송된 이벤트를 받게 된다는 점에 유의하세요.

이 여덟 번의 시도 내에 검증을 확인하지 못하면 해당 활동은 더 이상 Account Activity API를 통해 제공되지 않습니다. 

<div id="what-are-retries">
  ### 재시도 타임라인
</div>

Account Activity API는 200 응답을 받을 때까지 약 5분 동안 최대 세 차례 재시도합니다. 자세한 내용은 아래 표를 참고하세요. 약 5분이 지나면 Account Activity API를 통해 해당 활동을 다시 전송할 수 없습니다. 누락된 데이터를 수집하려면 다른 X 엔드포인트를 사용해야 합니다. 예를 들어 [검색 API](/ko/x-api/enterprise-gnip-2.0/fundamentals/search-api)를 사용해 관련 게시물, 리포스트, 인용 게시물, 멘션, 답글을 검색할 수 있습니다. 누락된 다이렉트 메시지는 [이 엔드포인트](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/list-events)로 가져올 수 있습니다.

#### 재시도 타임라인

|     |
| :--- |
| 활동이 생성되며 Account Activity API가 webhook URL로 POST를 시도하고, 3초 후 타임아웃됩니다. |
| 직전 타임아웃이 끝난 뒤 3초를 기다린 다음 Account Activity API가 webhook URL로 POST를 시도하고, 3초 후 타임아웃됩니다. |
| 직전 타임아웃이 끝난 뒤 27초를 기다린 다음 Account Activity API가 webhook URL로 POST를 시도하고, 3초 후 타임아웃됩니다. |
| 직전 타임아웃이 끝난 뒤 242초를 기다린 다음 Account Activity API가 webhook URL로 POST를 시도하고, 3초 후 타임아웃됩니다. |
| 이 이후로는 Account Activity API가 POST 시도를 중단합니다. 클라이언트는 데이터를 복구하기 위해 다른 X 엔드포인트를 사용해야 합니다. |

## 계정 활동 데이터 객체 구조

| 객체 | 세부 정보 |
| :--- | :--- |
| for\_user\_id | 이벤트와 관련된 구독 사용자(구독된 사용자)를 식별합니다. |
| is\_blocked\_by | (조건부) 다른 사용자가 구독된 사용자를 언급할 때에만 표시됩니다. 게시물 언급 이벤트에서 true인 경우에만 포함됩니다. |
| source | 활동을 수행하는 사용자입니다. 예: 팔로우, 차단, 음소거를 수행하는 사용자가 source 사용자입니다. |
| target | 활동의 대상이 되는 사용자입니다. 예: 팔로우되거나, 차단되거나, 음소거되는 사용자가 target 사용자입니다. |

**사용 가능한 활동**

| 메시지 유형 | 세부 정보 |
| :--- | :--- |
| [tweet\_create\_events](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#tweet-create-events-posts-retweets-replies-quotetweets) | 구독 사용자가 수행하거나 구독 사용자에게 수행된 다음 작업의 게시물 상태 페이로드: 게시물, 리트윗, 답글, @언급, 인용 트윗, 인용 트윗의 리트윗. |
| [favorite\_events](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#favorite-events) | 사용자와 대상이 포함된 즐겨찾기(좋아요) 이벤트 상태. |
| [follow\_events](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#follow-events) | 사용자와 대상이 포함된 팔로우 이벤트. |
| [unfollow\_events](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#unfollow-events) | 사용자와 대상이 포함된 언팔로우 이벤트. |
| [block\_events](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#block-events) | 사용자와 대상이 포함된 차단 이벤트. |
| [unblock\_events](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#unblock-events) | 사용자와 대상이 포함된 차단 해제 이벤트. |
| [mute\_events](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#mute-events) | 사용자와 대상이 포함된 음소거 이벤트. |
| [unmute\_events](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#unmute-events) | 사용자와 대상이 포함된 음소거 해제 이벤트. |
| [user\_event](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#user-event) | 사용자가 애플리케이션 권한을 제거하여 구독이 자동으로 삭제될 때 전송되는 권한 취소 이벤트. |
| [direct\_message\_events](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#direct-message-events) | 다이렉트 메시지 송수신 시 사용자와 대상이 포함된 다이렉트 메시지 상태. |
| [direct\_message\_indicate\_typing\_events](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#direct-message-indicate-typing-events) | 사용자와 대상이 포함된 다이렉트 메시지 입력 중 표시 이벤트. |
| [direct\_message\_mark\_read\_events](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#direct-message-mark-read-events) | 사용자와 대상이 포함된 다이렉트 메시지 읽음 표시 이벤트. |
| [tweet\_delete\_events](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#tweet-delete-events) | 컴플라이언스 유지를 용이하게 하기 위한 게시물 삭제 알림. |

**페이로드 예시**

위 표에서 설명한 각 계정 활동 이벤트의 페이로드 예시는 아래를 참고하세요.

#### tweet\_create\_events (게시물, 리포스트, 답글, 인용 게시물) 

```
{
	"for_user_id": "2244994945",
	"tweet_create_events": [
	  {
		<Tweet Object>
	  }
	]
}
```

#### tweet\_create\_events (@멘션) 

```
{
	"for_user_id": "2244994945",
	"user_has_blocked": "false",
	"tweet_create_events": [
	  {
		<Tweet Object>
	  }
	]
}
```

#### favorite\_events

```
{
	"for_user_id": "2244994945",
	"favorite_events": [{
		"id": "a7ba59eab0bfcba386f7acedac279542",
		"created_at": "Mon Mar 26 16:33:26 +0000 2018",
		"timestamp_ms": 1522082006140,
		"favorited_status": {
			<Tweet Object>
		},
		"user": {
			<User Object>
		}
	}]
}
```

#### follow\_events

```
{
	"for_user_id": "2244994945",
	"follow_events": [{
			"type": "follow",
			"created_timestamp": "1517588749178",
			"target": {
				< 사용자 오브젝트 >
			},
			"source": {
				< 사용자 오브젝트 >
			}
		]
	}
}
```

#### unfollow\_events

```
{
	"for_user_id": "2244994945",
	"follow_events": [{
			"type": "unfollow",
			"created_timestamp": "1517588749178",
			"target": {
				<User Object>
			},
			"source": {
				<User Object>
			}
		]
	}
}
```

#### block\_events

```
{
	"for_user_id": "2244994945",
	"block_events": [{
		"type": "block",
		"created_timestamp": "1518127020304",
		"source": {
			<User Object>
		},
		"target": {
			<User Object>
		}
	}]
}
```

#### unblock\_events

```
{
	"for_user_id": "2244994945",
	"block_events": [{
		"type": "unblock",
		"created_timestamp": "1518127020304",
		"source": {
			<User Object>
		},
		"target": {
			<User Object>
		}
	}]
}
```

#### mute\_events

```
{
	"for_user_id": "2244994945",
	"mute_events": [
		{
			"type": "mute",
		  	"created_timestamp": "1518127020304",
			"source": {
				<User Object>
			},
			"target": {
				<User Object>
			}
		}
	]
}
```

#### unmute\_events

```
{
	"for_user_id": "2244994945",
	"mute_events": [
		{
			"type": "unmute",
		  	"created_timestamp": "1518127020304",
			"source": {
				<User Object>
			},
			"target": {
				<User Object>
			}
		}
	]
}
```

#### user\_event

```
{
	"user_event": {
		"revoke": {
			"date_time": "2018-05-24T09:48:12+00:00",
			"target": {
				"app_id": "13090192"
			},
			"source": {
				"user_id": "63046977"
			}
		}
	}
}
```

#### direct\_message\_events

```
{
  	"for_user_id": "4337869213",
	"direct_message_events": [{
		"type": "message_create",
		"id": "954491830116155396",
		"created_timestamp": "1516403560557",
		"message_create": {
			"target": {
				"recipient_id": "4337869213"
			},
			"sender_id": "3001969357",
			"source_app_id": "13090192",
			"message_data": {
				"text": "Hello World!",
				"entities": {
					"hashtags": [],
					"symbols": [],
					"user_mentions": [],
					"urls": []
				}
			}
		}
	}],
	"apps": {
		"13090192": {
			"id": "13090192",
			"name": "FuriousCamperTestApp1",
			"url": "https://x.com/furiouscamper"
		},
		"users": {},
		"3001969357": {
			"id": "3001969357",
			"created_timestamp": "1422556069340",
			"name": "Jordan Brinks",
			"screen_name": "furiouscamper",
			"location": "Boulder, CO",
			"description": "Alter Ego - X PE opinions-are-my-own",
			"url": "https://t.co/SnxaA15ZuY",
			"protected": false,
			"verified": false,
			"followers_count": 22,
			"friends_count": 45,
			"statuses_count": 494,
			"profile_image_url": "null",
			"profile_image_url_https": "https://pbs.twimg.com/profile_images/851526626785480705/cW4WTi7C_normal.jpg"
		},
		"4337869213": {
			"id": "4337869213",
			"created_timestamp": "1448312972328",
			"name": "Harrison Test",
			"screen_name": "Harris_0ff",
			"location": "Burlington, MA",
			"protected": false,
			"verified": false,
			"followers_count": 8,
			"friends_count": 8,
			"profile_image_url": "null",
			"statuses_count": 240,
			"profile_image_url_https": "https://abs.twimg.com/sticky/default_profile_images/default_profile_normal.png"
		}
	}
}
```

#### direct\_message\_indicate\_typing\_events

```
{
	"for_user_id": "4337869213",
	"direct_message_indicate_typing_events": [{
		"created_timestamp": "1518127183443",
		"sender_id": "3284025577",
		"target": {
			"recipient_id": "3001969357"
		}
	}],
	"users": {
		"3001969357": {
			"id": "3001969357",
			"created_timestamp": "1422556069340",
			"name": "Jordan Brinks",
			"screen_name": "furiouscamper",
			"location": "Boulder, CO",
			"description": "Alter Ego - X PE opinions-are-my-own",
			"url": "https://t.co/SnxaA15ZuY",
			"protected": false,
			"verified": false,
			"followers_count": 23,
			"friends_count": 47,
			"statuses_count": 509,
			"profile_image_url": "null",
			"profile_image_url_https": "https://pbs.twimg.com/profile_images/851526626785480705/cW4WTi7C_normal.jpg"
		},
		"3284025577": {
			"id": "3284025577",
			"created_timestamp": "1437281176085",
			"name": "Bogus Bogart",
			"screen_name": "bogusbogart",
			"protected": true,
			"verified": false,
			"followers_count": 1,
			"friends_count": 4,
			"statuses_count": 35,
			"profile_image_url": "null",
			"profile_image_url_https": "https://pbs.twimg.com/profile_images/763383202857779200/ndvZ96mE_normal.jpg"
		}
	}
}
```

#### direct\_message\_mark\_read\_events

```
{
	"for_user_id": "4337869213",
	"direct_message_mark_read_events": [{
		"created_timestamp": "1518452444662",
		"sender_id": "199566737",
		"target": {
			"recipient_id": "3001969357"
		},
		"last_read_event_id": "963085315333238788"
	}],
	"users": {
		"199566737": {
			"id": "199566737",
			"created_timestamp": "1286429788000",
			"name": "Le Braat",
			"screen_name": "LeBraat",
			"location": "Denver, CO",
			"description": "data by day @X, design by dusk",
			"protected": false,
			"verified": false,
			"followers_count": 299,
			"friends_count": 336,
			"statuses_count": 752,
			"profile_image_url": "null",
			"profile_image_url_https": "https://pbs.twimg.com/profile_images/936652894371119105/YHEozVAg_normal.jpg"
		},
		"3001969357": {
			"id": "3001969357",
			"created_timestamp": "1422556069340",
			"name": "Jordan Brinks",
			"screen_name": "furiouscamper",
			"location": "Boulder, CO",
			"description": "Alter Ego - X PE opinions-are-my-own",
			"url": "https://t.co/SnxaA15ZuY",
			"protected": false,
			"verified": false,
			"followers_count": 23,
			"friends_count": 48,
			"statuses_count": 510,
			"profile_image_url": "null",
			"profile_image_url_https": "https://pbs.twimg.com/profile_images/851526626785480705/cW4WTi7C_normal.jpg"
		}
	}
}
```

#### tweet\_delete\_events

```
{
    "for_user_id": "930524282358325248",
    "tweet_delete_events": [
{
        "status": {
            "id": "1045405559317569537",
            "user_id": "930524282358325248"
        },
        "timestamp_ms": "1432228155593"
    }
   ]
}
```

## Account Activity Replay API

`Enterprise`

Account Activity Replay API는 최대 5일 전까지의 이벤트를 복구할 수 있는 데이터 복구 도구입니다. [웹훅](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#enterprise-account-activity-api) 서버가 이벤트를 놓친 경우, 즉 [재시도 기간](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#retries)보다 긴 연결 끊김이 있었거나 시스템을 정상 상태로 복구하는 데 며칠이 필요한 재해 복구 상황 등에서 데이터 복구를 위해 사용해야 합니다.

Account Activity Replay API는 일정 기간 동안 [활동](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity) 수집에 실패한 모든 상황을 위해 개발되었습니다. 원래 실시간으로 활동을 전달하던 것과 동일한 웹훅으로 활동을 다시 전달합니다. 이 제품은 백필(backfill) 도구가 아닌 복구 도구이므로, 과거에 해당 이벤트의 전달이 시도된 경우에만 이벤트가 재생됩니다. 또한 구독이 생성되기 이전 기간의 이벤트는 전달할 수 없습니다.

### Account Activity Replay API 사용

계정에 Replay 기능이 구성되어 있다면 Account Activity API에 요청하는 방식과 유사하게 요청할 수 있습니다. 요청에는 어떤 webhook의 활동을 재생할지 지정하기 위해 반드시 webhook id 매개변수를 포함해야 합니다. 다시 말해, Replay 요청은 webhook id 및 application id를 기준으로 특정 시작 일시부터 종료 일시까지의 이벤트를 가져오도록 Account Activity Replay API에 요청하는 것입니다.

시간 표기는 UTC여야 합니다. 이러한 활동은 해당 id와 연결된 등록된 webhook을 통해 초당 최대 2,500건의 속도로 전달됩니다. 또한 하나의 webhook당 동시에 실행될 수 있는 Replay 작업은 하나뿐이라는 점을 유의하십시오. 다만 해당 webhook에 지정한 기간 동안 활성 상태였던 모든 구독은 재생됩니다.

이벤트는 지정한 기간의 첫 번째(가장 오래된) 1분부터 시작해 최종 1분이 전달될 때까지 시간순으로(가능한 한 최대로) 전달됩니다. 그 시점에 Replay는 webhook으로 [작업 완료 이벤트](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#job-completed-successfully-message)를 전달합니다. 활동을 시간순으로 전달하므로 시작 시점 근처에 일치하는 결과가 거의 없거나 없는 경우 첫 결과가 전달되기까지 시간이 소요될 수 있습니다.

<div id="using-account-activity-replay-api">
  ### 제한 사항
</div>

Replay는 최대 5일 전까지의 활동을 손쉽게 복구하기 위한 도구로 설계되었지만, 구독이 생성된 시점 이전의 이벤트는 제공하지 않습니다. 예를 들어 3일 전에 새 구독을 추가하고 오늘 기준으로 과거 5일을 범위로 Replay 작업을 실행했다면, 해당 새 구독이 활성 상태였던 지난 3일치 데이터만 받게 됩니다.

<div id="limitations">
  ### 데이터 가용성 및 유형
</div>

Account Activity Replay API의 활동 데이터는 요청을 시작한 시점부터 5일간 제공되며, 각 활동이 생성된 후 약 10분이 지나면 새 데이터가 이용 가능해집니다. 이 5일 기간 내에서 from\_date 및 to\_date 매개변수를 사용해 요청의 시간 범위를 지정할 수 있습니다. Replay에 대한 액세스 권한을 받기 전에 원래 전달된 이벤트는 재생할 수 없습니다. 예를 들어, 계정에 Account Activity Replay API 액세스가 2019년 6월 1일 15:30(UTC)에 활성화되었다면, 그 이전의 이벤트는 Replay로 조회할 수 없습니다.

[Account Activity Replay API 참조](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-all-deprecated)로 계속

## 마이그레이션 소개

**당사는 2018년에 Site Streams, User Streams, 그리고 Account Activity API - DM Only 제품의 표준 베타 버전을 종료했습니다. 해당 제품을 사용 중이셨다면 반드시 Account Activity API의 프리미엄 또는 엔터프라이즈 버전으로 마이그레이션해 주시기 바랍니다.**

**레거시 Direct Message 엔드포인트 또한 종료되었습니다. 해당 엔드포인트를 사용 중이셨다면, 새로운 DM 엔드포인트 또는 Account Activity API의 프리미엄 혹은 엔터프라이즈 버전으로 반드시 마이그레이션해 주시기 바랍니다.**

**자세한 내용은 [이 공지](https://devcommunity.x.com/t/details-and-what-to-expect-from-the-api-deprecations-this-week-on-august-16-2018/110746)를 확인해 주세요.**

다음 엔드포인트가 이번 변경의 영향을 받습니다:

- User Streams
- Site Streams
- GET direct\_messages
- GET direct\_messages/sent
- GET direct\_messages/show
- POST direct\_messages/new
- POST direct\_messages/destroy
   

유사한 접근을 제공하고, Direct Messages의 경우 일부 추가 기능도 제공하는 새로운 엔드포인트와 서비스가 마련되어 있습니다:

- Account Activity API [enterprise](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#enterprise-account-activity-api) 및 [premium](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-api-reference-index)
- [GET direct\_messages/events/list](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/list-events)
- [GET direct\_messages/events/show](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/get-event)
- [POST direct\_messages/events/new](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/new-event)
- [POST direct\_messages/events/destroy](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/delete-message-event)

이러한 새로운 엔드포인트와 서비스로 원활히 마이그레이션하실 수 있도록 두 가지 마이그레이션 가이드를 제공합니다:

- 웹훅 기반의 새로운 서비스로 User Streams 및 Site Streams에서 이동하려는 분을 위한 [Account Activity API 마이그레이션 가이드](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#migration-guide-moving-from-user-streams-site-streams-to-account-activity-api)
- Direct Message REST 엔드포인트 간 마이그레이션을 위한 [Direct Message 마이그레이션 가이드](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/guides/direct-message-migration)
   

또한 Account Activity API와 시작 방법을 다룬 [동영상 시리즈](https://www.youtube.com/playlist?list=PLFKjcMIU2WshGG6Yj940XM7Z6BFs1zfBg)도 제공됩니다.

마지막으로, 이해를 돕고 빠르게 시작하실 수 있도록 코드 샘플을 제공합니다:

- [Account Activity Dashboard](https://github.com/xdevplatform/Account-Activity-dashboard)는 Account Activity API 시작에 도움이 되는 보조 스크립트를 포함한 예시 Node.js 웹 앱입니다.
- [SnowBot](https://github.com/xdevplatform/SnowBotDev)은 Account Activity API와 REST Direct Message 엔드포인트를 사용하는 샘플 챗봇입니다. Ruby로 작성되었고 Sinatra 웹 앱 프레임워크를 사용하며 Heroku에 배포되어 있습니다.

<div id="migration-introduction">
  ## 마이그레이션 가이드: User Streams/Site Streams에서 Account Activity API로 전환
</div>

**2018년 8월 23일부로 Site Streams와 User Streams를 종료했습니다. 반드시 Account Activity API로 전환해 주시기 바랍니다.**

**자세한 내용은 [이 공지](https://devcommunity.x.com/t/details-and-what-to-expect-from-the-api-deprecations-this-week-on-august-16-2018/110746)를 확인해 주십시오.**

본 가이드는 레거시 User Streams 및 Site Streams API에서 그 대체 기술인 Account Activity API로 마이그레이션하는 데 도움을 드리기 위해 작성되었습니다. 아래에서 변경 사항 요약, 신규 기능 목록, 전환을 돕기 위한 주요 차이점 및 고려사항을 확인하실 수 있습니다. 기본 DM 엔드포인트에서 마이그레이션하는 방법에 대한 안내는 [Direct Message 마이그레이션 가이드](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/guides/direct-message-migration)를 참고하십시오.

### 변경 사항 요약

Account Activity API는 User Streams 및 Site Streams처럼 스트리밍 연결을 사용하는 대신, 웹후크를 통해 인증되고 구독된 계정의 이벤트를 전달합니다.

#### 사용 중단된 API

GET user

GET site (제어 스트림 포함: GET site/c/:stream\_id, GET site/c/:stream\_id/info.json, GET site/c/:stream\_id/friends/ids.json, POST site/c/:stream\_id/add\_user.json, POST /site/c/:stream\_id/remove\_user.json)

<div id="deprecated-apis">
  #### 대체 API
</div>

[Enterprise Account Activity API - 전체 활동](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#enterprise-account-activity-api)

### 차이점 및 마이그레이션 고려사항

**API 형식:** 새로운 Account Activity API는 User Streams 및 Site Streams와는 다르게 동작합니다. 웹훅으로 데이터를 수신하도록 웹 앱을 수정해야 합니다. 웹훅에 대한 자세한 내용은 [여기](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#getting-started-with-webhooks)에서 확인할 수 있습니다.

**사용 가능한 데이터:** 또 다른 주요 차이점은 전달되는 데이터와 관련이 있습니다. X는 더 이상 사용자가 X에서 팔로우하는 사람들(즉, 홈 타임라인)로부터의 이벤트를 보내지 않습니다. 이는 의도적인 변경이며 앞으로도 변경할 계획이 없습니다.

**신뢰성:** 스트리밍과 달리 웹훅은 전달 확인을 지원하고, 웹훅 URL에 도달하지 못한 POST 활동을 재시도할 수 있는 옵션을 제공합니다. 이를 통해 짧은 연결 끊김이나 다운타임이 있더라도 앱이 모든 관련 활동을 수신하고 있음을 더욱 보장할 수 있습니다.

<div id="differences-migration-considerations">
  ### 새로운 기능
</div>

Account Activity API는 특히 데이터가 스트리밍이 아닌 웹훅으로 전달된다는 점을 포함해 많은 새로운 기능을 제공합니다. 웹훅은 스트리밍 대비 여러 이점이 있으며, 가장 두드러진 것은 속도와 안정성입니다. API는 데이터가 준비되는 즉시 JSON 이벤트 형태로 전송하므로, 더 이상 활성 연결을 유지하거나 엔드포인트를 폴링할 필요가 없습니다. 이는 중복 구성의 필요성을 줄이고 전반적인 효율성을 높입니다. 웹훅에 대한 자세한 내용은 [기술 문서](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#getting-started-with-webhooks)에서 확인할 수 있습니다.

<div id="new-features">
  ### 사용자 구독 관리
</div>

Account Activity API는 하나의 등록된 웹훅에 대해 여러 구독을 허용합니다. 이를 통해 웹훅을 사용해 Site Streams 아키텍처와 유사하게 여러 사용자 구독 활동을 동일한 엔드포인트로 전달할 수 있습니다. 즉, 구독 한도와 관련된 구독을 웹훅 연결과는 별개로 추적할 수 있습니다. 또한 단일 웹훅에서 소수의 구독부터 수천 개의 구독까지 확장할 수 있습니다.

<div id="managing-user-subscriptions">
  ### **마이그레이션 방법**
</div>

<div id="how-to-migrate">
  ### **아래 단계에 따라 Site Streams API에서 Account Activity API로 쉽게 마이그레이션하세요**
</div>

**1단계: 패키지 결정**

현재 User Streams 또는 Site Streams를 어떻게 운영하고 있는지에 따라 Account Activity API의 enterprise 또는 premium 버전으로 전환하는 것을 고려해야 합니다. 현재 지원 중인 애플리케이션 수와 승인된 사용자 수를 감안하여 필요한 트래픽 규모와 안정성에 맞게 확장하십시오. 가장 적합한 패키지를 결정할 때 고려할 사항은 다음과 같습니다:

- 필요한 웹훅 수
- 애플리케이션에서 관리 중인 현재/예상 구독 수 및 승인된 사용자 수
- 현재 X 클라이언트 애플리케이션 수
- X로부터 원하는 지원 수준(포럼 지원 또는 관리형 엔터프라이즈 1:1 지원)
- 각 패키지의 가격

**2단계:** **개발자 포털에서 X 앱 설정 확인**

User Streams 또는 Site Streams에 현재 사용 중인 [X 앱](/ko/resources/fundamentals/developer-apps)은 [개발자 포털](/ko/resources/fundamentals/developer-portal)에서 소유 사용자 기준으로 표시됩니다. 이 X 앱은 해당 애플리케이션의 승인된 사용자를 유지하기 위해 Account Activity API에도 사용할 수 있습니다. 또한 새 앱을 생성하고, 원할 경우 사용자에게 새 앱에 대한 승인을 다시 받을 수도 있습니다. 기업을 대신해 새 앱을 만드는 경우, 회사의 X @handle 계정으로 앱을 생성하는 것을 권장합니다.

- X 앱 페이지의 [permissions](/ko/resources/fundamentals/developer-apps#app-permissions) 탭에서 "Read, Write and Access direct messages"를 활성화하세요.
  \*이 설정 변경은 소급 적용되지 않으며, 이미 승인된 사용자는 승인 당시의 설정을 유지합니다. 사용자가 아직 읽기, 쓰기 및 다이렉트 메시지 액세스를 허용하지 않았다면 해당 사용자에게 애플리케이션 재승인을 받아야 합니다.
- [X Sign-in](/ko/resources/fundamentals/authentication#log-in-with-x)과 X API에서 사용자 컨텍스트가 작동하는 방식에 익숙하지 않다면 [Obtaining Access Tokens](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#getting-started-with-webhooks)를 검토하세요.
- “Keys and Tokens” 탭 하단에서 X 앱 소유자용 액세스 토큰을 생성하세요. 같은 탭에서 Consumer Key, Consumer Secret, Access Token, Access Token Secret을 기록해 두세요. API 사용 시 필요합니다.
- [application-only](/ko/resources/fundamentals/authentication#bearer-token-also-known-as-app-only) API 메서드용으로 Consumer Key와 Consumer Secret을 사용해 베어러 토큰을 생성하세요.

**3단계: 웹훅 설정 및 구성**

- 이벤트를 수신할 웹훅으로 사용할 엔드포인트가 있는 웹 앱을 생성하세요(예: https://your\_domain.com/webhook/twitter 또는 https://webhooks.your\_domain.com).

- 웹훅을 생성할 때 Consumer Key, Consumer Secret, Access Token, Access Token Secret을 사용하세요. 엔드포인트는 response\_token을 포함하는 JSON 응답을 반환해야 하며, 이 토큰은 crc\_token과 앱 Consumer Secret으로부터 생성한 base64 인코딩된 HMAC SHA-256 해시여야 합니다.

- Challenge Response Check(CRC) 요구 사항에 특히 유의하여 [Securing Webhooks](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#securing-webhooks) 문서를 검토하세요.

- 웹훅이 수신 이벤트용 POST 요청과 CRC용 GET 요청을 지원하는지 확인하세요.

- 웹훅이 낮은 지연 시간(예: POST 요청에 대해 3초 미만으로 응답)을 보장하는지 확인하세요.

**4단계: 웹훅 설정 검증**

- Webhook API는 다음 두 가지 방식으로 웹훅을 보호합니다:

               - 웹훅 소유자가 웹 앱 소유자인지 확인하기 위한 챌린지 응답 검사를 요구합니다.

               - 각 POST 요청에 서명 헤더를 포함하여 웹 앱이 출처를 검증할 수 있도록 합니다.

- 웹 앱과 웹훅 URL의 소유자임을 확인하기 위해 X는 Challenge Response Check(CRC)를 수행합니다. 이는 cyclic redundancy check와 혼동하지 마세요.
- crc\_token이라는 매개변수가 포함된 GET 요청이 웹훅 URL로 전송됩니다. 엔드포인트는 response\_token을 포함하는 JSON 응답을 반환해야 하며, 이 토큰은 crc\_token과 앱 Consumer Secret으로부터 생성한 base64 인코딩된 HMAC SHA-256 해시여야 합니다.
- crc\_token은 각 CRC 요청마다 변경됩니다. 계산 시 crc\_token을 메시지로, Consumer Secret을 키로 사용하세요.
- 응답이 유효하지 않은 경우 등록된 웹훅으로 이벤트 전송이 중지됩니다.

**5단계: 각 User Stream 또는 Site Streams 승인 사용자에 대한 구독 생성**

User Streams에서 Account Activity API로 전환:

- User Streams에서 현재 사용자 구독 목록을 생성합니다.
- 다음 요청으로 새 Account Activity API 구독을 설정합니다:  _POST account\_activity/all/:env\_name/subscriptions_
- 다음 요청으로 Account Activity API 구독을 확인합니다:  \_GET account\_activity/all/:env\_name/subscriptions/list
   \_

Site Streams에서 Account Activity API로 전환하기: (컨트롤 스트림 사용)

- 다음 요청으로 Site Streams의 현재 구독 목록을 생성합니다:  _GET /1.1/site/c/:stream\_id/info.json_
- 다음 요청으로 새 Account Activity API 구독을 설정합니다:  _POST account\_activity/all/:env\_name/subscriptions_
- 다음 요청으로 Account Activity API 구독을 확인합니다:  \_GET account\_activity/all/:env\_name/subscriptions/list
   \_

Webhook 등록 및 구독 생성(Site Streams 또는 User Streams에서 마이그레이션하지 않는 경우)

- 앱에 webhook URL을 [POST webhooks](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#enterprise-account-activity-api)로 등록하고 webhook\_id를 발급받습니다.
- 반환된 webhook\_id를 사용해 [POST webhooks/:webhook\_id/subscriptions/all](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks-webhook-id-subscriptions-all)로 사용자 구독을 추가합니다.

<div id="follow-the-steps-below-to-easily-migrate-from-the-site-streams-api-to-the-account-activity-api">
  ### Account Activity 대시보드(샘플 Account Activity API 애플리케이션)
</div>

Account Activity API를 더 빠르게 테스트할 수 있도록 샘플 앱을 제공했습니다:   

- Account Activity Dashboard 샘플 애플리케이션을 [여기](https://github.com/xdevplatform/Account-Activity-dashboard)에서 다운로드하세요(Node.js 사용)
- 설치 및 실행 방법은 README의 안내를 따르세요
- 애플리케이션을 실행한 후 UI에서 웹훅을 간편하게 설정하고 새 구독을 생성할 수 있습니다

<div id="the-account-activity-dashboard-sample-account-activity-api-application">
  ### 사용 가능한 활동
</div>

| 메시지 유형 | 상세 정보 |
| :--- | :--- |
| [tweet\_create\_events](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#tweet-create-events-posts-retweets-replies-quotetweets) | 구독 사용자에 의한/구독 사용자 대상의 다음 작업 발생 시 전달되는 게시 상태 페이로드: 게시, 리트윗, 답글, @멘션, 인용 트윗 |
| [favorite\_events](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#favorite-events) | 사용자와 대상이 포함된 좋아요 이벤트 상태. |
| [follow\_events](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#follow-events) | 사용자와 대상이 포함된 팔로우 이벤트. |
| [block\_events](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#block-events) | 사용자와 대상이 포함된 차단 이벤트. |
| [mute\_events](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#mute-events) | 사용자와 대상이 포함된 음소거 이벤트. |
| [direct\_message\_events](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#direct-message-events) | 사용자와 대상이 포함된 다이렉트 메시지 이벤트 상태. |
| [direct\_message\_indicate\_typing\_events](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#direct-message-indicate-typing-events) | 사용자와 대상이 포함된 다이렉트 메시지 입력 중 표시 이벤트. |
| [direct\_message\_mark\_read\_events](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#direct-message-mark-read-events) | 사용자와 대상이 포함된 다이렉트 메시지 읽음 표시 이벤트. |

<div id="available-activities">
  ### 사용 중단된 스트리밍 메시지 유형
</div>

|     |     |
| :--- | :--- |
| 빈 줄 | 빈 줄은 더 이상 Account Activity API에서 전달되지 않습니다. 이는 과거 User Streams 및 Site Streams에서 keep-alive 메시지로 사용되었기 때문입니다. |
| 제한 알림 | 제한 알림은 더 이상 특정 웹훅으로 전송되지 않습니다. 대신 사용자는 API를 호출하여 사용 가능한 핸들의 현재 사용량을 확인할 수 있습니다. 이는 향후 개발자 포털에 포함될 예정입니다. |
| 연결 해제 메시지 | 웹훅은 활성 연결에 의존하지 않으므로 연결 해제 알림은 더 이상 필요하지 않습니다. |
| 지연 경고 | 웹훅은 다량의 수신 메시지를 처리하기 위한 활성 연결에 의존하지 않으므로 지연 경고는 더 이상 필요하지 않습니다. |
| 친구 목록 | 친구 목록은 더 이상 선제적으로 전송되지 않습니다. 이제 이 정보를 조회할 수 있는 REST 엔드포인트가 제공됩니다. |

<div id="deprecated-streaming-message-types">
  ### 사용 중단된 이벤트 유형
</div>

|     |     |     |     |     |
| :--- | :--- | :--- | :--- | :--- |
| **설명** | **이벤트 이름** | **소스** | **대상** | **대상 객체** |
| 사용자가 게시물을 삭제함 | delete | 현재 사용자 | 현재 사용자 | 게시물 |
| 팔로우한 사용자가 게시물을 삭제함 | delete | 팔로우한 사용자 | 팔로우한 사용자 | 게시물 |
| 사용자가 게시물의 좋아요를 취소함 | unfavorite | 현재 사용자 | 게시물 작성자 | 게시물 |
| 사용자의 게시물이 좋아요 취소됨 | unfavorite | 좋아요를 취소한 사용자 | 현재 사용자 | 게시물 |
| 사용자가 다른 사용자를 언팔로우함 | unfollow | 현재 사용자 | 팔로우한 사용자 | Null |
| 사용자가 리스트를 생성함 | list\_created | 현재 사용자 | 현재 사용자 | 리스트 |
| 사용자가 리스트를 삭제함 | list\_destroyed | 현재 사용자 | 현재 사용자 | 리스트 |
| 사용자가 리스트를 수정함 | list\_updated | 현재 사용자 | 현재 사용자 | 리스트 |
| 사용자가 누군가를 리스트에 추가함 | list\_member\_added | 현재 사용자 | 추가된 사용자 | 리스트 |
| 사용자가 리스트에 추가됨 | list\_member\_added | 추가한 사용자 | 현재 사용자 | 리스트 |
| 사용자가 누군가를 리스트에서 제거함 | list\_member\_removed | 현재 사용자 | 제거된 사용자 | 리스트 |
| 사용자가 리스트에서 제거됨 | list\_member\_removed | 제거한 사용자 | 현재 사용자 | 리스트 |
| 사용자가 리스트를 구독함 | list\_user\_subscribed | 현재 사용자 | 리스트 소유자 | 리스트 |
| 사용자의 리스트가 구독됨 | list\_user\_subscribed | 구독한 사용자 | 현재 사용자 | 리스트 |
| 사용자가 리스트 구독을 취소함 | list\_user\_unsubscribed | 현재 사용자 | 리스트 소유자 | 리스트 |
| 사용자의 리스트가 구독 취소됨 | list\_user\_unsubscribed | 구독을 취소한 사용자 | 현재 사용자 | 리스트 |
| 사용자가 프로필을 업데이트함 | user\_update | 현재 사용자 | 현재 사용자 | Null |
| 사용자가 보호 상태를 업데이트함 | user\_update | 현재 사용자 | 현재 사용자 | Null |

## 다이렉트 메시지 마이그레이션 가이드

**2018년 9월 17일부로 레거시 다이렉트 메시지 엔드포인트를 종료했습니다.
해당 엔드포인트를 사용 중이었다면 새로운 다이렉트 메시지 엔드포인트 또는 Account Activity API로 반드시 마이그레이션해 주십시오.**

**자세한 내용은 [이 공지](https://devcommunity.x.com//t/details-and-what-to-expect-from-the-api-deprecations-this-week-on-august-16-2018/110746)를 확인하십시오.**

이 가이드는 레거시 다이렉트 메시지 REST API에서 베타를 졸업한 개선된 대체 API로 마이그레이션하는 데 도움을 드리기 위해 작성되었습니다. 아래에서 변경 사항 요약, 새로운 기능 목록, 전환에 도움이 되는 주요 차이점과 고려 사항을 확인할 수 있습니다. 새로운 다이렉트 메시지 엔드포인트는 현재 모든 개발자가 사용할 수 있습니다. User Streams 또는 Site Streams에서 마이그레이션하는 방법은 [Account Activity API로의 마이그레이션 가이드](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#migration-guide-moving-from-user-streams-site-streams-to-account-activity-api)를 참조하십시오.

- [변경 사항 요약](#summary)
- [신규 기능](#features)
- [다이렉트 메시지 보내기](#sending)
- [다이렉트 메시지 받기](#receiving)
- [다이렉트 메시지 삭제](#deleting)

### 변경 사항 요약

다음 DM 엔드포인트를 아직 사용 중이라면, 새 엔드포인트로 마이그레이션해야 합니다.

| 사용 중단된 엔드포인트 | 마이그레이션 대상 |
| :--- | :--- |
| [POST direct\_messages/new](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/new-event) | [POST direct\_messages/events/new](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/new-event) |
| [GET direct\_messages/show](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/get-event) | [GET direct\_messages/events/show](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/get-event) |
| [GET direct\_messages](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/list-events) | [GET direct\_messages/events/list](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/list-events) |
| [GET direct\_messages/sent](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/get-event) | [GET direct\_messages/events/list](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/list-events) |
| [POST direct\_messages/destroy](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/delete-message-event) | [DELETE direct\_messages/events/destroy](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/delete-message-event "GET direct_messages/events/list") |

<div id="differences-migration-considerations">
  ### 새로운 기능
</div>

새로운 다이렉트 메시지 API 엔드포인트는 여러 신규 기능을 제공하며, 이전 다이렉트 메시지에 대한 접근성을 개선합니다. 새로운 기능은 다음과 같습니다:

- 미디어 첨부(이미지, GIF, 동영상) 지원
- 미리 정의된 옵션 목록으로 사용자에게 구조화된 답장을 요청하는 기능
- 과거 다이렉트 메시지에 최대 30일간 접근 가능

새로운 다이렉트 메시지 기능의 전체 목록과 추가 신규 API 엔드포인트는 [기술 문서](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/overview)를 참조하세요.
 

<div id="new-features">
  ### 차이점과 마이그레이션 고려 사항
</div>

새로운 API 엔드포인트는 이전 것과 매우 다르게 동작합니다. 엔드포인트 URL만 업데이트하면 애플리케이션에서 오류가 발생합니다. 마이그레이션에 맞춰 애플리케이션을 업데이트할 때 다음을 유의하십시오.

#### 새로운 다이렉트 메시지 오브젝트

가장 먼저 눈에 띄는 변경 사항은 다이렉트 메시지의 새로운 오브젝트 구조입니다. 이 새로운 Message Create 오브젝트 구조는 [빠른 답장(Quick Replies)](https://developer.x.com/en/docs/x-api/v1/direct-messages/quick-replies/overview) 및 [첨부(Attachments)](https://developer.x.com/en/docs/x-api/v1/direct-messages/message-attachments/overview)와 같은 기능을 지원하기 위해 도입되었습니다. 이 오브젝트에는 더 작고 응축된 사용자 오브젝트도 포함됩니다. 애플리케이션은 이 새로운 오브젝트 구조를 반영하여 파싱 로직은 물론, 필요한 경우 데이터 모델이나 스토리지도 업데이트해야 합니다. 각 속성에 대한 설명은 [Message Create 오브젝트에 대한 전체 문서](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/guides/message-create-object)를 참조하세요.

**Message Create 오브젝트 예시**

```json
{
      "type": "message_create",
      "id": "1234858592",
      "created_timestamp": "1392078023603",
      "initiated_via": {
        "tweet_id": "123456",
        "welcome_message_id": "456789"
      },
      "message_create": {
        "target": {
          "recipient_id": "1234858592"
        },
        "sender_id": "3805104374",
        "source_app_id": "268278",
        "message_data": {
          "text": "Blue Bird",
          "entities": {
            "hashtags": [],
            "symbols": [],
            "urls": [],
            "user_mentions": [],
          },
          "quick_reply_response": {
            "type": "options",
            "metadata": "external_id_2"
          },
          "attachment": {
            "type": "media",
            "media": {
             ...
            }
          }
        }
      }
```

<div id="new-direct-message-object">
  #### 요약
</div>

- 다이렉트 메시지 객체 구조 전면 개편
- 사용자 객체 간소화
- 새 정보 제공(퀵 리플라이 응답, 첨부 파일 등)

### 다이렉트 메시지 보내기

[POST direct\_messages/events/new](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/new-event)는 다이렉트 메시지 전송을 위한 대체 엔드포인트입니다. 이 엔드포인트의 가장 큰 차이점은 개별 POST 매개변수 대신 모든 정보를 POST 요청 본문에 JSON으로 전송한다는 점입니다.

**Twurl 요청 예시**

```bash
twurl -A 'Content-type: application/json' -X POST /1.1/direct\_messages/events/new.json -d '{"event": {"type": "message\_create", "message\_create": {"target": {"recipient\_id": "4534871"}, "message_data": {"text": "Hello World!"}}}}'
```

위 요청에서 content-type이 application/x-www-form-urlencoded가 아니라 application/json으로 설정되어 있음을 유의하세요. 또한 OAuth 1.0a 서명을 생성할 때 JSON 본문은 서명에 포함되지 않는다는 점에 유의하세요. 대부분의 OAuth 라이브러리는 이미 이를 처리합니다. [twurl](https://github.com/twitter/twurl)을 사용하는 경우 버전 0.9.3 이상을 사용하세요.

<div id="new-direct-message-object">
  #### 요약
</div>

- 메시지는 JSON POST 본문에 정의됩니다.
- Content-Type 헤더는 application/json으로 설정해야 합니다.
- JSON 본문은 OAuth 서명 생성에 포함되지 않습니다.
   

### 다이렉트 메시지 가져오기

과거 다이렉트 메시지는 이제 단일 API 엔드포인트인 [GET direct\_messages/events/list](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/list-events)로 조회합니다. 이 신규 엔드포인트의 주요 변화는 보낸 메시지와 받은 메시지를 모두 최신순(역순)으로 반환한다는 점입니다. 이는 대화 스레드를 재구성하는 데 유용할 수 있습니다. 다만 보낸 메시지 또는 받은 메시지만 필요하다면 `sender_id` 속성을 참고하여 응답을 후처리해야 합니다.

이제 페이지네이션은 다이렉트 메시지 ID가 아니라 커서 값에 기반합니다. 각 응답에는 `cursor` 속성이 함께 반환됩니다. [GET direct\_messages/events/list](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/list-events)는 지난 30일 이내의 과거 메시지를, 해당 기간의 메시지 개수와 무관하게 반환합니다. 커서가 반환되지 않으면 더 이상 반환할 메시지가 없는 것입니다. [GET direct\_messages/events/show](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/get-event)를 사용하여 개별 다이렉트 메시지에 접근하는 방법은 동일하지만, 앞서 설명한 대로 반환되는 다이렉트 메시지 객체의 구조는 변경되었습니다.

마지막으로, 다이렉트 메시지에 대한 실시간 액세스는 [Account Activity API](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity)의 웹훅을 통해 제공합니다. User Streams 또는 Site Streams에서의 이전과 관련해서는 Account Activity API 마이그레이션 가이드를 참고하세요.

<div id="new-direct-message-object">
  #### 요약
</div>

- 보낸 메시지와 받은 메시지가 이제 동일한 엔드포인트에서 반환됩니다.
- 최대 30일치 메시지가 반환됩니다.
- 커서 기반 페이지네이션 지원.
- 웹훅을 통한 다이렉트 메시지 실시간 접근.

### 다이렉트 메시지 삭제

다이렉트 메시지는 이제 DELETE direct\_messages/events/destroy로 삭제할 수 있습니다. 인터페이스는 대부분 동일하며, 삭제할 메시지의 ID가 필요합니다. 주요 차이점은 이 엔드포인트가 이제 POST 요청이 아니라 DELETE 요청을 요구한다는 점입니다.

삭제된 다이렉트 메시지가 공식 X 클라이언트에 반영되는 방식은 동일합니다. 다이렉트 메시지는 제공된 사용자 컨텍스트의 인터페이스에서만 제거됩니다. 대화의 다른 참여자는 계속 해당 다이렉트 메시지를 볼 수 있습니다.

<div id="new-direct-message-object">
  #### 요약
</div>

- 다이렉트 메시지를 삭제하려면 ID가 필요합니다.
- 새 엔드포인트는 DELETE 요청을 요구합니다.
- 삭제된 다이렉트 메시지가 공식 X 클라이언트에 반영되는 방식은 변경되지 않았습니다.

\*\*새 다이렉트 메시지 엔드포인트로 마이그레이션하는 것에 대해 질문이 있으신가요?
\*\*[devcommunity.com](https://devcommunity.x.com/)의 개발자 커뮤니티 포럼에 질문을 올려주세요.

## 자주 묻는 질문

### 일반

**Account Activity API를 사용하면 어떤 이점이 있나요?**

Account Activity API는 웹훅을 사용합니다. 이는 스트리밍 API와 달리 정보를 전송하기 위해 지속적으로 연결을 열어 둘 필요가 없다는 의미입니다. 웹훅은 REST API와도 다릅니다. 원하는 데이터를 받기 위해 15분마다 수백 번씩 폴링할 필요가 없습니다. 발생 즉시 데이터를 전달하므로 사용자와 앱 간 효율이 높아집니다.

Account Activity API의 주요 이점은 다음과 같습니다.

1. **속도**: X의 속도로 데이터를 전달합니다.
2. **단순성**: 하나의 웹훅 연결만으로 해당 계정의 모든 이벤트를 전달합니다. API로 전달되는 활동에는 게시물, @멘션, 답글, 리트윗, 인용 게시물, 인용 게시물의 리트윗, 좋아요, 보낸 다이렉트 메시지, 받은 다이렉트 메시지, 팔로우, 차단, 뮤트가 포함됩니다.
3. **확장성**: 이벤트 한도나 레이트 제한에 구애받지 않고 관리 중인 계정의 모든 활동을 수신합니다.

Account Activity API는 프리미엄 샌드박스, 유료 프리미엄, 엔터프라이즈로 제공되며, 책임 관련 기능이나 추가 기능을 위해 더 많은 계정이 필요할 때 요구 사항에 맞춰 확장할 수 있습니다.

시작하려면 [GitHub](https://github.com/xdevplatform/account-activity-dashboard)에서 샘플 코드 스니펫을 다운로드하세요.
 

**어떤 제품 티어가 나에게 가장 적합한지 어떻게 알 수 있나요?**

프리미엄 옵션과 엔터프라이즈 옵션 간 차이에 대해 알아보려면 [Account Activity API 개요](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity) 페이지를 확인하세요. 
 

**프리미엄 환경과 엔터프라이즈 웹훅의 차이점은 무엇인가요?**

차이가 없습니다. 각 프리미엄 환경은 고유한 webhook\_id를 가집니다.
 

**Account Activity API에 개발, 스테이징, 프로덕션 환경이 필요합니다. 가능한가요?**

가능합니다! Account Activity API의 유료 티어(유료 프리미엄 및 엔터프라이즈)에서는 여러 웹훅 URL을 등록하고 API 메서드를 통해 환경별로 구독을 각각 관리할 수 있습니다. 또한 여러 클라이언트 앱을 허용 목록에 추가하여 현재 승인된 사용자의 인가를 유지할 수 있습니다.
 

**Account Activity API 설정을 단계별로 안내하는 가이드가 있나요?**

물론입니다!

- 처음 시작하는 경우 [웹훅 시작하기](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#getting-started-with-webhooks) 가이드를 권장합니다.

- X Dev에서 제공하는 스크립트를 따라 해보세요:
  - [Account Activity API 대시보드](https://github.com/xdevplatform/account-activity-dashboard): 웹훅 이벤트를 표시하는 Node 웹 앱입니다.
  - [SnowBot 챗봇](https://github.com/xdevplatform/SnowBotDev): Account Activity 및 Direct Message API를 기반으로 구축된 Ruby 웹 앱입니다. 이 코드베이스에는 Account Activity API 웹훅 설정을 돕는 [스크립트](https://github.com/xdevplatform/SnowBotDev/wiki/Account-Activity-API-setup-script)가 포함되어 있습니다.
     

**시스템이 일정 기간 다운되었을 때 데이터를 복구할 방법이 있나요?**

Account Activity API의 유료 티어(유료 프리미엄 및 엔터프라이즈)에서는 당사 시스템이 4시간에 걸쳐 여러 차례 활동 전송을 [재시도](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#retries)합니다. 해당 4시간 내에 시스템이 응답하지 않으면 활동은 손실되며, 7일 이내에 다른 REST 엔드포인트를 사용해 데이터를 복구해야 합니다.

여러 웹훅 또는 환경을 [Account Activity Replay API](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-replay-api)와 같은 이중화 도구로 활용하여, 시스템 중 하나가 다운되더라도 활동을 놓치지 않도록 하시길 권장합니다.
 

**Account Activity API에는 어떤 인증을 사용해야 하나요?**

Account Activity API에 필요한 인가 방식은 [API 참조 페이지](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-api-reference-index)의 각 메서드에 설명되어 있습니다. X 인증을 처음 시작하는 경우 [이 섹션](/ko/resources/fundamentals/authentication)을 먼저 읽어보시기 바랍니다.

**Challenge-response check(CRC)란 무엇인가요?**

Account Activity API 챌린지 응답 검사는 Account Activity API의 활동이 올바른 개발자에게 전송되고 있음을 보장하기 위해 마련된 보안 기능입니다. 또한 개발자는 수신하는 데이터가 X에서 온 것임을 확인하는 데 사용할 수 있습니다. X는 웹훅 URL이 마지막으로 검증된 시점을 기준으로 24시간마다 자동으로 CRC를 해당 웹훅 URL로 전송합니다. 시스템은 검증 상태를 유지하려면 3초 이내에 유효한 응답을 반환해야 합니다. 

자세한 내용은 [웹훅 보안](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#securing-webhooks) 페이지를 방문하세요.
 

**웹훅 URL이 즉시 무효화되는 경우가 있나요?**

다음 중 하나가 발생하면 웹훅을 즉시 무효로 표시합니다:

- 서버가 CRC에 잘못된 토큰으로 응답한 경우. 이 경우 당사 시스템은 활동을 보내기 위해 [재시도](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#retries)하지 않습니다.
- 웹훅 URL에 잘못된 인증서가 구성된 경우. 이 경우 당사 시스템은 활동을 보내기 위해 [재시도](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#retries)하지 않습니다.
- 서버가 2XX, 4XX, 5XX가 아닌 응답 코드를 반환하는 경우.
- gzip 사용을 지정했지만 실제로는 전송하지 않는 경우.
- gzip 사용을 지정하지 않았지만 실제 응답에서 gzip으로 전송하는 경우.
   

**서로 상호작용하는 사용자에 구독한 경우 중복 활동을 받게 되나요?**

예. 웹 앱이 사용자 A와 사용자 B에 대한 활성 구독이 있고, 사용자 A가 게시물에서 사용자 B를 멘션하면 등록된 웹훅으로 두 개의 POST 활동이 전송됩니다. 각 활동에는 해당 활동이 어떤 구독에 속하는지를 나타내는 "for\_user\_id" 표시가 포함됩니다.
 

**내 웹훅에 구독을 만들 때, API가 전달하는 활동을 제한하기 위해 다음 엔드포인트의 `/all/` 부분을 다른 계정 활동 데이터 객체로 바꿀 수 있나요?** `POST https://api.x.com/1.1/account_activity/all/:env_name/subscriptions.json`

아니요, 불가능합니다. 현재로서는 `/all/` 제품만 제공하고 있습니다.
 

**사용자로부터 Direct Messages 권한을 요청하지 않고 Account Activity API를 사용할 방법이 있나요?**

현재로서는 Direct Messages 권한이 필요합니다. 이 API에서 Direct Messages 활동을 ‘필터링’할 방법이 없기 때문입니다. 
 

**Account Activity API의 무료 버전이 있나요?**

예, 샌드박스 버전을 무료 티어로 제공합니다. 샌드박스 옵션은 단일 웹훅과 최대 15개의 구독으로 제한됩니다. 샌드박스 옵션에 대한 자세한 내용은 [문서](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity)를 참조하세요. 

**구독된 사용자를 멘션하는 게시물의 리트윗을 Account Activity API로 받을 수 있나요?**

안타깝게도 이 API에서 제공되는 활동에는 포함되지 않습니다. 이를 위해서는 Streaming API 사용을 권장합니다. 
 

**tweet\_create\_event가 나타내는 가능한 활동 유형은 무엇인가요?**

tweet\_create\_event 페이로드는 다음 경우에 전송됩니다:

구독 사용자 본인이 다음 작업 중 하나를 수행한 경우:

- 게시물 작성
- 리트윗
- 게시물에 답글

다른 사용자가 다음을 수행한 경우:

- 구독 사용자를 @멘션\*
- 구독 사용자가 작성한 트윗을 인용

\*참고: Account Activity API는 구독 사용자가 X에서 알림을 받고 공개적으로 해당 이벤트를 볼 수 있는 경우에만 이벤트를 전달합니다. 즉, 멘션된 계정(@userA)이 보호된 계정(@userB)을 팔로우하는 경우 UserA는 UserB가 자신을 멘션했다는 알림을 받습니다. UserA가 UserB를 팔로우하지 않았거나(그리고 UserB에게 승인을 받지 않은 경우) 알림을 받지 못하므로, @userA가 구독을 보유하더라도 AAA를 통해 tweet\_create\_event가 전송되지 않습니다.

**차단된 사용자가 내 구독 사용자를 멘션한 경우 이를 어떻게 식별할 수 있나요?**

JSON 응답의 최상위에 "user\_has\_blocked"라는 불리언 필드가 “true” 또는 “false”로 표시됩니다. 이 필드는 게시물 멘션에만 노출됩니다. 

Enterprise

**내 앱을 허용 목록에 추가하거나 이미 허용 목록에 있는지 확인하려면 어떻게 해야 하나요?**

Enterprise API를 통해 접근할 수 있도록 허용 목록에 추가한 [X apps](/ko/resources/fundamentals/developer-apps)를 관리하려면 앱 ID와 함께 계정 담당자에게 문의해 주세요. 앱 ID는 [developer portal](/ko/resources/fundamentals/developer-portal)의 ["Apps"](/ko/resources/fundamentals/developer-apps) 페이지에서 확인할 수 있습니다.
 

**웹후크를 세 개 사용할 수 있는 권한이 있다면, 엔터프라이즈용으로 등록한 각 앱마다 웹후크 세 개를 사용할 수 있나요?**

웹후크 한도는 앱 단위가 아니라 계정 단위로 설정됩니다. 웹후크 세 개에 대한 권한이 있고 엔터프라이즈용으로 등록된 앱이 두 개라면, 한 앱에 두 개, 다른 앱에 하나를 사용할 수는 있지만 각 앱마다 세 개씩은 사용할 수 없습니다. 

**Account Activity Replay API로 재전달할 이벤트 유형을 지정할 수 있나요?**

재생할 이벤트 유형은 지정할 수 없습니다. 지정한 날짜와 시간 범위 동안 전달된 모든 이벤트가 재생됩니다. 

**내 애플리케이션이 Account Activity Replay API 이벤트 수집에 실패한 경우 재시도가 이루어지나요?**

아니요, 재시도는 없습니다. 애플리케이션이 Account Activity Replay API가 보낸 이벤트 수집에 실패한 경우, 동일한 기간에 대해 다른 Replay 작업을 제출하여 누락된 Replay 이벤트의 재전달을 시도할 수 있습니다. 

**부분 성공 완료 이벤트를 수신하면 무엇을 해야 하나요?**

수신된 이벤트의 타임스탬프를 확인해 기록하고, 누락된 이벤트에 대해 다시 Replay 작업을 요청할 것을 권장합니다. 

**동시에 실행할 수 있는 Account Activity Replay API 작업은 몇 개인가요?**

웹후크당 한 번에 하나의 Account Activity Replay API 작업만 실행할 수 있습니다. 

**웹후크로 전달될 때 Account Activity Replay API 이벤트와 실시간 프로덕션 이벤트를 어떻게 구분할 수 있나요?**

Account Activity Replay API는 항상 과거 이벤트를 전달하므로, 이벤트의 타임스탬프를 기준으로 실시간 프로덕션 이벤트와 구분할 수 있습니다. 

**애플리케이션이 누락하거나 드롭한 활동을 재전달하기 위해 Account Activity Replay API를 얼마나 빨리 사용할 수 있나요?**

활동은 생성된 후 약 10분이 지나면 재전달이 가능해집니다. 

<div id="general">
  ### 오류 해결 가이드
</div>

#### 코드 32

이 오류는 일반적으로 요청, 헤더, 인증, 또는 지정한 URL 중 일부가 잘못 구성되었음을 의미합니다. 이는 Account Activity API 오류가 아니라 인증 오류이며, X가 올바른 OAuth 설정 또는 URL을 받지 못하고 있습니다.

- **Enterprise** - 사용 중인 consumer key와 access token이 Enterprise 제품 사용을 위해 등록된 [X app](/ko/resources/fundamentals/developer-apps)에 속해 있는지 확인하세요. consumer key와 access token이 없거나 X app을 허용 목록에 추가해야 하는 경우 계정 담당자에게 문의하세요.

- 사용자 컨텍스트로 인증하는 경우, `oauth nonce`, `oauth_signature`, `oauth_timestamp`가 올바르게 포함되도록 [요청을 승인](/ko/resources/fundamentals/authentication#authorizing-a-request)했는지 확인하세요.

- access token에 올바른 권한 수준이 있는지 확인하세요.
  - [app dashboard](/ko/resources/fundamentals/developer-apps)의 'Keys and tokens' 탭에서 access token이 'Read, write, and direct messages' [permission level](/ko/resources/fundamentals/developer-apps#app-permissions)을 보유하고 있는지 확인하세요.
  - 토큰의 권한 수준이 이보다 낮게 설정되어 있다면 'Permissions' 탭으로 이동해 권한을 'Read, write, and direct messages'로 조정한 다음, 'Keys and tokens' 탭에서 access token과 secret을 다시 생성하세요.

- URL이 올바르게 구성되어 있는지 확인하세요.
  - `:env_name`은 대소문자를 구분한다는 점을 유의하세요.
     

<div id="code-32">
  #### 코드 200 - Forbidden
</div>

- **Premium** - API 요청 전에 승인된 [개발자 계정](/ko/resources/fundamentals/developer-portal)이 있는지 확인하세요. 또한 요청에서 올바른 :env\_name을 사용해야 하며, 이는 [dev environments](/ko/resources/fundamentals/developer-portal) 페이지에서 설정할 수 있습니다.

- **Enterprise** - 계정 담당자가 Account Activity API에 대한 접근 권한을 부여했는지 확인하세요.

- URI를 올바르게 구성했는지 확인하세요. 요청에 잘못된 URI를 입력하면 이 오류가 발생할 수 있습니다.
   

<div id="code-200-forbidden">
  #### 코드 214 - Webhook URL이 요구 사항을 충족하지 않습니다.
</div>

- HTTPS를 사용하고 있는지 확인하세요.
- Webhook URL의 형식이 잘못되었을 수 있습니다.
- [웹훅 시작하기](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#getting-started-with-webhooks) 페이지의 [웹훅 컨슈머 앱 개발](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#3-develop-webhook-consumer-app) 섹션에서 웹훅 URL 설정 방법을 자세히 알아보세요.
   

<div id="code-214-webhook-url-does-not-meet-the-requirements">
  #### 코드 214 - CRC GET 요청 지연 시간이 높습니다. 웹후크는 3초 이내에 응답해야 합니다.
</div>

- 이는 서버가 느리다는 뜻입니다. CRC에 3초 이내에 응답하는지 확인하세요.
   

<div id="code-214-high-latency-on-crc-get-request-your-webhook-should-respond-in-less-than-3-seconds">
  #### 코드 214 - CRC GET 요청 중 200이 아닌 응답 코드(예: 404, 500 등).
</div>

- 서버가 다운되었습니다. 서버가 정상적으로 실행 중인지 확인하세요.
   

<div id="code-214-non-200-response-code-during-crc-get-request-ie-404-500-etc">
  #### 코드 214 - 생성된 리소스가 너무 많습니다.
</div>

- **Enterprise** - 이미 모든 웹훅을 사용했습니다. 등록된 각 앱에 대해 [GET webhooks](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks) 엔드포인트를 사용하여 웹훅이 어디에 배포되어 있는지 확인하세요. 

<div id="code-214-too-many-resources-already-created">
  #### 코드 261 - 애플리케이션이 쓰기 작업을 수행할 수 없습니다.
</div>

- API와 함께 사용 중인 앱의 액세스 토큰 및 액세스 토큰 시크릿에 적절한 [권한 수준](/ko/resources/fundamentals/developer-apps#app-permissions)이 설정되어 있지 않습니다. [X apps](/ko/resources/fundamentals/developer-apps) 대시보드의 ‘Keys and tokens’ 탭으로 이동해 해당 액세스 토큰과 액세스 토큰 시크릿에 부여된 권한 수준을 확인하세요. 설정이 ‘Read, write and Direct Messages’가 아니라면 ‘Permission’ 탭에서 권한을 변경한 뒤, 새 설정을 적용하기 위해 액세스 토큰과 액세스 토큰 시크릿을 다시 생성해야 합니다.
- 또는 app-only 인증으로 webhook 등록을 시도하고 있을 수 있으며, 이는 지원되지 않습니다. [Enterprise Account Activity API](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks)의 webhook 등록 관련 API 참조에 안내된 대로 사용자 컨텍스트로 인증하세요.

## Account Activity API 참고 색인

|     |     |
| :--- | :--- |
| **Purpose** | 엔터프라이즈 |
| 웹훅 URL 등록 / webhook\_id 생성 | [POST  <br />webhooks](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#enterprise-account-activity-api) |
| 모든 웹훅 URL과 상태 반환 | [GET  <br />webhooks](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks) |
| 챌린지 응답 검사를 수동으로 실행 | [PUT  <br />webhooks/:webhook\_id](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#put-account-activity-webhooks-webhook-id) |
| 애플리케이션을 계정 이벤트에 구독 | [POST  <br />webhooks/:webhook\_id/subscriptions/all](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks-webhook-id-subscriptions-all) |
| 현재 활성 구독 수 반환 | [GET  <br />subscriptions/count](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-subscriptions-count) |
| 웹훅이 계정에 구독되어 있는지 확인 | [GET  <br />webhooks/:webhook\_id/subscriptions/all](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks-webhook-id-subscriptions-all) |
| 현재 활성 구독 목록 반환 | [GET  <br />webhooks/:webhook\_id/subscriptions/all/list](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-subscriptions-count) |
| 웹훅 삭제 | [DELETE  <br />webhooks/:webhook\_id](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id) |
| 3-legged OAuth로 구독 비활성화(지원 중단됨) | [DELETE  <br />webhooks/:webhook\_id/subscriptions/all](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-all-deprecated) |
| 애플리케이션 전용 OAuth로 구독 비활성화 | [DELETE  <br />webhooks/:webhook\_id/subscriptions/:user\_id/all.json](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-user-id-all-json) |
| 활동을 웹훅으로 재전달 | [POST  <br />replay/webhooks/:webhook\_id/subscriptions/all](/ko/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-all-deprecated) |

### 엔터프라이즈 Account Activity API

#### POST account\_activity/webhooks[](#post-account-activity-webhooks "이 제목의 고유 링크")

지정된 애플리케이션 컨텍스트에 대해 새 webhook URL을 등록합니다. 저장 전에 CRC 요청으로 URL을 검증합니다. 검증이 실패하면 요청자에게 상세한 오류 메시지를 반환합니다.

허용되는 webhook 수는 요금제에 따라 결정됩니다.

### 리소스 URL[](#resource-url "이 제목의 퍼머링크")

`https://api.x.com/1.1/account_activity/webhooks.json`

<div id="resource-url">
  ### 리소스 정보[](#resource-information "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| 응답 형식 | JSON |
| 인증 필요 | 예(사용자 컨텍스트 — 모든 consumer 및 access 토큰) |
| 속도 제한 | 예 |
| 요청 수/15분 윈도우(사용자 인증) | 15 |
| 트윗 편집 지원 | 모든 트윗 오브젝트에는 트윗의 편집 이력을 설명하는 트윗 편집 메타데이터가 포함됩니다. 자세한 내용은 ["트윗 편집" 기본 사항](/ko/x-api/enterprise-gnip-2.0/fundamentals/edit-tweets) 페이지를 참조하세요. |

<div id="resource-information">
  ### 매개변수[](#parameters "이 제목의 고유 주소")
</div>

|     |     |
| :--- | :--- |
| url (필수) | 콜백 엔드포인트용으로 인코딩된 URL입니다. |

<div id="parameters">
  ### 예제 요청[](#example-request "이 제목의 퍼머링크")
</div>

$ curl --request POST
\--url 'https://api.x.com/1.1/account\_activity/webhooks.json?url=https%3A%2F%2Fyour\_domain.com%2Fwebhooks%2Ftwitter%2F0'
\--header 'authorization: OAuth oauth\_consumer\_key="CONSUMER\_KEY", oauth\_nonce="GENERATED", oauth\_signature="GENERATED", oauth\_signature\_method="HMAC-SHA1", oauth\_timestamp="GENERATED", oauth\_token="ACCESS\_TOKEN", oauth\_version="1.0"'

<div id="example-request">
  ### HTTP 응답[](#http-responses "Permalink to this headline")
</div>

| HTTP 코드 | 메시지 |
| :--- | :--- |
| 200 | 웹후크 URL이 제공된 애플리케이션에 등록되었습니다 |
| 403 | 요청에 오류가 있습니다. 아래 오류 메시지 섹션을 참조하세요. |

<div id="http-responses">
  ### 응답 예시 - 성공[](#example-response-success "Permalink to this headline")
</div>

```json
_HTTP 200_

    {
      "id": "1234567890",
      "url": "https://your_domain.com/webhook/twitter/0",
      "valid": true,
      "created_at": "2016-06-02T23:54:02Z"
    }
```

<div id="example-response-success">
  ### 오류 메시지[](#error-messages "Permalink to this headline")
</div>

| 코드 | 메시지 |
| :--- | :--- |
| 214 | Webhook URL이 요구 사항을 충족하지 않습니다. |
| 214 | 이미 생성된 리소스가 너무 많습니다. |
| 214 | Webhook URL이 요구 사항을 충족하지 않습니다. CRC 토큰이 잘못되었거나 JSON 응답 형식이 올바르지 않습니다. |
| 214 | CRC GET 요청의 지연 시간이 큽니다. Webhook은 3초 이내에 응답해야 합니다. |
| 214 | CRC GET 요청 중 200 이외의 응답 코드(예: 404, 500 등)입니다. |

_HTTP 403_

```json
    {
      "errors": [
        {
          "code": 214,
          "message": "Too many resources already created."
        }
      ]
    }
```

#### GET account\_activity/webhooks[](#get-account-activity-webhooks "Permalink to this headline")

지정된 애플리케이션의 모든 URL과 해당 상태를 반환합니다.

일일 유효성 검사에 실패한 URL은 무효로 표시됩니다. URL을 다시 활성화하려면 업데이트 엔드포인트를 호출하세요.

### 리소스 URL[](#resource-url "이 제목의 퍼머링크")

`https://api.x.com/1.1/account_activity/webhooks.json`

<div id="resource-url">
  ### 리소스 정보[](#resource-information "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| 응답 형식 | JSON |
| 인증 필요 | 예(애플리케이션 전용 - 베어러 토큰) |
| 요청 한도 적용 | 예 |
| 요청 수/15분 윈도우(애플리케이션 인증) | 15  |

### 예제 요청[](#example-request "이 제목의 고유 링크")

```bash
    $ curl --request GET
     --url https://api.x.com/1.1/account_activity/webhooks.json
     --header 'authorization: Bearer TOKEN'
```

<div id="example-request">
  ### 예시 응답[](#example-response "Permalink to this headline")
</div>

_HTTP 200 OK_

```json
    [
      {
        "id": "1234567890",
        "url": "https://your_domain.com/webhook/twitter/0",
        "valid": true,
        "created_at": "2016-06-02T23:54:02Z"
      }
      {
        "id": "2468013579",
        "url": "https://your_domain2.com/webhook/twitter/0",
        "valid": true,
        "created_at": "2016-06-04T22:31:29Z"
      }
    ]
```

<div id="example-response-success">
  ### 오류 메시지[](#error-messages "Permalink to this headline")
</div>

| 코드 | 메시지 |
| :--- | :--- |
| 99  | 이 리소스에 대한 접근 권한이 없습니다. |

#### PUT account\_activity/webhooks/:webhook\_id[](#put-account-activity-webhooks-webhook-id "Permalink to this headline")

지정된 webhook의 URL에 대해 챌린지 응답 확인(CRC)을 트리거합니다. 확인이 성공하면 204를 반환하고 상태를 `valid`로 설정하여 webhook을 다시 활성화합니다.

### 리소스 URL[](#resource-url "Permalink to this headline")

`https://api.x.com/1.1/account_activity/webhooks/:webhook_id.json`
\---MDX\_CONTENTEND---

### 리소스 정보[](#resource-information "이 제목의 고유 링크")

|     |     |
| :--- | :--- |
| 응답 형식 | JSON |
| 인증 필요 | 예(사용자 컨텍스트 - 모든 컨슈머 및 액세스 토큰) |
| 제한 여부 | 예 |
| 요청 수/15분(사용자 인증) | 15 |

### 매개변수[](#parameters "Permalink to this headline")

|     |     |
| :--- | :--- |
| webhook\_id (필수) | Webhook ID. 리소스 경로에서 정의됩니다. |

### 예제 요청[](#example-request "Permalink to this headline")

```json
    $ curl --request PUT
     --url https://api.x.com/1.1/account_activity/webhooks/:WEBHOOK_ID.json
     --header 'authorization: OAuth oauth_consumer_key="CONSUMER_KEY", oauth_nonce="GENERATED", oauth_signature="GENERATED", oauth_signature_method="HMAC-SHA1", oauth_timestamp="GENERATED", oauth_token="ACCESS_TOKEN", oauth_version="1.0"'
```

<div id="example-request">
  ### 응답[](#response "Permalink to this headline")
</div>

_HTTP 204 정상 응답_

```
    { }
```

### 오류 메시지[](#error-messages "이 제목의 고유 링크")

| 코드 | 메시지 |
| :--- | :--- |
| 34  | Webhook이 존재하지 않거나 다른 X 애플리케이션에 연결되어 있습니다. |
| 214 | Webhook URL이 요구 사항을 충족하지 않습니다. |
| 214 | Webhook URL이 요구 사항을 충족하지 않습니다. CRC 토큰이 잘못되었거나 JSON 응답 형식이 올바르지 않습니다. |
| 214 | CRC GET 요청의 지연 시간이 큽니다. Webhook은 3초 이내에 응답해야 합니다. |
| 214 | CRC GET 요청 중 200이 아닌 응답 코드(예: 404, 500 등)가 반환되었습니다. |

#### POST account\_activity/webhooks/:webhook\_id/subscriptions/all[](#post-account-activity-webhooks-webhook-id-subscriptions-all "이 제목의 고유 링크")

지정된 사용자 컨텍스트에 대해 모든 메시지 유형의 모든 이벤트를 지정된 애플리케이션이 구독하도록 합니다. 활성화되면, 요청한 사용자에 대한 모든 이벤트가 POST 요청을 통해 애플리케이션의 웹훅으로 전송됩니다.

구독은 현재 계정 구성에 따라 제한됩니다. 더 많은 구독이 필요하면 계정 관리자에게 문의하세요.

### 리소스 URL[](#resource-url "Permalink to this headline")

`https://api.x.com/1.1/account_activity/webhooks/:webhook_id/subscriptions/all.json`

<div id="resource-url">
  ### 리소스 정보[](#resource-information "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| 응답 형식 | JSON |
| 인증 필요 | 예(3-legged OAuth - 화이트리스트에 등록된 consumer key 및 구독 사용자의 access token) |
| 속도 제한 | 예 |
| 요청 수/15분 창(사용자 인증) | 500 |

### 매개변수[](#parameters "Permalink to this headline")

|     |     |
| :--- | :--- |
| webhook\_id (필수) | Webhook ID. 리소스 경로에서 정의됩니다. |

<div id="parameters">
  ### 예시 요청[](#example-request "이 제목의 퍼머링크")
</div>

```bash
    $ curl --request POST
     --url https://api.x.com/1.1/account_activity/webhooks/:WEBHOOK_ID/subscriptions/all.json
     --header 'authorization: OAuth oauth_consumer_key="WHITELISTED_CONSUMER_KEY", oauth_nonce="GENERATED", oauth_signature="GENERATED", oauth_signature_method="HMAC-SHA1", oauth_timestamp="GENERATED", oauth_token="SUBSCRIBING_USER'S_ACCESS_TOKEN", oauth_version="1.0"'
```

<div id="example-request">
  ### 예시 응답 - 성공[](#example-response-success "이 제목에 대한 고유 링크")
</div>

_HTTP 204 내용 없음_

```
    {}
```

<div id="example-response-success">
  ### 오류 메시지[](#error-messages "Permalink to this headline")
</div>

| 코드 | 메시지 |
| :--- | :--- |
| 34  | Webhook이 존재하지 않거나 다른 X 애플리케이션에 연결되어 있습니다. |
| 348 | 클라이언트 애플리케이션은 이 사용자의 Webhook 구독에 접근할 수 있는 권한이 없습니다. |

#### GET account\_activity/subscriptions/count[](#get-account-activity-subscriptions-count "이 제목에 대한 퍼머링크")

현재 계정에서 활성 상태인 구독 수를 반환합니다. /count 엔드포인트는 애플리케이션 전용 OAuth가 필요하므로 사용자 컨텍스트 대신 베어러 토큰으로 요청해야 합니다.

### 리소스 URL[](#resource-url "Permalink to this headline")

`https://api.x.com/1.1/account_activity/subscriptions/count.json`

<div id="resource-url">
  ### 리소스 정보[](#resource-information "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| 응답 형식 | HTTP 응답 코드 |
| 인증 필요 | 예(애플리케이션 전용 - 베어러 토큰) |
| 레이트 제한 | 예 |
| 요청 수/15분(애플리케이션 인증) | 15  |

<div id="resource-information">
  ### HTTP 응답 코드[](#http-response-codes "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| 코드 | 메시지 |
| 200 | 성공. 요청한 웹훅의 구독 수가 반환됩니다. |
| 401 | 지정된 웹훅의 구독을 조회할 권한이 애플리케이션에 없습니다. |

<div id="http-response-codes">
  ### 요청 예시[](#example-request "Permalink to this headline")
</div>

```bash
    $ curl --request GET
     --url https://api.x.com/1.1/account_activity/subscriptions/count.json
     --header 'authorization: Bearer TOKEN'
```

### 예시 응답 - 성공[](#example-response-success "Permalink to this headline")

_HTTP 200_

```bash
    {
      "account_name":"my-account",
      "subscriptions_count_all":"1",
      "subscriptions_count_direct_messages":"0",
      "provisioned_count":"50"
    }
```

<div id="example-response-success">
  ### 오류 메시지[](#error-messages "Permalink to this headline")
</div>

| 코드 | 메시지 |
| :--- | :--- |
| 32  | 인증할 수 없습니다. |

_HTTP 401_

```abash
    {
      "errors": [
        {
           "code": 32,
          "message": "Could not authenticate you."
        }
      ]
    }
```

#### GET account\_activity/webhooks/:webhook\_id/subscriptions/all[](#get-account-activity-webhooks-webhook-id-subscriptions-all "이 제목의 고유 링크")

웹훅 구성이 지정된 사용자의 이벤트에 대해 구독되어 있는지 확인하는 방법을 제공합니다. 제공된 사용자 컨텍스트가 해당 애플리케이션에 대해 활성 구독 상태라면 204 OK를 반환합니다. 응답 코드가 204가 아니면 해당 사용자는 활성 구독이 없습니다. 자세한 내용은 아래의 HTTP 응답 코드와 오류 메시지를 참조하세요.

### 리소스 URL[](#resource-url "Permalink to this headline")

`https://api.x.com/1.1/account_activity/webhooks/:webhook_id/subscriptions/all.json`

<div id="resource-url">
  ### 리소스 정보[](#resource-information "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| 응답 형식 | JSON |
| 인증 필요 | 예(3-legged OAuth - 화이트리스트에 등록된 consumer key 및 구독 사용자의 access token) |
| 속도 제한 | 예 |
| 요청 수/15분 창(사용자 인증) | 500 |

### 매개변수[](#parameters "Permalink to this headline")

|     |     |
| :--- | :--- |
| webhook\_id (필수) | Webhook ID. 리소스 경로에서 정의됩니다. |

### 예제 요청[](#example-request "이 머리글에 대한 고유 링크")

$ curl --request GET
\--url https://api.x.com/1.1/account\_activity/webhooks/:WEBHOOK\_ID/subscriptions/all.json
\--header 'authorization: OAuth oauth\_consumer\_key="WHITELISTED\_CONSUMER\_KEY", oauth\_nonce="GENERATED", oauth\_signature="GENERATED", oauth\_signature\_method="HMAC-SHA1", oauth\_timestamp="GENERATED", oauth\_token="SUBSCRIBING\_USER'S\_ACCESS\_TOKEN", oauth\_version="1.0"'

### 예시 응답 - 성공[](#example-response-success "Permalink to this headline")

_HTTP 204 콘텐츠 없음_

```
    { }
```

#### GET account\_activity/webhooks/:webhook\_id/subscriptions/all/list[](#get-account-activity-webhooks-webhook-id-subscriptions-all-list "이 제목의 퍼머링크")

지정된 웹훅에 대한 현재 All Activity 유형의 구독 목록을 반환합니다. /list 엔드포인트는 애플리케이션 전용 OAuth가 필요하므로 사용자 컨텍스트 대신 베어러 토큰을 사용해 요청해야 합니다.

### 리소스 URL[](#resource-url "Permalink to this headline")

`https://api.x.com/1.1/account_activity/webhooks/:webhook_id/subscriptions/all/list.json`

<div id="resource-url">
  ### 리소스 정보[](#resource-information "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| 응답 형식 | HTTP 응답 코드 |
| 인증 필요 | 예(애플리케이션 전용 - 베어러 토큰) |
| 레이트 리밋 적용 | 예 |
| 15분당 요청 수(애플리케이션 인증) | 50  |

### 매개변수[](#parameters "Permalink to this headline")

|     |     |
| :--- | :--- |
| webhook\_id (필수) | Webhook ID. 리소스 경로에서 정의됩니다. |

<div id="resource-information">
  ### HTTP 응답 코드[](#http-response-codes "Permalink to this headline")
</div>

| 코드 | 메시지 |
| :--- | :--- |
| 200 | 성공. 요청한 webhook의 구독 목록이 반환됩니다. |
| 401 | 해당 webhook의 구독을 조회할 권한이 애플리케이션에 없습니다. |

### 요청 예시[](#example-request "이 제목으로 연결되는 고유 링크")

$ curl --request GET
\--url https://api.x.com/1.1/account\_activity/webhooks/:WEBHOOK\_ID/subscriptions/all/list.json
\--header 'authorization: Bearer TOKEN'

### 예시 응답 - 성공[](#example-response-success "Permalink to this headline")

_HTTP 200_

```bash
    {
      "webhook_id": "1234567890",
      "webhook_url": "https://your_domain.com/webhook/twitter/0",
      "application_id": "11231812",
      "subscriptions": [{
        "user_id": "20212306"
      }]
    }
```

### 오류 메시지[](#error-messages "이 제목으로의 퍼머링크")

| 코드 | 메시지 |
| :--- | :--- |
| 32  | 인증할 수 없습니다. |

_HTTP 401_

```bash
    {
      "errors": [
        {
           "code": 32,
          "message": "Could not authenticate you."
        }
      ]
    }
```

#### DELETE account\_activity/webhooks/:webhook\_id[](#delete-account-activity-webhooks-webhook-id "Permalink to this headline")

지정한 애플리케이션의 설정에서 웹훅을 제거합니다. 웹훅 ID는 GET /1.1/account\_activity/webhooks 호출로 확인할 수 있습니다.

### 리소스 URL[](#resource-url "Permalink to this headline")

`https://api.x.com/1.1/account_activity/webhooks/:webhook_id.json`
\---MDX\_CONTENTEND---

### 리소스 정보[](#resource-information "이 제목의 고유 링크")

|     |     |
| :--- | :--- |
| 응답 형식 | JSON |
| 인증 필요 | 예(사용자 컨텍스트 - 모든 컨슈머 및 액세스 토큰) |
| 제한 여부 | 예 |
| 요청 수/15분(사용자 인증) | 15 |

### 매개변수[](#parameters "Permalink to this headline")

|     |     |
| :--- | :--- |
| webhook\_id (필수) | Webhook ID. 리소스 경로에서 정의됩니다. |

### 예제 요청[](#example-request "Permalink to this headline")

```bash
    $ curl --request DELETE
     --url https://api.x.com/1.1/account_activity/webhooks/:WEBHOOK_ID.json
     --header 'authorization: OAuth oauth_consumer_key="CONSUMER_KEY", oauth_nonce="GENERATED", oauth_signature="GENERATED", oauth_signature_method="HMAC-SHA1", oauth_timestamp="GENERATED", oauth_token="ACCESS_TOKEN", oauth_version="1.0"'
```

<div id="example-request">
  ### 응답[](#response "Permalink to this headline")
</div>

_HTTP 204 정상 응답_

```
    { }
```

#### DELETE account\_activity/webhooks/:webhook\_id/subscriptions/all (지원 중단됨)[](#delete-account-activity-webhooks-webhook-id-subscriptions-all-deprecated- "Permalink to this headline")

제공된 사용자 컨텍스트와 애플리케이션에 대한 구독을 비활성화합니다. 비활성화되면 요청한 사용자와 관련된 모든 이벤트가 더 이상 웹후크 URL로 전송되지 않습니다.

### 리소스 URL[](#resource-url "Permalink to this headline")

`https://api.x.com/1.1/account_activity/webhooks/:webhook_id/subscriptions/all.json`

### 리소스 정보[](#resource-information "이 제목의 고유 링크")

|     |     |
| :--- | :--- |
| 응답 형식 | JSON |
| 인증 필요 | 예(3-legged OAuth - 화이트리스트 등록 consumer key 및 구독 사용자 access token) |
| 할당량 제한 | 예 |
| 요청 수/15분(사용자 인증) | 500 |

### 매개변수[](#parameters "Permalink to this headline")

|     |     |
| :--- | :--- |
| webhook\_id (필수) | Webhook ID. 리소스 경로에서 정의됩니다. |

### 예시 요청[](#example-request "Permalink to this headline")

```bash
    $ curl --request DELETE
     --url https://api.x.com/1.1/account_activity/webhooks/:WEBHOOK_ID/subscriptions/all.json
     --header 'authorization: OAuth oauth_consumer_key="WHITELISTED_CONSUMER_KEY", oauth_nonce="GENERATED", oauth_signature="GENERATED", oauth_signature_method="HMAC-SHA1", oauth_timestamp="GENERATED", oauth_token="SUBSCRIBED_USER'S_ACCESS_TOKEN", oauth_version="1.0"'
```

예시 요청

```
    { }
```

#### DELETE /account\_activity/webhooks/:webhook\_id/subscriptions/:user\_id/all.json[](#delete-account-activity-webhooks-webhook-id-subscriptions-user-id-all-json "Permalink to this headline")

지정된 webhook 및 사용자 ID의 구독을 비활성화합니다. 비활성화되면 요청한 사용자에 대한 모든 이벤트가 더 이상 webhook URL로 전송되지 않습니다. 참고: 이 엔드포인트는 애플리케이션 전용 OAuth가 필요하므로 사용자 컨텍스트 대신 베어러 토큰으로 요청해야 합니다.

### 리소스 URL[](#resource-url "이 제목의 고유 링크")

`https://api.x.com/1.1/account_activity/webhooks/:webhook_id/subscriptions/:user_id/all.json`

<div id="resource-url">
  ### 리소스 정보[](#resource-information "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| 응답 형식 | JSON |
| 인증 필요 | 예(애플리케이션 전용 - 베어러 토큰) |
| 요청 제한 | 예 |
| 15분당 요청 수 | 500 |

### 예제 요청[](#example-request "이 제목으로 이동")

```bash
    $ curl --request DELETE
     --url https://api.x.com/1.1/account_activity/webhooks/:webhook_id/subscriptions/:user_id/all.json
     --header 'authorization: Bearer TOKEN'
```

<div id="example-request">
  ### 응답[](#response "Permalink to this headline")
</div>

_HTTP 204 내용 없음_

### 오류 메시지[](#error-messages "이 제목의 고유 링크")

| 코드 | 메시지 |
| :--- | :--- |
| 404 | 죄송합니다. 해당 페이지가 존재하지 않습니다. - 지정한 사용자 ID가 실제로 구독되어 있지 않을 때 흔히 발생합니다. |

<div id="error-messages">
  ### 재생 API
</div>

**POST /1.1/account\_activity/replay/webhooks/:webhook\_id/subscriptions/all.json [¶](#post-1-1-account-activity-replay-webhooks-webhook-id-subscriptions-all-json- "이 제목의 영구 링크")**

요청에 지정된 날짜와 시간 범위 동안 존재했던 모든 구독에서 최대 과거 5일치 활동을 가져오도록 요청을 제출합니다. 웹훅에 활성 사용자 구독이 있는 경우 해당 이벤트도 동시에 수신합니다. 참고: 재생 이벤트를 전달하기 전에 CRC를 수행합니다.

|     |     |
| :--- | :--- |
| **요청 메서드** | HTTP POST |
| **URL** | /1.1/account\_activity/replay/webhooks/:webhook\_id/subscriptions/all.json?from\_date=yyyymmddhhmm\&to\_date=yyyymmddhhmm |
| **응답 형식** | JSON |
| **인증 필요** | 예(애플리케이션 전용 - 베어러 토큰) |
| **요율 제한** | 15분당 5건의 요청. 현재 요청 가능한 재생 작업 수에는 상한이 없습니다. |
| **from\_date** | 이벤트 제공의 시작점이 되는 가장 이른 UTC 타임스탬프로, 'yyyymmddhhmm' 형식이어야 합니다. 타임스탬프는 분 단위 세분화 수준이며 포함입니다(예: 12:00은 00분을 포함). 유효한 시간은 최근 5일 이내(UTC)여야 하며, 현재 시각으로부터 최소 31분 이전이어야 합니다. from\_date와 to\_date는 약 2시간 이내 범위로 설정하는 것을 권장합니다. |
| **to\_date** | 이벤트 제공의 종료점이 되는 가장 늦은 UTC 타임스탬프로, 'yyyymmddhhmm' 형식이어야 합니다. 타임스탬프는 분 단위 세분화 수준이며 배타입니다(예: 12:30은 해당 시의 30분을 포함하지 않음). 유효한 시간은 최근 5일 이내(UTC)여야 하며, 현재 시각으로부터 최소 10분 이전이어야 합니다. |

#### 응답

다음 응답이 API에서 반환될 수 있습니다. 대부분의 오류 코드는 본문에 추가 세부 정보를 포함한 문자열과 함께 반환됩니다. 200이 아닌 응답의 경우 오류를 해결한 뒤 다시 시도해야 합니다.

| 상태 | 텍스트 | 오류 코드 | 설명 | 메시지 |
| :--- | :--- | :--- | :--- | :--- |
| 202 | Accepted | N/A | 요청이 성공했으며 활동 내역이 전송됩니다. | N/A |
| 400 | Bad Request | 214 | Webhook이 유효하지 않은 것으로 표시되었습니다. | Webhook이 유효하지 않아 CRC 검사가 필요합니다. |
| 400 | Bad Request | 357 | 쿼리 매개변수가 누락되었습니다. | : queryParam은 필수입니다. |
| 400 | Bad Request | 358 | 경로 또는 쿼리 매개변수의 형식이 올바르지 않습니다. | 매개변수를 구문 분석할 수 없습니다. |
| 400 | Bad Request | 360 | 경로 매개변수가 음수입니다. | webhook\_id: \[]는 0보다 크거나 같아야 합니다. |
| 400 | Bad Request | 368 | from\_date 또는 to\_date가 과거 시점이 아닙니다. | : \[\<field\_value>]는 과거가 아닙니다. |
| 400 | Bad Request | 356 | from\_date는 to\_date보다 이전이어야 합니다. | from\_date는 to\_date보다 이전이어야 합니다. |
| 400 | Bad Request | 356 | from\_date는 과거 5일 이내여야 합니다. | from\_date는 과거 5일 이내여야 합니다. |
| 401 | Unauthorized | 32  | 3-legged 인증이 제공되어 HTTP 인증에 실패했습니다. | 잘못된 인증 방식입니다. 애플리케이션 전용 인증을 사용하세요. |
| 401 | Unauthorized | 61  | 클라이언트가 이 메서드를 요청할 권한이 없습니다. | 클라이언트가 이 메서드를 요청할 권한이 없습니다. |
| 403 | Forbidden | 200 | 클라이언트에 Replay가 활성화된 엔터프라이즈 계정이 없습니다. | Account Activity API 엔터프라이즈 계정(Replay 활성화)이 필요합니다. 엔터프라이즈 계정 보유 및 Replay 활성화 여부를 확인하세요. |
| 404 | Not Found | 34  | 존재하지 않는 webhook\_id 또는 webhook\_id와 application\_id 불일치. | Webhook이 존재하지 않거나 다른 X 애플리케이션과 연결되어 있습니다. |
| 409 | Conflict | 355 | 처리 중인 요청이 있어, 다른 요청을 하려면 처리가 완료되어야 합니다. | 이 webhook에 대한 재생 작업이 이미 진행 중입니다. |
| 429 | Too Many Requests | 88  | 레이트 리밋(단위 시간당 요청 수 한도 초과) | 요청이 너무 많습니다. API 요청 속도를 낮추세요. |
| 500 | Internal Server Error | 0   | 내부 서버 오류입니다. | 내부 서버 오류입니다. |
| 503 | Service Unavailable | 67  | X의 하나 이상의 종속 서비스가 사용 불가입니다. | X 서버 오류입니다. 지수 백오프 패턴으로 재시도하세요. |

<div id="responses">
  #### "작업이 성공적으로 완료되었습니다" 메시지
</div>

작업이 성공적으로 완료되면 Account Activity Replay API가 다음과 같은 작업 완료 이벤트를 전달합니다. 이 이벤트를 받으면 작업이 종료되었으며, 다른 작업을 제출할 수 있습니다.

```json
{
  "replay\_job\_status": {
    "webhook_id": "1234577122340233217",
    "job_state": "Complete",
    "job\_state\_description": "Job completed successfully"
    "job_id": "1095098195724558337"
  }
}
```

<div id="job-completed-successfully-message">
  #### "작업 완료 실패" 메시지
</div>

작업이 정상적으로 완료되지 않은 경우 Replay 작업을 다시 시도하도록 권장하는 다음 메시지가 반환됩니다. 이 이벤트를 수신하면 해당 작업의 실행은 종료되었으며, 다른 작업을 제출할 수 있습니다.

```json
{
  "replay\_job\_status": {
    "webhook_id": "123451374207332352",
    "job_state": "Incomplete",
    "job\_state\_description": "Job failed to deliver all events, please retry your replay job",
    "job_id": "1093226942650736640"
  }
}
```

<div id="job-failed-to-complete-message">
  #### curl 요청 예시
</div>

```bash
    curl --request POST  --url 'https://api.x.com/1.1/account_activity/replay/webhooks/:webhook_id/subscriptions/all.json?from_date=yyyymmddhhmm&to_date=yyyymmddhhmm'
    --header 'authorization: Bearer TOKEN'
```

<div id="example-curl-request">
  #### 예시 응답
</div>

HTTP 202

```bash
{
  "job_id": "1234567890",
  "created_at": "2016-06-02T23:54:02Z"
}
```