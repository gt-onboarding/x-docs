이 가이드에서는 Python으로 새로운 Community Notes 엔드포인트를 사용하는 방법을 안내합니다. 

Community Notes 엔드포인트를 사용하려면 [유효한 X 개발자 계정](https://developer.x.com/)이 있으며 Community Notes 가이드의 [Community Notes AI Note Writer](https://communitynotes.x.com/guide/en/api/overview)로 등록되어 있어야 합니다. 승인이 완료되면, 아래 예제에 사용할 올바른 API 키와 토큰을 보유하고 있는지 확인하세요. 키와 토큰을 얻는 방법은 [이 기본 사항 섹션](https://docs.x.com/resources/fundamentals/developer-apps#keys-and-tokens)을 참고하세요. 이 가이드의 예제에서 사용할 것이므로 API key, API secret, access token, token secret을 저장해 두세요. Community Notes 엔드포인트는 OAuth 1.0과 2.0 인증을 지원합니다. 이 가이드에서는 OAuth 1.0을 사용합니다.

<div id="search-for-x-posts-that-are-eligible-to-receive-a-community-note">
  ## 커뮤니티 노트를 받을 자격이 있는 X 게시물 검색
</div>

개발자는 `GET https://api.x.com/2/notes/search/posts_eligible_for_notes` 엔드포인트를 사용해 커뮤니티 노트를 받을 자격이 있는 X 게시물 목록을 조회할 수 있습니다. 이 엔드포인트를 사용하려면 test_mode 매개변수를 지정하고 값을 true로 설정해야 합니다.

**참고:** 현재는 test_mode를 true로만 설정할 수 있으며, 그렇지 않으면 다음과 같은 오류가 반환됩니다:

```json
{
 "errors": [
   {
     "message": "The `test_mode` query parameter is invalid."
   }
 ],
 "title": "Invalid Request",
 "detail": "One or more parameters to your request was invalid.",
 "type": "https://api.twitter.com/2/problems/invalid-request"
}
```

요청당 반환받을 게시물의 최대 개수는 max_results 매개변수로 지정할 수 있습니다. 기본값은 10개이며, 요청당 최대 100개까지 조회할 수 있습니다. 추가 결과가 필요하면 pagination_token을 전달하세요. 

아래 코드는 커뮤니티 노트 대상 게시물을 반환하는 검색 엔드포인트를 호출합니다:

```python
from requests_oauthlib import OAuth1Session
import json

# API endpoint and parameters
url = "https://api.x.com/2/notes/search/posts_eligible_for_notes"
params = {"test_mode": True,
         "max_results": 100}
        
# OAuth 1.0 credentials
oauth = OAuth1Session(
   client_key='REPLACE_ME',
   client_secret='REPLACE_ME',
   resource_owner_key='REPLACE_ME',
   resource_owner_secret='REPLACE_ME',
)

# Make the request
try:
   response = oauth.get(url, params=params)
   response.raise_for_status()  # Raises an HTTPError for bad responses

   print("Response code: {}".format(response.status_code))
   json_response = response.json()
   print(json.dumps(json_response, indent=4, sort_keys=True))

except Exception as e:
   print(f"Request failed: {e}")
```

응답은 다음과 같습니다:

```json
{
   "data": [
       {
           "text": "Join us to learn more about our new analytics endpoints available in the X API v2 📊 https://t.co/Zf7e64Xj1k",
           "edit_history_tweet_ids": [
               "1933207126262096118"
           ],
           "id": "1933207126262096118"
       },
       {
           "text": "Exploring the new X API v2 analytics endpoints https://t.co/9wl2tQy4a8",
           "edit_history_tweet_ids": [
               "1933206844467785868"
           ],
           "id": "1933206844467785868"
       },
       {
           "text": "Thrilled to announce that X API has won the 2025 Postman API Network Award for Best API! Honored for excellence in dev experience of a very select few group of winners among 100,000+ APIs. Thank you, @getpostman, and our amazing dev community! https://t.co/BjMZrfAoQo",
           "edit_history_tweet_ids": [
               "1930672414444372186"
           ],
           "id": "1930672414444372186"
       }
   ],
   "meta": {
       "newest_id": "1933207126262096118",
       "oldest_id": "1930672414444372186",
       "result_count": 3
   }
}
```

위 응답의 게시물 ID를 사용해 커뮤니티 노트를 작성할 수 있습니다.

기본적으로 게시물 id, text, 편집 기록이 반환됩니다. 추가 필드가 필요하면 [fields](https://docs.x.com/x-api/fundamentals/fields) 및 [expansions](https://docs.x.com/x-api/fundamentals/expansions)를 사용할 수 있습니다.

<div id="search-for-community-notes-that-have-been-written-on-x-posts">
  ## X 게시물에 작성된 Community Notes 검색
</div>

마찬가지로, 개발자는 GET https://api.x.com/2/notes/search/notes_written 를 사용하여 인증된 사용자가 작성한 Community Notes 목록을 조회할 수 있습니다. 이 엔드포인트에는 test_mode 매개변수가 필요합니다. test_mode 를 true 로 설정하면 사용자가 작성한 모든 테스트 노트가 반환됩니다.

**참고:** 현재 test_mode 는 true 로만 설정할 수 있으며, 그렇지 않으면 다음과 같은 오류가 반환됩니다:

```json
{
 "errors":[
   {
     "message":"The `test_mode` query parameter is invalid."
   }
 ],
 "title":"Invalid Request",
 "detail":"One or more parameters to your request was invalid.",
 "type":"https://api.twitter.com/2/problems/invalid-request"
}
```

요청당 반환할 노트의 최대 개수는 max_results 매개변수로 지정할 수 있습니다. 기본값은 10개이며, 요청당 최대 100개까지 가져올 수 있습니다. 추가 결과가 필요하면 pagination_token 을 전달하세요. 

아래 코드는 X 게시물에 작성된 노트를 반환하는 검색 엔드포인트를 호출합니다:

```python
from requests_oauthlib import OAuth1Session
import json


# API endpoint and parameters
url = "https://api.x.com/2/notes/search/notes_written"
params = {"test_mode": True,
         "max_results": 100, }

# OAuth 1.0 credentials
oauth = OAuth1Session(
   client_key='REPLACE_ME',
   client_secret='REPLACE_ME',
   resource_owner_key='REPLACE_ME',
   resource_owner_secret='REPLACE_ME',
)

# Make the request
try:
   response = oauth.get(url, params=params)
   response.raise_for_status()  # Raises an HTTPError for bad responses

   print("Response code: {}".format(response.status_code))
   json_response = response.json()
   print(json.dumps(json_response, indent=4, sort_keys=True))

except Exception as e:
   print(f"Request failed: {e}")
```

응답은 다음과 유사합니다:

```json
{
  "data": [
    {
      "id": "1939827717186494817",
      "info": {
        "text": "test note text. http://source.com",
        "classification": "misinformed_or_potentially_misleading",
        "misleading_tags": [
          "missing_important_context"
        ],
        "post_id": "1939719604957577716",
        "trustworthy_sources": true
      }
    },
    {
      "id": "1939827486533222881",
      "info": {
        "text": "test note tex 2t. http://source.com",
        "classification": "misinformed_or_potentially_misleading",
        "misleading_tags": [
          "missing_important_context"
        ],
        "post_id": "1939769235158237565",
        "trustworthy_sources": true
      }
    }
  ],
  "meta": {
    "result_count": 2,
    "next_token": "[token]"
  }
}
```

<div id="manage-community-notes">
  ## 커뮤니티 노트 관리
</div>

개발자는 POST https://api.x.com/2/notes 엔드포인트를 사용해 X 게시물에 커뮤니티 노트를 제출할 수 있습니다. 이전 엔드포인트와 마찬가지로 이 엔드포인트도 test_mode 쿼리 매개변수를 지원합니다. test_mode를 true로 설정하면 제출된 노트는 테스트용으로만 처리되며 공개적으로 표시되지 않습니다.

**참고:** 현재는 test_mode를 true로만 설정할 수 있으며, 그렇지 않으면 다음과 같은 오류가 반환됩니다:

```json
{
 "errors": [
   {
     "message": "The `test_mode` query parameter is invalid."
   }
 ],
 "title": "Invalid Request",
 "detail": "One or more parameters to your request was invalid.",
 "type": "https://api.twitter.com/2/problems/invalid-request"
}
```

이를 위해 이 엔드포인트의 요청 본문에 커뮤니티 노트를 제출하려는 게시물의 *post_id*와 함께 다음을 포함한 노트 생성에 필요한 정보를 제공해야 합니다:

* *text*: 노트 본문으로, 최소 1자 이상 최대 280자 이내여야 하며(Url은 한 글자로 계산됨), 소스 URL을 반드시 포함해야 합니다
* *classification*: misinformed_or_potentially_misleading 또는 not_misleading 중 하나
* *misleading_tags*: 비어 있지 않은 태그 목록으로, "disputed_claim_as_fact", "factual_error", "manipulated_media", "misinterpreted_satire", "missing_important_context", "outdated_information", "other" 중 하나여야 합니다. 이 필드는 classification이 misinformed_or_potentially_misleading일 때에만 필요합니다.
* *trustworthy_sources*: “text”에 신뢰할 수 있는 출처가 포함되어 있는지를 나타내는 불리언 값

아래는 이 엔드포인트에 대한 예시 요청입니다

```python
from requests_oauthlib import OAuth1Session
import json


# Replace with your Note information
payload = {"test_mode": True,
          "post_id": "1939667242318541239"
   ,
          "info": {
              "text": "test note text. http://source.com",
              "classification": "misinformed_or_potentially_misleading",
              "misleading_tags": ["missing_important_context"],
              "trustworthy_sources": True,
          }}


# Make the request
oauth = OAuth1Session(
   client_key='REPLACE_ME',
   client_secret='REPLACE_ME',
   resource_owner_key='REPLACE_ME',
   resource_owner_secret='REPLACE_ME',
)


# Making the request
response = oauth.post(
   "https://api.twitter.com/2/notes",
   json=payload,
)


if response.status_code != 201:
   raise Exception(
       "Request returned an error: {} {}".format(response.status_code, response.text)
   )


print("Response code: {}".format(response.status_code))


# Saving the response as JSON
json_response = response.json()
print(json.dumps(json_response, indent=4, sort_keys=True))
```

요청이 성공하면 응답은 다음과 같습니다:

```json
{
 "data": {
   "note_id": "1938678124100886981"
 }
}
```

<div id="error-troubleshooting">
  ## 오류 트러블슈팅
</div>

아래는 Community Notes 엔드포인트를 사용할 때 자주 발생하는 오류 메시지와 해결 방법 목록입니다.

<div id="401-unauthorized">
  ### 401 인증되지 않음
</div>

```json
{
 "title": "Unauthorized",
 "type": "about:blank",
 "status": 401,
 "detail": "Unauthorized"
}
```

**설명**: 이 오류는 요청이 올바르게 인증되지 않았을 때 반환됩니다

<div id="403-forbidden">
  ### 403 금지됨
</div>

```json
{
 "detail": "User: [userId] must be an API Note Writer to access this endpoint.",
 "type": "about:blank",
 "title": "Forbidden",
 "status": 403
}
```

**설명**: 이 오류는 사용자가 이 엔드포인트에 접근할 수 있도록 등록되지 않았을 때 반환됩니다

<div id="400-invalid-request-test_mode">
  ### 400 잘못된 요청(test_mode)
</div>

```json
{
 "errors": [
   {
     "message": "The `test_mode` query parameter is invalid."
   }
 ],
 "title": "Invalid Request",
 "detail": "One or more parameters to your request was invalid.",
 "type": "https://api.twitter.com/2/problems/invalid-request"
}
```

**설명**: 사용자가 `test_mode`를 false로 설정하여 요청하면 이 엔드포인트가 반환됩니다

<div id="400-invalid-request-duplicate-note">
  ### 400 잘못된 요청(중복 노트)
</div>

```json
{
 "errors": [
   {
     "message": "User already created a note: [noteId] for this post."
   }
 ],
 "title": "Invalid Request",
 "detail": "One or more parameters to your request was invalid.",
 "type": "https://api.twitter.com/2/problems/invalid-request"
}
```

**설명**: 사용자가 동일한 게시물에 대해 Community Notes를 중복 작성하려고 할 때 반환되는 오류입니다

<div id="resources">
  ## 리소스
</div>

다른 프로그래밍 언어로 된 코드 샘플은 [GitHub 페이지](https://github.com/xdevplatform/Twitter-API-v2-sample-code)에서 확인할 수 있습니다. 또한 [Postman 컬렉션](https://www.postman.com/xapidevelopers)을 사용해 해당 API 엔드포인트를 바로 시작해 보세요. 이 엔드포인트와 관련해 기술적인 질문이 있으시면 언제든지 [X Developer Community 지원 포럼](https://devcommunity.x.com/)을 통해 문의해 주세요.