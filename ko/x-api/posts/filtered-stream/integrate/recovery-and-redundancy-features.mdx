---
title: 복구 및 중복 대비
sidebarTitle: 복구 및 중복 대비
---

<div id="introduction">
  #### 소개
</div>

스트리밍 데이터를 사용할 때 연결 시간을 최대로 유지하고 일치하는 모든 데이터를 수신하는 것이 핵심 목표입니다. 이를 위해서는 중복 연결을 활용하고, 연결 끊김을 자동으로 감지해 신속히 재연결하며, 누락된 데이터를 복구할 계획을 갖추는 것이 중요합니다.

이 통합 가이드에서는 다양한 복구 및 중복 기능(중복 연결, 백필, 복구)에 대해 설명합니다.
 

**중복 연결**

중복 연결은 필터드 스트림에 두 개 이상의 동시 연결을 설정할 수 있게 합니다. 이는 동일한 스트림에 두 개의 별도 소비자(consumer)로 연결하여 두 연결 모두에서 동일한 데이터를 수신함으로써 중복성을 제공합니다. 따라서 한 스트림이 끊기거나 애플리케이션의 기본 서버에 장애가 발생하는 등 다양한 상황에서 앱이 즉시 장애 조치(hot failover)를 수행할 수 있습니다.

필터드 스트림은 현재 엔터프라이즈 액세스가 있는 프로젝트에 한해 최대 두 개의 중복 연결을 허용합니다. 중복 스트림을 사용하려면 기본 연결에 사용한 것과 동일한 URL로 연결하면 됩니다. 스트림 데이터는 두 연결 모두를 통해 전송됩니다.

<div id="recovering-missed-data-after-a-disconnection-backfill">
  #### 연결 끊김 이후 누락된 데이터 복구: 백필(Backfill)
</div>

연결 끊김을 감지한 후에는 스트림에 자동으로 재연결할 수 있어야 합니다. 가능하다면 끊겨 있던 시간을 기록하여 적절한 복구 기능로 데이터를 백필할 수 있도록 하십시오. 

Enterprise 액세스가 있는 프로젝트를 사용 중이고 연결 끊김이 5분 이내였음을 확인했다면, 백필 매개변수인 backfill\_minutes를 사용할 수 있습니다. 이 매개변수를 [GET /tweets/search/stream](/ko/x-api/posts/filtered-stream#get-2-tweets-search-stream) 요청에 함께 전달하면, 과거 1~5분 이내 규칙과 일치하는 게시물(Posts)을 받게 됩니다. 일반적으로 이러한 이전 게시물이 새로 일치한 게시물보다 먼저 전달되며, 중복 제거는 수행하지 않습니다. 예를 들어 90초 동안 연결이 끊겼는데 2분 분량의 백필 데이터를 요청하면, 30초 분량의 중복 게시물을 받게 되므로 시스템이 이를 허용하도록 설계되어야 합니다. 다음은 backfill 매개변수를 사용한 요청 예시입니다:

`curl 'https://api.x.com/2/tweets/search/stream?backfill_minutes=5' -H "Authorization: Bearer $ACCESS_TOKEN"`

Enterprise 액세스가 없거나 연결 끊김 시간이 5분을 초과한 경우에는 [recent search endpoint](/ko/x-api/posts/search/introduction) 또는 복구 기능을 활용하여 누락된 데이터를 요청할 수 있습니다. 다만, 검색용 게시물 엔드포인트에는 sample:, bio:, bio\_name:, bio\_location: 연산자가 포함되지 않으며, 키워드 및 #hashtag 연산자에서 악센트/발음 구별 기호 사용 시 매칭 동작에 차이가 있다는 점에 유의하십시오. 이러한 차이로 인해 필터드 스트림 엔드포인트를 통해 수신되었을 수 있는 모든 게시물을 완전히 복구하지 못할 수 있습니다. 

**연결 끊김 이후 누락된 데이터 복구: Recovery**

Enterprise 액세스가 있는 프로젝트를 사용하는 경우, 5분 백필 윈도 내에 재연결하지 못했다면 Recovery 기능을 사용해 최근 24시간 내의 누락 데이터를 복구할 수 있습니다.

스트리밍 복구 기능은 최대 24시간의 확장 백필 윈도를 제공합니다. Recovery를 사용하면 누락된 데이터가 발생한 기간을 ‘재생(replay)’할 수 있습니다. 'start\_time'과 'end\_time' 요청 매개변수를 사용해 연결 요청을 보내면 복구 스트림이 시작됩니다. 연결되면 Recovery가 지정된 기간을 재스트리밍한 뒤 연결을 종료합니다.  

동시에 최대 2개의 복구 요청, 즉 “두 개의 복구 작업”을 수행할 수 있습니다. Recovery는 시작 시각과 종료 시각을 정의한다는 점을 제외하면 기술적으로 백필과 동일하게 동작합니다. 하나의 복구 기간은 단일 시간 범위에 해당합니다.

|     |     |     |
| :--- | :--- | :--- |
| **Name** | **Type** | **Description** |
| start\_time | date (ISO 8601) | YYYY-MM-DDTHH:mm:ssZ (ISO 8601/RFC 3339).<br /><br />복구를 시작할 UTC 기준 시작 시각. |
| end\_time | date (ISO 8601) | YYYY-MM-DDTHH:mm:ssZ (ISO 8601/RFC 3339).<br /><br />복구를 종료할 UTC 기준 종료 시각. |

예시 요청 URL: [https://api.x.com/2/tweets/search/stream?start\_time=2022-07-12T15:10:00Z\&end\_time=2022-07-12T15:20:00Z](https://api.x.com/2/tweets/search/stream?start_time=1985-04-12T23:20:50.52Z\&end_time=1985-04-13T00:20:50.52Z)