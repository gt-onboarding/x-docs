---
title: OAuth 2.0 권한 부여 코드 흐름(PKCE)
sidebarTitle: OAuth 2.0 권한 부여 코드 흐름(PKCE)
---

<div id="oauth-20-authorization-code-flow-with-pkce">
  ### OAuth 2.0 인증 코드 플로우(PKCE)
</div>

<div id="introduction">
  #### 소개
</div>

OAuth 2.0는 애플리케이션의 권한 범위와 여러 기기에서의 인가 흐름을 보다 정밀하게 제어할 수 있게 해주는 업계 표준 인가 프로토콜입니다. OAuth 2.0을 사용하면 사용자를 대신해 특정 권한을 부여하는 세밀한 스코프를 선택할 수 있습니다.

앱에서 OAuth 2.0을 사용하려면 개발자 포털의 앱 설정 섹션에 있는 인증 설정에서 이를 활성화해야 합니다.

#### 내 자격 증명은 얼마나 오래 유효한가요?  

기본적으로 OAuth 2.0 with PKCE의 Authorization Code Flow로 생성한 액세스 토큰은 `offline.access` 범위를 사용하지 않은 경우 2시간만 유효합니다.

<div id="refresh-tokens">
  #### 리프레시 토큰
</div>

리프레시 토큰은 리프레시 토큰 플로우를 통해 사용자 상호작용 없이 애플리케이션이 새 액세스 토큰을 발급받을 수 있게 합니다.

`offline.access` 스코프가 적용되면 OAuth 2.0 리프레시 토큰이 발급됩니다. 이 리프레시 토큰으로 액세스 토큰을 받을 수 있습니다. 이 스코프가 포함되지 않으면 리프레시 토큰은 발급되지 않습니다.

리프레시 토큰을 사용해 새 액세스 토큰을 받기 위한 요청 예시는 다음과 같습니다:

```bash
POST 'https://api.x.com/2/oauth2/token' \
--header 'Content-Type: application/x-www-form-urlencoded' \
--data-urlencode 'refresh_token=bWRWa3gzdnk3WHRGU1o0bmRRcTJ5VUxWX1lZTDdJSUtmaWcxbTVxdEFXcW5tOjE2MjIxNDc3NDM5MTQ6MToxOnJ0OjE' \
--data-urlencode 'grant_type=refresh_token' \
--data-urlencode 'client_id=rG9n6402A3dbUJKzXTNX4oWHJ
```

<div id="app-settings">
  #### 앱 설정
</div>

앱의 인증 설정을 OAuth 1.0a 또는 OAuth 2.0으로 선택할 수 있습니다. 또한 앱이 OAuth 1.0a와 OAuth 2.0을 모두 사용하도록 활성화할 수도 있습니다.

OAuth 2.0은 X API v2에서만 사용할 수 있습니다. OAuth 2.0을 선택한 경우 앱의 Keys and Tokens 섹션에서 Client ID를 확인할 수 있습니다. 

<div id="confidential-clients">
  #### 기밀 클라이언트
</div>

[기밀 클라이언트](https://datatracker.ietf.org/doc/html/rfc6749#section-2.1)는 자격 증명을 무단 당사자에게 노출하지 않고 안전하게 보관할 수 있으며, 권한 부여 서버와 안전하게 인증하여 클라이언트 시크릿을 보호합니다. 퍼블릭 클라이언트는 일반적으로 브라우저나 모바일 기기에서 실행되므로 클라이언트 시크릿을 사용할 수 없습니다. 기밀 클라이언트 유형의 앱을 선택하면 클라이언트 시크릿이 제공됩니다.

개발자 포털에서 기밀 클라이언트 유형을 선택했다면 Client Secret도 확인할 수 있습니다. 선택지는 Native App, Single Page App, Web App, Automated App 또는 Bot입니다. Native App과 Single Page App은 퍼블릭 클라이언트이며, Web App과 Automated App 또는 Bot은 기밀 클라이언트입니다.

유효한 Authorization 헤더를 사용하는 기밀 클라이언트에는 Client ID가 필요하지 않습니다. 퍼블릭 클라이언트로 요청하는 경우에는 요청 본문에 Client ID를 포함해야 합니다. 

<div id="scopes">
  #### 스코프
</div>

스코프를 사용하면 앱이 필요한 권한만 갖도록 접근 권한을 세분화해 설정할 수 있습니다. 각 스코프가 어떤 엔드포인트에 매핑되는지 알아보려면 [인증 매핑 가이드](/ko/resources/fundamentals/authentication/guides/v2-authentication-mapping)를 확인하세요.

|     |     |
| :--- | :--- |
| **스코프** | **설명** |
| tweet.read | 보호된 계정을 포함해 사용자가 볼 수 있는 모든 트윗. |
| tweet.write | 사용자를 대신해 트윗 작성 및 리트윗. |
| tweet.moderate.write | 사용자의 트윗에 대한 답글 숨기기 및 숨기기 해제. |
| users.email | 인증된 사용자의 이메일. |
| users.read | 보호된 계정을 포함해 사용자가 볼 수 있는 모든 계정. |
| follows.read | 사용자를 팔로우하는 사람들과 사용자가 팔로우하는 사람들. |
| follows.write | 사용자를 대신해 팔로우 및 언팔로우. |
| offline.access | 사용자가 액세스를 취소할 때까지 계정에 계속 연결 유지. |
| space.read | 사용자가 볼 수 있는 모든 스페이스. |
| mute.read | 사용자가 뮤트한 계정. |
| mute.write | 사용자를 대신해 계정 뮤트 및 뮤트 해제. |
| like.read | 사용자가 좋아요한 트윗과 사용자가 볼 수 있는 좋아요. |
| like.write | 사용자를 대신해 트윗에 좋아요 또는 좋아요 취소. |
| list.read | 사용자가 생성했거나 구성원인 리스트의 리스트, 리스트 멤버, 리스트 팔로워(비공개 리스트 포함). |
| list.write | 사용자를 대신해 리스트 생성 및 관리. |
| block.read | 사용자가 차단한 계정. |
| block.write | 사용자를 대신해 계정 차단 및 차단 해제. |
| bookmark.read | 인증된 사용자의 북마크한 트윗 가져오기. |
| bookmark.write | 트윗에 북마크 추가 및 제거. |
| media.write | 미디어 업로드. |

<div id="rate-limits">
  #### 레이트 리밋
</div>

대부분의 경우 레이트 리밋은 OAuth 1.0a로 인증할 때와 동일하지만, Tweets 조회와 Users 조회는 예외입니다. Tweet 조회와 User 조회에 OAuth 2.0을 사용할 경우, 앱당 한도를 15분당 300건에서 900건으로 상향합니다. 자세한 내용은 [레이트 리밋 문서](/ko/resources/fundamentals/rate-limits)를 확인하세요.

<div id="grant-types">
  #### 그랜트 타입
</div>

초기 출시에서는 지원되는 [그랜트 타입](https://oauth.net/2/grant-types/)으로 [authorization code](https://oauth.net/2/grant-types/authorization-code/) + [PKCE](https://oauth.net/2/pkce/), 그리고 [refresh token](https://oauth.net/2/grant-types/refresh-token/)만 제공합니다. 추후 더 많은 그랜트 타입을 제공할 수 있습니다.

<div id="oauth-20-flow">
  #### OAuth 2.0 플로우
</div>

OAuth 2.0는 현재 OAuth 1.0a에서 사용하는 플로우와 유사한 절차를 따릅니다. 이 주제에 대한 다이어그램과 자세한 설명은 [해당 문서](/ko/resources/fundamentals/authentication/oauth-1-0a/obtaining-user-access-tokens)에서 확인할 수 있습니다. 

<div id="glossary">
  #### 용어집
</div>

|     |     |
| :--- | :--- |
| **용어** | **설명** |
| 부여 유형(Grant types) | OAuth 프레임워크는 다양한 사용 사례에 맞춘 여러 부여 유형과 새로운 부여 유형을 만들기 위한 프레임워크를 정의합니다. 예로 authorization code, client credentials, device code, refresh token 등이 있습니다. |
| 기밀 클라이언트 | 인가 서버와 안전하게 인증할 수 있는 애플리케이션을 말하며, 예를 들어 등록된 client secret을 안전하게 보관할 수 있습니다. |
| 공개 클라이언트 | 브라우저나 모바일 기기에서 실행되는 애플리케이션처럼 등록된 client secret을 사용할 수 없는 클라이언트를 말합니다. |
| Authorization code 플로우 | 기밀 클라이언트와 공개 클라이언트 모두가 authorization code를 access token으로 교환할 때 사용됩니다. |
| PKCE | 여러 공격을 방지하고 공개 클라이언트에서도 OAuth 교환을 안전하게 수행할 수 있도록 authorization code 플로우를 확장한 것입니다. |
| Client ID | 개발자 포털의 키 및 토큰 섹션에서 "Client ID" 항목 아래에서 확인할 수 있습니다. 보이지 않는 경우 당사 팀에 직접 문의해 주세요. authorize URL을 생성하려면 Client ID가 필요합니다. |
| Redirect URI | 콜백 URL입니다. [exact match validation](https://datatracker.ietf.org/doc/html/rfc6749#section-10.6)이 필요합니다. |
| Authorization code | 애플리케이션이 사용자를 대신해 API를 호출할 수 있도록 합니다. auth\_code로도 알려져 있습니다. 앱 소유자가 사용자로부터 승인된 auth\_code를 받으면 해당 auth\_code의 유효 시간은 30초입니다. 30초 이내에 access token으로 교환해야 하며, 그렇지 않으면 auth\_code가 만료됩니다. |
| Access token | 애플리케이션이 사용자를 대신하여 API 요청을 수행할 때 사용하는 토큰입니다. |
| Refresh token | refresh token 플로우를 통해 사용자에게 다시 동의를 요청하지 않고도 애플리케이션이 새로운 access token을 획득할 수 있도록 합니다. |
| Client Secret | 기밀 클라이언트 유형의 앱을 선택한 경우, 앱의 키 및 토큰 섹션에서 "Client ID" 아래에 "Client Secret"이 제공됩니다. |

<div id="parameters">
  #### 매개변수
</div>

OAuth 2.0 승인 URL을 구성하려면 승인 URL에 다음 매개변수가 포함되어 있는지 확인하세요. 

|     |     |
| :--- | :--- |
| **Parameter** | **Description** |
| response\_type | 이 값이 인가 코드임을 “code”로 지정해야 합니다. |
| client\_id | 개발자 포털의 "Client ID" 항목에서 확인할 수 있습니다. |
| redirect\_uri | 콜백 URL입니다. 이 값은 앱 설정에 정의된 Callback URLs 중 하나와 정확히 일치해야 합니다. OAuth 2.0의 경우 콜백 URL에 대해 [정확 일치 검증](https://datatracker.ietf.org/doc/html/rfc6749#section-10.6)이 필요합니다. |
| state | [CSRF 공격](https://auth0.com/docs/protocols/state-parameters) 방지를 위해 검증에 사용하는 임의의 문자열입니다. 길이는 최대 500자입니다. |
| code\_challenge | [PKCE](https://www.oauth.com/oauth2-servers/pkce/authorization-request/) 매개변수로, 각 요청마다 생성하는 임의의 시크릿입니다. |
| code\_challenge\_method | 요청에 사용할 방법을 지정합니다(S256 또는 plain). |

#### Authorize URL 

OAuth 2.0를 사용하면 사용자가 X의 “Sign In”과 유사한 인증 플로우를 통해 로그인할 수 있도록 authorize URL을 생성합니다. 

다음은 생성할 URL의 예시입니다: 

```
https://x.com/i/oauth2/authorize?response_type=code&client_id=M1M5R3BMVy13QmpScXkzTUt5OE46MTpjaQ&redirect_uri=https://www.example.com&scope=tweet.read%20users.read%20account.follows.read%20account.follows.write&state=state&code_challenge=challenge&code_challenge_method=plain
```

이 URL이 올바르게 동작하려면 적절한 인코딩이 필요합니다. [percent encoding](/ko/resources/fundamentals/authentication/oauth-1-0a/percent-encoding-parameters) 관련 문서를 확인하세요.